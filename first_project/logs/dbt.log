

============================== 2022-06-04 13:42:24.650737 | 6b323608-63a3-4df5-b7d4-d9efa9a2596e ==============================
13:42:24.650748 [info ] [MainThread]: Running with dbt=1.1.0
13:42:24.651104 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:42:24.651195 [debug] [MainThread]: Tracking: tracking
13:42:24.657220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe745dac9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe745dacc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe745daca60>]}
13:42:24.706669 [debug] [MainThread]: Executing "git --help"
13:42:24.722570 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:42:24.722920 [debug] [MainThread]: STDERR: "b''"
13:42:24.726093 [debug] [MainThread]: Acquiring new postgres connection "debug"
13:42:24.726416 [debug] [MainThread]: Using postgres connection "debug"
13:42:24.726495 [debug] [MainThread]: On debug: select 1 as id
13:42:24.726557 [debug] [MainThread]: Opening a new connection, currently in state init
13:42:24.731342 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
13:42:24.732267 [debug] [MainThread]: On debug: Close
13:42:24.732572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7445b2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7445b0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7445b0b20>]}
13:42:25.322233 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-04 14:18:18.532766 | 5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1 ==============================
14:18:18.532784 [info ] [MainThread]: Running with dbt=1.1.0
14:18:18.533251 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:18:18.533386 [debug] [MainThread]: Tracking: tracking
14:18:18.536053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bca45820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bca45fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bca45d30>]}
14:18:18.544313 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
14:18:18.544588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc9fa550>]}
14:18:18.550959 [debug] [MainThread]: Parsing macros/catalog.sql
14:18:18.553103 [debug] [MainThread]: Parsing macros/relations.sql
14:18:18.554054 [debug] [MainThread]: Parsing macros/adapters.sql
14:18:18.570141 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
14:18:18.571297 [debug] [MainThread]: Parsing macros/materializations/configs.sql
14:18:18.572821 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
14:18:18.575119 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
14:18:18.581761 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
14:18:18.591095 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
14:18:18.601676 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
14:18:18.604568 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
14:18:18.605622 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
14:18:18.606402 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
14:18:18.607756 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
14:18:18.609315 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
14:18:18.613381 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
14:18:18.618018 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
14:18:18.619784 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
14:18:18.630181 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
14:18:18.634123 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
14:18:18.635320 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
14:18:18.638119 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
14:18:18.639304 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
14:18:18.647897 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
14:18:18.658965 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
14:18:18.666156 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
14:18:18.667478 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
14:18:18.669079 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
14:18:18.670046 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
14:18:18.670893 [debug] [MainThread]: Parsing macros/adapters/columns.sql
14:18:18.676828 [debug] [MainThread]: Parsing macros/adapters/relation.sql
14:18:18.682272 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
14:18:18.684046 [debug] [MainThread]: Parsing macros/adapters/schema.sql
14:18:18.685442 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
14:18:18.687136 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
14:18:18.691969 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
14:18:18.695284 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
14:18:18.696295 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
14:18:18.697035 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
14:18:18.697511 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
14:18:18.698336 [debug] [MainThread]: Parsing macros/etc/datetime.sql
14:18:18.703124 [debug] [MainThread]: Parsing macros/etc/statement.sql
14:18:18.705846 [debug] [MainThread]: Parsing tests/generic/builtin.sql
14:18:18.844098 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:18:18.852666 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
14:18:18.855249 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
14:18:18.899770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc54d0d0>]}
14:18:18.904742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bec19400>]}
14:18:18.905097 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:18:18.905307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bec19430>]}
14:18:18.906413 [info ] [MainThread]: 
14:18:18.907017 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:18.907880 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:18:18.920036 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:18:18.921031 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:18:18.921219 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:18.931964 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:18:18.934173 [debug] [ThreadPool]: On list_erp_oltp: Close
14:18:18.937411 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:18:18.946485 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:18.946826 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:18:18.946978 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:18.952868 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:18:18.953090 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:18.953199 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:18:18.956666 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
14:18:18.957826 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:18:18.958121 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:18:18.960966 [debug] [MainThread]: Using postgres connection "master"
14:18:18.961096 [debug] [MainThread]: On master: BEGIN
14:18:18.961177 [debug] [MainThread]: Opening a new connection, currently in state init
14:18:18.973860 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:18:18.974056 [debug] [MainThread]: Using postgres connection "master"
14:18:18.974133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:18:18.983825 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
14:18:18.984743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56beb9b940>]}
14:18:18.984998 [debug] [MainThread]: On master: ROLLBACK
14:18:18.985242 [debug] [MainThread]: Using postgres connection "master"
14:18:18.985345 [debug] [MainThread]: On master: BEGIN
14:18:18.985572 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:18.985718 [debug] [MainThread]: On master: COMMIT
14:18:18.985787 [debug] [MainThread]: Using postgres connection "master"
14:18:18.985843 [debug] [MainThread]: On master: COMMIT
14:18:18.986009 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:18.986109 [debug] [MainThread]: On master: Close
14:18:18.986388 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:18:18.986593 [info ] [MainThread]: 
14:18:18.990757 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:18:18.991014 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:18:18.991269 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:18:18.991351 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:18:18.991449 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:18:18.992276 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:18:18.992575 [debug] [Thread-1  ]: finished collecting timing info
14:18:18.992673 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:18:19.000332 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:18:19.000668 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:18:19.000995 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:18:19.001091 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:18:19.001321 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:18:19.003063 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:18:19.003342 [debug] [Thread-2  ]: finished collecting timing info
14:18:19.003435 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:18:19.036594 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:18:19.039316 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:18:19.040163 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:19.040300 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:18:19.040408 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:18:19.040640 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:19.041193 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:18:19.041277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:19.044201 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
14:18:19.044312 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:19.044379 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:18:19.050787 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:18:19.051042 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:19.051163 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    customers.sql
with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name
  from erp_oltp.public.clientes
)
select * from customers
  );
14:18:19.051467 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "customers"
LINE 4:     customers.sql
            ^

14:18:19.051674 [debug] [Thread-1  ]: On model.first_project.customers: ROLLBACK
14:18:19.052007 [debug] [Thread-1  ]: finished collecting timing info
14:18:19.052146 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:18:19.052474 [debug] [Thread-1  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "customers"
  LINE 4:     customers.sql
              ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
14:18:19.052759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc47f7c0>]}
14:18:19.053044 [error] [Thread-1  ]: 1 of 3 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.06s]
14:18:19.053485 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:18:19.053633 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
14:18:19.058664 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:19.058854 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:18:19.059289 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:19.066696 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:19.066874 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:19.066947 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:19.069046 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:18:19.073530 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:19.073732 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:18:19.074079 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:18:19.074830 [debug] [Thread-2  ]: finished collecting timing info
14:18:19.074970 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:18:19.075334 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc46dd00>]}
14:18:19.075564 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
14:18:19.075801 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:18:19.076386 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:18:19.076538 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:18:19.076767 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:18:19.076843 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:18:19.076915 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:18:19.078296 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:18:19.078544 [debug] [Thread-4  ]: finished collecting timing info
14:18:19.078690 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:18:19.081370 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:18:19.081729 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:19.081909 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:18:19.081996 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:18:19.087429 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:18:19.087667 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:19.087770 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:18:19.090345 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:18:19.091933 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:19.092038 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:18:19.092298 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:19.093058 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:19.093150 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:19.093215 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:19.093978 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:18:19.094858 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:19.094948 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:18:19.095447 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:19.097700 [debug] [Thread-4  ]: finished collecting timing info
14:18:19.097883 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:18:19.098333 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc4528b0>]}
14:18:19.098595 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
14:18:19.098865 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:18:19.100654 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:19.100813 [debug] [MainThread]: Using postgres connection "master"
14:18:19.100886 [debug] [MainThread]: On master: BEGIN
14:18:19.100945 [debug] [MainThread]: Opening a new connection, currently in state closed
14:18:19.104906 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:19.105031 [debug] [MainThread]: On master: COMMIT
14:18:19.105096 [debug] [MainThread]: Using postgres connection "master"
14:18:19.105180 [debug] [MainThread]: On master: COMMIT
14:18:19.105318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:19.105404 [debug] [MainThread]: On master: Close
14:18:19.105691 [info ] [MainThread]: 
14:18:19.105850 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.20s.
14:18:19.105961 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:19.106019 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:18:19.106072 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:18:19.106174 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:18:19.108707 [info ] [MainThread]: 
14:18:19.109833 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:18:19.110002 [info ] [MainThread]: 
14:18:19.110127 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
14:18:19.110231 [error] [MainThread]:   syntax error at or near "customers"
14:18:19.110327 [error] [MainThread]:   LINE 4:     customers.sql
14:18:19.110737 [error] [MainThread]:               ^
14:18:19.110836 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
14:18:19.110942 [info ] [MainThread]: 
14:18:19.111064 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
14:18:19.111233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bca4b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56be309dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc4603a0>]}


============================== 2022-06-04 14:18:49.503431 | a3fe30c9-6c9a-4221-86a5-0eb7293f7b06 ==============================
14:18:49.503446 [info ] [MainThread]: Running with dbt=1.1.0
14:18:49.503794 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:18:49.503882 [debug] [MainThread]: Tracking: tracking
14:18:49.506648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d5c4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d5c4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d5c4040>]}
14:18:49.526360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:18:49.526707 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
14:18:49.534902 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:18:49.556912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d0880d0>]}
14:18:49.560211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d54eeb0>]}
14:18:49.560438 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:18:49.560622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d54ee80>]}
14:18:49.561906 [info ] [MainThread]: 
14:18:49.562419 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:49.563176 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:18:49.571718 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:18:49.571952 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:18:49.572038 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:49.577345 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:18:49.578684 [debug] [ThreadPool]: On list_erp_oltp: Close
14:18:49.579592 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:18:49.583481 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:49.583663 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:18:49.583743 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:49.588500 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:18:49.588684 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:49.588756 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:18:49.590174 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
14:18:49.591118 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:18:49.591317 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:18:49.622492 [debug] [MainThread]: Using postgres connection "master"
14:18:49.622677 [debug] [MainThread]: On master: BEGIN
14:18:49.622744 [debug] [MainThread]: Opening a new connection, currently in state init
14:18:49.627249 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:49.627410 [debug] [MainThread]: Using postgres connection "master"
14:18:49.627481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:18:49.636451 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
14:18:49.637635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1ee4a970>]}
14:18:49.637922 [debug] [MainThread]: On master: ROLLBACK
14:18:49.638233 [debug] [MainThread]: Using postgres connection "master"
14:18:49.638339 [debug] [MainThread]: On master: BEGIN
14:18:49.638799 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:49.638909 [debug] [MainThread]: On master: COMMIT
14:18:49.638981 [debug] [MainThread]: Using postgres connection "master"
14:18:49.639040 [debug] [MainThread]: On master: COMMIT
14:18:49.639273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:49.639388 [debug] [MainThread]: On master: Close
14:18:49.639669 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:18:49.639845 [info ] [MainThread]: 
14:18:49.644137 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:18:49.644372 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:18:49.644802 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:18:49.644962 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:18:49.645109 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:18:49.646201 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:18:49.646444 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:18:49.646721 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:18:49.647020 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:18:49.647107 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:18:49.647177 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:18:49.648568 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:18:49.648816 [debug] [Thread-2  ]: finished collecting timing info
14:18:49.648955 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:18:49.665671 [debug] [Thread-1  ]: finished collecting timing info
14:18:49.669766 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:18:49.670137 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:18:49.683864 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:18:49.684289 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.684410 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:18:49.684484 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:18:49.684705 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:49.684820 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:18:49.684921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:49.689469 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:18:49.689652 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:49.689732 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name
  from erp_oltp.public.clientes
)
select * from customers
  );
14:18:49.690344 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:18:49.690458 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.690521 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:18:49.691488 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:18:49.696896 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.697070 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:18:49.698556 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:49.698663 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:18:49.697213 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:18:49.699108 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:49.702967 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:18:49.703082 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:49.703160 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:18:49.703306 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:49.704544 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.704675 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:18:49.705025 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:49.708288 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:49.708418 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.708482 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:49.708624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
14:18:49.711700 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:49.711852 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:18:49.712030 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:18:49.712192 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:49.713702 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.714526 [debug] [Thread-1  ]: finished collecting timing info
14:18:49.714659 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:18:49.714826 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:18:49.717187 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d5aa130>]}
14:18:49.717502 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
14:18:49.717945 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:18:49.718048 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:18:49.719982 [debug] [Thread-2  ]: finished collecting timing info
14:18:49.720097 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:18:49.721429 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d01c6a0>]}
14:18:49.721653 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
14:18:49.721893 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:18:49.722248 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:18:49.722396 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:18:49.722638 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:18:49.722717 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:18:49.722787 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:18:49.724060 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:18:49.724282 [debug] [Thread-4  ]: finished collecting timing info
14:18:49.724387 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:18:49.725760 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:18:49.726195 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:49.726305 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:18:49.726370 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:18:49.731816 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:18:49.731968 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:49.732062 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:18:49.733018 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:18:49.734678 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:49.734775 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:18:49.735100 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:49.735915 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:49.736003 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:49.736065 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:49.736693 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:18:49.737650 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:49.737778 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:18:49.737967 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:49.738578 [debug] [Thread-4  ]: finished collecting timing info
14:18:49.738687 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:18:49.741152 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1f79b700>]}
14:18:49.741416 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
14:18:49.741804 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:18:49.745249 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:49.745487 [debug] [MainThread]: Using postgres connection "master"
14:18:49.745559 [debug] [MainThread]: On master: BEGIN
14:18:49.745650 [debug] [MainThread]: Opening a new connection, currently in state closed
14:18:49.755131 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:18:49.755297 [debug] [MainThread]: On master: COMMIT
14:18:49.755359 [debug] [MainThread]: Using postgres connection "master"
14:18:49.755416 [debug] [MainThread]: On master: COMMIT
14:18:49.755660 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:49.755781 [debug] [MainThread]: On master: Close
14:18:49.756115 [info ] [MainThread]: 
14:18:49.756268 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.19s.
14:18:49.756371 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:49.756423 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:18:49.756472 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:18:49.756519 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:18:49.760118 [info ] [MainThread]: 
14:18:49.760341 [info ] [MainThread]: [32mCompleted successfully[0m
14:18:49.760499 [info ] [MainThread]: 
14:18:49.760610 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:18:49.760790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d54ea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1edd35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1f734d90>]}


============================== 2022-06-04 14:30:52.103022 | 77030143-cfa1-428e-a15c-ddd1e8749edb ==============================
14:30:52.103036 [info ] [MainThread]: Running with dbt=1.1.0
14:30:52.103437 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:30:52.103531 [debug] [MainThread]: Tracking: tracking
14:30:52.106151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1679bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1679bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1679b040>]}
14:30:52.141138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:30:52.143942 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
14:30:52.152273 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:30:52.175743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1625f0d0>]}
14:30:52.179809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c16727eb0>]}
14:30:52.180064 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:30:52.180235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c16727e80>]}
14:30:52.181208 [info ] [MainThread]: 
14:30:52.181556 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:52.182576 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:30:52.189798 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:30:52.190024 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:30:52.190120 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:52.197568 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:30:52.198699 [debug] [ThreadPool]: On list_erp_oltp: Close
14:30:52.199902 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:30:52.204097 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:52.204247 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:30:52.204321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:30:52.211031 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:30:52.211471 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:52.211791 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:30:52.214785 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:30:52.215803 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:30:52.216033 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:30:52.245423 [debug] [MainThread]: Using postgres connection "master"
14:30:52.245713 [debug] [MainThread]: On master: BEGIN
14:30:52.245810 [debug] [MainThread]: Opening a new connection, currently in state init
14:30:52.250751 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:52.250913 [debug] [MainThread]: Using postgres connection "master"
14:30:52.250980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:30:52.260035 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:30:52.261199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c166e2580>]}
14:30:52.261480 [debug] [MainThread]: On master: ROLLBACK
14:30:52.261834 [debug] [MainThread]: Using postgres connection "master"
14:30:52.261967 [debug] [MainThread]: On master: BEGIN
14:30:52.262268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:52.262431 [debug] [MainThread]: On master: COMMIT
14:30:52.262552 [debug] [MainThread]: Using postgres connection "master"
14:30:52.262668 [debug] [MainThread]: On master: COMMIT
14:30:52.262877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:52.263036 [debug] [MainThread]: On master: Close
14:30:52.263474 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:30:52.263671 [info ] [MainThread]: 
14:30:52.270088 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:30:52.270336 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:30:52.270645 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:30:52.270772 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:30:52.270861 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:30:52.271681 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:30:52.271970 [debug] [Thread-1  ]: finished collecting timing info
14:30:52.272112 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:30:52.278884 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:30:52.279142 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:30:52.279438 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:30:52.279514 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:30:52.279579 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:30:52.281012 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:30:52.292876 [debug] [Thread-2  ]: finished collecting timing info
14:30:52.293376 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:30:52.303729 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:30:52.311971 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:30:52.312374 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.312484 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:30:52.312559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:52.312966 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.313485 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:30:52.313552 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:30:52.317027 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:30:52.317270 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.317372 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
14:30:52.317517 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
14:30:52.317713 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.317864 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:30:52.318811 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:30:52.323059 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.323168 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:30:52.323274 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:30:52.325249 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.325410 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:52.325568 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
14:30:52.327330 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.327530 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:30:52.327894 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:52.330143 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.330347 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:30:52.330484 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:52.336549 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:52.336703 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
14:30:52.336855 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.337702 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:30:52.338006 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.337888 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:52.338086 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:30:52.341614 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:30:52.345478 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.345617 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:30:52.345723 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
14:30:52.346700 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.346797 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:30:52.347145 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:30:52.348103 [debug] [Thread-2  ]: finished collecting timing info
14:30:52.348220 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:30:52.348317 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:52.350212 [debug] [Thread-1  ]: finished collecting timing info
14:30:52.350506 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c16219a90>]}
14:30:52.350647 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:30:52.350924 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
14:30:52.351243 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:30:52.351468 [debug] [Thread-2  ]: Began running node model.first_project.my_second_dbt_model
14:30:52.351597 [info ] [Thread-2  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:30:52.351891 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:30:52.351976 [debug] [Thread-2  ]: Began compiling node model.first_project.my_second_dbt_model
14:30:52.352050 [debug] [Thread-2  ]: Compiling model.first_project.my_second_dbt_model
14:30:52.353399 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:30:52.353749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1621d970>]}
14:30:52.354000 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
14:30:52.354227 [debug] [Thread-2  ]: finished collecting timing info
14:30:52.354391 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:30:52.354485 [debug] [Thread-2  ]: Began executing node model.first_project.my_second_dbt_model
14:30:52.356787 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:30:52.357191 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:52.357324 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: BEGIN
14:30:52.357426 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:52.364612 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:30:52.364792 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:52.364881 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:30:52.365892 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:52.367346 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:52.367448 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:30:52.367709 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:52.368704 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:52.368797 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:52.368873 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:52.371236 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:30:52.372962 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:52.373089 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:30:52.373434 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:52.374400 [debug] [Thread-2  ]: finished collecting timing info
14:30:52.374573 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: Close
14:30:52.375215 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c161c8910>]}
14:30:52.375712 [info ] [Thread-2  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
14:30:52.376165 [debug] [Thread-2  ]: Finished running node model.first_project.my_second_dbt_model
14:30:52.377242 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:52.377358 [debug] [MainThread]: Using postgres connection "master"
14:30:52.377422 [debug] [MainThread]: On master: BEGIN
14:30:52.377480 [debug] [MainThread]: Opening a new connection, currently in state closed
14:30:52.383587 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:30:52.383732 [debug] [MainThread]: On master: COMMIT
14:30:52.383798 [debug] [MainThread]: Using postgres connection "master"
14:30:52.383857 [debug] [MainThread]: On master: COMMIT
14:30:52.384026 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:52.384125 [debug] [MainThread]: On master: Close
14:30:52.384400 [info ] [MainThread]: 
14:30:52.384593 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.20s.
14:30:52.384707 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:52.384782 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:30:52.384850 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:30:52.388822 [info ] [MainThread]: 
14:30:52.389298 [info ] [MainThread]: [32mCompleted successfully[0m
14:30:52.389457 [info ] [MainThread]: 
14:30:52.389563 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:30:52.389810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c180210a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1858a160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1890bf10>]}


============================== 2022-06-04 14:46:38.123061 | 33057868-0c1f-4dd6-a2fc-4b5c5399cc18 ==============================
14:46:38.123075 [info ] [MainThread]: Running with dbt=1.1.0
14:46:38.123442 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:46:38.123535 [debug] [MainThread]: Tracking: tracking
14:46:38.126558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f434b8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f434b85b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f434b8610>]}
14:46:38.149214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:46:38.149811 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
14:46:38.158053 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:46:38.174741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42f870d0>]}
14:46:38.178498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f43450d00>]}
14:46:38.178740 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:46:38.178932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f43450e80>]}
14:46:38.179901 [info ] [MainThread]: 
14:46:38.180249 [debug] [MainThread]: Acquiring new postgres connection "master"
14:46:38.181394 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:46:38.188081 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:46:38.188281 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:46:38.188356 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:38.194362 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:46:38.195757 [debug] [ThreadPool]: On list_erp_oltp: Close
14:46:38.196818 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:46:38.201028 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:46:38.201202 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:46:38.201281 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:38.205494 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:46:38.205719 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:46:38.205848 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:46:38.207314 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:46:38.208227 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:46:38.208482 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:46:38.234532 [debug] [MainThread]: Using postgres connection "master"
14:46:38.234749 [debug] [MainThread]: On master: BEGIN
14:46:38.234844 [debug] [MainThread]: Opening a new connection, currently in state init
14:46:38.240047 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:46:38.240196 [debug] [MainThread]: Using postgres connection "master"
14:46:38.240266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:46:38.248941 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:46:38.250206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42f6a0a0>]}
14:46:38.250452 [debug] [MainThread]: On master: ROLLBACK
14:46:38.250801 [debug] [MainThread]: Using postgres connection "master"
14:46:38.250959 [debug] [MainThread]: On master: BEGIN
14:46:38.251308 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:46:38.251430 [debug] [MainThread]: On master: COMMIT
14:46:38.251521 [debug] [MainThread]: Using postgres connection "master"
14:46:38.251656 [debug] [MainThread]: On master: COMMIT
14:46:38.251880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:46:38.252038 [debug] [MainThread]: On master: Close
14:46:38.252438 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:46:38.252707 [info ] [MainThread]: 
14:46:38.257429 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:46:38.257831 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:46:38.258004 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:46:38.258389 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:46:38.258621 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:46:38.259041 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:46:38.259120 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:46:38.259200 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:46:38.258749 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:46:38.261170 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:46:38.261320 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:46:38.262088 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:46:38.262425 [debug] [Thread-2  ]: finished collecting timing info
14:46:38.262522 [debug] [Thread-1  ]: finished collecting timing info
14:46:38.262623 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:46:38.262727 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:46:38.292632 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:46:38.293101 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.293254 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:46:38.293323 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:46:38.300330 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:46:38.300923 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.301130 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:46:38.301249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:46:38.302657 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:46:38.302807 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.302878 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:46:38.303997 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:46:38.308763 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.310444 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:46:38.311051 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:38.313097 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.313248 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:46:38.313640 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:38.313791 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:46:38.319843 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.319971 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
14:46:38.322997 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:46:38.323227 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.323313 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:46:38.324867 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:46:38.330394 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.330585 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:46:38.332370 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.332544 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
14:46:38.330712 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:46:38.333940 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:38.335977 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.336145 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:46:38.336285 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:46:38.336960 [debug] [Thread-2  ]: finished collecting timing info
14:46:38.337053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:38.337840 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:46:38.337930 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.338006 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:46:38.337171 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:46:38.338356 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42f3e4c0>]}
14:46:38.338572 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
14:46:38.339791 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:46:38.340116 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:46:38.340278 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:46:38.340536 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:46:38.340619 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:46:38.340687 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:46:38.342142 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:46:38.342310 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:46:38.343165 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.343260 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:46:38.343378 [debug] [Thread-4  ]: finished collecting timing info
14:46:38.343499 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:46:38.344819 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:46:38.344965 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:46:38.345869 [debug] [Thread-1  ]: finished collecting timing info
14:46:38.346039 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:46:38.346195 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:38.346310 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:46:38.346426 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:46:38.347337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42f03730>]}
14:46:38.347574 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.09s]
14:46:38.347961 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:46:38.351568 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:46:38.351797 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:38.351887 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:46:38.352809 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:46:38.354398 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:38.354502 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:46:38.354875 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:38.355718 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:46:38.355813 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:38.355875 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:46:38.356444 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:46:38.357327 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:38.357409 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:46:38.357682 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:46:38.358311 [debug] [Thread-4  ]: finished collecting timing info
14:46:38.358429 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:46:38.358775 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f44cd07c0>]}
14:46:38.360552 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
14:46:38.360853 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:46:38.362541 [debug] [MainThread]: Acquiring new postgres connection "master"
14:46:38.362691 [debug] [MainThread]: Using postgres connection "master"
14:46:38.362760 [debug] [MainThread]: On master: BEGIN
14:46:38.362819 [debug] [MainThread]: Opening a new connection, currently in state closed
14:46:38.368087 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:46:38.368313 [debug] [MainThread]: On master: COMMIT
14:46:38.368392 [debug] [MainThread]: Using postgres connection "master"
14:46:38.368513 [debug] [MainThread]: On master: COMMIT
14:46:38.368766 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:46:38.368875 [debug] [MainThread]: On master: Close
14:46:38.369191 [info ] [MainThread]: 
14:46:38.369389 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.19s.
14:46:38.369566 [debug] [MainThread]: Connection 'master' was properly closed.
14:46:38.369650 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:46:38.369707 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:46:38.369760 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:46:38.372558 [info ] [MainThread]: 
14:46:38.372756 [info ] [MainThread]: [32mCompleted successfully[0m
14:46:38.372930 [info ] [MainThread]: 
14:46:38.373060 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:46:38.373256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f452b5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f452b32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f45634f40>]}


============================== 2022-06-04 16:30:18.958262 | 6ce328bc-fba4-4d35-900a-c36ed5de5ab6 ==============================
16:30:18.958276 [info ] [MainThread]: Running with dbt=1.1.0
16:30:18.959663 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:30:18.959782 [debug] [MainThread]: Tracking: tracking
16:30:18.962513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a82100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a82c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a82e20>]}
16:30:18.977567 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:30:18.977893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a868b0>]}
16:30:19.000852 [debug] [MainThread]: Parsing macros/catalog.sql
16:30:19.003032 [debug] [MainThread]: Parsing macros/relations.sql
16:30:19.004018 [debug] [MainThread]: Parsing macros/adapters.sql
16:30:19.019681 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:30:19.020978 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:30:19.022600 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:30:19.025202 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:30:19.031879 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:30:19.042073 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:30:19.053322 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:30:19.056441 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:30:19.057512 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:30:19.058383 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:30:19.060003 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:30:19.062021 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:30:19.067298 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:30:19.072567 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:30:19.075483 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:30:19.086519 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:30:19.090774 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:30:19.092070 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:30:19.095519 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:30:19.096728 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:30:19.114974 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:30:19.125890 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:30:19.132397 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:30:19.133727 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:30:19.135923 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:30:19.136978 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:30:19.137914 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:30:19.144515 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:30:19.150941 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:30:19.153145 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:30:19.155052 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:30:19.157247 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:30:19.162618 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:30:19.166097 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:30:19.166937 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:30:19.167520 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:30:19.167982 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:30:19.168903 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:30:19.176261 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:30:19.179466 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:30:19.330619 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:30:19.339192 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:30:19.340729 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:30:19.376276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7183348ca0>]}
16:30:19.379341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a829a0>]}
16:30:19.379580 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:30:19.379743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71833489d0>]}
16:30:19.380589 [info ] [MainThread]: 
16:30:19.380947 [debug] [MainThread]: Acquiring new postgres connection "master"
16:30:19.381617 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:30:19.388532 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:30:19.388647 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:30:19.388719 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:30:19.404762 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
16:30:19.405991 [debug] [ThreadPool]: On list_erp_oltp: Close
16:30:19.407518 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:30:19.411184 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:30:19.411377 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:30:19.411449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:30:19.417059 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:30:19.417274 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:30:19.417384 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:30:19.420218 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:30:19.421276 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:30:19.421620 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:30:19.424639 [debug] [MainThread]: Using postgres connection "master"
16:30:19.424790 [debug] [MainThread]: On master: BEGIN
16:30:19.424909 [debug] [MainThread]: Opening a new connection, currently in state init
16:30:19.429438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:19.429633 [debug] [MainThread]: Using postgres connection "master"
16:30:19.429709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:30:19.438947 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:30:19.440001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71846cd130>]}
16:30:19.440258 [debug] [MainThread]: On master: ROLLBACK
16:30:19.440555 [debug] [MainThread]: Using postgres connection "master"
16:30:19.440675 [debug] [MainThread]: On master: BEGIN
16:30:19.441195 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:19.441317 [debug] [MainThread]: On master: COMMIT
16:30:19.441395 [debug] [MainThread]: Using postgres connection "master"
16:30:19.441465 [debug] [MainThread]: On master: COMMIT
16:30:19.441648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:30:19.441799 [debug] [MainThread]: On master: Close
16:30:19.442110 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:30:19.442284 [info ] [MainThread]: 
16:30:19.448667 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:30:19.448850 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:30:19.449069 [info ] [Thread-1  ]: 1 of 3 START table model public.customers ...................................... [RUN]
16:30:19.449279 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:30:19.449608 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:30:19.449913 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:30:19.450035 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:30:19.450147 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:30:19.450259 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:30:19.450352 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:30:19.451555 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:30:19.453049 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:30:19.453385 [debug] [Thread-2  ]: finished collecting timing info
16:30:19.453533 [debug] [Thread-1  ]: finished collecting timing info
16:30:19.453637 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:30:19.453749 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:30:19.490362 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:30:19.491680 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:30:19.492496 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.492608 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:30:19.492683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:30:19.492222 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.492957 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:30:19.493057 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:30:19.498446 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:30:19.498661 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.498730 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:30:19.499096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:30:19.499293 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.499411 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:30:19.507125 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
16:30:19.511889 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.512126 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
16:30:19.512294 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:30:19.513876 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.514897 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:30:19.515604 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:19.517105 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.517276 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:30:19.517449 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:19.518754 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.518844 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:30:19.519123 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:19.519221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:19.527528 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:30:19.527642 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.529311 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:30:19.529457 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:30:19.529581 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.529724 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:30:19.531617 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:30:19.535364 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.535535 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:30:19.535716 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:30:19.536881 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.536991 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:30:19.539277 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
16:30:19.540284 [debug] [Thread-1  ]: finished collecting timing info
16:30:19.540413 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:30:19.540620 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:30:19.541542 [debug] [Thread-2  ]: finished collecting timing info
16:30:19.541693 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:30:19.542120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71804a2df0>]}
16:30:19.542374 [info ] [Thread-1  ]: 1 of 3 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.09s]
16:30:19.542640 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:30:19.543550 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71846cd4f0>]}
16:30:19.543766 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
16:30:19.544931 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:30:19.545330 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:30:19.545551 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:30:19.545865 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:30:19.545954 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:30:19.546025 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:30:19.547372 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:30:19.547612 [debug] [Thread-4  ]: finished collecting timing info
16:30:19.547756 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:30:19.561692 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:30:19.562254 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:19.562420 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:30:19.562494 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:30:19.567433 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
16:30:19.567581 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:19.567651 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:30:19.569977 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:30:19.571580 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:19.571681 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:30:19.571980 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:19.572706 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:30:19.572787 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:19.572849 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:30:19.573681 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:30:19.575919 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:19.576074 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:30:19.576592 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:30:19.577708 [debug] [Thread-4  ]: finished collecting timing info
16:30:19.578000 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:30:19.578543 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718150b550>]}
16:30:19.578868 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
16:30:19.579216 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:30:19.580510 [debug] [MainThread]: Acquiring new postgres connection "master"
16:30:19.580621 [debug] [MainThread]: Using postgres connection "master"
16:30:19.580687 [debug] [MainThread]: On master: BEGIN
16:30:19.580743 [debug] [MainThread]: Opening a new connection, currently in state closed
16:30:19.585432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:19.585607 [debug] [MainThread]: On master: COMMIT
16:30:19.585740 [debug] [MainThread]: Using postgres connection "master"
16:30:19.585840 [debug] [MainThread]: On master: COMMIT
16:30:19.585992 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:30:19.586104 [debug] [MainThread]: On master: Close
16:30:19.586373 [info ] [MainThread]: 
16:30:19.586514 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.21s.
16:30:19.586620 [debug] [MainThread]: Connection 'master' was properly closed.
16:30:19.586675 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:30:19.586725 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:30:19.586776 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:30:19.589288 [info ] [MainThread]: 
16:30:19.589447 [info ] [MainThread]: [32mCompleted successfully[0m
16:30:19.589591 [info ] [MainThread]: 
16:30:19.589700 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:30:19.589867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a56190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a1dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71838dd7f0>]}


============================== 2022-06-04 16:35:31.829290 | d404547e-a259-4006-a988-d6855cbe208b ==============================
16:35:31.829305 [info ] [MainThread]: Running with dbt=1.1.0
16:35:31.829713 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:35:31.829815 [debug] [MainThread]: Tracking: tracking
16:35:31.832636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76481664c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7648166d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76481666d0>]}
16:35:31.845645 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:35:31.845915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764816dd60>]}
16:35:31.853333 [debug] [MainThread]: Parsing macros/catalog.sql
16:35:31.855566 [debug] [MainThread]: Parsing macros/relations.sql
16:35:31.856543 [debug] [MainThread]: Parsing macros/adapters.sql
16:35:31.881666 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:35:31.882855 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:35:31.884239 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:35:31.886595 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:35:31.892652 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:35:31.901807 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:35:31.912529 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:35:31.915397 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:35:31.916380 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:35:31.917154 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:35:31.918608 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:35:31.920173 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:35:31.924199 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:35:31.928545 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:35:31.930413 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:35:31.940723 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:35:31.944990 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:35:31.946206 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:35:31.948850 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:35:31.949939 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:35:31.957206 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:35:31.967020 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:35:31.973453 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:35:31.974521 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:35:31.976456 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:35:31.977600 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:35:31.978600 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:35:31.984867 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:35:31.991276 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:35:31.994525 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:35:31.996260 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:35:31.998066 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:35:32.002278 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:35:32.004874 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:35:32.005387 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:35:32.005905 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:35:32.006301 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:35:32.007079 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:35:32.012481 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:35:32.015283 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:35:32.151340 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:35:32.159878 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:35:32.161778 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:35:32.192389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7649a30cd0>]}
16:35:32.207773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76499860d0>]}
16:35:32.208261 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:35:32.208653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7649a30c10>]}
16:35:32.209708 [info ] [MainThread]: 
16:35:32.210012 [debug] [MainThread]: Acquiring new postgres connection "master"
16:35:32.210646 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:35:32.217762 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:35:32.217920 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:35:32.218046 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:35:32.225621 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:35:32.226860 [debug] [ThreadPool]: On list_erp_oltp: Close
16:35:32.234953 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:35:32.246159 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:35:32.246367 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:35:32.246446 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:35:32.252911 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:35:32.253116 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:35:32.253194 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:35:32.254852 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:35:32.256016 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:35:32.256322 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:35:32.259950 [debug] [MainThread]: Using postgres connection "master"
16:35:32.260152 [debug] [MainThread]: On master: BEGIN
16:35:32.260223 [debug] [MainThread]: Opening a new connection, currently in state init
16:35:32.265388 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:35:32.265553 [debug] [MainThread]: Using postgres connection "master"
16:35:32.265624 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:35:32.273940 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:35:32.275137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7648106e20>]}
16:35:32.275535 [debug] [MainThread]: On master: ROLLBACK
16:35:32.275969 [debug] [MainThread]: Using postgres connection "master"
16:35:32.276117 [debug] [MainThread]: On master: BEGIN
16:35:32.276699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:35:32.276882 [debug] [MainThread]: On master: COMMIT
16:35:32.276994 [debug] [MainThread]: Using postgres connection "master"
16:35:32.277062 [debug] [MainThread]: On master: COMMIT
16:35:32.277235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:35:32.277324 [debug] [MainThread]: On master: Close
16:35:32.277657 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:35:32.277946 [info ] [MainThread]: 
16:35:32.281584 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:35:32.281804 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
16:35:32.282129 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:35:32.282225 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:35:32.282302 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:35:32.283447 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:35:32.283689 [debug] [Thread-1  ]: finished collecting timing info
16:35:32.284835 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:35:32.285090 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:35:32.285311 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:35:32.285383 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:35:32.285444 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:35:32.286798 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:35:32.287049 [debug] [Thread-2  ]: finished collecting timing info
16:35:32.287160 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:35:32.284966 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:35:32.321423 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:35:32.322338 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:35:32.322772 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.322977 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.323175 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:35:32.323456 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:35:32.323791 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:35:32.323589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:32.329963 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:35:32.330170 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.330271 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:35:32.330669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:35:32.330822 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.330902 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:35:32.331271 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:35:32.336076 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.336264 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
16:35:32.336386 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:35:32.337926 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.338156 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:35:32.338482 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:32.338585 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:32.339873 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.341899 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.342145 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:35:32.342286 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:35:32.343054 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:32.348420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:35:32.349855 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:35:32.350700 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:35:32.350874 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.350995 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.351104 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:35:32.351215 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:35:32.352263 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:35:32.355406 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.355546 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:35:32.355650 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:35:32.356716 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.356863 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:35:32.358512 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
16:35:32.359357 [debug] [Thread-1  ]: finished collecting timing info
16:35:32.359488 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:35:32.359598 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:35:32.360288 [debug] [Thread-2  ]: finished collecting timing info
16:35:32.360423 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:35:32.360709 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764adbd3d0>]}
16:35:32.361082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647c168e0>]}
16:35:32.362090 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
16:35:32.362347 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
16:35:32.362783 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:35:32.362949 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:35:32.363278 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:35:32.363413 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:35:32.363646 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:35:32.363725 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:35:32.363835 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:35:32.365398 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:35:32.365855 [debug] [Thread-4  ]: finished collecting timing info
16:35:32.366010 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:35:32.368217 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:35:32.368597 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:32.368705 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:35:32.368774 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:35:32.372857 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
16:35:32.372990 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:32.373074 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:35:32.375203 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:35:32.376693 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:32.376820 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:35:32.377150 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:32.377882 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:35:32.377993 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:32.378073 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:35:32.378880 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:35:32.379930 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:32.380031 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:35:32.380259 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:35:32.381114 [debug] [Thread-4  ]: finished collecting timing info
16:35:32.381240 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:35:32.381639 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76443079a0>]}
16:35:32.381911 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
16:35:32.383438 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:35:32.385811 [debug] [MainThread]: Acquiring new postgres connection "master"
16:35:32.385979 [debug] [MainThread]: Using postgres connection "master"
16:35:32.386053 [debug] [MainThread]: On master: BEGIN
16:35:32.386115 [debug] [MainThread]: Opening a new connection, currently in state closed
16:35:32.392455 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:35:32.392657 [debug] [MainThread]: On master: COMMIT
16:35:32.392729 [debug] [MainThread]: Using postgres connection "master"
16:35:32.392791 [debug] [MainThread]: On master: COMMIT
16:35:32.393136 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:35:32.393331 [debug] [MainThread]: On master: Close
16:35:32.393704 [info ] [MainThread]: 
16:35:32.393906 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.18s.
16:35:32.394096 [debug] [MainThread]: Connection 'master' was properly closed.
16:35:32.394162 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:35:32.394215 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:35:32.394267 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:35:32.397162 [info ] [MainThread]: 
16:35:32.397331 [info ] [MainThread]: [32mCompleted successfully[0m
16:35:32.397479 [info ] [MainThread]: 
16:35:32.397592 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:35:32.397865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76481067c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647be6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647be6d60>]}


============================== 2022-06-04 16:36:23.602053 | eb1bd2d1-89ce-44ad-96f1-f9401d216a9b ==============================
16:36:23.602067 [info ] [MainThread]: Running with dbt=1.1.0
16:36:23.602414 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:36:23.602511 [debug] [MainThread]: Tracking: tracking
16:36:23.604904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad771efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad771e0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad771efa0>]}
16:36:23.620896 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:36:23.621179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad771d9d0>]}
16:36:23.626862 [debug] [MainThread]: Parsing macros/catalog.sql
16:36:23.629043 [debug] [MainThread]: Parsing macros/relations.sql
16:36:23.631087 [debug] [MainThread]: Parsing macros/adapters.sql
16:36:23.644240 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:36:23.645404 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:36:23.647209 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:36:23.649916 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:36:23.656516 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:36:23.667444 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:36:23.679248 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:36:23.682319 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:36:23.683645 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:36:23.684608 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:36:23.686225 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:36:23.687938 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:36:23.693312 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:36:23.698177 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:36:23.700367 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:36:23.710398 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:36:23.714523 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:36:23.716109 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:36:23.719422 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:36:23.720572 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:36:23.728120 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:36:23.739105 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:36:23.745971 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:36:23.747098 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:36:23.749498 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:36:23.750487 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:36:23.751378 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:36:23.757347 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:36:23.762991 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:36:23.766115 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:36:23.767618 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:36:23.769188 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:36:23.773146 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:36:23.775942 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:36:23.776512 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:36:23.777126 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:36:23.777825 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:36:23.778682 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:36:23.783963 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:36:23.786715 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:36:23.930295 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:36:23.939001 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:36:23.940627 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:36:23.973179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad76c2be0>]}
16:36:23.976664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad771ebe0>]}
16:36:23.976955 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:36:23.977132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad76c2c40>]}
16:36:23.978069 [info ] [MainThread]: 
16:36:23.978401 [debug] [MainThread]: Acquiring new postgres connection "master"
16:36:23.979148 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:36:23.986593 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:36:23.986767 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:36:23.986853 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:36:23.993326 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:36:23.994588 [debug] [ThreadPool]: On list_erp_oltp: Close
16:36:23.996994 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:36:24.002029 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:36:24.002216 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:36:24.002299 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:36:24.008390 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:36:24.008578 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:36:24.008655 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:36:24.010721 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:36:24.012149 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:36:24.012486 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:36:24.016129 [debug] [MainThread]: Using postgres connection "master"
16:36:24.016523 [debug] [MainThread]: On master: BEGIN
16:36:24.016646 [debug] [MainThread]: Opening a new connection, currently in state init
16:36:24.021685 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:36:24.021895 [debug] [MainThread]: Using postgres connection "master"
16:36:24.021970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:36:24.029846 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:36:24.030947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad76bc340>]}
16:36:24.031198 [debug] [MainThread]: On master: ROLLBACK
16:36:24.031463 [debug] [MainThread]: Using postgres connection "master"
16:36:24.031607 [debug] [MainThread]: On master: BEGIN
16:36:24.032102 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:36:24.032222 [debug] [MainThread]: On master: COMMIT
16:36:24.032302 [debug] [MainThread]: Using postgres connection "master"
16:36:24.032373 [debug] [MainThread]: On master: COMMIT
16:36:24.032598 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:36:24.032806 [debug] [MainThread]: On master: Close
16:36:24.033342 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:36:24.033661 [info ] [MainThread]: 
16:36:24.041445 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:36:24.041689 [info ] [Thread-1  ]: 1 of 3 START table model public.customers ...................................... [RUN]
16:36:24.041989 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:36:24.042079 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:36:24.042156 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:36:24.043321 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:36:24.043641 [debug] [Thread-1  ]: finished collecting timing info
16:36:24.043780 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:36:24.045649 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:36:24.051105 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:36:24.051522 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:36:24.057006 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:36:24.057152 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:36:24.058650 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:36:24.065277 [debug] [Thread-2  ]: finished collecting timing info
16:36:24.065900 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:36:24.070897 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:36:24.072057 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:36:24.072410 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.072576 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:36:24.072646 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:36:24.072836 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.073152 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:36:24.073239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:36:24.079718 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:36:24.080025 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.080341 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:36:24.081302 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:36:24.081417 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.081487 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:36:24.084713 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
16:36:24.089158 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.089303 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:36:24.089429 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
16:36:24.090822 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.090927 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:36:24.091221 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:24.092402 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.092481 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:36:24.092990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:24.094228 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.094326 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:36:24.094439 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:24.101604 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:36:24.101781 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:36:24.102848 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:36:24.102966 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.103034 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:36:24.101914 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.103159 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:36:24.105125 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:36:24.108150 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.108354 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:36:24.108288 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:36:24.109382 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.109632 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:36:24.109538 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
16:36:24.110749 [debug] [Thread-1  ]: finished collecting timing info
16:36:24.110868 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:36:24.111003 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:36:24.111773 [debug] [Thread-2  ]: finished collecting timing info
16:36:24.111993 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:36:24.112328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad76a46a0>]}
16:36:24.114148 [info ] [Thread-1  ]: 1 of 3 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.07s]
16:36:24.114670 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:36:24.116439 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad7694910>]}
16:36:24.116727 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
16:36:24.117051 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:36:24.117448 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:36:24.117601 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:36:24.117947 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:36:24.118062 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:36:24.118140 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:36:24.119664 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:36:24.119989 [debug] [Thread-4  ]: finished collecting timing info
16:36:24.120100 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:36:24.136581 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:36:24.137482 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:24.137818 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:36:24.137925 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:36:24.143298 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:36:24.143488 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:24.143569 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:36:24.144873 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:36:24.146461 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:24.146591 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:36:24.146916 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:24.147690 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:36:24.147840 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:24.147933 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:36:24.148521 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:36:24.152440 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:24.152652 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:36:24.153132 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:36:24.155098 [debug] [Thread-4  ]: finished collecting timing info
16:36:24.155304 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:36:24.155659 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad7236370>]}
16:36:24.155900 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
16:36:24.156163 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:36:24.157223 [debug] [MainThread]: Acquiring new postgres connection "master"
16:36:24.157343 [debug] [MainThread]: Using postgres connection "master"
16:36:24.157409 [debug] [MainThread]: On master: BEGIN
16:36:24.157467 [debug] [MainThread]: Opening a new connection, currently in state closed
16:36:24.161245 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:36:24.161393 [debug] [MainThread]: On master: COMMIT
16:36:24.161460 [debug] [MainThread]: Using postgres connection "master"
16:36:24.161518 [debug] [MainThread]: On master: COMMIT
16:36:24.161642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:36:24.161727 [debug] [MainThread]: On master: Close
16:36:24.162017 [info ] [MainThread]: 
16:36:24.162169 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.18s.
16:36:24.162275 [debug] [MainThread]: Connection 'master' was properly closed.
16:36:24.162331 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:36:24.162382 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:36:24.162432 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:36:24.165293 [info ] [MainThread]: 
16:36:24.165492 [info ] [MainThread]: [32mCompleted successfully[0m
16:36:24.165673 [info ] [MainThread]: 
16:36:24.165808 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:36:24.166250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad8fe5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad72362e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad719ce20>]}


============================== 2022-06-04 16:37:17.701914 | bcda9422-e321-432a-a2b6-6b293733e52b ==============================
16:37:17.701932 [info ] [MainThread]: Running with dbt=1.1.0
16:37:17.702574 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:37:17.702757 [debug] [MainThread]: Tracking: tracking
16:37:17.707252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab486070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab486040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab4862b0>]}
16:37:17.733766 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:37:17.734279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab48e520>]}
16:37:17.745115 [debug] [MainThread]: Parsing macros/catalog.sql
16:37:17.748665 [debug] [MainThread]: Parsing macros/relations.sql
16:37:17.749912 [debug] [MainThread]: Parsing macros/adapters.sql
16:37:17.773382 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:37:17.774872 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:37:17.777619 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:37:17.780522 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:37:17.787195 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:37:17.798286 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:37:17.809258 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:37:17.812843 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:37:17.814079 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:37:17.814976 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:37:17.816553 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:37:17.818346 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:37:17.822874 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:37:17.828328 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:37:17.830470 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:37:17.841228 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:37:17.845630 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:37:17.847094 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:37:17.850059 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:37:17.851242 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:37:17.860338 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:37:17.872034 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:37:17.880430 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:37:17.881766 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:37:17.883387 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:37:17.884508 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:37:17.885566 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:37:17.892642 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:37:17.899682 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:37:17.901778 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:37:17.903343 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:37:17.905189 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:37:17.909719 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:37:17.913248 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:37:17.913911 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:37:17.914495 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:37:17.914966 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:37:17.915901 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:37:17.929622 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:37:17.932515 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:37:18.072096 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:37:18.080255 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:37:18.082682 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:37:18.119439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeacd499a0>]}
16:37:18.122683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab4455b0>]}
16:37:18.122895 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:37:18.123050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeacd49a60>]}
16:37:18.123949 [info ] [MainThread]: 
16:37:18.124226 [debug] [MainThread]: Acquiring new postgres connection "master"
16:37:18.125132 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:37:18.131428 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:37:18.131594 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:37:18.131670 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:37:18.140075 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:37:18.141325 [debug] [ThreadPool]: On list_erp_oltp: Close
16:37:18.143183 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:37:18.148125 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:37:18.148344 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:37:18.148419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:37:18.154731 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:37:18.154956 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:37:18.155069 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:37:18.157296 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:37:18.158834 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:37:18.159460 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:37:18.163350 [debug] [MainThread]: Using postgres connection "master"
16:37:18.163531 [debug] [MainThread]: On master: BEGIN
16:37:18.163598 [debug] [MainThread]: Opening a new connection, currently in state init
16:37:18.167735 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:37:18.167897 [debug] [MainThread]: Using postgres connection "master"
16:37:18.167965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:37:18.176557 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:37:18.177622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab4205e0>]}
16:37:18.177894 [debug] [MainThread]: On master: ROLLBACK
16:37:18.178200 [debug] [MainThread]: Using postgres connection "master"
16:37:18.178314 [debug] [MainThread]: On master: BEGIN
16:37:18.178591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:37:18.178705 [debug] [MainThread]: On master: COMMIT
16:37:18.178780 [debug] [MainThread]: Using postgres connection "master"
16:37:18.178874 [debug] [MainThread]: On master: COMMIT
16:37:18.179012 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:37:18.179105 [debug] [MainThread]: On master: Close
16:37:18.179451 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:37:18.179620 [info ] [MainThread]: 
16:37:18.182990 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:37:18.183181 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
16:37:18.183475 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:37:18.183569 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:37:18.183647 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:37:18.184920 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:37:18.185190 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:37:18.185416 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:37:18.185687 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:37:18.185784 [debug] [Thread-1  ]: finished collecting timing info
16:37:18.185891 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:37:18.186013 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:37:18.186117 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:37:18.198927 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:37:18.199241 [debug] [Thread-2  ]: finished collecting timing info
16:37:18.199389 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:37:18.219925 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:37:18.220316 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.220468 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:37:18.220535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:37:18.223907 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:37:18.224201 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.224343 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:37:18.224405 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:37:18.225826 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:37:18.226042 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.226116 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:37:18.227847 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
16:37:18.231897 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.232214 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:37:18.232611 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:37:18.232736 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.232852 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:37:18.232979 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:37:18.235433 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.235544 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:37:18.235631 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:37:18.237152 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.237275 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:37:18.237366 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:37:18.241200 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:37:18.241405 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.241512 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:37:18.241656 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:37:18.243334 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.243488 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:37:18.243640 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:37:18.247474 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.247684 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:37:18.247928 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:37:18.251073 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:37:18.251206 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
16:37:18.251305 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.251988 [debug] [Thread-1  ]: finished collecting timing info
16:37:18.252129 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:37:18.252270 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:37:18.254066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeaaf8b580>]}
16:37:18.254311 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
16:37:18.254543 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:37:18.254804 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:37:18.255684 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.255784 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:37:18.256937 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:37:18.257601 [debug] [Thread-2  ]: finished collecting timing info
16:37:18.257715 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:37:18.257978 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeaaf678b0>]}
16:37:18.259509 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
16:37:18.259786 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:37:18.260194 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:37:18.260337 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:37:18.260572 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:37:18.260651 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:37:18.260719 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:37:18.262153 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:37:18.262388 [debug] [Thread-4  ]: finished collecting timing info
16:37:18.262522 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:37:18.264329 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:37:18.264529 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:37:18.264644 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:37:18.264702 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:37:18.272350 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:37:18.272543 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:37:18.272622 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:37:18.273527 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:37:18.275314 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:37:18.275610 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:37:18.276136 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:37:18.277142 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:37:18.277251 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:37:18.277319 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:37:18.278013 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:37:18.279024 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:37:18.279115 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:37:18.279316 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:37:18.279972 [debug] [Thread-4  ]: finished collecting timing info
16:37:18.280080 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:37:18.280432 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea8688c10>]}
16:37:18.280666 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
16:37:18.281032 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:37:18.282438 [debug] [MainThread]: Acquiring new postgres connection "master"
16:37:18.282556 [debug] [MainThread]: Using postgres connection "master"
16:37:18.282619 [debug] [MainThread]: On master: BEGIN
16:37:18.282676 [debug] [MainThread]: Opening a new connection, currently in state closed
16:37:18.288456 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:37:18.288672 [debug] [MainThread]: On master: COMMIT
16:37:18.288750 [debug] [MainThread]: Using postgres connection "master"
16:37:18.288814 [debug] [MainThread]: On master: COMMIT
16:37:18.289006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:37:18.289111 [debug] [MainThread]: On master: Close
16:37:18.289427 [info ] [MainThread]: 
16:37:18.289580 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.17s.
16:37:18.289709 [debug] [MainThread]: Connection 'master' was properly closed.
16:37:18.289764 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:37:18.289817 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:37:18.289870 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:37:18.293234 [info ] [MainThread]: 
16:37:18.293518 [info ] [MainThread]: [32mCompleted successfully[0m
16:37:18.293717 [info ] [MainThread]: 
16:37:18.295164 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:37:18.295396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab420df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeaaeffdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeaaeff8b0>]}


============================== 2022-06-04 16:42:27.366546 | 68e51c5c-19e4-4b39-9896-a5006d48cb9c ==============================
16:42:27.366560 [info ] [MainThread]: Running with dbt=1.1.0
16:42:27.366931 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:42:27.367026 [debug] [MainThread]: Tracking: tracking
16:42:27.369602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8be2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8be2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8be21f0>]}
16:42:27.391475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
16:42:27.391767 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/customer2.sql
16:42:27.399233 [debug] [MainThread]: 1699: static parser successfully parsed erp/customer2.sql
16:42:27.413881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f86b90d0>]}
16:42:27.417472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8b84eb0>]}
16:42:27.417721 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:42:27.417887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8b84dc0>]}
16:42:27.418877 [info ] [MainThread]: 
16:42:27.419215 [debug] [MainThread]: Acquiring new postgres connection "master"
16:42:27.423079 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:42:27.430953 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:42:27.431143 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:42:27.431218 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:42:27.437034 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:42:27.438248 [debug] [ThreadPool]: On list_erp_oltp: Close
16:42:27.439470 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:42:27.443480 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:42:27.443606 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:42:27.443673 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:42:27.447399 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:42:27.447541 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:42:27.447615 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:42:27.449086 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:42:27.450272 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:42:27.450488 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:42:27.479885 [debug] [MainThread]: Using postgres connection "master"
16:42:27.480088 [debug] [MainThread]: On master: BEGIN
16:42:27.480174 [debug] [MainThread]: Opening a new connection, currently in state init
16:42:27.484841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:42:27.484995 [debug] [MainThread]: Using postgres connection "master"
16:42:27.485087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:42:27.493074 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:42:27.494059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8b46ee0>]}
16:42:27.494331 [debug] [MainThread]: On master: ROLLBACK
16:42:27.494801 [debug] [MainThread]: Using postgres connection "master"
16:42:27.494896 [debug] [MainThread]: On master: BEGIN
16:42:27.495162 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:42:27.495253 [debug] [MainThread]: On master: COMMIT
16:42:27.495312 [debug] [MainThread]: Using postgres connection "master"
16:42:27.495369 [debug] [MainThread]: On master: COMMIT
16:42:27.495515 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:42:27.495601 [debug] [MainThread]: On master: Close
16:42:27.495850 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:42:27.495991 [info ] [MainThread]: 
16:42:27.502130 [debug] [Thread-1  ]: Began running node model.first_project.customer2
16:42:27.502391 [info ] [Thread-1  ]: 1 of 4 START table model public.customer2 ...................................... [RUN]
16:42:27.502697 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
16:42:27.502794 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
16:42:27.502871 [debug] [Thread-1  ]: Compiling model.first_project.customer2
16:42:27.504333 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
16:42:27.504626 [debug] [Thread-1  ]: finished collecting timing info
16:42:27.504751 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
16:42:27.510373 [debug] [Thread-2  ]: Began running node model.first_project.customers
16:42:27.510533 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
16:42:27.515972 [info ] [Thread-2  ]: 2 of 4 START view model public.customers ....................................... [RUN]
16:42:27.526180 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
16:42:27.526331 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
16:42:27.526810 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers"
16:42:27.527264 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:42:27.527426 [debug] [Thread-2  ]: Began compiling node model.first_project.customers
16:42:27.527543 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
16:42:27.527649 [debug] [Thread-2  ]: Compiling model.first_project.customers
16:42:27.527781 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
16:42:27.528564 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers"
16:42:27.530257 [debug] [Thread-2  ]: finished collecting timing info
16:42:27.530375 [debug] [Thread-2  ]: Began executing node model.first_project.customers
16:42:27.529978 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:42:27.528683 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
16:42:27.543564 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
16:42:27.543694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:42:27.544104 [debug] [Thread-3  ]: finished collecting timing info
16:42:27.544285 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
16:42:27.543409 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers"
16:42:27.546504 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:42:27.546964 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.547102 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.547213 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
16:42:27.547325 [debug] [Thread-2  ]: On model.first_project.customers: BEGIN
16:42:27.547432 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:42:27.547763 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:42:27.551467 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:42:27.551596 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
16:42:27.551691 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:42:27.556993 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
16:42:27.561062 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
16:42:27.561422 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
16:42:27.561873 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:27.568215 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
16:42:27.574747 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
16:42:27.575713 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.575550 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.575836 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:42:27.575421 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
16:42:27.575943 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:42:27.576103 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
16:42:27.576246 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
16:42:27.577325 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
16:42:27.578754 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.578867 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
16:42:27.580370 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.579025 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:42:27.580468 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:42:27.578958 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:42:27.583289 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
16:42:27.583405 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:27.589111 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.587199 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
16:42:27.589281 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:42:27.583492 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
16:42:27.591051 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.591608 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
16:42:27.591731 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:42:27.592653 [debug] [Thread-1  ]: finished collecting timing info
16:42:27.592996 [debug] [Thread-1  ]: On model.first_project.customer2: Close
16:42:27.593317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f86815b0>]}
16:42:27.593561 [info ] [Thread-1  ]: 1 of 4 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.09s]
16:42:27.592774 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:27.595831 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
16:42:27.595929 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.594999 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:27.595995 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
16:42:27.594879 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
16:42:27.597087 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
16:42:27.597446 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.597527 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
16:42:27.598495 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
16:42:27.599616 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.599724 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:42:27.601612 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:42:27.601939 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
16:42:27.603375 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.605166 [debug] [Thread-3  ]: finished collecting timing info
16:42:27.605707 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:42:27.605979 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
16:42:27.608891 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f86371f0>]}
16:42:27.609744 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
16:42:27.610436 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
16:42:27.610976 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
16:42:27.611278 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
16:42:27.611923 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:42:27.612201 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
16:42:27.612439 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
16:42:27.612648 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
16:42:27.619976 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:42:27.620478 [debug] [Thread-5  ]: finished collecting timing info
16:42:27.620709 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
16:42:27.615245 [debug] [Thread-2  ]: finished collecting timing info
16:42:27.629084 [debug] [Thread-2  ]: On model.first_project.customers: Close
16:42:27.632074 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f86185b0>]}
16:42:27.625849 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:42:27.633296 [info ] [Thread-2  ]: 2 of 4 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.11s]
16:42:27.635597 [debug] [Thread-2  ]: Finished running node model.first_project.customers
16:42:27.636124 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:27.636300 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
16:42:27.636399 [debug] [Thread-5  ]: Opening a new connection, currently in state init
16:42:27.642581 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
16:42:27.642823 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:27.642949 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:42:27.644940 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
16:42:27.650478 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:27.650710 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:42:27.651177 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:27.652071 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
16:42:27.652213 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:27.652309 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
16:42:27.653099 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
16:42:27.656053 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:27.656303 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:42:27.656664 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
16:42:27.657670 [debug] [Thread-5  ]: finished collecting timing info
16:42:27.657931 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
16:42:27.662762 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f85c5910>]}
16:42:27.663213 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
16:42:27.663553 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
16:42:27.665466 [debug] [MainThread]: Acquiring new postgres connection "master"
16:42:27.665637 [debug] [MainThread]: Using postgres connection "master"
16:42:27.665714 [debug] [MainThread]: On master: BEGIN
16:42:27.665777 [debug] [MainThread]: Opening a new connection, currently in state closed
16:42:27.669746 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:42:27.669912 [debug] [MainThread]: On master: COMMIT
16:42:27.669984 [debug] [MainThread]: Using postgres connection "master"
16:42:27.670075 [debug] [MainThread]: On master: COMMIT
16:42:27.670257 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:42:27.670350 [debug] [MainThread]: On master: Close
16:42:27.670682 [info ] [MainThread]: 
16:42:27.670919 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0.25s.
16:42:27.671220 [debug] [MainThread]: Connection 'master' was properly closed.
16:42:27.671294 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:42:27.671352 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
16:42:27.671408 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:42:27.671464 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:42:27.675620 [info ] [MainThread]: 
16:42:27.675924 [info ] [MainThread]: [32mCompleted successfully[0m
16:42:27.676361 [info ] [MainThread]: 
16:42:27.677148 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
16:42:27.677375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8aefeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fad5b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fad5b820>]}


============================== 2022-06-04 17:03:17.203794 | a9b0e3c3-0ed2-48fa-87d7-842fb48322b1 ==============================
17:03:17.203806 [info ] [MainThread]: Running with dbt=1.1.0
17:03:17.204204 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:03:17.204305 [debug] [MainThread]: Tracking: tracking
17:03:17.206713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bd75100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bd75c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bd75e20>]}
17:03:17.229424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bd79df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bcdba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bcdb910>]}


============================== 2022-06-04 17:03:50.393766 | 15aef3a4-7875-4808-b99e-38c3acad6253 ==============================
17:03:50.393785 [info ] [MainThread]: Running with dbt=1.1.0
17:03:50.394278 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:03:50.394407 [debug] [MainThread]: Tracking: tracking
17:03:50.397754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81ebc3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81ebc35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81ebc32e0>]}
17:03:50.424005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:03:50.424379 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/schema.yml
17:03:50.452996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81ea7a0d0>]}
17:03:50.456397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81eb2adf0>]}
17:03:50.456652 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:03:50.456895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81eb2adc0>]}
17:03:50.457908 [info ] [MainThread]: 
17:03:50.458266 [debug] [MainThread]: Acquiring new postgres connection "master"
17:03:50.459060 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:03:50.466840 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:03:50.467018 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:03:50.467090 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:03:50.474448 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:03:50.475710 [debug] [ThreadPool]: On list_erp_oltp: Close
17:03:50.476837 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:03:50.481231 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:03:50.481399 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:03:50.481464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:03:50.488321 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:03:50.488581 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:03:50.488683 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:03:50.490459 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:03:50.491671 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:03:50.492028 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:03:50.497081 [debug] [MainThread]: Using postgres connection "master"
17:03:50.497298 [debug] [MainThread]: On master: BEGIN
17:03:50.497372 [debug] [MainThread]: Opening a new connection, currently in state init
17:03:50.503026 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:03:50.503207 [debug] [MainThread]: Using postgres connection "master"
17:03:50.503301 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:03:50.512801 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:03:50.514038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81eb86640>]}
17:03:50.514417 [debug] [MainThread]: On master: ROLLBACK
17:03:50.514789 [debug] [MainThread]: Using postgres connection "master"
17:03:50.514899 [debug] [MainThread]: On master: BEGIN
17:03:50.515110 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:03:50.515230 [debug] [MainThread]: On master: COMMIT
17:03:50.515322 [debug] [MainThread]: Using postgres connection "master"
17:03:50.515396 [debug] [MainThread]: On master: COMMIT
17:03:50.515538 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:03:50.515647 [debug] [MainThread]: On master: Close
17:03:50.515956 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:03:50.516117 [info ] [MainThread]: 
17:03:50.555194 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:03:50.555453 [debug] [Thread-2  ]: Began running node model.first_project.customers
17:03:50.556107 [info ] [Thread-2  ]: 2 of 4 START view model public.customers ....................................... [RUN]
17:03:50.555856 [info ] [Thread-1  ]: 1 of 4 START table model public.customer2 ...................................... [RUN]
17:03:50.556446 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers"
17:03:50.557214 [debug] [Thread-2  ]: Began compiling node model.first_project.customers
17:03:50.557506 [debug] [Thread-2  ]: Compiling model.first_project.customers
17:03:50.556883 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:03:50.559070 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:03:50.555577 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:03:50.559446 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
17:03:50.559191 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:03:50.559722 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:03:50.562084 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:03:50.561751 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:03:50.562199 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:03:50.564727 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:03:50.558842 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers"
17:03:50.565111 [debug] [Thread-2  ]: finished collecting timing info
17:03:50.565251 [debug] [Thread-3  ]: finished collecting timing info
17:03:50.565362 [debug] [Thread-2  ]: Began executing node model.first_project.customers
17:03:50.565473 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:03:50.596637 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers"
17:03:50.602247 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:03:50.602873 [debug] [Thread-1  ]: finished collecting timing info
17:03:50.603277 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:03:50.604989 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:03:50.605284 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.605489 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:03:50.605564 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:03:50.605848 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.606131 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:03:50.606211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:03:50.606021 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.606596 [debug] [Thread-2  ]: On model.first_project.customers: BEGIN
17:03:50.606670 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:03:50.610960 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
17:03:50.611225 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.611355 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:03:50.612752 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:03:50.613012 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:03:50.613122 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.613291 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.613412 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:03:50.613539 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:03:50.613977 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
17:03:50.619129 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.619760 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
17:03:50.624758 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.622484 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.01 seconds
17:03:50.625006 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:03:50.622315 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:03:50.626618 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.627050 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:03:50.627567 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.627856 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.630110 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.630307 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.633217 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.631906 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:03:50.633354 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:03:50.631716 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.633698 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.634837 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.642387 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:03:50.641369 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:03:50.642557 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.642836 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:03:50.642688 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.642979 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:03:50.634918 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:03:50.643582 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.644586 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
17:03:50.644964 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:03:50.645093 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.648334 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.648475 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:03:50.649737 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.648722 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:03:50.649835 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:03:50.648593 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
17:03:50.651097 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:03:50.652035 [debug] [Thread-1  ]: finished collecting timing info
17:03:50.652182 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:03:50.652269 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:03:50.653411 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.653508 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:03:50.652359 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
17:03:50.655288 [debug] [Thread-3  ]: finished collecting timing info
17:03:50.655433 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:03:50.655771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff820dab130>]}
17:03:50.656089 [info ] [Thread-1  ]: 1 of 4 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.10s]
17:03:50.656365 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:03:50.657233 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff821815a00>]}
17:03:50.657468 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
17:03:50.657581 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:03:50.658026 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:03:50.658710 [debug] [Thread-2  ]: finished collecting timing info
17:03:50.659049 [debug] [Thread-2  ]: On model.first_project.customers: Close
17:03:50.659155 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:03:50.659319 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
17:03:50.659585 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:03:50.659678 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:03:50.659757 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:03:50.661357 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:03:50.661633 [debug] [Thread-5  ]: finished collecting timing info
17:03:50.661755 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:03:50.663292 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:03:50.663622 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81eacfd90>]}
17:03:50.663894 [info ] [Thread-2  ]: 2 of 4 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.11s]
17:03:50.664151 [debug] [Thread-2  ]: Finished running node model.first_project.customers
17:03:50.664893 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:50.664987 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:03:50.665053 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:03:50.669467 [debug] [Thread-5  ]: SQL status: BEGIN in 0.0 seconds
17:03:50.669602 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:50.669675 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:03:50.670580 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:03:50.672426 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:50.672526 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:03:50.672776 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.673614 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:03:50.673706 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:50.675120 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:03:50.676889 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:03:50.680922 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:50.681172 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:03:50.681593 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:03:50.682542 [debug] [Thread-5  ]: finished collecting timing info
17:03:50.682713 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:03:50.698069 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81c1d0250>]}
17:03:50.698597 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
17:03:50.698946 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:03:50.701178 [debug] [MainThread]: Acquiring new postgres connection "master"
17:03:50.701426 [debug] [MainThread]: Using postgres connection "master"
17:03:50.701523 [debug] [MainThread]: On master: BEGIN
17:03:50.701583 [debug] [MainThread]: Opening a new connection, currently in state closed
17:03:50.706830 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:03:50.707012 [debug] [MainThread]: On master: COMMIT
17:03:50.707080 [debug] [MainThread]: Using postgres connection "master"
17:03:50.707143 [debug] [MainThread]: On master: COMMIT
17:03:50.707282 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:03:50.707376 [debug] [MainThread]: On master: Close
17:03:50.707818 [info ] [MainThread]: 
17:03:50.707989 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0.25s.
17:03:50.708098 [debug] [MainThread]: Connection 'master' was properly closed.
17:03:50.708154 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:03:50.708205 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:03:50.708255 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:03:50.708305 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:03:50.712062 [info ] [MainThread]: 
17:03:50.712413 [info ] [MainThread]: [32mCompleted successfully[0m
17:03:50.726659 [info ] [MainThread]: 
17:03:50.726779 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
17:03:50.727001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81ea4dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81eb2a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81c164f40>]}


============================== 2022-06-04 17:10:22.067660 | c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5 ==============================
17:10:22.067673 [info ] [MainThread]: Running with dbt=1.1.0
17:10:22.068016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:10:22.068096 [debug] [MainThread]: Tracking: tracking
17:10:22.070313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263df22100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263df22c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263df22e20>]}
17:10:22.093598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:10:22.094112 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/postgres_sample_source_customers.sql
17:10:22.109119 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
17:10:22.124016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263d9f60d0>]}
17:10:22.127423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263de8ad90>]}
17:10:22.127643 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:10:22.127798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263de8af10>]}
17:10:22.128877 [info ] [MainThread]: 
17:10:22.129543 [debug] [MainThread]: Acquiring new postgres connection "master"
17:10:22.130469 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:10:22.138911 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:10:22.139108 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:10:22.139190 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:10:22.144812 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:10:22.146375 [debug] [ThreadPool]: On list_erp_oltp: Close
17:10:22.147376 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:10:22.151184 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:10:22.151294 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:10:22.151364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:10:22.160093 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:10:22.160377 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:10:22.160480 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:10:22.162080 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:10:22.163383 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:10:22.163736 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:10:22.207297 [debug] [MainThread]: Using postgres connection "master"
17:10:22.207486 [debug] [MainThread]: On master: BEGIN
17:10:22.207549 [debug] [MainThread]: Opening a new connection, currently in state init
17:10:22.211532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:10:22.211683 [debug] [MainThread]: Using postgres connection "master"
17:10:22.211753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:10:22.221585 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:10:22.222681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263df28fa0>]}
17:10:22.222949 [debug] [MainThread]: On master: ROLLBACK
17:10:22.223354 [debug] [MainThread]: Using postgres connection "master"
17:10:22.223470 [debug] [MainThread]: On master: BEGIN
17:10:22.224925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:10:22.225045 [debug] [MainThread]: On master: COMMIT
17:10:22.225122 [debug] [MainThread]: Using postgres connection "master"
17:10:22.225189 [debug] [MainThread]: On master: COMMIT
17:10:22.225347 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:10:22.225445 [debug] [MainThread]: On master: Close
17:10:22.225812 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:10:22.226058 [info ] [MainThread]: 
17:10:22.230333 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:10:22.230561 [info ] [Thread-1  ]: 1 of 5 START table model public.customer2 ...................................... [RUN]
17:10:22.230884 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:10:22.230996 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:10:22.231167 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:10:22.232664 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:10:22.232971 [debug] [Thread-1  ]: finished collecting timing info
17:10:22.233166 [debug] [Thread-2  ]: Began running node model.first_project.customers
17:10:22.233287 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:10:22.233860 [info ] [Thread-3  ]: 3 of 5 START table model public.my_first_dbt_model ............................. [RUN]
17:10:22.234223 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:10:22.233621 [info ] [Thread-2  ]: 2 of 5 START view model public.customers ....................................... [RUN]
17:10:22.233367 [debug] [Thread-4  ]: Began running node model.first_project.postgres_sample_source_customers
17:10:22.234869 [info ] [Thread-4  ]: 4 of 5 START view model public.postgres_sample_source_customers ................ [RUN]
17:10:22.235115 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.234683 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers"
17:10:22.235191 [debug] [Thread-4  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:10:22.235413 [debug] [Thread-4  ]: Compiling model.first_project.postgres_sample_source_customers
17:10:22.234342 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:10:22.237023 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:10:22.236893 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:10:22.238655 [debug] [Thread-4  ]: finished collecting timing info
17:10:22.238761 [debug] [Thread-4  ]: Began executing node model.first_project.postgres_sample_source_customers
17:10:22.235298 [debug] [Thread-2  ]: Began compiling node model.first_project.customers
17:10:22.250927 [debug] [Thread-2  ]: Compiling model.first_project.customers
17:10:22.233443 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:10:22.238343 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:10:22.257208 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers"
17:10:22.280411 [debug] [Thread-3  ]: finished collecting timing info
17:10:22.278635 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:10:22.280738 [debug] [Thread-2  ]: finished collecting timing info
17:10:22.260153 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:10:22.280978 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:10:22.281248 [debug] [Thread-2  ]: Began executing node model.first_project.customers
17:10:22.281471 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.284026 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:10:22.286522 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers"
17:10:22.286721 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.287105 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:10:22.287184 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:10:22.287506 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.287615 [debug] [Thread-2  ]: On model.first_project.customers: BEGIN
17:10:22.287681 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:10:22.286852 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:10:22.288142 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.288329 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:10:22.288442 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:10:22.288632 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:10:22.295728 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:10:22.296038 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.296207 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:10:22.299139 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:10:22.299394 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.299574 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:10:22.299786 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:10:22.299888 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.299951 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:10:22.300740 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:10:22.300928 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.300994 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:10:22.301361 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
17:10:22.306788 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
17:10:22.306956 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.01 seconds
17:10:22.308335 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.310656 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:10:22.310293 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.310801 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:10:22.308479 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.310533 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:10:22.310909 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:10:22.312266 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.312462 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:10:22.312854 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:22.317972 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:10:22.318108 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
17:10:22.318234 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.320011 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:10:22.318423 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
17:10:22.321276 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.318316 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:10:22.321402 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:10:22.319883 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.323561 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:10:22.323901 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:22.323316 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.328118 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:10:22.328249 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:22.329641 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
17:10:22.328511 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:10:22.329738 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.329900 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
17:10:22.328317 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
17:10:22.328662 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.333366 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:10:22.334696 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.333487 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:22.336339 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:10:22.334861 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:10:22.333254 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.336650 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:10:22.336963 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:22.333665 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:10:22.336462 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.337789 [debug] [Thread-4  ]: finished collecting timing info
17:10:22.338018 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:10:22.338459 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:22.339480 [debug] [Thread-2  ]: finished collecting timing info
17:10:22.339596 [debug] [Thread-2  ]: On model.first_project.customers: Close
17:10:22.340146 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263d9ab4f0>]}
17:10:22.338614 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: Close
17:10:22.340302 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:10:22.340565 [info ] [Thread-2  ]: 2 of 5 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.11s]
17:10:22.343482 [debug] [Thread-2  ]: Finished running node model.first_project.customers
17:10:22.342993 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.343863 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263d957df0>]}
17:10:22.345215 [info ] [Thread-4  ]: 4 of 5 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
17:10:22.344883 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:10:22.343969 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:10:22.347955 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.348061 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:10:22.345520 [debug] [Thread-4  ]: Finished running node model.first_project.postgres_sample_source_customers
17:10:22.348165 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
17:10:22.349712 [debug] [Thread-3  ]: finished collecting timing info
17:10:22.349842 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:10:22.349937 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:10:22.351696 [debug] [Thread-1  ]: finished collecting timing info
17:10:22.351993 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263d9abf40>]}
17:10:22.352104 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:10:22.352380 [info ] [Thread-3  ]: 3 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
17:10:22.355118 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:10:22.355387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263d972580>]}
17:10:22.355754 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
17:10:22.355980 [info ] [Thread-1  ]: 1 of 5 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.12s]
17:10:22.356145 [info ] [Thread-6  ]: 5 of 5 START view model public.my_second_dbt_model ............................. [RUN]
17:10:22.356484 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:10:22.356825 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:10:22.357056 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
17:10:22.357153 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
17:10:22.358658 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:10:22.358903 [debug] [Thread-6  ]: finished collecting timing info
17:10:22.359020 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
17:10:22.360385 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:10:22.360585 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:22.360687 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
17:10:22.360751 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:10:22.367737 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:10:22.367942 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:22.368016 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:10:22.368954 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:10:22.373606 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:22.373772 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:10:22.378580 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:22.380577 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:10:22.380854 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:22.380979 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:10:22.382333 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:10:22.383529 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:22.383652 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:10:22.384765 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:22.387308 [debug] [Thread-6  ]: finished collecting timing info
17:10:22.387444 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
17:10:22.387903 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263c096f10>]}
17:10:22.388212 [info ] [Thread-6  ]: 5 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:10:22.388542 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
17:10:22.389794 [debug] [MainThread]: Acquiring new postgres connection "master"
17:10:22.389913 [debug] [MainThread]: Using postgres connection "master"
17:10:22.389987 [debug] [MainThread]: On master: BEGIN
17:10:22.390096 [debug] [MainThread]: Opening a new connection, currently in state closed
17:10:22.395199 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:10:22.395345 [debug] [MainThread]: On master: COMMIT
17:10:22.395418 [debug] [MainThread]: Using postgres connection "master"
17:10:22.395548 [debug] [MainThread]: On master: COMMIT
17:10:22.395876 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:10:22.396075 [debug] [MainThread]: On master: Close
17:10:22.396674 [info ] [MainThread]: 
17:10:22.396996 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0.27s.
17:10:22.397127 [debug] [MainThread]: Connection 'master' was properly closed.
17:10:22.397190 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:10:22.397247 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:10:22.397303 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:10:22.397358 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:10:22.397412 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:10:22.401113 [info ] [MainThread]: 
17:10:22.401309 [info ] [MainThread]: [32mCompleted successfully[0m
17:10:22.401448 [info ] [MainThread]: 
17:10:22.401546 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
17:10:22.401725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26400a3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26400a3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26400a3af0>]}


============================== 2022-06-04 17:20:18.078822 | aa2af42c-41e1-4e18-a871-43b0ebc1f279 ==============================
17:20:18.078834 [info ] [MainThread]: Running with dbt=1.1.0
17:20:18.079218 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:20:18.079314 [debug] [MainThread]: Tracking: tracking
17:20:18.081850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbdd0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbdd0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbdd0e20>]}
17:20:18.103206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
17:20:18.103613 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_customers.sql
17:20:18.103810 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:20:18.116041 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:20:18.130333 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:20:18.137197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb8ab0d0>]}
17:20:18.141189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbd3fb80>]}
17:20:18.141518 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:20:18.141742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbd3fe80>]}
17:20:18.143024 [info ] [MainThread]: 
17:20:18.143438 [debug] [MainThread]: Acquiring new postgres connection "master"
17:20:18.145019 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:20:18.160344 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:20:18.160539 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:20:18.160615 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:20:18.166974 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:20:18.167988 [debug] [ThreadPool]: On list_erp_oltp: Close
17:20:18.170993 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:20:18.176544 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:20:18.176729 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:20:18.176840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:20:18.186191 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:20:18.186448 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:20:18.186549 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:20:18.188103 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
17:20:18.189271 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:20:18.189734 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:20:18.222815 [debug] [MainThread]: Using postgres connection "master"
17:20:18.223289 [debug] [MainThread]: On master: BEGIN
17:20:18.223428 [debug] [MainThread]: Opening a new connection, currently in state init
17:20:18.227469 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:20:18.227621 [debug] [MainThread]: Using postgres connection "master"
17:20:18.227681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:20:18.237011 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
17:20:18.238283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbdd7190>]}
17:20:18.238602 [debug] [MainThread]: On master: ROLLBACK
17:20:18.238824 [debug] [MainThread]: Using postgres connection "master"
17:20:18.238919 [debug] [MainThread]: On master: BEGIN
17:20:18.239163 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:20:18.239317 [debug] [MainThread]: On master: COMMIT
17:20:18.239444 [debug] [MainThread]: Using postgres connection "master"
17:20:18.239695 [debug] [MainThread]: On master: COMMIT
17:20:18.240008 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:20:18.240174 [debug] [MainThread]: On master: Close
17:20:18.240531 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:20:18.240722 [info ] [MainThread]: 
17:20:18.245311 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:20:18.245538 [info ] [Thread-1  ]: 1 of 6 START table model public.customer2 ...................................... [RUN]
17:20:18.245847 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:20:18.245946 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:20:18.246033 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:20:18.247577 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:20:18.247843 [debug] [Thread-1  ]: finished collecting timing info
17:20:18.248002 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:20:18.256029 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:20:18.256526 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:20:18.267328 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:20:18.267690 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.267778 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:20:18.267876 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:20:18.256939 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:20:18.256679 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:20:18.269534 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:20:18.275216 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:20:18.280936 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:20:18.281251 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:20:18.282335 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:20:18.281906 [debug] [Thread-3  ]: finished collecting timing info
17:20:18.282429 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:20:18.282771 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:20:18.282616 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:20:18.283617 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:20:18.281572 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:20:18.297521 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:20:18.298249 [debug] [Thread-4  ]: finished collecting timing info
17:20:18.303700 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:20:18.305939 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:20:18.298402 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:20:18.308039 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:20:18.308549 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.308872 [debug] [Thread-2  ]: finished collecting timing info
17:20:18.309133 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.309791 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:20:18.309885 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:20:18.309532 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:20:18.309286 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:20:18.309639 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:20:18.312772 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:20:18.312903 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:20:18.312623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:20:18.312363 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:20:18.313587 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.313695 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:20:18.313763 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:20:18.319332 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:20:18.319530 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.319604 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:20:18.320419 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:20:18.320565 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:20:18.320673 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.320819 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:20:18.321117 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

select * from customers
  );
17:20:18.320965 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:20:18.321352 [debug] [Thread-4  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 13: select * from customers
         ^

17:20:18.321448 [debug] [Thread-4  ]: On model.first_project.stg_customers: ROLLBACK
17:20:18.321623 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
17:20:18.326885 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.327058 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:20:18.327772 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:20:18.327913 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.327977 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:20:18.328397 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
17:20:18.330054 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.330363 [debug] [Thread-4  ]: finished collecting timing info
17:20:18.330789 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:20:18.330616 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:20:18.331078 [debug] [Thread-4  ]: Database Error in model stg_customers (models/erp/stg_customers.sql)
  syntax error at or near "select"
  LINE 13: select * from customers
           ^
  compiled SQL at target/run/first_project/models/erp/stg_customers.sql
17:20:18.331424 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd87b9640>]}
17:20:18.331651 [error] [Thread-4  ]: 4 of 6 ERROR creating view model public.stg_customers .......................... [[31mERROR[0m in 0.05s]
17:20:18.331891 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:20:18.332299 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:20:18.332417 [info ] [Thread-6  ]: 5 of 6 SKIP relation public.customers .......................................... [[33mSKIP[0m]
17:20:18.332598 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:20:18.333176 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:18.330472 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:18.335664 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.337338 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.337561 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
17:20:18.339438 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.337947 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:20:18.339573 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:20:18.337728 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:20:18.340565 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:18.346867 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
17:20:18.351932 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:20:18.352238 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:20:18.354825 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.353351 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.355037 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:20:18.354926 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:20:18.353179 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:20:18.355567 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.355723 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:20:18.356519 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:20:18.360372 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.360549 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:20:18.361457 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:20:18.362600 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:20:18.362745 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.363002 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:20:18.362914 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:20:18.363392 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:20:18.365086 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.366137 [debug] [Thread-2  ]: finished collecting timing info
17:20:18.366374 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:20:18.370644 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.366584 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:20:18.366466 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:20:18.372553 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdea1a1c0>]}
17:20:18.370882 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:20:18.373665 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
17:20:18.374769 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:20:18.375936 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:20:18.377061 [debug] [Thread-3  ]: finished collecting timing info
17:20:18.377497 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:20:18.377899 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:20:18.378832 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:20:18.378612 [debug] [Thread-1  ]: finished collecting timing info
17:20:18.379140 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:20:18.379389 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:20:18.379271 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:20:18.379479 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:20:18.381109 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:20:18.377786 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:20:18.381431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbd46370>]}
17:20:18.381690 [debug] [Thread-8  ]: finished collecting timing info
17:20:18.383665 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:20:18.383523 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.14s]
17:20:18.386204 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:20:18.386762 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:18.386469 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:20:18.386861 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:20:18.387058 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:20:18.383278 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb804e20>]}
17:20:18.387898 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
17:20:18.388530 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:20:18.396798 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:20:18.397077 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:18.397230 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:20:18.398249 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:20:18.399861 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:18.399985 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:20:18.400301 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:18.401124 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:20:18.401226 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:18.401293 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:20:18.403146 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:20:18.405172 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:18.405274 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:20:18.405510 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:20:18.408042 [debug] [Thread-8  ]: finished collecting timing info
17:20:18.408265 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:20:18.408643 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb8043a0>]}
17:20:18.408979 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:20:18.409418 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:20:18.410729 [debug] [MainThread]: Acquiring new postgres connection "master"
17:20:18.410863 [debug] [MainThread]: Using postgres connection "master"
17:20:18.410941 [debug] [MainThread]: On master: BEGIN
17:20:18.411007 [debug] [MainThread]: Opening a new connection, currently in state closed
17:20:18.414951 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:20:18.415098 [debug] [MainThread]: On master: COMMIT
17:20:18.415173 [debug] [MainThread]: Using postgres connection "master"
17:20:18.415237 [debug] [MainThread]: On master: COMMIT
17:20:18.415388 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:20:18.415481 [debug] [MainThread]: On master: Close
17:20:18.415747 [info ] [MainThread]: 
17:20:18.415896 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.27s.
17:20:18.416040 [debug] [MainThread]: Connection 'master' was properly closed.
17:20:18.416099 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:20:18.416154 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:20:18.416208 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:20:18.416291 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:20:18.416347 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:20:18.419518 [info ] [MainThread]: 
17:20:18.419748 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:20:18.419900 [info ] [MainThread]: 
17:20:18.420023 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/erp/stg_customers.sql)[0m
17:20:18.420146 [error] [MainThread]:   syntax error at or near "select"
17:20:18.420250 [error] [MainThread]:   LINE 13: select * from customers
17:20:18.420356 [error] [MainThread]:            ^
17:20:18.420469 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/stg_customers.sql
17:20:18.420595 [info ] [MainThread]: 
17:20:18.420721 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
17:20:18.420974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbdd7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbd3f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd874c6a0>]}


============================== 2022-06-04 17:22:18.955952 | e8a22e45-a943-4086-be68-a98431f3bbc5 ==============================
17:22:18.955971 [info ] [MainThread]: Running with dbt=1.1.0
17:22:18.956511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:22:18.956658 [debug] [MainThread]: Tracking: tracking
17:22:18.971319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8fd4d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8fd4dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8fd4de20>]}
17:22:18.995248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:22:18.995603 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
17:22:19.006031 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:22:19.021888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f8210d0>]}
17:22:19.026659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8fcc0d90>]}
17:22:19.026961 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:22:19.027168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8fcc0e20>]}
17:22:19.028279 [info ] [MainThread]: 
17:22:19.028622 [debug] [MainThread]: Acquiring new postgres connection "master"
17:22:19.029489 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:22:19.041201 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:22:19.041380 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:22:19.041453 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:22:19.051072 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:22:19.052182 [debug] [ThreadPool]: On list_erp_oltp: Close
17:22:19.055680 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:22:19.060570 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:22:19.060706 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:22:19.060772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:22:19.066469 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:22:19.066811 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:22:19.067050 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:22:19.068729 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
17:22:19.070053 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:22:19.070480 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:22:19.102618 [debug] [MainThread]: Using postgres connection "master"
17:22:19.103010 [debug] [MainThread]: On master: BEGIN
17:22:19.103107 [debug] [MainThread]: Opening a new connection, currently in state init
17:22:19.107020 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:22:19.107380 [debug] [MainThread]: Using postgres connection "master"
17:22:19.107457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:22:19.116475 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
17:22:19.117525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9156ddf0>]}
17:22:19.117769 [debug] [MainThread]: On master: ROLLBACK
17:22:19.117982 [debug] [MainThread]: Using postgres connection "master"
17:22:19.118071 [debug] [MainThread]: On master: BEGIN
17:22:19.118251 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:22:19.118338 [debug] [MainThread]: On master: COMMIT
17:22:19.118415 [debug] [MainThread]: Using postgres connection "master"
17:22:19.118485 [debug] [MainThread]: On master: COMMIT
17:22:19.118605 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:22:19.118694 [debug] [MainThread]: On master: Close
17:22:19.118970 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:22:19.119211 [info ] [MainThread]: 
17:22:19.123378 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:22:19.123628 [info ] [Thread-1  ]: 1 of 6 START table model public.customer2 ...................................... [RUN]
17:22:19.123944 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:22:19.124035 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:22:19.124112 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:22:19.125556 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:22:19.125721 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:22:19.125882 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:22:19.126118 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:22:19.126275 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:22:19.126394 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:22:19.126917 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:22:19.126717 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:22:19.126559 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:22:19.127029 [debug] [Thread-1  ]: finished collecting timing info
17:22:19.127297 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:22:19.127561 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.127664 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:22:19.127788 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:22:19.127891 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:22:19.127982 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:22:19.129361 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:22:19.150005 [debug] [Thread-2  ]: finished collecting timing info
17:22:19.146771 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:22:19.150152 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:22:19.136215 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:22:19.156191 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:22:19.151524 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:22:19.156607 [debug] [Thread-4  ]: finished collecting timing info
17:22:19.156846 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:22:19.155239 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:22:19.162544 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.162161 [debug] [Thread-3  ]: finished collecting timing info
17:22:19.149623 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:22:19.168232 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.167896 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:22:19.162646 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:22:19.171186 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:22:19.168339 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:22:19.170932 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:22:19.172171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:22:19.172624 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.172735 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:22:19.172813 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:22:19.168482 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:22:19.173992 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:19.174085 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:22:19.174144 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:22:19.178639 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
17:22:19.178792 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:19.178890 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)

select * from customers
  );
17:22:19.179309 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:22:19.179415 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.179477 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:22:19.180287 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:19.184283 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:19.184416 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:22:19.184613 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
17:22:19.186407 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.186527 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:22:19.187242 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:22:19.187520 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.187590 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:22:19.187735 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:22:19.187866 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.192301 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.192517 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:22:19.188773 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
17:22:19.194000 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.194113 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:22:19.188111 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.188656 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.198357 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:22:19.198605 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:22:19.198713 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.200636 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.200824 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:22:19.198927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:22:19.204404 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:22:19.204512 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.206057 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:22:19.206151 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.204906 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
17:22:19.206216 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:22:19.204603 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.208391 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:22:19.199069 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:19.208540 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:22:19.207824 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.209036 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:22:19.209642 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.211744 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.211975 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.212143 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.212246 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.212385 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:22:19.217606 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.220526 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:22:19.220211 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:19.220675 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:22:19.220964 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:19.218740 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.221969 [debug] [Thread-4  ]: finished collecting timing info
17:22:19.222076 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.224728 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:22:19.222480 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:22:19.225720 [debug] [Thread-2  ]: finished collecting timing info
17:22:19.225834 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:22:19.222379 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:22:19.227598 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f7e6fd0>]}
17:22:19.222613 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:22:19.224935 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.228648 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:22:19.230084 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f7e61c0>]}
17:22:19.230310 [info ] [Thread-4  ]: 4 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.10s]
17:22:19.228208 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
17:22:19.230492 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.230763 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:22:19.230844 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:22:19.232065 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.232309 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:22:19.233272 [debug] [Thread-1  ]: finished collecting timing info
17:22:19.233783 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:22:19.235412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f77a7f0>]}
17:22:19.235770 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.11s]
17:22:19.236103 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:22:19.236510 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:22:19.236674 [info ] [Thread-6  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:22:19.236964 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
17:22:19.237047 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
17:22:19.237114 [debug] [Thread-6  ]: Compiling model.first_project.customers
17:22:19.238468 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
17:22:19.238686 [debug] [Thread-6  ]: finished collecting timing info
17:22:19.233539 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:22:19.238817 [debug] [Thread-6  ]: Began executing node model.first_project.customers
17:22:19.238995 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
17:22:19.243866 [info ] [Thread-7  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:22:19.244151 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:22:19.244230 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
17:22:19.244297 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
17:22:19.243554 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
17:22:19.245713 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:22:19.246260 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.246362 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
17:22:19.246442 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:22:19.246753 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:22:19.247751 [debug] [Thread-3  ]: finished collecting timing info
17:22:19.247877 [debug] [Thread-7  ]: finished collecting timing info
17:22:19.248036 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:22:19.248211 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
17:22:19.250347 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:22:19.250768 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8c6aa1c0>]}
17:22:19.251138 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
17:22:19.251445 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:22:19.251839 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:19.251936 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: BEGIN
17:22:19.251999 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:22:19.254238 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:22:19.254371 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.254461 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:22:19.256017 [debug] [Thread-7  ]: SQL status: BEGIN in 0.0 seconds
17:22:19.256130 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:19.256206 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:22:19.256293 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:19.258181 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.258298 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:22:19.258407 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:19.260350 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:19.260472 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:22:19.261983 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.265615 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: COMMIT
17:22:19.265793 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:19.266009 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: COMMIT
17:22:19.267701 [debug] [Thread-7  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.270233 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:19.270429 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:22:19.270772 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:19.271664 [debug] [Thread-7  ]: finished collecting timing info
17:22:19.272295 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: Close
17:22:19.272417 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.01 seconds
17:22:19.277982 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.278222 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:22:19.278663 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8c6be820>]}
17:22:19.278988 [info ] [Thread-7  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:22:19.279422 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
17:22:19.281682 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.282870 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:22:19.282982 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.283051 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:22:19.285120 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.287973 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.288134 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:22:19.292196 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:19.293556 [debug] [Thread-6  ]: finished collecting timing info
17:22:19.293726 [debug] [Thread-6  ]: On model.first_project.customers: Close
17:22:19.294156 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8c6c3eb0>]}
17:22:19.294426 [info ] [Thread-6  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.06s]
17:22:19.294657 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:22:19.295815 [debug] [MainThread]: Acquiring new postgres connection "master"
17:22:19.295932 [debug] [MainThread]: Using postgres connection "master"
17:22:19.295998 [debug] [MainThread]: On master: BEGIN
17:22:19.296058 [debug] [MainThread]: Opening a new connection, currently in state closed
17:22:19.304866 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:22:19.305119 [debug] [MainThread]: On master: COMMIT
17:22:19.305203 [debug] [MainThread]: Using postgres connection "master"
17:22:19.305267 [debug] [MainThread]: On master: COMMIT
17:22:19.305419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:22:19.305568 [debug] [MainThread]: On master: Close
17:22:19.305955 [info ] [MainThread]: 
17:22:19.306177 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.28s.
17:22:19.306298 [debug] [MainThread]: Connection 'master' was properly closed.
17:22:19.306357 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:22:19.306411 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:22:19.306463 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:22:19.306515 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:22:19.306567 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:22:19.306619 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:22:19.311605 [info ] [MainThread]: 
17:22:19.311898 [info ] [MainThread]: [32mCompleted successfully[0m
17:22:19.312173 [info ] [MainThread]: 
17:22:19.312300 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:22:19.313402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f821310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f7d7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a91ec22e0>]}


============================== 2022-06-04 17:46:44.072022 | 6254cbf2-30ca-47d7-b054-5a1f816f7b1a ==============================
17:46:44.072034 [info ] [MainThread]: Running with dbt=1.1.0
17:46:44.072355 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:46:44.072440 [debug] [MainThread]: Tracking: tracking
17:46:44.075082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d0a01070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d0a01040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d0a012b0>]}
17:46:44.097039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d0a01880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d099c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d099c3a0>]}


============================== 2022-06-04 17:47:36.777878 | 331ed1c3-aa71-43be-b62a-bcca585f76f5 ==============================
17:47:36.777892 [info ] [MainThread]: Running with dbt=1.1.0
17:47:36.778426 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:47:36.778583 [debug] [MainThread]: Tracking: tracking
17:47:36.781872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824cca9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824cca9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824cca9e20>]}
17:47:36.797010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824ccaddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824cc46220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824cc46370>]}


============================== 2022-06-04 17:48:33.489732 | ceaa3359-33fc-4824-bed5-0dececad7288 ==============================
17:48:33.489750 [info ] [MainThread]: Running with dbt=1.1.0
17:48:33.490267 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:48:33.490416 [debug] [MainThread]: Tracking: tracking
17:48:33.493443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35febcf100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35febcfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35febcfe20>]}
17:48:33.509153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35febd3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35feb75220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35feb75370>]}


============================== 2022-06-04 17:48:48.281943 | 0f5f9ae3-ddd8-4f75-8c12-45f820ed9a57 ==============================
17:48:48.281961 [info ] [MainThread]: Running with dbt=1.1.0
17:48:48.282535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:48:48.282741 [debug] [MainThread]: Tracking: tracking
17:48:48.293257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c85f4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c85f4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c85f42b0>]}
17:48:48.310841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c85f4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c858e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c858e3a0>]}


============================== 2022-06-04 17:50:01.936817 | b446dcfb-fb34-4d93-8ac5-4d331cf4187b ==============================
17:50:01.936831 [info ] [MainThread]: Running with dbt=1.1.0
17:50:01.937293 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:50:01.937410 [debug] [MainThread]: Tracking: tracking
17:50:01.940039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89219e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89219ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89219e6d0>]}
17:50:01.965562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:50:01.966103 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/schema.yml
17:50:01.993438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b446dcfb-fb34-4d93-8ac5-4d331cf4187b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8920220d0>]}
17:50:01.997126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b446dcfb-fb34-4d93-8ac5-4d331cf4187b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa892114d30>]}
17:50:01.997384 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:50:01.997560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b446dcfb-fb34-4d93-8ac5-4d331cf4187b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa892114df0>]}
17:50:01.998707 [info ] [MainThread]: 
17:50:01.999069 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:02.000105 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:50:02.011538 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:50:02.011752 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:50:02.011891 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:50:02.017893 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:50:02.018079 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:50:02.018150 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:50:02.019458 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:50:02.020516 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:50:02.020714 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:50:02.051745 [debug] [MainThread]: Using postgres connection "master"
17:50:02.051940 [debug] [MainThread]: On master: BEGIN
17:50:02.052007 [debug] [MainThread]: Opening a new connection, currently in state init
17:50:02.055931 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:02.056108 [debug] [MainThread]: Using postgres connection "master"
17:50:02.056174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:50:02.076284 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
17:50:02.077417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b446dcfb-fb34-4d93-8ac5-4d331cf4187b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa893a34370>]}
17:50:02.077677 [debug] [MainThread]: On master: ROLLBACK
17:50:02.078023 [debug] [MainThread]: Using postgres connection "master"
17:50:02.078141 [debug] [MainThread]: On master: BEGIN
17:50:02.078607 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:02.078721 [debug] [MainThread]: On master: COMMIT
17:50:02.078795 [debug] [MainThread]: Using postgres connection "master"
17:50:02.078898 [debug] [MainThread]: On master: COMMIT
17:50:02.079163 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:02.079287 [debug] [MainThread]: On master: Close
17:50:02.079646 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:50:02.079881 [info ] [MainThread]: 
17:50:02.082987 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:50:02.083208 [info ] [Thread-1  ]: 1 of 6 START test not_null_customers_customer_id ............................... [RUN]
17:50:02.083466 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:50:02.083545 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:50:02.083631 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
17:50:02.091730 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:50:02.091958 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:50:02.105471 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:50:02.092067 [debug] [Thread-4  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:50:02.092202 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:50:02.105079 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:50:02.105907 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:50:02.110103 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:50:02.109730 [info ] [Thread-4  ]: 4 of 6 START test unique_customers_customer_id ................................. [RUN]
17:50:02.110696 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:50:02.109873 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:50:02.109493 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:50:02.092137 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:50:02.110451 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:50:02.111407 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:50:02.111032 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:50:02.111692 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:50:02.111901 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:50:02.110779 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:50:02.118095 [debug] [Thread-4  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
17:50:02.110210 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:50:02.111522 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:50:02.111251 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:50:02.117917 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:50:02.120426 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:50:02.127008 [debug] [Thread-4  ]: finished collecting timing info
17:50:02.123348 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:50:02.126231 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:50:02.126686 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:50:02.127145 [debug] [Thread-4  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:50:02.111808 [debug] [Thread-1  ]: finished collecting timing info
17:50:02.127446 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:50:02.137625 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:50:02.137802 [debug] [Thread-3  ]: finished collecting timing info
17:50:02.138595 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:50:02.138107 [debug] [Thread-2  ]: finished collecting timing info
17:50:02.138224 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:50:02.138369 [debug] [Thread-6  ]: finished collecting timing info
17:50:02.137983 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:50:02.139687 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:50:02.139824 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:50:02.147397 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:50:02.140023 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:50:02.148142 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
17:50:02.146230 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:50:02.147767 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:50:02.148461 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:50:02.147965 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:50:02.148675 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:50:02.148807 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:50:02.148544 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:50:02.143001 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:50:02.142720 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:50:02.150387 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:50:02.148267 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:50:02.150749 [debug] [Thread-5  ]: finished collecting timing info
17:50:02.151249 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:50:02.152414 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:50:02.152626 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:50:02.152719 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:50:02.152809 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:50:02.153083 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:50:02.153185 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:50:02.153247 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:50:02.150878 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:50:02.154732 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
17:50:02.154812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:50:02.156399 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:50:02.156512 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:50:02.156580 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:50:02.163522 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.01 seconds
17:50:02.165851 [debug] [Thread-4  ]: finished collecting timing info
17:50:02.166053 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
17:50:02.166397 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
17:50:02.166907 [error] [Thread-4  ]: 4 of 6 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.06s]
17:50:02.167354 [debug] [Thread-4  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:50:02.171717 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:50:02.171935 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:50:02.172217 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:50:02.172469 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
17:50:02.172641 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:50:02.172741 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:50:02.173270 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:50:02.174495 [debug] [Thread-3  ]: finished collecting timing info
17:50:02.174710 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:50:02.174847 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
17:50:02.175818 [debug] [Thread-6  ]: finished collecting timing info
17:50:02.175934 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:50:02.176319 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:50:02.176445 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:50:02.176741 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
17:50:02.177358 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:50:02.178003 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
17:50:02.176887 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:50:02.178232 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:50:02.178337 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:50:02.178126 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:50:02.178465 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:50:02.177624 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
17:50:02.178754 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:50:02.179394 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:50:02.180211 [debug] [Thread-2  ]: finished collecting timing info
17:50:02.180309 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:50:02.180694 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:50:02.180831 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
17:50:02.181021 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:50:02.182060 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:50:02.184445 [debug] [Thread-5  ]: finished collecting timing info
17:50:02.184573 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:50:02.182738 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
17:50:02.182459 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.07s]
17:50:02.185849 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:50:02.186220 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:50:02.186598 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
17:50:02.186878 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:50:02.187047 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:50:02.188239 [debug] [Thread-1  ]: finished collecting timing info
17:50:02.188396 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
17:50:02.188597 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
17:50:02.188981 [info ] [Thread-1  ]: 1 of 6 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.11s]
17:50:02.189276 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:50:02.192333 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:02.192527 [debug] [MainThread]: Using postgres connection "master"
17:50:02.192592 [debug] [MainThread]: On master: BEGIN
17:50:02.192656 [debug] [MainThread]: Opening a new connection, currently in state closed
17:50:02.202314 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:50:02.202605 [debug] [MainThread]: On master: COMMIT
17:50:02.202685 [debug] [MainThread]: Using postgres connection "master"
17:50:02.202756 [debug] [MainThread]: On master: COMMIT
17:50:02.203200 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:02.203415 [debug] [MainThread]: On master: Close
17:50:02.203902 [info ] [MainThread]: 
17:50:02.204219 [info ] [MainThread]: Finished running 6 tests in 0.20s.
17:50:02.204405 [debug] [MainThread]: Connection 'master' was properly closed.
17:50:02.204490 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
17:50:02.204571 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:50:02.204658 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:50:02.204712 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
17:50:02.204848 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:50:02.204952 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:50:02.209086 [info ] [MainThread]: 
17:50:02.209392 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:50:02.209580 [info ] [MainThread]: 
17:50:02.209735 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
17:50:02.209899 [error] [MainThread]:   Got 50 results, configured to fail if != 0
17:50:02.210028 [info ] [MainThread]: 
17:50:02.210160 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
17:50:02.210290 [info ] [MainThread]: 
17:50:02.210416 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:50:02.210545 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:50:02.210666 [info ] [MainThread]: 
17:50:02.210814 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:50:02.210951 [info ] [MainThread]: 
17:50:02.211077 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
17:50:02.211286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8921afa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8939be310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa891f97850>]}


============================== 2022-06-04 17:50:21.481193 | db27c35a-3a1e-474c-b2a6-f534629d9eaa ==============================
17:50:21.481209 [info ] [MainThread]: Running with dbt=1.1.0
17:50:21.481628 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:50:21.481751 [debug] [MainThread]: Tracking: tracking
17:50:21.484560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bf53040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bf53f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bf53070>]}
17:50:21.517756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:50:21.517995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:50:21.524789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be810d0>]}
17:50:21.528865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be50310>]}
17:50:21.529129 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:50:21.529306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be503a0>]}
17:50:21.530398 [info ] [MainThread]: 
17:50:21.530761 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:21.531638 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:50:21.545081 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:50:21.545346 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:50:21.545455 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:50:21.551052 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:50:21.552064 [debug] [ThreadPool]: On list_erp_oltp: Close
17:50:21.553298 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:50:21.557507 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:50:21.557994 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:50:21.558109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:50:21.562180 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:50:21.562342 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:50:21.562414 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:50:21.563962 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:50:21.565004 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:50:21.565276 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:50:21.568440 [debug] [MainThread]: Using postgres connection "master"
17:50:21.568569 [debug] [MainThread]: On master: BEGIN
17:50:21.568643 [debug] [MainThread]: Opening a new connection, currently in state init
17:50:21.572648 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:21.572791 [debug] [MainThread]: Using postgres connection "master"
17:50:21.572897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:50:21.582883 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:50:21.584019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bf16640>]}
17:50:21.584371 [debug] [MainThread]: On master: ROLLBACK
17:50:21.584594 [debug] [MainThread]: Using postgres connection "master"
17:50:21.584679 [debug] [MainThread]: On master: BEGIN
17:50:21.584919 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:21.585014 [debug] [MainThread]: On master: COMMIT
17:50:21.585093 [debug] [MainThread]: Using postgres connection "master"
17:50:21.585155 [debug] [MainThread]: On master: COMMIT
17:50:21.585272 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:21.585356 [debug] [MainThread]: On master: Close
17:50:21.585637 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:50:21.585795 [info ] [MainThread]: 
17:50:21.590086 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:50:21.590303 [info ] [Thread-1  ]: 1 of 6 START table model public.customer2 ...................................... [RUN]
17:50:21.590575 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:50:21.590663 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:50:21.590742 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:50:21.592344 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:50:21.592655 [debug] [Thread-1  ]: finished collecting timing info
17:50:21.592892 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:50:21.593016 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:50:21.598597 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:50:21.598735 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:50:21.599134 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:50:21.611771 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:50:21.611889 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:50:21.613677 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:50:21.599226 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:50:21.614343 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:50:21.611490 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:50:21.615129 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.615225 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:50:21.615342 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:50:21.614723 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:50:21.655457 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:50:21.655605 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:50:21.614052 [debug] [Thread-2  ]: finished collecting timing info
17:50:21.656414 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:50:21.663522 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:50:21.663216 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:50:21.665574 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:50:21.665951 [debug] [Thread-4  ]: finished collecting timing info
17:50:21.669530 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:50:21.670093 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.670377 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:50:21.670621 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.676513 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:50:21.682178 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:50:21.670932 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:50:21.688507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:50:21.688258 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:50:21.682028 [debug] [Thread-3  ]: finished collecting timing info
17:50:21.689546 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:50:21.689066 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.691747 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:50:21.691979 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:50:21.692481 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:50:21.693711 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.693884 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:50:21.693963 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:50:21.697296 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:50:21.697447 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.697526 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:50:21.698213 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:50:21.698331 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.698397 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:50:21.699417 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
17:50:21.703682 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.703827 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:50:21.704055 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
17:50:21.706346 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.706745 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:50:21.707224 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.708599 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.708705 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:50:21.708861 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:50:21.709011 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.709114 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.709229 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)

select * from customers
  );
17:50:21.710435 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.710718 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:50:21.710850 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.717863 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
17:50:21.719703 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.719814 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:50:21.719953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:50:21.723428 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:50:21.723562 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.723634 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:50:21.723827 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:50:21.724788 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.724943 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.728702 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.728871 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:50:21.725084 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:50:21.728998 [debug] [Thread-3  ]: SQL status: BEGIN in 0.04 seconds
17:50:21.729793 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.729894 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:50:21.729091 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
17:50:21.730048 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.734478 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.736568 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:50:21.737004 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.736411 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.738124 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:50:21.738314 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:50:21.738480 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
17:50:21.738612 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.738683 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:50:21.743947 [debug] [Thread-1  ]: finished collecting timing info
17:50:21.744081 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:50:21.742950 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:50:21.743051 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:50:21.740406 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.745420 [debug] [Thread-2  ]: finished collecting timing info
17:50:21.745702 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:50:21.746494 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.748357 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.746990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b28585fa0>]}
17:50:21.746694 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:50:21.750798 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2857d880>]}
17:50:21.748933 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.752551 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.748772 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:50:21.751090 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
17:50:21.753096 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:50:21.749210 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.16s]
17:50:21.753491 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
17:50:21.753790 [info ] [Thread-6  ]: 5 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:50:21.752649 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:50:21.755134 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:50:21.755250 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.756078 [debug] [Thread-4  ]: finished collecting timing info
17:50:21.757808 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:50:21.756689 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:50:21.757582 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:50:21.756253 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:50:21.757944 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
17:50:21.759516 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
17:50:21.759336 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.761701 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:50:21.762812 [debug] [Thread-6  ]: finished collecting timing info
17:50:21.762443 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:50:21.762968 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
17:50:21.766565 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:50:21.767055 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:21.767165 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
17:50:21.767235 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:50:21.758285 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be367f0>]}
17:50:21.768325 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.769325 [info ] [Thread-4  ]: 4 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.14s]
17:50:21.775266 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.775866 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:50:21.776015 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:50:21.776499 [debug] [Thread-8  ]: Began running node model.first_project.customers
17:50:21.776783 [info ] [Thread-8  ]: 6 of 6 START view model public.customers ....................................... [RUN]
17:50:21.777129 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
17:50:21.777220 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
17:50:21.777299 [debug] [Thread-8  ]: Compiling model.first_project.customers
17:50:21.782417 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
17:50:21.783071 [debug] [Thread-8  ]: finished collecting timing info
17:50:21.783457 [debug] [Thread-8  ]: Began executing node model.first_project.customers
17:50:21.787205 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
17:50:21.787719 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:50:21.788042 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:50:21.788151 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
17:50:21.789322 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:21.789210 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
17:50:21.789402 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:50:21.790912 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:50:21.789494 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:50:21.789085 [debug] [Thread-3  ]: finished collecting timing info
17:50:21.792753 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:21.794714 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:50:21.798417 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b28573370>]}
17:50:21.798799 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.18s]
17:50:21.799396 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:50:21.794912 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:50:21.800175 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.801279 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:50:21.801382 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:21.801471 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:50:21.802477 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.803656 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:21.803839 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:50:21.805082 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
17:50:21.805221 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:50:21.805290 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:50:21.806232 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:50:21.807926 [debug] [Thread-6  ]: finished collecting timing info
17:50:21.808373 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:50:21.808585 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
17:50:21.814831 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b28559970>]}
17:50:21.815303 [info ] [Thread-6  ]: 5 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
17:50:21.815681 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
17:50:21.810884 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:50:21.816090 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:50:21.816941 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.817977 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
17:50:21.818087 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:50:21.818159 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
17:50:21.818996 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.820279 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:50:21.820434 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:50:21.820827 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:50:21.822887 [debug] [Thread-8  ]: finished collecting timing info
17:50:21.823013 [debug] [Thread-8  ]: On model.first_project.customers: Close
17:50:21.823520 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b284ceeb0>]}
17:50:21.824144 [info ] [Thread-8  ]: 6 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.05s]
17:50:21.824653 [debug] [Thread-8  ]: Finished running node model.first_project.customers
17:50:21.826095 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:21.826240 [debug] [MainThread]: Using postgres connection "master"
17:50:21.826323 [debug] [MainThread]: On master: BEGIN
17:50:21.826387 [debug] [MainThread]: Opening a new connection, currently in state closed
17:50:21.835121 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:50:21.835343 [debug] [MainThread]: On master: COMMIT
17:50:21.835424 [debug] [MainThread]: Using postgres connection "master"
17:50:21.835496 [debug] [MainThread]: On master: COMMIT
17:50:21.835648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:21.835771 [debug] [MainThread]: On master: Close
17:50:21.836173 [info ] [MainThread]: 
17:50:21.836368 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0.31s.
17:50:21.836490 [debug] [MainThread]: Connection 'master' was properly closed.
17:50:21.836553 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:50:21.836610 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:50:21.836665 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:50:21.836719 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:50:21.836821 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:50:21.836887 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:50:21.840582 [info ] [MainThread]: 
17:50:21.840924 [info ] [MainThread]: [32mCompleted successfully[0m
17:50:21.841142 [info ] [MainThread]: 
17:50:21.841258 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:50:21.841457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be45e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be4ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bde2f70>]}


============================== 2022-06-04 17:53:04.334996 | ecf19713-bc72-4e09-aabe-ed71d31cff6f ==============================
17:53:04.335013 [info ] [MainThread]: Running with dbt=1.1.0
17:53:04.335514 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:53:04.335671 [debug] [MainThread]: Tracking: tracking
17:53:04.338660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff6a4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff6a4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff6a4d60>]}
17:53:04.374980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:53:04.375361 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
17:53:04.391248 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:53:04.408414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff1660d0>]}
17:53:04.412290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff584c40>]}
17:53:04.412592 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:53:04.412774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff58dfa0>]}
17:53:04.414081 [info ] [MainThread]: 
17:53:04.414441 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:04.415291 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:53:04.421980 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:53:04.422128 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:53:04.422208 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:53:04.428878 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:53:04.430545 [debug] [ThreadPool]: On list_erp_oltp: Close
17:53:04.431975 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:53:04.438544 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:53:04.438931 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:53:04.439115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:53:04.443542 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:53:04.444752 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:53:04.445009 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:53:04.446908 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:53:04.447800 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:53:04.448071 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:53:04.477758 [debug] [MainThread]: Using postgres connection "master"
17:53:04.477968 [debug] [MainThread]: On master: BEGIN
17:53:04.478072 [debug] [MainThread]: Opening a new connection, currently in state init
17:53:04.482060 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:53:04.482194 [debug] [MainThread]: Using postgres connection "master"
17:53:04.482256 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:53:04.492610 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:53:04.493913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff15dcd0>]}
17:53:04.494196 [debug] [MainThread]: On master: ROLLBACK
17:53:04.494851 [debug] [MainThread]: Using postgres connection "master"
17:53:04.494962 [debug] [MainThread]: On master: BEGIN
17:53:04.495298 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:53:04.495402 [debug] [MainThread]: On master: COMMIT
17:53:04.495478 [debug] [MainThread]: Using postgres connection "master"
17:53:04.495542 [debug] [MainThread]: On master: COMMIT
17:53:04.495731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:04.495848 [debug] [MainThread]: On master: Close
17:53:04.496223 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:53:04.496408 [info ] [MainThread]: 
17:53:04.500044 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:53:04.500258 [info ] [Thread-1  ]: 1 of 6 START table model public.customer2 ...................................... [RUN]
17:53:04.500568 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:53:04.500675 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:53:04.500766 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:53:04.502494 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:53:04.502666 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:53:04.502826 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:53:04.503244 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:53:04.503458 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:53:04.503545 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:53:04.504985 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:53:04.505206 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:53:04.505551 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:53:04.506074 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.505659 [debug] [Thread-2  ]: finished collecting timing info
17:53:04.505373 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:53:04.506528 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:53:04.506314 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:53:04.506181 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:53:04.519532 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:53:04.526570 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:53:04.506796 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:53:04.526836 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:53:04.526930 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:53:04.527610 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:53:04.506949 [debug] [Thread-1  ]: finished collecting timing info
17:53:04.527918 [debug] [Thread-4  ]: finished collecting timing info
17:53:04.534295 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:53:04.528119 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:53:04.547734 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:53:04.548028 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.546011 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:53:04.528244 [debug] [Thread-3  ]: finished collecting timing info
17:53:04.533772 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:53:04.548224 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:53:04.548457 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:53:04.548717 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.550859 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:53:04.551501 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.551629 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:53:04.551248 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:53:04.551836 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:53:04.549001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:53:04.551698 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:53:04.551100 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.553947 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:53:04.554083 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:53:04.558003 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:53:04.558321 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.558472 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:53:04.561006 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
17:53:04.566797 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.566953 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:53:04.567278 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:53:04.570418 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:53:04.570868 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.570662 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.571001 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:53:04.571743 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:53:04.571216 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:53:04.571851 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.572020 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
17:53:04.571124 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.574035 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.574154 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:53:04.574717 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:04.576168 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.576261 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:53:04.576718 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.576863 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.577065 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
17:53:04.582496 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
17:53:04.584252 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:53:04.586412 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.588261 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.589856 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.590081 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.590205 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:53:04.590387 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:53:04.590528 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:53:04.591091 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.592196 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.592284 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:53:04.592416 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.590649 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:53:04.593547 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.594926 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:53:04.593701 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.593627 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.595816 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:53:04.596649 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:53:04.597121 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.596954 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.597293 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:53:04.597191 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:53:04.596777 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.597029 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.597949 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:53:04.598088 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.602089 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.601101 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.602340 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:53:04.602209 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:53:04.601203 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.600955 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.603270 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.603467 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:53:04.603608 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:53:04.604232 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:53:04.605607 [debug] [Thread-2  ]: finished collecting timing info
17:53:04.605737 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.605875 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:53:04.608469 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff59e910>]}
17:53:04.606043 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:04.609642 [debug] [Thread-3  ]: finished collecting timing info
17:53:04.608743 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
17:53:04.610056 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:53:04.609746 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:53:04.606979 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.605961 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:53:04.610404 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
17:53:04.611624 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:53:04.611844 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff0b4c10>]}
17:53:04.612664 [info ] [Thread-6  ]: 5 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:53:04.613197 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:53:04.613338 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
17:53:04.613453 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
17:53:04.615367 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:53:04.612500 [debug] [Thread-1  ]: finished collecting timing info
17:53:04.619022 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:53:04.619688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2fc052d90>]}
17:53:04.619897 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.12s]
17:53:04.619246 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
17:53:04.621643 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:53:04.621391 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:53:04.619360 [debug] [Thread-6  ]: finished collecting timing info
17:53:04.621861 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
17:53:04.623177 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:53:04.623384 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
17:53:04.624343 [debug] [Thread-4  ]: finished collecting timing info
17:53:04.630504 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:53:04.630904 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:04.631047 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
17:53:04.631126 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:53:04.631726 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2dc7f8220>]}
17:53:04.632031 [info ] [Thread-4  ]: 4 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
17:53:04.633081 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:53:04.633511 [debug] [Thread-8  ]: Began running node model.first_project.customers
17:53:04.633680 [info ] [Thread-8  ]: 6 of 6 START view model public.customers ....................................... [RUN]
17:53:04.633966 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
17:53:04.634080 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
17:53:04.634188 [debug] [Thread-8  ]: Compiling model.first_project.customers
17:53:04.636001 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
17:53:04.636387 [debug] [Thread-8  ]: finished collecting timing info
17:53:04.636610 [debug] [Thread-8  ]: Began executing node model.first_project.customers
17:53:04.638273 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
17:53:04.638580 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:53:04.638682 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
17:53:04.638748 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:53:04.644606 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:53:04.644761 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:53:04.644872 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:53:04.648385 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:04.650728 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:53:04.650880 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:53:04.651410 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.651599 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
17:53:04.653453 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
17:53:04.653856 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:04.654002 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:53:04.654117 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:53:04.654235 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
17:53:04.655667 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:04.657228 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:04.657322 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:53:04.657688 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.658511 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:53:04.658598 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:04.658659 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:53:04.658856 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.659921 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:53:04.660022 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:53:04.660124 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.661186 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:04.661289 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:53:04.661369 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:04.662120 [debug] [Thread-8  ]: finished collecting timing info
17:53:04.662251 [debug] [Thread-8  ]: On model.first_project.customers: Close
17:53:04.662348 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:04.663189 [debug] [Thread-6  ]: finished collecting timing info
17:53:04.663304 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
17:53:04.663624 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2dc7f3910>]}
17:53:04.664721 [info ] [Thread-6  ]: 5 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
17:53:04.665034 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2dc7e1520>]}
17:53:04.666356 [info ] [Thread-8  ]: 6 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.03s]
17:53:04.666582 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
17:53:04.666826 [debug] [Thread-8  ]: Finished running node model.first_project.customers
17:53:04.667985 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:04.668098 [debug] [MainThread]: Using postgres connection "master"
17:53:04.668164 [debug] [MainThread]: On master: BEGIN
17:53:04.668223 [debug] [MainThread]: Opening a new connection, currently in state closed
17:53:04.673547 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:53:04.673726 [debug] [MainThread]: On master: COMMIT
17:53:04.673832 [debug] [MainThread]: Using postgres connection "master"
17:53:04.673897 [debug] [MainThread]: On master: COMMIT
17:53:04.674757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:04.674905 [debug] [MainThread]: On master: Close
17:53:04.675262 [info ] [MainThread]: 
17:53:04.675528 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0.26s.
17:53:04.675657 [debug] [MainThread]: Connection 'master' was properly closed.
17:53:04.675715 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:53:04.675768 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:53:04.675820 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:53:04.675872 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:53:04.675922 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:53:04.675996 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:53:04.680706 [info ] [MainThread]: 
17:53:04.681143 [info ] [MainThread]: [32mCompleted successfully[0m
17:53:04.681490 [info ] [MainThread]: 
17:53:04.681750 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:53:04.682008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff615ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff301885070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff300eb3730>]}


============================== 2022-06-04 17:55:34.357270 | 2eee8b5b-ffd1-4fe3-b22e-f8ea68116662 ==============================
17:55:34.357284 [info ] [MainThread]: Running with dbt=1.1.0
17:55:34.357647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:55:34.357751 [debug] [MainThread]: Tracking: tracking
17:55:34.360232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08802be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08802b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08802b220>]}
17:55:34.380074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
17:55:34.380454 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:55:34.380630 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customer2.sql
17:55:34.392689 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:55:34.404586 [debug] [MainThread]: 1699: static parser successfully parsed erp/customer2.sql
17:55:34.433631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa087f4b1f0>]}
17:55:34.464148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa087f20970>]}
17:55:34.464416 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:55:34.464596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08a20f2e0>]}
17:55:34.465613 [info ] [MainThread]: 
17:55:34.465911 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:34.466643 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:55:34.479765 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:55:34.479952 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:55:34.480034 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:55:34.491703 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:55:34.492861 [debug] [ThreadPool]: On list_erp_oltp: Close
17:55:34.505168 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:55:34.509503 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:55:34.509702 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:55:34.509783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:55:34.514214 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:55:34.514469 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:55:34.514630 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:55:34.517009 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:55:34.518108 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:55:34.519101 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:55:34.522029 [debug] [MainThread]: Using postgres connection "master"
17:55:34.522173 [debug] [MainThread]: On master: BEGIN
17:55:34.522247 [debug] [MainThread]: Opening a new connection, currently in state init
17:55:34.527974 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:34.528160 [debug] [MainThread]: Using postgres connection "master"
17:55:34.528239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:55:34.539789 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:55:34.540927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08a20f580>]}
17:55:34.541197 [debug] [MainThread]: On master: ROLLBACK
17:55:34.541437 [debug] [MainThread]: Using postgres connection "master"
17:55:34.541535 [debug] [MainThread]: On master: BEGIN
17:55:34.541753 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:55:34.541849 [debug] [MainThread]: On master: COMMIT
17:55:34.541920 [debug] [MainThread]: Using postgres connection "master"
17:55:34.541984 [debug] [MainThread]: On master: COMMIT
17:55:34.542149 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:34.542259 [debug] [MainThread]: On master: Close
17:55:34.542656 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:55:34.542885 [info ] [MainThread]: 
17:55:34.546005 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:55:34.546225 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:55:34.546525 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:55:34.546620 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:55:34.546701 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:55:34.548546 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:55:34.548977 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:55:34.551469 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:55:34.551938 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.552039 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:55:34.552122 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:55:34.554223 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:55:34.554362 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:55:34.554629 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:55:34.554902 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:55:34.554987 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:55:34.555083 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:55:34.555935 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:55:34.556182 [debug] [Thread-3  ]: finished collecting timing info
17:55:34.556300 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:55:34.554449 [debug] [Thread-1  ]: finished collecting timing info
17:55:34.565428 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:55:34.565197 [debug] [Thread-2  ]: finished collecting timing info
17:55:34.595844 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:55:34.595568 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:55:34.589755 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:55:34.597553 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:55:34.598274 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.598630 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.598775 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:55:34.599025 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:55:34.599499 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:55:34.599364 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.599682 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:55:34.600688 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:55:34.600960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:55:34.607564 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:55:34.607783 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.607869 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
17:55:34.608467 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:55:34.608594 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.608703 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:55:34.608921 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:55:34.614114 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.614308 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:55:34.615650 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.619349 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.619520 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
17:55:34.619639 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:55:34.621322 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.621657 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:55:34.621482 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.619797 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:55:34.621805 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:55:34.622305 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.627556 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:55:34.627752 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:55:34.627925 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:55:34.631257 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.629826 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.631478 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:55:34.628027 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.631694 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:55:34.632010 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:55:34.632871 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.635093 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.635206 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:55:34.635514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.639123 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:55:34.639461 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.639280 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.639580 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:55:34.635310 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:55:34.640372 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:55:34.645038 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.645187 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:55:34.644012 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:55:34.646221 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.646316 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:55:34.643856 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.646424 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:55:34.649928 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:34.650982 [debug] [Thread-3  ]: finished collecting timing info
17:55:34.651200 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:55:34.652685 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.652838 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:55:34.651376 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:55:34.652976 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:55:34.654029 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa087a7ef10>]}
17:55:34.654180 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:34.655616 [debug] [Thread-1  ]: finished collecting timing info
17:55:34.656426 [debug] [Thread-2  ]: finished collecting timing info
17:55:34.656976 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:55:34.656828 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:55:34.657343 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa084209a30>]}
17:55:34.657578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa087a80730>]}
17:55:34.658686 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
17:55:34.661075 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:55:34.656648 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.10s]
17:55:34.660646 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
17:55:34.661495 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:55:34.663318 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:55:34.665022 [debug] [Thread-5  ]: Began running node model.first_project.customer2
17:55:34.665252 [info ] [Thread-5  ]: 4 of 6 START table model public.customer2 ...................................... [RUN]
17:55:34.665578 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customer2"
17:55:34.665665 [debug] [Thread-5  ]: Began compiling node model.first_project.customer2
17:55:34.665744 [debug] [Thread-5  ]: Compiling model.first_project.customer2
17:55:34.667534 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customer2"
17:55:34.667804 [debug] [Thread-5  ]: finished collecting timing info
17:55:34.667955 [debug] [Thread-5  ]: Began executing node model.first_project.customer2
17:55:34.670452 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customer2"
17:55:34.670573 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:55:34.670972 [info ] [Thread-6  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:55:34.671231 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
17:55:34.671313 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
17:55:34.671455 [debug] [Thread-6  ]: Compiling model.first_project.customers
17:55:34.670769 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:55:34.673726 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:55:34.674007 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:55:34.674092 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:55:34.674187 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:55:34.675464 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:55:34.673499 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
17:55:34.676154 [debug] [Thread-6  ]: finished collecting timing info
17:55:34.675952 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.676275 [debug] [Thread-6  ]: Began executing node model.first_project.customers
17:55:34.675772 [debug] [Thread-8  ]: finished collecting timing info
17:55:34.679950 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:55:34.679726 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
17:55:34.682942 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:55:34.682086 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:55:34.683093 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
17:55:34.683371 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:55:34.676391 [debug] [Thread-5  ]: On model.first_project.customer2: BEGIN
17:55:34.683779 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:34.684717 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:55:34.684865 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:55:34.685615 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:55:34.690523 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:55:34.690713 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:55:34.690820 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:55:34.692703 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:55:34.694331 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:34.694441 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:55:34.696200 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:55:34.696382 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.696457 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:55:34.697541 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.01 seconds
17:55:34.701003 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:55:34.701164 [debug] [Thread-5  ]: SQL status: SELECT 100 in 0.0 seconds
17:55:34.701274 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
17:55:34.702936 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.704842 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:55:34.704328 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:34.701443 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:55:34.705091 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:55:34.705617 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.706521 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:55:34.706703 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.706869 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:34.707715 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:55:34.707857 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:55:34.707956 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.709664 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.709776 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:55:34.709897 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:55:34.708070 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:55:34.711356 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:34.711494 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:55:34.711643 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:55:34.711938 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:34.712747 [debug] [Thread-8  ]: finished collecting timing info
17:55:34.712919 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:55:34.713200 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.713035 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:55:34.713512 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0841eb460>]}
17:55:34.715855 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
17:55:34.717840 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.717612 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
17:55:34.717934 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
17:55:34.717096 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:55:34.718232 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:55:34.718421 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:55:34.719027 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:34.719813 [debug] [Thread-6  ]: finished collecting timing info
17:55:34.719923 [debug] [Thread-6  ]: On model.first_project.customers: Close
17:55:34.720211 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0841fbd60>]}
17:55:34.720462 [info ] [Thread-6  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.05s]
17:55:34.720716 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:55:34.721726 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.722088 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:55:34.724987 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:55:34.725351 [debug] [Thread-5  ]: SQL status: DROP TABLE in 0.0 seconds
17:55:34.726095 [debug] [Thread-5  ]: finished collecting timing info
17:55:34.726243 [debug] [Thread-5  ]: On model.first_project.customer2: Close
17:55:34.726545 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa088041580>]}
17:55:34.726763 [info ] [Thread-5  ]: 4 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.06s]
17:55:34.727465 [debug] [Thread-5  ]: Finished running node model.first_project.customer2
17:55:34.728552 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:34.728671 [debug] [MainThread]: Using postgres connection "master"
17:55:34.728740 [debug] [MainThread]: On master: BEGIN
17:55:34.728803 [debug] [MainThread]: Opening a new connection, currently in state closed
17:55:34.736422 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:34.736645 [debug] [MainThread]: On master: COMMIT
17:55:34.736725 [debug] [MainThread]: Using postgres connection "master"
17:55:34.736824 [debug] [MainThread]: On master: COMMIT
17:55:34.736988 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:34.737094 [debug] [MainThread]: On master: Close
17:55:34.737476 [info ] [MainThread]: 
17:55:34.737717 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.27s.
17:55:34.737862 [debug] [MainThread]: Connection 'master' was properly closed.
17:55:34.737925 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:55:34.737981 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:55:34.738035 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:55:34.738087 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:55:34.738141 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:55:34.738195 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:55:34.741339 [info ] [MainThread]: 
17:55:34.741546 [info ] [MainThread]: [32mCompleted successfully[0m
17:55:34.741740 [info ] [MainThread]: 
17:55:34.741877 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:55:34.742071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa087a74850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08984f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08a20f5b0>]}


============================== 2022-06-04 17:59:42.087681 | ad7e604d-3079-4b41-8d29-b74801c57fed ==============================
17:59:42.087694 [info ] [MainThread]: Running with dbt=1.1.0
17:59:42.090616 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:59:42.090711 [debug] [MainThread]: Tracking: tracking
17:59:42.103407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabd41fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabd41fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabd41d60>]}
17:59:42.134551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:59:42.135057 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:59:42.143881 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:59:42.206842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ead54c6d0>]}
17:59:42.210302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabd364c0>]}
17:59:42.210605 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:59:42.210759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabd36250>]}
17:59:42.211754 [info ] [MainThread]: 
17:59:42.212099 [debug] [MainThread]: Acquiring new postgres connection "master"
17:59:42.213099 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:59:42.220346 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:59:42.220480 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:59:42.220546 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:59:42.228458 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:59:42.229654 [debug] [ThreadPool]: On list_erp_oltp: Close
17:59:42.230637 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:59:42.235220 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:59:42.235461 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:59:42.235591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:59:42.247244 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:59:42.247500 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:59:42.247572 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:59:42.249403 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:59:42.250433 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:59:42.250650 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:59:42.253881 [debug] [MainThread]: Using postgres connection "master"
17:59:42.254081 [debug] [MainThread]: On master: BEGIN
17:59:42.254158 [debug] [MainThread]: Opening a new connection, currently in state init
17:59:42.259040 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:59:42.259347 [debug] [MainThread]: Using postgres connection "master"
17:59:42.259430 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:59:42.268970 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:59:42.270228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabc2beb0>]}
17:59:42.270487 [debug] [MainThread]: On master: ROLLBACK
17:59:42.270956 [debug] [MainThread]: Using postgres connection "master"
17:59:42.271084 [debug] [MainThread]: On master: BEGIN
17:59:42.271387 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:59:42.271500 [debug] [MainThread]: On master: COMMIT
17:59:42.271570 [debug] [MainThread]: Using postgres connection "master"
17:59:42.271631 [debug] [MainThread]: On master: COMMIT
17:59:42.271752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:59:42.271843 [debug] [MainThread]: On master: Close
17:59:42.272173 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:59:42.272375 [info ] [MainThread]: 
17:59:42.277738 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:59:42.278025 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:59:42.278349 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:59:42.278463 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:59:42.278546 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:59:42.280049 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:59:42.280346 [debug] [Thread-1  ]: finished collecting timing info
17:59:42.280499 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:59:42.286812 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:59:42.286965 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:59:42.292615 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:59:42.305242 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.304820 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:59:42.305331 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:59:42.305766 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:59:42.305590 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:59:42.307271 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:59:42.303823 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:59:42.307483 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:59:42.307798 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:59:42.309929 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:59:42.310430 [debug] [Thread-3  ]: finished collecting timing info
17:59:42.310616 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.310770 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:59:42.310924 [debug] [Thread-2  ]: finished collecting timing info
17:59:42.321920 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:59:42.311032 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:59:42.326051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:59:42.324937 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:59:42.326551 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.326653 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:59:42.326717 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:59:42.325871 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:59:42.327512 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.327606 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:59:42.327670 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:59:42.336013 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:59:42.336224 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.336301 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:59:42.336447 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:59:42.336568 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.336636 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:59:42.341679 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
17:59:42.342109 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:59:42.351384 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.351578 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:59:42.351923 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:59:42.355141 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.355243 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
17:59:42.355392 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.352176 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.357371 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:59:42.356882 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.357249 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:42.357552 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:59:42.359404 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.359919 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:59:42.359650 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.360212 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.362640 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.369367 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:59:42.367623 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:59:42.363368 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.370562 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.372044 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.372459 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:59:42.372244 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:59:42.372910 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.373862 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:59:42.374115 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.373966 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:59:42.372136 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.374238 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:59:42.377851 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.382515 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:59:42.381988 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:59:42.383100 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.383265 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:59:42.384850 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:59:42.389885 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.390102 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
17:59:42.394924 [debug] [Thread-2  ]: finished collecting timing info
17:59:42.393877 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:59:42.395063 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:59:42.395538 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea8713f70>]}
17:59:42.395795 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
17:59:42.396055 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:59:42.396893 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:42.392933 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:59:42.397625 [debug] [Thread-3  ]: finished collecting timing info
17:59:42.398603 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.398790 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:59:42.398982 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:59:42.400418 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eab775d00>]}
17:59:42.400539 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:59:42.400861 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.09s]
17:59:42.401615 [debug] [Thread-1  ]: finished collecting timing info
17:59:42.401884 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:59:42.402116 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:59:42.403117 [debug] [Thread-5  ]: Began running node model.first_project.customer2
17:59:42.403282 [info ] [Thread-5  ]: 4 of 6 START table model public.customer2 ...................................... [RUN]
17:59:42.403557 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customer2"
17:59:42.403790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eab780d90>]}
17:59:42.403908 [debug] [Thread-5  ]: Began compiling node model.first_project.customer2
17:59:42.404338 [debug] [Thread-5  ]: Compiling model.first_project.customer2
17:59:42.404234 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
17:59:42.404003 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:59:42.409646 [info ] [Thread-6  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:59:42.409955 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
17:59:42.410032 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
17:59:42.410101 [debug] [Thread-6  ]: Compiling model.first_project.customers
17:59:42.409232 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:59:42.411501 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
17:59:42.412317 [debug] [Thread-6  ]: finished collecting timing info
17:59:42.411945 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:59:42.412620 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:59:42.412933 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:59:42.413095 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:59:42.413239 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:59:42.414957 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:59:42.415194 [debug] [Thread-8  ]: finished collecting timing info
17:59:42.415299 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:59:42.416735 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:59:42.412430 [debug] [Thread-6  ]: Began executing node model.first_project.customers
17:59:42.418413 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
17:59:42.408806 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customer2"
17:59:42.418598 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:42.418775 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:59:42.418841 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:59:42.419111 [debug] [Thread-5  ]: finished collecting timing info
17:59:42.419257 [debug] [Thread-5  ]: Began executing node model.first_project.customer2
17:59:42.420679 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customer2"
17:59:42.420925 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:59:42.421063 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
17:59:42.421133 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:59:42.421576 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.421669 [debug] [Thread-5  ]: On model.first_project.customer2: BEGIN
17:59:42.421732 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:59:42.430274 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:59:42.430560 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:59:42.430671 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:59:42.432132 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:42.433719 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:59:42.433808 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:59:42.434950 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.435794 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:59:42.435893 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:59:42.435961 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:59:42.436223 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
17:59:42.436332 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:42.437344 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:59:42.437477 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:59:42.438889 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:59:42.439015 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:42.439225 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:59:42.440720 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:42.441012 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:59:42.441225 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:42.442905 [debug] [Thread-6  ]: finished collecting timing info
17:59:42.443322 [debug] [Thread-6  ]: On model.first_project.customers: Close
17:59:42.444878 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea86fda90>]}
17:59:42.446866 [info ] [Thread-6  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.03s]
17:59:42.447386 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:59:42.453106 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.01 seconds
17:59:42.454685 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:59:42.454846 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:42.454961 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:59:42.456237 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:59:42.457412 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:42.457527 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:59:42.457789 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:42.458914 [debug] [Thread-8  ]: finished collecting timing info
17:59:42.459115 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:59:42.460875 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabc49670>]}
17:59:42.461165 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
17:59:42.461430 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:59:42.461947 [debug] [Thread-5  ]: SQL status: BEGIN in 0.04 seconds
17:59:42.462050 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.462118 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:59:42.465101 [debug] [Thread-5  ]: SQL status: SELECT 100 in 0.0 seconds
17:59:42.466746 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.466870 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:59:42.468436 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.470530 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.470690 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:59:42.471166 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.472312 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
17:59:42.472409 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.472473 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
17:59:42.474834 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:59:42.476221 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.476367 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:59:42.478441 [debug] [Thread-5  ]: SQL status: DROP TABLE in 0.0 seconds
17:59:42.479443 [debug] [Thread-5  ]: finished collecting timing info
17:59:42.479570 [debug] [Thread-5  ]: On model.first_project.customer2: Close
17:59:42.479992 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabc3d040>]}
17:59:42.480224 [info ] [Thread-5  ]: 4 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.08s]
17:59:42.480519 [debug] [Thread-5  ]: Finished running node model.first_project.customer2
17:59:42.481616 [debug] [MainThread]: Acquiring new postgres connection "master"
17:59:42.481742 [debug] [MainThread]: Using postgres connection "master"
17:59:42.481814 [debug] [MainThread]: On master: BEGIN
17:59:42.481870 [debug] [MainThread]: Opening a new connection, currently in state closed
17:59:42.486757 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:59:42.486935 [debug] [MainThread]: On master: COMMIT
17:59:42.487007 [debug] [MainThread]: Using postgres connection "master"
17:59:42.487067 [debug] [MainThread]: On master: COMMIT
17:59:42.487182 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:59:42.487273 [debug] [MainThread]: On master: Close
17:59:42.487581 [info ] [MainThread]: 
17:59:42.487744 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.28s.
17:59:42.487905 [debug] [MainThread]: Connection 'master' was properly closed.
17:59:42.488031 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:59:42.488147 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:59:42.488247 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:59:42.488384 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:59:42.488496 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:59:42.488648 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:59:42.495824 [info ] [MainThread]: 
17:59:42.496113 [info ] [MainThread]: [32mCompleted successfully[0m
17:59:42.496330 [info ] [MainThread]: 
17:59:42.496480 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:59:42.496712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabc22e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eadb308b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea869cb20>]}


============================== 2022-06-04 18:00:09.422935 | 008a8d17-1d3b-4c16-837a-faf3f06508a9 ==============================
18:00:09.422952 [info ] [MainThread]: Running with dbt=1.1.0
18:00:09.423425 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:00:09.423523 [debug] [MainThread]: Tracking: tracking
18:00:09.426512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe015637fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe015637fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe015637d60>]}
18:00:09.451648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:00:09.451823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:00:09.457599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '008a8d17-1d3b-4c16-837a-faf3f06508a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0154d80d0>]}
18:00:09.461775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '008a8d17-1d3b-4c16-837a-faf3f06508a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0155a33d0>]}
18:00:09.462015 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:00:09.462188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '008a8d17-1d3b-4c16-837a-faf3f06508a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0155a3670>]}
18:00:09.463477 [info ] [MainThread]: 
18:00:09.463982 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:09.465141 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:00:09.471617 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:09.471737 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:00:09.471814 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:00:09.479477 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:00:09.479719 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:09.479798 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:00:09.481944 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:00:09.483352 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:00:09.483645 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:00:09.487653 [debug] [MainThread]: Using postgres connection "master"
18:00:09.487840 [debug] [MainThread]: On master: BEGIN
18:00:09.487913 [debug] [MainThread]: Opening a new connection, currently in state init
18:00:09.493219 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:00:09.493418 [debug] [MainThread]: Using postgres connection "master"
18:00:09.493502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:00:09.504929 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:00:09.506042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '008a8d17-1d3b-4c16-837a-faf3f06508a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe015521fd0>]}
18:00:09.506310 [debug] [MainThread]: On master: ROLLBACK
18:00:09.506551 [debug] [MainThread]: Using postgres connection "master"
18:00:09.506663 [debug] [MainThread]: On master: BEGIN
18:00:09.507183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:09.507398 [debug] [MainThread]: On master: COMMIT
18:00:09.507476 [debug] [MainThread]: Using postgres connection "master"
18:00:09.507548 [debug] [MainThread]: On master: COMMIT
18:00:09.507852 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:09.507982 [debug] [MainThread]: On master: Close
18:00:09.508319 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:00:09.508499 [info ] [MainThread]: 
18:00:09.514794 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:09.515003 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [RUN]
18:00:09.515368 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:09.515485 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:09.515569 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:09.525259 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:09.525468 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:09.529593 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:00:09.529889 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:09.529207 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:00:09.530276 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:09.530356 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:09.530427 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:09.529982 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:09.537007 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:09.525586 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:09.568524 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:00:09.529461 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:09.569078 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:00:09.536903 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:09.569761 [debug] [Thread-2  ]: finished collecting timing info
18:00:09.568257 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:09.568862 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:09.570427 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:09.569335 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:09.570673 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:09.570756 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:09.529063 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:09.570258 [debug] [Thread-3  ]: finished collecting timing info
18:00:09.570549 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:09.529316 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:09.569924 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:09.529394 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:09.593092 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:00:09.593442 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:09.580391 [debug] [Thread-1  ]: finished collecting timing info
18:00:09.580229 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:09.582640 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:00:09.592877 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:09.593539 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:09.595622 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:09.593677 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:09.602438 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:09.595320 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:09.602658 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:09.602766 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:09.595028 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:09.582491 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:09.604777 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:09.579905 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:09.605871 [debug] [Thread-7  ]: finished collecting timing info
18:00:09.604939 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:09.606275 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: BEGIN
18:00:09.606357 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:00:09.605689 [debug] [Thread-5  ]: finished collecting timing info
18:00:09.606569 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:09.605595 [debug] [Thread-4  ]: finished collecting timing info
18:00:09.606151 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:09.605205 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:09.611863 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:00:09.610276 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:09.612308 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:09.610552 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:09.611712 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:09.614404 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:09.614526 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:00:09.612451 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:00:09.611954 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:00:09.606027 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:09.615203 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:00:09.615294 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:00:09.613562 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:09.615846 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:09.615933 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:00:09.615997 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:00:09.614669 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:00:09.597899 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:09.618301 [debug] [Thread-6  ]: finished collecting timing info
18:00:09.617107 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:00:09.618584 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:09.618469 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:09.619833 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:09.618672 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT'
)



      
    ) dbt_internal_test
18:00:09.614598 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:00:09.620782 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:09.620912 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:00:09.620977 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:00:09.623613 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:09.625544 [debug] [Thread-1  ]: finished collecting timing info
18:00:09.625727 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: ROLLBACK
18:00:09.626687 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: Close
18:00:09.627100 [error] [Thread-1  ]: 1 of 7 FAIL 3 accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [[31mFAIL 3[0m in 0.11s]
18:00:09.627571 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:09.631570 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:00:09.631751 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:09.631831 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:00:09.632002 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:00:09.632153 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:09.632226 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:00:09.633535 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:09.634630 [debug] [Thread-2  ]: finished collecting timing info
18:00:09.634772 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:00:09.634899 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:00:09.634998 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:09.635066 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:00:09.635352 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:00:09.635441 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:09.635501 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:00:09.635654 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:09.636463 [debug] [Thread-3  ]: finished collecting timing info
18:00:09.636567 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:00:09.636707 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:00:09.636898 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:09.638144 [debug] [Thread-4  ]: finished collecting timing info
18:00:09.638526 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:00:09.637107 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:00:09.637266 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:09.639411 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.11s]
18:00:09.639882 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:09.637186 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:00:09.640275 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.11s]
18:00:09.640676 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:09.641175 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
18:00:09.642143 [debug] [Thread-5  ]: finished collecting timing info
18:00:09.642258 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:00:09.642740 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:00:09.643117 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.05s]
18:00:09.643411 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:09.639577 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:00:09.643923 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:00:09.644232 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
18:00:09.644464 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:09.646893 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:00:09.647139 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:09.647225 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:00:09.648001 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:09.649033 [debug] [Thread-6  ]: finished collecting timing info
18:00:09.649160 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:00:09.649508 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.01 seconds
18:00:09.650298 [debug] [Thread-7  ]: finished collecting timing info
18:00:09.650398 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:00:09.650490 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:00:09.651751 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
18:00:09.651960 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:00:09.652322 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
18:00:09.652724 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:09.653434 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:09.655883 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:09.656028 [debug] [MainThread]: Using postgres connection "master"
18:00:09.656121 [debug] [MainThread]: On master: BEGIN
18:00:09.656186 [debug] [MainThread]: Opening a new connection, currently in state closed
18:00:09.661087 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:09.661293 [debug] [MainThread]: On master: COMMIT
18:00:09.661364 [debug] [MainThread]: Using postgres connection "master"
18:00:09.661429 [debug] [MainThread]: On master: COMMIT
18:00:09.661565 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:09.661672 [debug] [MainThread]: On master: Close
18:00:09.661961 [info ] [MainThread]: 
18:00:09.662268 [info ] [MainThread]: Finished running 7 tests in 0.20s.
18:00:09.662415 [debug] [MainThread]: Connection 'master' was properly closed.
18:00:09.662476 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09' was properly closed.
18:00:09.662540 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:00:09.662593 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:00:09.662645 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:00:09.662696 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:00:09.662747 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:00:09.667210 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:00:09.675687 [info ] [MainThread]: 
18:00:09.676009 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:00:09.676193 [info ] [MainThread]: 
18:00:09.676340 [error] [MainThread]: [31mFailure in test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT (models/erp/schema.yml)[0m
18:00:09.676495 [error] [MainThread]:   Got 3 results, configured to fail if != 0
18:00:09.676629 [info ] [MainThread]: 
18:00:09.676765 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/accepted_values_customers_78814b7ce7fca4528a65518db3449206.sql
18:00:09.676951 [info ] [MainThread]: 
18:00:09.677085 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:00:09.677202 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:00:09.677352 [info ] [MainThread]: 
18:00:09.677481 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:00:09.677613 [info ] [MainThread]: 
18:00:09.677743 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:00:09.677870 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:00:09.678019 [info ] [MainThread]: 
18:00:09.678137 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:00:09.678361 [info ] [MainThread]: 
18:00:09.678485 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
18:00:09.678727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0155a3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0154b57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0154b5a60>]}


============================== 2022-06-04 18:08:12.406389 | 15e37265-1cd0-4b8b-bd5f-acd93f59bdf4 ==============================
18:08:12.406403 [info ] [MainThread]: Running with dbt=1.1.0
18:08:12.406864 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:08:12.406973 [debug] [MainThread]: Tracking: tracking
18:08:12.410343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a76df550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a76df730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a76df430>]}
18:08:12.431520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:08:12.432370 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:08:12.442246 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:08:12.510179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15e37265-1cd0-4b8b-bd5f-acd93f59bdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a8f5edf0>]}
18:08:12.513968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15e37265-1cd0-4b8b-bd5f-acd93f59bdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a75ddf40>]}
18:08:12.514176 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:08:12.514342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15e37265-1cd0-4b8b-bd5f-acd93f59bdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a75dde80>]}
18:08:12.515225 [info ] [MainThread]: 
18:08:12.515513 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:12.516355 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:08:12.525216 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:12.525487 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:08:12.525584 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:08:12.531558 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:08:12.531772 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:12.531853 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:08:12.534944 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:08:12.536070 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:08:12.536361 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:08:12.539094 [debug] [MainThread]: Using postgres connection "master"
18:08:12.539245 [debug] [MainThread]: On master: BEGIN
18:08:12.539343 [debug] [MainThread]: Opening a new connection, currently in state init
18:08:12.545144 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:12.545406 [debug] [MainThread]: Using postgres connection "master"
18:08:12.545550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:08:12.558456 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:08:12.559716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15e37265-1cd0-4b8b-bd5f-acd93f59bdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a75ddd30>]}
18:08:12.559983 [debug] [MainThread]: On master: ROLLBACK
18:08:12.560354 [debug] [MainThread]: Using postgres connection "master"
18:08:12.560506 [debug] [MainThread]: On master: BEGIN
18:08:12.561143 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:08:12.561406 [debug] [MainThread]: On master: COMMIT
18:08:12.561500 [debug] [MainThread]: Using postgres connection "master"
18:08:12.561577 [debug] [MainThread]: On master: COMMIT
18:08:12.561987 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:12.562141 [debug] [MainThread]: On master: Close
18:08:12.562490 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:08:12.562678 [info ] [MainThread]: 
18:08:12.567220 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:12.567398 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:08:12.567751 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:12.567867 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:12.567949 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:12.573359 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:12.573513 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:12.573676 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:08:12.573861 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:12.573972 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:08:12.574102 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:12.574170 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:08:12.574396 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:12.575568 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:12.574839 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:12.575761 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:08:12.575982 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:12.576058 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:12.576123 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:12.575662 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:12.585982 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:12.574997 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:12.586240 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:08:12.580241 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:12.575482 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:12.586721 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:12.574678 [debug] [Thread-1  ]: finished collecting timing info
18:08:12.574927 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:12.586515 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:12.575250 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:12.587582 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:12.587000 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:12.587149 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:08:12.597847 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:12.597999 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:12.598081 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:12.600325 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:12.597394 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:12.587463 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:12.586830 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:12.603364 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:12.587692 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:12.606846 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:12.600661 [debug] [Thread-6  ]: finished collecting timing info
18:08:12.600961 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:12.587370 [debug] [Thread-5  ]: finished collecting timing info
18:08:12.609795 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:12.607096 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:12.607248 [debug] [Thread-3  ]: finished collecting timing info
18:08:12.611212 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:12.612188 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:12.609614 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:12.610805 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:12.600772 [debug] [Thread-2  ]: finished collecting timing info
18:08:12.610962 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: BEGIN
18:08:12.613629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:12.607374 [debug] [Thread-4  ]: finished collecting timing info
18:08:12.616379 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:12.612782 [debug] [Thread-7  ]: finished collecting timing info
18:08:12.613241 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:12.613477 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:12.607518 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:12.618483 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:12.613058 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:12.618684 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:12.620054 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:12.620288 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:08:12.621351 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:12.623370 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:12.623506 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:08:12.623579 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:08:12.622735 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:12.623036 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:12.624358 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:08:12.622527 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:12.624588 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:12.621653 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:08:12.624847 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:08:12.624714 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:08:12.625050 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:08:12.620423 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:08:12.625237 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:08:12.625633 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:12.625718 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:08:12.625773 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:08:12.623831 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:08:12.626436 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:08:12.628667 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.630461 [debug] [Thread-1  ]: finished collecting timing info
18:08:12.630671 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: ROLLBACK
18:08:12.630845 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: Close
18:08:12.630966 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:08:12.631111 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:12.631207 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:12.631481 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.06s]
18:08:12.631827 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:12.632937 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.634186 [debug] [Thread-6  ]: finished collecting timing info
18:08:12.634365 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:08:12.639882 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:08:12.640550 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
18:08:12.641315 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:12.648109 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:08:12.648380 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:08:12.648525 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:12.649266 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:08:12.648701 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:08:12.649123 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:12.649601 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:12.649432 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:12.648922 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:08:12.649734 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:08:12.649839 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:12.649988 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:12.650500 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.651406 [debug] [Thread-4  ]: finished collecting timing info
18:08:12.651661 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:08:12.651892 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:08:12.651975 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:12.652035 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:12.651772 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.652949 [debug] [Thread-5  ]: finished collecting timing info
18:08:12.653070 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:08:12.653248 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.653915 [debug] [Thread-2  ]: finished collecting timing info
18:08:12.654030 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:08:12.654123 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.655541 [debug] [Thread-7  ]: finished collecting timing info
18:08:12.654712 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.656332 [debug] [Thread-3  ]: finished collecting timing info
18:08:12.655652 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:08:12.654199 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:08:12.656432 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:08:12.656499 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:08:12.657168 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.08s]
18:08:12.656873 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
18:08:12.657421 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:12.657829 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:08:12.657660 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:12.654841 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:08:12.658391 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.08s]
18:08:12.658586 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:12.658111 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
18:08:12.658838 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:12.661245 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:08:12.661969 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
18:08:12.662309 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:12.664103 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:12.664257 [debug] [MainThread]: Using postgres connection "master"
18:08:12.664334 [debug] [MainThread]: On master: BEGIN
18:08:12.664392 [debug] [MainThread]: Opening a new connection, currently in state closed
18:08:12.669595 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:12.669854 [debug] [MainThread]: On master: COMMIT
18:08:12.669934 [debug] [MainThread]: Using postgres connection "master"
18:08:12.670005 [debug] [MainThread]: On master: COMMIT
18:08:12.670176 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:12.670305 [debug] [MainThread]: On master: Close
18:08:12.670684 [info ] [MainThread]: 
18:08:12.670848 [info ] [MainThread]: Finished running 7 tests in 0.16s.
18:08:12.670963 [debug] [MainThread]: Connection 'master' was properly closed.
18:08:12.671021 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
18:08:12.671077 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:08:12.671133 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:08:12.671187 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:08:12.671242 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:08:12.671294 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:08:12.671396 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:08:12.675066 [info ] [MainThread]: 
18:08:12.675470 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:08:12.675650 [info ] [MainThread]: 
18:08:12.675786 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:08:12.675932 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:08:12.676059 [info ] [MainThread]: 
18:08:12.676233 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:08:12.676378 [info ] [MainThread]: 
18:08:12.676505 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:08:12.676639 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:08:12.676762 [info ] [MainThread]: 
18:08:12.677000 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:08:12.677216 [info ] [MainThread]: 
18:08:12.677533 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
18:08:12.677889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a8f77250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a8f5e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a40d0040>]}


============================== 2022-06-04 18:14:29.969158 | 282e22a7-ebbd-4002-84ec-30e599a767a3 ==============================
18:14:29.969171 [info ] [MainThread]: Running with dbt=1.1.0
18:14:29.969598 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:14:29.969712 [debug] [MainThread]: Tracking: tracking
18:14:29.972167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308a051e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308a051340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308a051220>]}
18:14:29.996606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
18:14:29.996930 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_orders.sql
18:14:29.997135 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:14:30.006593 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:14:30.016398 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:14:30.045109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3089fd0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3089b01580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3089b01250>]}


============================== 2022-06-04 18:15:29.891829 | 22e85c0f-158d-4622-9240-cf888899fb5c ==============================
18:15:29.891842 [info ] [MainThread]: Running with dbt=1.1.0
18:15:29.892239 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:15:29.892333 [debug] [MainThread]: Tracking: tracking
18:15:29.895028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2cf8eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2cf8e280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2cf8e940>]}
18:15:29.923872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
18:15:29.924312 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_orders.sql
18:15:29.924552 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:15:29.931703 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:15:29.942063 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:15:29.968702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2ce91c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2ca3e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2ca3e250>]}


============================== 2022-06-04 18:15:55.796960 | ca111683-aa89-4120-ae31-772b3289a1b8 ==============================
18:15:55.796975 [info ] [MainThread]: Running with dbt=1.1.0
18:15:55.797363 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:15:55.797454 [debug] [MainThread]: Tracking: tracking
18:15:55.801486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e91a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e91ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e91ae20>]}
18:15:55.825610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
18:15:55.825984 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_orders.sql
18:15:55.826202 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:15:55.835717 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:15:55.845076 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:15:55.906105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2013a850>]}
18:15:55.909924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e819ee0>]}
18:15:55.910181 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:15:55.910355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e819df0>]}
18:15:55.911328 [info ] [MainThread]: 
18:15:55.911821 [debug] [MainThread]: Acquiring new postgres connection "master"
18:15:55.912693 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:15:55.920574 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:15:55.920768 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:15:55.920848 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:15:55.927680 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:15:55.928706 [debug] [ThreadPool]: On list_erp_oltp: Close
18:15:55.930011 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:15:55.934728 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:15:55.934896 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:15:55.934982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:15:55.940239 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:15:55.940694 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:15:55.940792 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:15:55.942405 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:15:55.943447 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:15:55.943702 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:15:55.946889 [debug] [MainThread]: Using postgres connection "master"
18:15:55.947016 [debug] [MainThread]: On master: BEGIN
18:15:55.947082 [debug] [MainThread]: Opening a new connection, currently in state init
18:15:55.951445 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:15:55.951736 [debug] [MainThread]: Using postgres connection "master"
18:15:55.951905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:15:55.962368 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:15:55.963534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e819b80>]}
18:15:55.963808 [debug] [MainThread]: On master: ROLLBACK
18:15:55.964037 [debug] [MainThread]: Using postgres connection "master"
18:15:55.964140 [debug] [MainThread]: On master: BEGIN
18:15:55.964318 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:15:55.964412 [debug] [MainThread]: On master: COMMIT
18:15:55.964480 [debug] [MainThread]: Using postgres connection "master"
18:15:55.964580 [debug] [MainThread]: On master: COMMIT
18:15:55.965243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:15:55.965370 [debug] [MainThread]: On master: Close
18:15:55.965760 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:15:55.966149 [info ] [MainThread]: 
18:15:55.970339 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:15:55.970580 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
18:15:55.970891 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:15:55.970983 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:15:55.971065 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:15:55.972517 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:15:55.972966 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:15:55.973186 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:15:55.973697 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
18:15:55.973473 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
18:15:55.974583 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:15:55.974663 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:15:55.974164 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:15:55.974833 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:15:55.974735 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:15:55.974935 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:15:55.973315 [debug] [Thread-1  ]: finished collecting timing info
18:15:55.977750 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:15:55.977575 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:15:55.976512 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:15:55.993991 [debug] [Thread-2  ]: finished collecting timing info
18:15:55.994172 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:15:56.007423 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:15:56.009033 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:15:56.010231 [debug] [Thread-3  ]: finished collecting timing info
18:15:56.011028 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:15:56.015146 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:15:56.015715 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.015884 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:15:56.015958 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:15:56.016739 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.016906 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:15:56.016991 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:15:56.017337 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.017452 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:15:56.017515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:15:56.020687 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
18:15:56.020863 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.020963 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
18:15:56.022957 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:15:56.027808 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.027937 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:15:56.028289 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:15:56.028382 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.028443 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
18:15:56.029249 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.031123 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.031386 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:15:56.031535 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:15:56.034977 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.034742 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.035075 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:15:56.031670 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:15:56.035178 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:15:56.035679 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.035782 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.037037 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.041215 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:15:56.041353 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:15:56.041447 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:15:56.042875 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.043056 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:15:56.041571 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.043212 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:15:56.043449 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.045248 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:15:56.045353 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.045504 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.046900 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.045683 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:15:56.045584 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:15:56.047020 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:15:56.050793 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.051059 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:15:56.052343 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.052596 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:15:56.052496 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.051259 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:15:56.056252 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:15:56.056394 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:15:56.057133 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.058008 [debug] [Thread-3  ]: finished collecting timing info
18:15:56.058384 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:15:56.058244 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:15:56.058746 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e37adf0>]}
18:15:56.058919 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:15:56.060469 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.08s]
18:15:56.062002 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:15:56.061620 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.058115 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:15:56.062249 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:15:56.062444 [debug] [Thread-5  ]: Began running node model.first_project.customer2
18:15:56.065691 [info ] [Thread-5  ]: 4 of 6 START table model public.customer2 ...................................... [RUN]
18:15:56.066028 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customer2"
18:15:56.066130 [debug] [Thread-5  ]: Began compiling node model.first_project.customer2
18:15:56.066214 [debug] [Thread-5  ]: Compiling model.first_project.customer2
18:15:56.062530 [debug] [Thread-6  ]: Began running node model.first_project.customers
18:15:56.068214 [info ] [Thread-6  ]: 5 of 6 START view model public.customers ....................................... [RUN]
18:15:56.067973 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customer2"
18:15:56.065314 [debug] [Thread-2  ]: finished collecting timing info
18:15:56.068501 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
18:15:56.068940 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
18:15:56.069024 [debug] [Thread-6  ]: Compiling model.first_project.customers
18:15:56.070627 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
18:15:56.068701 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:15:56.071720 [debug] [Thread-1  ]: finished collecting timing info
18:15:56.070775 [debug] [Thread-5  ]: finished collecting timing info
18:15:56.070990 [debug] [Thread-6  ]: finished collecting timing info
18:15:56.072124 [debug] [Thread-6  ]: Began executing node model.first_project.customers
18:15:56.073853 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
18:15:56.074113 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:15:56.074229 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
18:15:56.074294 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:15:56.068851 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:15:56.071973 [debug] [Thread-5  ]: Began executing node model.first_project.customer2
18:15:56.071836 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:15:56.076729 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customer2"
18:15:56.077409 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.077538 [debug] [Thread-5  ]: On model.first_project.customer2: BEGIN
18:15:56.077604 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:15:56.077038 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1c2ccf40>]}
18:15:56.078435 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
18:15:56.078756 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:15:56.079039 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc233aeee0>]}
18:15:56.079374 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
18:15:56.079638 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:15:56.079909 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:15:56.080061 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
18:15:56.080309 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:15:56.080390 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:15:56.080463 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:15:56.082237 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:15:56.082545 [debug] [Thread-8  ]: finished collecting timing info
18:15:56.082727 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:15:56.091235 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:15:56.091632 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:56.091798 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:15:56.091883 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:15:56.092416 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:15:56.092530 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:15:56.092591 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select * from "erp_oltp"."public"."stg_orders"
),


customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:15:56.093108 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:15:56.093287 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.093409 [debug] [Thread-6  ]: Postgres adapter: Postgres error: relation "public.stg_orders" does not exist
LINE 9:   select * from "erp_oltp"."public"."stg_orders"
                        ^

18:15:56.093515 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:15:56.093632 [debug] [Thread-6  ]: On model.first_project.customers: ROLLBACK
18:15:56.094044 [debug] [Thread-6  ]: finished collecting timing info
18:15:56.094170 [debug] [Thread-6  ]: On model.first_project.customers: Close
18:15:56.094422 [debug] [Thread-6  ]: Database Error in model customers (models/erp/customers.sql)
  relation "public.stg_orders" does not exist
  LINE 9:   select * from "erp_oltp"."public"."stg_orders"
                          ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
18:15:56.094596 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e3782b0>]}
18:15:56.094846 [error] [Thread-6  ]: 5 of 6 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.03s]
18:15:56.095108 [debug] [Thread-6  ]: Finished running node model.first_project.customers
18:15:56.097107 [debug] [Thread-5  ]: SQL status: SELECT 100 in 0.0 seconds
18:15:56.099427 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.099701 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
18:15:56.102359 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:15:56.102580 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.102750 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:56.105576 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.105766 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:15:56.105953 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
18:15:56.106421 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.107515 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
18:15:56.107614 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.107680 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
18:15:56.107763 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:15:56.109540 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:56.109643 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:15:56.109735 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
18:15:56.110672 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.110813 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.113832 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:15:56.113942 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:56.114053 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:15:56.112807 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
18:15:56.121724 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
18:15:56.123390 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:56.123500 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:15:56.123841 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:15:56.124891 [debug] [Thread-8  ]: finished collecting timing info
18:15:56.125350 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:15:56.125927 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2019ffd0>]}
18:15:56.127382 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:15:56.127661 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:15:56.127866 [debug] [Thread-5  ]: SQL status: DROP TABLE in 0.01 seconds
18:15:56.128813 [debug] [Thread-5  ]: finished collecting timing info
18:15:56.129016 [debug] [Thread-5  ]: On model.first_project.customer2: Close
18:15:56.129335 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e3683d0>]}
18:15:56.129545 [info ] [Thread-5  ]: 4 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.06s]
18:15:56.129843 [debug] [Thread-5  ]: Finished running node model.first_project.customer2
18:15:56.133816 [debug] [MainThread]: Acquiring new postgres connection "master"
18:15:56.134091 [debug] [MainThread]: Using postgres connection "master"
18:15:56.134175 [debug] [MainThread]: On master: BEGIN
18:15:56.134244 [debug] [MainThread]: Opening a new connection, currently in state closed
18:15:56.138566 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:15:56.138759 [debug] [MainThread]: On master: COMMIT
18:15:56.138868 [debug] [MainThread]: Using postgres connection "master"
18:15:56.138936 [debug] [MainThread]: On master: COMMIT
18:15:56.139110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:15:56.139265 [debug] [MainThread]: On master: Close
18:15:56.139617 [info ] [MainThread]: 
18:15:56.139851 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.23s.
18:15:56.140000 [debug] [MainThread]: Connection 'master' was properly closed.
18:15:56.140071 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:15:56.140133 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:15:56.140191 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:15:56.140248 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
18:15:56.140307 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:15:56.140365 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:15:56.145220 [info ] [MainThread]: 
18:15:56.145579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:15:56.145759 [info ] [MainThread]: 
18:15:56.145893 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
18:15:56.146022 [error] [MainThread]:   relation "public.stg_orders" does not exist
18:15:56.146141 [error] [MainThread]:   LINE 9:   select * from "erp_oltp"."public"."stg_orders"
18:15:56.146257 [error] [MainThread]:                           ^
18:15:56.146398 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
18:15:56.146527 [info ] [MainThread]: 
18:15:56.146653 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
18:15:56.146854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc20a937c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc20a93790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e3c0880>]}


============================== 2022-06-04 18:16:37.942797 | d46728d9-0e07-4e30-b12e-a12460cafa8d ==============================
18:16:37.942811 [info ] [MainThread]: Running with dbt=1.1.0
18:16:37.943309 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:16:37.943406 [debug] [MainThread]: Tracking: tracking
18:16:37.945821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2ee070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2ee040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2ee2b0>]}
18:16:37.967182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
18:16:37.967555 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:16:37.967742 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_orders.sql
18:16:37.977101 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:16:37.987682 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:16:38.042935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e19e3a0>]}
18:16:38.047376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f0460>]}
18:16:38.047689 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:16:38.047950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f0a00>]}
18:16:38.049054 [info ] [MainThread]: 
18:16:38.049390 [debug] [MainThread]: Acquiring new postgres connection "master"
18:16:38.050379 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:16:38.057202 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:16:38.057338 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:16:38.057422 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:16:38.065501 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:16:38.066551 [debug] [ThreadPool]: On list_erp_oltp: Close
18:16:38.067651 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:16:38.071346 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:16:38.071479 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:16:38.071545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:16:38.076141 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:16:38.076287 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:16:38.076355 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:16:38.078016 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
18:16:38.078908 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:16:38.079118 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:16:38.084556 [debug] [MainThread]: Using postgres connection "master"
18:16:38.084753 [debug] [MainThread]: On master: BEGIN
18:16:38.084865 [debug] [MainThread]: Opening a new connection, currently in state init
18:16:38.088743 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:16:38.088966 [debug] [MainThread]: Using postgres connection "master"
18:16:38.089037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:16:38.107256 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
18:16:38.108938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f0df0>]}
18:16:38.109308 [debug] [MainThread]: On master: ROLLBACK
18:16:38.109689 [debug] [MainThread]: Using postgres connection "master"
18:16:38.109892 [debug] [MainThread]: On master: BEGIN
18:16:38.110229 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:16:38.110395 [debug] [MainThread]: On master: COMMIT
18:16:38.110538 [debug] [MainThread]: Using postgres connection "master"
18:16:38.110672 [debug] [MainThread]: On master: COMMIT
18:16:38.110929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:16:38.111103 [debug] [MainThread]: On master: Close
18:16:38.111559 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:16:38.111904 [info ] [MainThread]: 
18:16:38.122437 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:16:38.125338 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:16:38.125489 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:16:38.125855 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:16:38.125620 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:16:38.125557 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:16:38.126163 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:16:38.127332 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:16:38.127423 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:16:38.127515 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:16:38.126942 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:16:38.128349 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:16:38.128909 [debug] [Thread-4  ]: finished collecting timing info
18:16:38.129006 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:16:38.128645 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:16:38.126679 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.139756 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:16:38.139504 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:16:38.126480 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:16:38.148535 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:16:38.139873 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:16:38.148159 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:16:38.147047 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:16:38.148666 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:16:38.150573 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:16:38.151467 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:16:38.153060 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:16:38.153565 [debug] [Thread-3  ]: finished collecting timing info
18:16:38.153707 [debug] [Thread-2  ]: finished collecting timing info
18:16:38.155195 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:16:38.154945 [debug] [Thread-1  ]: finished collecting timing info
18:16:38.156652 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:16:38.156518 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:16:38.154814 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:38.155074 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:16:38.170214 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:16:38.170671 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.172761 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:16:38.173010 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:16:38.172418 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:16:38.173301 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.173999 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:16:38.174091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:16:38.175003 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.175249 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:16:38.175680 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:16:38.170812 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:16:38.177242 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:16:38.182406 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:16:38.182649 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.182736 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:16:38.182991 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:16:38.183186 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.183275 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
18:16:38.184766 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:38.184972 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:16:38.193447 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.193621 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:16:38.194087 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.195436 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.195563 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:16:38.196138 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.196213 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
18:16:38.195666 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:16:38.196011 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:16:38.196333 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:38.196523 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
18:16:38.195876 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.196640 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:16:38.196761 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.198061 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:38.206065 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:38.206199 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:16:38.206301 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
18:16:38.210236 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.208600 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:16:38.210338 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:16:38.208407 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:16:38.210427 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.212633 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:16:38.211902 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.212767 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:38.213718 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:16:38.213249 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.216439 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.216576 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:16:38.217163 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.216695 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.221897 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:38.217914 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:16:38.222120 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.222209 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:16:38.222010 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:16:38.211734 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.213435 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:16:38.222387 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:16:38.222659 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:16:38.224801 [debug] [Thread-4  ]: finished collecting timing info
18:16:38.224948 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.225037 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.226982 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.225933 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:16:38.227184 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.227084 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:16:38.225119 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.227264 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:16:38.225215 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:16:38.229888 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f1730>]}
18:16:38.230296 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.10s]
18:16:38.229991 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.229289 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:16:38.229145 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.233062 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:16:38.232112 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:16:38.232903 [debug] [Thread-1  ]: finished collecting timing info
18:16:38.233924 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:16:38.231795 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.234776 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:16:38.235877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2dd4a220>]}
18:16:38.236201 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:16:38.236475 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
18:16:38.236646 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:16:38.238359 [debug] [Thread-2  ]: finished collecting timing info
18:16:38.237737 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:16:38.238472 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:16:38.237419 [debug] [Thread-3  ]: finished collecting timing info
18:16:38.239236 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:16:38.239473 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f1a60>]}
18:16:38.239687 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
18:16:38.238811 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
18:16:38.243964 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:16:38.239116 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f1850>]}
18:16:38.244243 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
18:16:38.244497 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:16:38.244733 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:16:38.245055 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
18:16:38.245136 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
18:16:38.246509 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:16:38.246790 [debug] [Thread-6  ]: finished collecting timing info
18:16:38.246921 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
18:16:38.248361 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:16:38.248596 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:38.248715 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
18:16:38.244915 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:16:38.249124 [debug] [Thread-8  ]: Began running node model.first_project.customer2
18:16:38.249286 [info ] [Thread-8  ]: 6 of 7 START table model public.customer2 ...................................... [RUN]
18:16:38.249531 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customer2"
18:16:38.249653 [debug] [Thread-8  ]: Began compiling node model.first_project.customer2
18:16:38.249736 [debug] [Thread-8  ]: Compiling model.first_project.customer2
18:16:38.251240 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customer2"
18:16:38.251446 [debug] [Thread-8  ]: finished collecting timing info
18:16:38.251575 [debug] [Thread-8  ]: Began executing node model.first_project.customer2
18:16:38.253924 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customer2"
18:16:38.254065 [debug] [Thread-9  ]: Began running node model.first_project.customers
18:16:38.254357 [info ] [Thread-9  ]: 7 of 7 START view model public.customers ....................................... [RUN]
18:16:38.254614 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
18:16:38.254731 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
18:16:38.254872 [debug] [Thread-9  ]: Compiling model.first_project.customers
18:16:38.248783 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:16:38.257270 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
18:16:38.257842 [debug] [Thread-9  ]: finished collecting timing info
18:16:38.257972 [debug] [Thread-9  ]: Began executing node model.first_project.customers
18:16:38.259562 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers"
18:16:38.259818 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:16:38.259913 [debug] [Thread-9  ]: On model.first_project.customers: BEGIN
18:16:38.259974 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:16:38.261098 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.261223 [debug] [Thread-8  ]: On model.first_project.customer2: BEGIN
18:16:38.261296 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:16:38.266689 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:16:38.267022 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
18:16:38.267204 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:38.267439 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:16:38.267760 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:16:38.267583 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:16:38.269648 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:38.271977 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:38.272133 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:38.272425 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:16:38.274366 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:16:38.274960 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:16:38.275173 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:16:38.275353 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.275655 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:16:38.275466 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.276423 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:16:38.276524 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:38.276591 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:16:38.276695 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.277692 [debug] [Thread-9  ]: On model.first_project.customers: COMMIT
18:16:38.277785 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:16:38.277849 [debug] [Thread-9  ]: On model.first_project.customers: COMMIT
18:16:38.278278 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
18:16:38.281997 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.282321 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.282503 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:16:38.285830 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:38.285984 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:16:38.282594 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
18:16:38.283702 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:16:38.286370 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:16:38.286753 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.288041 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.288142 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
18:16:38.286504 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:16:38.288225 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
18:16:38.289173 [debug] [Thread-6  ]: finished collecting timing info
18:16:38.290308 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
18:16:38.290062 [debug] [Thread-9  ]: finished collecting timing info
18:16:38.289337 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.292662 [debug] [Thread-8  ]: On model.first_project.customer2: COMMIT
18:16:38.291732 [debug] [Thread-9  ]: On model.first_project.customers: Close
18:16:38.290764 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2c4ecee0>]}
18:16:38.293361 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:16:38.292764 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.293705 [debug] [Thread-8  ]: On model.first_project.customer2: COMMIT
18:16:38.294994 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2e41f0>]}
18:16:38.295215 [info ] [Thread-9  ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
18:16:38.295598 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
18:16:38.295938 [debug] [Thread-9  ]: Finished running node model.first_project.customers
18:16:38.296225 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.297494 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.297636 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
18:16:38.299333 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
18:16:38.300070 [debug] [Thread-8  ]: finished collecting timing info
18:16:38.300228 [debug] [Thread-8  ]: On model.first_project.customer2: Close
18:16:38.300601 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2dd909a0>]}
18:16:38.300851 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.05s]
18:16:38.301139 [debug] [Thread-8  ]: Finished running node model.first_project.customer2
18:16:38.302450 [debug] [MainThread]: Acquiring new postgres connection "master"
18:16:38.302562 [debug] [MainThread]: Using postgres connection "master"
18:16:38.302625 [debug] [MainThread]: On master: BEGIN
18:16:38.302680 [debug] [MainThread]: Opening a new connection, currently in state closed
18:16:38.308691 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:16:38.309080 [debug] [MainThread]: On master: COMMIT
18:16:38.309260 [debug] [MainThread]: Using postgres connection "master"
18:16:38.309389 [debug] [MainThread]: On master: COMMIT
18:16:38.309563 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:16:38.309660 [debug] [MainThread]: On master: Close
18:16:38.310009 [info ] [MainThread]: 
18:16:38.310164 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.26s.
18:16:38.310277 [debug] [MainThread]: Connection 'master' was properly closed.
18:16:38.310336 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:16:38.310392 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:16:38.310504 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:16:38.310560 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:16:38.310610 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:16:38.310661 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
18:16:38.310712 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:16:38.314982 [info ] [MainThread]: 
18:16:38.315261 [info ] [MainThread]: [32mCompleted successfully[0m
18:16:38.316774 [info ] [MainThread]: 
18:16:38.316963 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:16:38.317154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2e23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2fb0a5b0>]}


============================== 2022-06-04 18:20:00.444659 | 213ce5bd-25dd-462f-80e1-8ca18948a3a7 ==============================
18:20:00.444680 [info ] [MainThread]: Running with dbt=1.1.0
18:20:00.445183 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:20:00.445285 [debug] [MainThread]: Tracking: tracking
18:20:00.447520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1c4d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1c4dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1c4d6d0>]}
18:20:00.468521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:20:00.469034 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:20:00.479571 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:20:00.537377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '213ce5bd-25dd-462f-80e1-8ca18948a3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac346a790>]}
18:20:00.540573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '213ce5bd-25dd-462f-80e1-8ca18948a3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1b92160>]}
18:20:00.540851 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:20:00.541044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213ce5bd-25dd-462f-80e1-8ca18948a3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1b92040>]}
18:20:00.542100 [info ] [MainThread]: 
18:20:00.542426 [debug] [MainThread]: Acquiring new postgres connection "master"
18:20:00.543241 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:20:00.550049 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:20:00.550156 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:20:00.550224 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:20:00.556694 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:20:00.556958 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:20:00.557057 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:20:00.559485 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:20:00.561067 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:20:00.561504 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:20:00.565219 [debug] [MainThread]: Using postgres connection "master"
18:20:00.565378 [debug] [MainThread]: On master: BEGIN
18:20:00.565450 [debug] [MainThread]: Opening a new connection, currently in state init
18:20:00.570195 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:20:00.570348 [debug] [MainThread]: Using postgres connection "master"
18:20:00.570416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:20:00.582410 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:20:00.583924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213ce5bd-25dd-462f-80e1-8ca18948a3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1b489d0>]}
18:20:00.584217 [debug] [MainThread]: On master: ROLLBACK
18:20:00.584634 [debug] [MainThread]: Using postgres connection "master"
18:20:00.584801 [debug] [MainThread]: On master: BEGIN
18:20:00.585036 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:20:00.585133 [debug] [MainThread]: On master: COMMIT
18:20:00.585225 [debug] [MainThread]: Using postgres connection "master"
18:20:00.585313 [debug] [MainThread]: On master: COMMIT
18:20:00.585449 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:20:00.585541 [debug] [MainThread]: On master: Close
18:20:00.585820 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:20:00.585987 [info ] [MainThread]: 
18:20:00.591079 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:00.591505 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:20:00.592273 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:00.592419 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:00.592524 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:00.598362 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:00.598544 [debug] [Thread-3  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:20:00.601719 [info ] [Thread-3  ]: 3 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_customers_  [RUN]
18:20:00.602013 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:20:00.602105 [debug] [Thread-3  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:20:00.601571 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:20:00.602181 [debug] [Thread-3  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:20:00.598654 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:00.598722 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:00.605668 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
18:20:00.602455 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:00.605379 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:20:00.605546 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
18:20:00.605920 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:00.606499 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:00.606036 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:00.606711 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:00.606584 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:00.601407 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:00.606396 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:00.606810 [debug] [Thread-3  ]: finished collecting timing info
18:20:00.609190 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:00.616261 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:00.616620 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:00.616879 [debug] [Thread-3  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:20:00.617134 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:00.628578 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:20:00.634024 [debug] [Thread-3  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:20:00.631125 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:00.634295 [debug] [Thread-4  ]: finished collecting timing info
18:20:00.634453 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:00.628805 [debug] [Thread-5  ]: finished collecting timing info
18:20:00.635689 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:00.635521 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:00.637048 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:00.637150 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:20:00.636682 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:00.637489 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:00.637224 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:20:00.633740 [debug] [Thread-1  ]: finished collecting timing info
18:20:00.638162 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:00.637607 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:20:00.639298 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:20:00.634118 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: BEGIN
18:20:00.639503 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:20:00.633488 [debug] [Thread-2  ]: finished collecting timing info
18:20:00.639688 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:00.639152 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:00.640936 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:00.641070 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:20:00.641134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:20:00.640618 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:00.641498 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:00.641608 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:20:00.641670 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:20:00.645345 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:20:00.645556 [debug] [Thread-3  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:20:00.645633 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "erp_oltp"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "erp_oltp"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
18:20:00.647732 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:00.649298 [debug] [Thread-3  ]: finished collecting timing info
18:20:00.649447 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: ROLLBACK
18:20:00.650306 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:20:00.650449 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:00.650520 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:20:00.651302 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:00.652493 [debug] [Thread-4  ]: finished collecting timing info
18:20:00.652717 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:20:00.653133 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:20:00.653619 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.05s]
18:20:00.654244 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: Close
18:20:00.654609 [info ] [Thread-3  ]: 3 of 5 PASS relationships_stg_orders_customer_id__customer_id__ref_customers_ .. [[32mPASS[0m in 0.05s]
18:20:00.655129 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:00.655430 [debug] [Thread-3  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:20:00.657178 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:20:00.657344 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:00.657457 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:20:00.659138 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:00.660709 [debug] [Thread-5  ]: finished collecting timing info
18:20:00.660905 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:20:00.661714 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:20:00.661882 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:00.661987 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:20:00.662070 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:20:00.663276 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
18:20:00.663584 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:00.671443 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:20:00.675474 [debug] [Thread-1  ]: finished collecting timing info
18:20:00.675786 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:20:00.676205 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
18:20:00.676306 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:00.676374 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:20:00.676912 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:20:00.677267 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.09s]
18:20:00.677524 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:00.679160 [debug] [Thread-2  ]: finished collecting timing info
18:20:00.679489 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:00.679690 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:20:00.680567 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:20:00.680967 [info ] [Thread-2  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
18:20:00.681227 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:00.685221 [debug] [MainThread]: Acquiring new postgres connection "master"
18:20:00.685380 [debug] [MainThread]: Using postgres connection "master"
18:20:00.685483 [debug] [MainThread]: On master: BEGIN
18:20:00.685552 [debug] [MainThread]: Opening a new connection, currently in state closed
18:20:00.694475 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:20:00.694689 [debug] [MainThread]: On master: COMMIT
18:20:00.694767 [debug] [MainThread]: Using postgres connection "master"
18:20:00.694840 [debug] [MainThread]: On master: COMMIT
18:20:00.695744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:20:00.695915 [debug] [MainThread]: On master: Close
18:20:00.696247 [info ] [MainThread]: 
18:20:00.696434 [info ] [MainThread]: Finished running 5 tests in 0.15s.
18:20:00.696556 [debug] [MainThread]: Connection 'master' was properly closed.
18:20:00.696616 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:20:00.696674 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
18:20:00.696729 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:20:00.696785 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:20:00.696878 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:20:00.700183 [info ] [MainThread]: 
18:20:00.700466 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:20:00.700702 [info ] [MainThread]: 
18:20:00.700957 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:20:00.701158 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:20:00.701296 [info ] [MainThread]: 
18:20:00.701405 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:20:00.701521 [info ] [MainThread]: 
18:20:00.701624 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
18:20:00.701798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1b6f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac3af75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac0644d00>]}


============================== 2022-06-04 18:23:26.509193 | 3ae8ecfe-a6de-446f-886f-65009533dbd7 ==============================
18:23:26.509217 [info ] [MainThread]: Running with dbt=1.1.0
18:23:26.509903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:23:26.510040 [debug] [MainThread]: Tracking: tracking
18:23:26.513699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffde4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffde48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffde4be0>]}
18:23:26.536542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:23:26.537008 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:23:26.544369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffd110d0>]}
18:23:26.550079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffd664c0>]}
18:23:26.550468 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:23:26.550705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffd66520>]}
18:23:26.552552 [info ] [MainThread]: 
18:23:26.554096 [debug] [MainThread]: Acquiring new postgres connection "master"
18:23:26.555667 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:23:26.562301 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:23:26.562467 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:23:26.562546 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:23:26.568930 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:23:26.571627 [debug] [ThreadPool]: On list_erp_oltp: Close
18:23:26.573045 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:23:26.576534 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:23:26.576658 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:23:26.576723 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:23:26.580709 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:23:26.580896 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:23:26.580979 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:23:26.585049 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:23:26.586293 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:23:26.586769 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:23:26.589772 [debug] [MainThread]: Using postgres connection "master"
18:23:26.589885 [debug] [MainThread]: On master: BEGIN
18:23:26.589953 [debug] [MainThread]: Opening a new connection, currently in state init
18:23:26.594112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:23:26.594245 [debug] [MainThread]: Using postgres connection "master"
18:23:26.594310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:23:26.604701 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:23:26.605857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffcddcd0>]}
18:23:26.606155 [debug] [MainThread]: On master: ROLLBACK
18:23:26.606378 [debug] [MainThread]: Using postgres connection "master"
18:23:26.606459 [debug] [MainThread]: On master: BEGIN
18:23:26.606641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:23:26.606722 [debug] [MainThread]: On master: COMMIT
18:23:26.606801 [debug] [MainThread]: Using postgres connection "master"
18:23:26.606859 [debug] [MainThread]: On master: COMMIT
18:23:26.606977 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:23:26.607060 [debug] [MainThread]: On master: Close
18:23:26.607322 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:23:26.607528 [info ] [MainThread]: 
18:23:26.612779 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:23:26.613117 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:23:26.613581 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:23:26.613976 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:23:26.613376 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:23:26.614383 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:23:26.614486 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:23:26.614586 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:23:26.613181 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:23:26.616246 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:23:26.616488 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:23:26.616045 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:23:26.616563 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:23:26.616729 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:23:26.617541 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:23:26.617729 [debug] [Thread-1  ]: finished collecting timing info
18:23:26.617866 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:23:26.614066 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:23:26.651431 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:23:26.652482 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:23:26.613022 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:23:26.658483 [debug] [Thread-4  ]: finished collecting timing info
18:23:26.658852 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:23:26.665093 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.664520 [debug] [Thread-3  ]: finished collecting timing info
18:23:26.664693 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:23:26.665217 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:23:26.663902 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:23:26.681648 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.671123 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:23:26.684232 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:23:26.684507 [debug] [Thread-2  ]: finished collecting timing info
18:23:26.684641 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:23:26.681811 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:23:26.686562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:23:26.665436 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:23:26.686332 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:23:26.682561 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:23:26.689233 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:23:26.689918 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.689589 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.690049 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:23:26.690158 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:23:26.690336 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:23:26.690476 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:23:26.692090 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.692201 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:23:26.692272 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:23:26.692517 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:23:26.692703 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.692825 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:23:26.694045 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:23:26.698527 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.698972 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:23:26.699175 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:23:26.699333 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.699450 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
18:23:26.699785 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.701254 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.701347 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:23:26.701467 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:23:26.705542 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.705692 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:23:26.705889 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.711323 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:23:26.711480 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:23:26.711632 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.715783 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
18:23:26.715510 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.715983 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:23:26.716316 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.717076 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:23:26.717169 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:23:26.719217 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.719319 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:23:26.717533 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.717361 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:23:26.719466 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:23:26.719584 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.719797 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
18:23:26.720097 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.721660 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.721815 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:23:26.723570 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.721981 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.723662 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:23:26.722146 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:23:26.727524 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.727063 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.728763 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.729285 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:23:26.728974 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.729109 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:23:26.730086 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:23:26.730316 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.730381 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:23:26.730173 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.731095 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:23:26.731186 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.731252 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:23:26.713530 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:23:26.731443 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.731535 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:23:26.731804 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:23:26.732742 [debug] [Thread-3  ]: finished collecting timing info
18:23:26.732907 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:23:26.733024 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.733101 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.736272 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.736379 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:23:26.735265 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffc91d90>]}
18:23:26.736702 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
18:23:26.737009 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:23:26.733155 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.738308 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.737357 [debug] [Thread-6  ]: Began running node model.first_project.customer2
18:23:26.738417 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:23:26.734950 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.738598 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
18:23:26.738712 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:23:26.740755 [debug] [Thread-2  ]: finished collecting timing info
18:23:26.739948 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
18:23:26.741016 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
18:23:26.740905 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:23:26.739451 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:23:26.741112 [debug] [Thread-6  ]: Compiling model.first_project.customer2
18:23:26.743068 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
18:23:26.741474 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffc91bb0>]}
18:23:26.743406 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.08s]
18:23:26.741185 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:23:26.743677 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:23:26.743857 [debug] [Thread-6  ]: finished collecting timing info
18:23:26.745048 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
18:23:26.746540 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
18:23:26.746763 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.746895 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
18:23:26.746963 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:23:26.744112 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:23:26.749606 [debug] [Thread-4  ]: finished collecting timing info
18:23:26.749742 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:23:26.750187 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffc91f70>]}
18:23:26.750454 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.13s]
18:23:26.744791 [debug] [Thread-1  ]: finished collecting timing info
18:23:26.752195 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:23:26.752583 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffc919a0>]}
18:23:26.752851 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.14s]
18:23:26.753120 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:23:26.753762 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:23:26.753920 [info ] [Thread-8  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:23:26.754172 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:23:26.754259 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:23:26.754342 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:23:26.751871 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:23:26.756094 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:23:26.756542 [debug] [Thread-10 ]: Began running node model.first_project.customers
18:23:26.756739 [info ] [Thread-10 ]: 7 of 7 START view model public.customers ....................................... [RUN]
18:23:26.756988 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
18:23:26.757131 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
18:23:26.757199 [debug] [Thread-10 ]: Compiling model.first_project.customers
18:23:26.758684 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
18:23:26.758952 [debug] [Thread-10 ]: finished collecting timing info
18:23:26.759099 [debug] [Thread-10 ]: Began executing node model.first_project.customers
18:23:26.760450 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
18:23:26.760669 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:23:26.760748 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
18:23:26.760886 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:23:26.761256 [debug] [Thread-8  ]: finished collecting timing info
18:23:26.761397 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:23:26.765239 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:23:26.765623 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:23:26.765764 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:23:26.765836 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:23:26.766397 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:23:26.766501 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.766567 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:23:26.768529 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:23:26.771210 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.771724 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
18:23:26.771854 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
18:23:26.772064 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:23:26.772139 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:23:26.772354 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.775701 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.777549 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
18:23:26.779482 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.01 seconds
18:23:26.781001 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:23:26.781120 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.781247 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:23:26.782231 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
18:23:26.782466 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.782565 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
18:23:26.782732 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.783790 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:23:26.783906 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.784056 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:23:26.784168 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
18:23:26.787361 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:23:26.787155 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:23:26.787462 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:23:26.786824 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.787732 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
18:23:26.788502 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
18:23:26.789920 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:23:26.790014 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:23:26.790119 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
18:23:26.790925 [debug] [Thread-6  ]: finished collecting timing info
18:23:26.791051 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
18:23:26.791235 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:23:26.793674 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:23:26.792054 [debug] [Thread-10 ]: finished collecting timing info
18:23:26.793917 [debug] [Thread-10 ]: On model.first_project.customers: Close
18:23:26.794303 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22fc3a0df0>]}
18:23:26.794515 [info ] [Thread-10 ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
18:23:26.793786 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:23:26.791392 [debug] [Thread-6  ]: On model.first_project.customer2: Close
18:23:26.794793 [debug] [Thread-10 ]: Finished running node model.first_project.customers
18:23:26.796512 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22fc387f70>]}
18:23:26.796642 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.797790 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:23:26.798249 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:23:26.798370 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:23:26.801021 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.802110 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:23:26.802293 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:23:26.802706 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:23:26.804286 [debug] [Thread-8  ]: finished collecting timing info
18:23:26.804485 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:23:26.809634 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.06s]
18:23:26.810312 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22fc3ade80>]}
18:23:26.810615 [info ] [Thread-8  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
18:23:26.810887 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
18:23:26.811149 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:23:26.812560 [debug] [MainThread]: Acquiring new postgres connection "master"
18:23:26.812696 [debug] [MainThread]: Using postgres connection "master"
18:23:26.812809 [debug] [MainThread]: On master: BEGIN
18:23:26.813064 [debug] [MainThread]: Opening a new connection, currently in state closed
18:23:26.816997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:23:26.817150 [debug] [MainThread]: On master: COMMIT
18:23:26.817224 [debug] [MainThread]: Using postgres connection "master"
18:23:26.817291 [debug] [MainThread]: On master: COMMIT
18:23:26.817471 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:23:26.817606 [debug] [MainThread]: On master: Close
18:23:26.817955 [info ] [MainThread]: 
18:23:26.818173 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.26s.
18:23:26.818339 [debug] [MainThread]: Connection 'master' was properly closed.
18:23:26.818430 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:23:26.818528 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:23:26.818618 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:23:26.818673 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:23:26.818724 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
18:23:26.818776 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:23:26.818845 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:23:26.823556 [info ] [MainThread]: 
18:23:26.824841 [info ] [MainThread]: [32mCompleted successfully[0m
18:23:26.825122 [info ] [MainThread]: 
18:23:26.825278 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:23:26.825521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffd11130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffcddf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffc6a4f0>]}


============================== 2022-06-04 20:29:28.815849 | 676e424b-6bcb-47d8-93d6-f1cbea783341 ==============================
20:29:28.815864 [info ] [MainThread]: Running with dbt=1.1.0
20:29:28.816326 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:29:28.816462 [debug] [MainThread]: Tracking: tracking
20:29:28.819821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563922280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65639227c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563922700>]}
20:29:28.840396 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:29:28.840729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563929880>]}
20:29:28.851877 [debug] [MainThread]: Parsing macros/catalog.sql
20:29:28.855102 [debug] [MainThread]: Parsing macros/relations.sql
20:29:28.856906 [debug] [MainThread]: Parsing macros/adapters.sql
20:29:28.874674 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:29:28.875795 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:29:28.877353 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:29:28.880838 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:29:28.887418 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:29:28.896958 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:29:28.909992 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:29:28.913380 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:29:28.914460 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:29:28.915308 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:29:28.916820 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:29:28.918589 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:29:28.923170 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:29:28.927859 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:29:28.929882 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:29:28.940215 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:29:28.944121 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:29:28.945611 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:29:28.948529 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:29:28.949777 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:29:28.958162 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:29:28.969292 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:29:28.975736 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:29:28.976835 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:29:28.978263 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:29:28.979218 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:29:28.980120 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:29:28.985945 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:29:28.999620 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:29:29.001423 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:29:29.002906 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:29:29.004692 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:29:29.009016 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:29:29.011734 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:29:29.012304 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:29:29.012876 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:29:29.013322 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:29:29.014182 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:29:29.019546 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:29:29.022637 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:29:29.174577 [debug] [MainThread]: 1699: static parser successfully parsed erp/customer2.sql
20:29:29.182693 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
20:29:29.184416 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
20:29:29.186138 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
20:29:29.187628 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
20:29:29.189233 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
20:29:29.190630 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
20:29:29.258339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65633ec070>]}
20:29:29.263067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563922700>]}
20:29:29.263407 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:29:29.263735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65638b5fa0>]}
20:29:29.265358 [info ] [MainThread]: 
20:29:29.265821 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:29.272896 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:29:29.279356 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:29:29.279538 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:29:29.279609 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:29:29.292571 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:29:29.293677 [debug] [ThreadPool]: On list_erp_oltp: Close
20:29:29.294862 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:29:29.299593 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:29:29.299778 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:29:29.299854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:29:29.305593 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:29:29.305766 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:29:29.305873 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:29:29.308014 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:29:29.309930 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:29:29.310281 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:29:29.314037 [debug] [MainThread]: Using postgres connection "master"
20:29:29.314228 [debug] [MainThread]: On master: BEGIN
20:29:29.314297 [debug] [MainThread]: Opening a new connection, currently in state init
20:29:29.318781 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:29.318944 [debug] [MainThread]: Using postgres connection "master"
20:29:29.319030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:29:29.329889 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
20:29:29.331004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65633ec100>]}
20:29:29.331292 [debug] [MainThread]: On master: ROLLBACK
20:29:29.331516 [debug] [MainThread]: Using postgres connection "master"
20:29:29.331611 [debug] [MainThread]: On master: BEGIN
20:29:29.331805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:29.331899 [debug] [MainThread]: On master: COMMIT
20:29:29.331968 [debug] [MainThread]: Using postgres connection "master"
20:29:29.332031 [debug] [MainThread]: On master: COMMIT
20:29:29.332306 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:29.332475 [debug] [MainThread]: On master: Close
20:29:29.332813 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:29:29.333034 [info ] [MainThread]: 
20:29:29.337307 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:29:29.337569 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:29:29.337895 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:29:29.337990 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:29:29.338073 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:29:29.339731 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:29:29.340001 [debug] [Thread-1  ]: finished collecting timing info
20:29:29.340173 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:29:29.345999 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:29:29.346240 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:29:29.346679 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.346779 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:29:29.346855 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:29:29.348439 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:29:29.348642 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:29:29.348837 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:29:29.354973 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
20:29:29.367375 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
20:29:29.368373 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:29:29.368074 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:29:29.367687 [debug] [Thread-2  ]: finished collecting timing info
20:29:29.368947 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:29:29.368462 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:29:29.368830 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:29:29.368682 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:29:29.378042 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:29:29.378193 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:29:29.388016 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:29:29.387282 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:29:29.386057 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:29:29.388423 [debug] [Thread-3  ]: finished collecting timing info
20:29:29.388731 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:29:29.390314 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:29:29.390501 [debug] [Thread-4  ]: finished collecting timing info
20:29:29.390629 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:29:29.391960 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:29:29.392245 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.392335 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:29:29.392398 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:29:29.392819 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.392917 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:29:29.392981 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:29:29.393440 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.393525 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:29:29.393582 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:29:29.394056 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.394158 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:29:29.394215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:29.398936 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
20:29:29.399177 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.399252 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
20:29:29.400313 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:29:29.400448 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.400510 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:29:29.400612 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
20:29:29.400724 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.400840 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:29.400964 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
20:29:29.406380 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.407357 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
20:29:29.407859 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.410296 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.410469 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:29:29.410620 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:29.412566 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.414929 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:29:29.414520 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.415081 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
20:29:29.414794 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
20:29:29.415219 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.415293 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
20:29:29.415412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.416704 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.416995 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:29:29.417338 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.416841 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.425013 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.425171 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
20:29:29.417085 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:29.425437 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:29.427137 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.427265 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:29.427435 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.410852 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
20:29:29.429037 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:29:29.429602 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.429730 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:29:29.426970 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.429259 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:29:29.429925 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
20:29:29.430126 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.436052 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:29:29.435131 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
20:29:29.436211 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.437651 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:29:29.436359 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.434749 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.439298 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.439678 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
20:29:29.437403 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.439465 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
20:29:29.440859 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.439845 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
20:29:29.439563 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
20:29:29.440964 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.441065 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
20:29:29.442656 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:29:29.442892 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.442983 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:29:29.443079 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:29:29.446039 [debug] [Thread-1  ]: finished collecting timing info
20:29:29.446197 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:29.446319 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
20:29:29.448563 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.447281 [debug] [Thread-4  ]: finished collecting timing info
20:29:29.448784 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:29:29.448664 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
20:29:29.446411 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
20:29:29.449689 [debug] [Thread-3  ]: finished collecting timing info
20:29:29.449829 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:29:29.450640 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65633cfdf0>]}
20:29:29.450931 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.08s]
20:29:29.451365 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:29:29.446532 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:29:29.452085 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65633e1df0>]}
20:29:29.452381 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.08s]
20:29:29.452638 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:29:29.453260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65602fbbb0>]}
20:29:29.453398 [debug] [Thread-6  ]: Began running node model.first_project.customer2
20:29:29.455090 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
20:29:29.455382 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
20:29:29.454794 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
20:29:29.455476 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
20:29:29.456557 [debug] [Thread-6  ]: Compiling model.first_project.customer2
20:29:29.453503 [debug] [Thread-7  ]: Began running node model.first_project.customers
20:29:29.458478 [info ] [Thread-7  ]: 6 of 7 START view model public.customers ....................................... [RUN]
20:29:29.458756 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
20:29:29.458285 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
20:29:29.458846 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
20:29:29.459037 [debug] [Thread-7  ]: Compiling model.first_project.customers
20:29:29.460744 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
20:29:29.456385 [debug] [Thread-2  ]: finished collecting timing info
20:29:29.461396 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:29:29.461152 [debug] [Thread-6  ]: finished collecting timing info
20:29:29.461271 [debug] [Thread-7  ]: finished collecting timing info
20:29:29.463280 [debug] [Thread-7  ]: Began executing node model.first_project.customers
20:29:29.461580 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
20:29:29.468642 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
20:29:29.465658 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
20:29:29.453793 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
20:29:29.469100 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
20:29:29.469345 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.469645 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
20:29:29.469816 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
20:29:29.470435 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:29:29.470003 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:29:29.470330 [debug] [Thread-7  ]: Opening a new connection, currently in state init
20:29:29.470227 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6565850940>]}
20:29:29.471542 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
20:29:29.472360 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:29:29.472655 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:29:29.472745 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
20:29:29.472872 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
20:29:29.474506 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:29:29.474742 [debug] [Thread-9  ]: finished collecting timing info
20:29:29.474914 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
20:29:29.477055 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:29:29.477452 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:29.477553 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
20:29:29.477620 [debug] [Thread-9  ]: Opening a new connection, currently in state init
20:29:29.479039 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
20:29:29.479491 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:29:29.482384 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
20:29:29.482551 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.482628 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
20:29:29.483951 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
20:29:29.484145 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:29.484236 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
20:29:29.485162 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:29.487242 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:29.487338 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
20:29:29.488756 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.487417 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:29:29.488930 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
20:29:29.489368 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
20:29:29.489483 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
20:29:29.489551 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
20:29:29.489631 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.489817 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.491103 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.495368 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:29.496425 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:29.496234 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
20:29:29.496515 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:29.496051 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.01 seconds
20:29:29.497141 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.498959 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
20:29:29.500324 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
20:29:29.499062 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
20:29:29.500173 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
20:29:29.502447 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:29.503034 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
20:29:29.502803 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.502613 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.503190 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
20:29:29.504917 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
20:29:29.505293 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:29.505458 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
20:29:29.506393 [debug] [Thread-9  ]: finished collecting timing info
20:29:29.506741 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
20:29:29.506606 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
20:29:29.507090 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560263fa0>]}
20:29:29.507325 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
20:29:29.506493 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
20:29:29.508507 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.508642 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
20:29:29.508977 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
20:29:29.513820 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
20:29:29.515776 [debug] [Thread-6  ]: finished collecting timing info
20:29:29.516041 [debug] [Thread-6  ]: On model.first_project.customer2: Close
20:29:29.516757 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560278790>]}
20:29:29.517668 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.06s]
20:29:29.518094 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
20:29:29.520909 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
20:29:29.522471 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
20:29:29.522602 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
20:29:29.522998 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:29.524435 [debug] [Thread-7  ]: finished collecting timing info
20:29:29.524615 [debug] [Thread-7  ]: On model.first_project.customers: Close
20:29:29.526730 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563383880>]}
20:29:29.527031 [info ] [Thread-7  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
20:29:29.527356 [debug] [Thread-7  ]: Finished running node model.first_project.customers
20:29:29.528741 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:29.528895 [debug] [MainThread]: Using postgres connection "master"
20:29:29.529064 [debug] [MainThread]: On master: BEGIN
20:29:29.529185 [debug] [MainThread]: Opening a new connection, currently in state closed
20:29:29.533614 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:29.533857 [debug] [MainThread]: On master: COMMIT
20:29:29.533943 [debug] [MainThread]: Using postgres connection "master"
20:29:29.534008 [debug] [MainThread]: On master: COMMIT
20:29:29.534767 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:29.534906 [debug] [MainThread]: On master: Close
20:29:29.535252 [info ] [MainThread]: 
20:29:29.536332 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.27s.
20:29:29.536494 [debug] [MainThread]: Connection 'master' was properly closed.
20:29:29.536562 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:29:29.536627 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:29:29.536681 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:29:29.536733 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:29:29.536786 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
20:29:29.536863 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
20:29:29.536916 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:29:29.542024 [info ] [MainThread]: 
20:29:29.542250 [info ] [MainThread]: [32mCompleted successfully[0m
20:29:29.542522 [info ] [MainThread]: 
20:29:29.542669 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:29:29.542876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6565aa6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6565a9a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563362b80>]}


============================== 2022-06-04 20:31:12.276304 | 964d5732-31fd-4765-b09c-39bedd30ca36 ==============================
20:31:12.276331 [info ] [MainThread]: Running with dbt=1.1.0
20:31:12.277115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
20:31:12.277269 [debug] [MainThread]: Tracking: tracking
20:31:12.280856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3964c6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3964c6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3964c64f0>]}
20:31:12.307836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:31:12.308043 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:31:12.316769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '964d5732-31fd-4765-b09c-39bedd30ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa39637b0d0>]}
20:31:12.322409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '964d5732-31fd-4765-b09c-39bedd30ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c78b0>]}
20:31:12.322679 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:31:12.322916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '964d5732-31fd-4765-b09c-39bedd30ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c7940>]}
20:31:12.323974 [info ] [MainThread]: 
20:31:12.324368 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:12.325085 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:31:12.331851 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:31:12.332057 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:31:12.332136 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:12.341802 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:31:12.343886 [debug] [ThreadPool]: On list_erp_oltp: Close
20:31:12.346788 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:31:12.350544 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:31:12.350658 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:31:12.350727 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:12.355458 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:31:12.355600 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:31:12.355678 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:31:12.357250 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:31:12.358226 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:31:12.358410 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:31:12.362592 [debug] [MainThread]: Using postgres connection "master"
20:31:12.362874 [debug] [MainThread]: On master: BEGIN
20:31:12.363023 [debug] [MainThread]: Opening a new connection, currently in state init
20:31:12.367262 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:12.367404 [debug] [MainThread]: Using postgres connection "master"
20:31:12.367471 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:31:12.380873 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
20:31:12.382039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '964d5732-31fd-4765-b09c-39bedd30ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c74f0>]}
20:31:12.382323 [debug] [MainThread]: On master: ROLLBACK
20:31:12.382656 [debug] [MainThread]: Using postgres connection "master"
20:31:12.382755 [debug] [MainThread]: On master: BEGIN
20:31:12.382970 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:12.383067 [debug] [MainThread]: On master: COMMIT
20:31:12.383128 [debug] [MainThread]: Using postgres connection "master"
20:31:12.383185 [debug] [MainThread]: On master: COMMIT
20:31:12.383298 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:12.383385 [debug] [MainThread]: On master: Close
20:31:12.383685 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:31:12.383846 [info ] [MainThread]: 
20:31:12.388917 [debug] [Thread-1  ]: Began running node seed.first_project.code-country
20:31:12.389171 [info ] [Thread-1  ]: 1 of 1 START seed file public.code-country ..................................... [RUN]
20:31:12.389463 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.first_project.code-country"
20:31:12.389575 [debug] [Thread-1  ]: Began compiling node seed.first_project.code-country
20:31:12.389668 [debug] [Thread-1  ]: finished collecting timing info
20:31:12.389904 [debug] [Thread-1  ]: Began executing node seed.first_project.code-country
20:31:12.425835 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:12.425981 [debug] [Thread-1  ]: On seed.first_project.code-country: BEGIN
20:31:12.426054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:31:12.431051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:31:12.431280 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:12.431356 [debug] [Thread-1  ]: On seed.first_project.code-country: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "seed.first_project.code-country"} */

    create table "erp_oltp"."public"."code-country" ("Name" text,"Code" text)
  
20:31:12.435102 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
20:31:12.554732 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:12.554948 [debug] [Thread-1  ]: On seed.first_project.code-country: 
          insert into "erp_oltp"."public"."code-country" ("Name", "Code") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,...
20:31:12.556339 [debug] [Thread-1  ]: SQL status: INSERT 0 249 in 0.0 seconds
20:31:12.558987 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.first_project.code-country"
20:31:12.566717 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:31:12.566914 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:12.567007 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:31:12.569249 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:31:12.569658 [debug] [Thread-1  ]: finished collecting timing info
20:31:12.569793 [debug] [Thread-1  ]: On seed.first_project.code-country: Close
20:31:12.570170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '964d5732-31fd-4765-b09c-39bedd30ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c7400>]}
20:31:12.570366 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.code-country ................................. [[32mINSERT 249[0m in 0.18s]
20:31:12.570712 [debug] [Thread-1  ]: Finished running node seed.first_project.code-country
20:31:12.572037 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:12.572155 [debug] [MainThread]: Using postgres connection "master"
20:31:12.572251 [debug] [MainThread]: On master: BEGIN
20:31:12.572346 [debug] [MainThread]: Opening a new connection, currently in state closed
20:31:12.577774 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:31:12.577971 [debug] [MainThread]: On master: COMMIT
20:31:12.578050 [debug] [MainThread]: Using postgres connection "master"
20:31:12.578113 [debug] [MainThread]: On master: COMMIT
20:31:12.578271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:12.578373 [debug] [MainThread]: On master: Close
20:31:12.578701 [info ] [MainThread]: 
20:31:12.578941 [info ] [MainThread]: Finished running 1 seed in 0.25s.
20:31:12.579089 [debug] [MainThread]: Connection 'master' was properly closed.
20:31:12.579152 [debug] [MainThread]: Connection 'list_erp_oltp' was properly closed.
20:31:12.579209 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
20:31:12.585621 [info ] [MainThread]: 
20:31:12.585931 [info ] [MainThread]: [32mCompleted successfully[0m
20:31:12.586254 [info ] [MainThread]: 
20:31:12.586688 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:31:12.587104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa396362f10>]}


============================== 2022-06-10 22:02:58.389463 | 9ae2ba42-dce0-4be1-a559-13bf9b72697b ==============================
22:02:58.389479 [info ] [MainThread]: Running with dbt=1.1.0
22:02:58.389899 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:02:58.389994 [debug] [MainThread]: Tracking: tracking
22:02:58.392992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ba611c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ba61af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ba61ca0>]}
22:02:58.405809 [info ] [MainThread]: Unable to do partial parsing because profile has changed
22:02:58.406236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9ae2ba42-dce0-4be1-a559-13bf9b72697b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ba64190>]}
22:02:58.421646 [debug] [MainThread]: Parsing macros/catalog.sql
22:02:58.424370 [debug] [MainThread]: Parsing macros/relations.sql
22:02:58.425766 [debug] [MainThread]: Parsing macros/adapters.sql
22:02:58.440193 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:02:58.442059 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:02:58.444446 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:02:58.446956 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:02:58.452766 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:02:58.462095 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:02:58.473193 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:02:58.476791 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:02:58.478374 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:02:58.479653 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:02:58.481873 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:02:58.484506 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:02:58.491324 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:02:58.498830 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:02:58.501844 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:02:58.517549 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:02:58.521645 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:02:58.522937 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:02:58.525956 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:02:58.527422 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:02:58.535129 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:02:58.545336 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:02:58.551683 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:02:58.552793 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:02:58.554285 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:02:58.555305 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:02:58.556194 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:02:58.562434 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:02:58.568152 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:02:58.570056 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:02:58.571560 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:02:58.573212 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:02:58.577581 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:02:58.580412 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:02:58.581012 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:02:58.581548 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:02:58.581992 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:02:58.582877 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:02:58.588022 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:02:58.590831 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:02:58.736163 [debug] [MainThread]: 1699: static parser successfully parsed erp/customer2.sql
22:02:58.745265 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
22:02:58.747134 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
22:02:58.749516 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
22:02:58.751257 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
22:02:58.752906 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
22:02:58.754365 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
22:02:58.808694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ae2ba42-dce0-4be1-a559-13bf9b72697b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533dc54fa0>]}
22:02:58.812545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ae2ba42-dce0-4be1-a559-13bf9b72697b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ba61190>]}
22:02:58.812827 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:02:58.813004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae2ba42-dce0-4be1-a559-13bf9b72697b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ba656a0>]}
22:02:58.814097 [info ] [MainThread]: 
22:02:58.814452 [debug] [MainThread]: Acquiring new postgres connection "master"
22:02:58.815297 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:02:58.821730 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:02:58.821917 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:02:58.821996 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:02:58.846950 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
22:02:58.847170 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:02:58.847246 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:02:58.867387 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.02 seconds
22:02:58.868508 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:02:58.868758 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:02:58.872308 [debug] [MainThread]: Using postgres connection "master"
22:02:58.872487 [debug] [MainThread]: On master: BEGIN
22:02:58.872557 [debug] [MainThread]: Opening a new connection, currently in state init
22:02:58.876884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:02:58.877101 [debug] [MainThread]: Using postgres connection "master"
22:02:58.877179 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:02:58.893030 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
22:02:58.894217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae2ba42-dce0-4be1-a559-13bf9b72697b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ba0ceb0>]}
22:02:58.894488 [debug] [MainThread]: On master: ROLLBACK
22:02:58.894786 [debug] [MainThread]: On master: Close
22:02:58.895132 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:02:58.895330 [info ] [MainThread]: 
22:02:58.899211 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:02:58.899497 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:02:58.899599 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:02:58.899685 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:02:58.901250 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:02:58.901569 [debug] [Thread-1  ]: finished collecting timing info
22:02:58.901746 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:02:58.901833 [debug] [Thread-1  ]: finished collecting timing info
22:02:58.902116 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:02:58.902233 [debug] [Thread-1  ]: Began running node model.first_project.postgres_sample_source_customers
22:02:58.902384 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:02:58.902460 [debug] [Thread-1  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:02:58.902534 [debug] [Thread-1  ]: Compiling model.first_project.postgres_sample_source_customers
22:02:58.904050 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:02:58.904238 [debug] [Thread-2  ]: Began running node model.first_project.stg_customers
22:02:58.904405 [debug] [Thread-3  ]: Began running node model.first_project.stg_orders
22:02:58.905175 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:02:58.904782 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:02:58.905622 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_customers
22:02:58.905723 [debug] [Thread-2  ]: Compiling model.first_project.stg_customers
22:02:58.905357 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
22:02:58.906788 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:02:58.906892 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
22:02:58.907023 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
22:02:58.908538 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:02:58.906494 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:02:58.905431 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:02:58.904512 [debug] [Thread-4  ]: Began running node seed.first_project.code-country
22:02:58.905494 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:02:58.908937 [debug] [Thread-1  ]: finished collecting timing info
22:02:58.905273 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_orders
22:02:58.912220 [debug] [Thread-3  ]: Compiling model.first_project.stg_orders
22:02:58.911258 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:02:58.913509 [debug] [Thread-4  ]: Began compiling node seed.first_project.code-country
22:02:58.911821 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:02:58.913732 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:02:58.912052 [debug] [Thread-1  ]: Began executing node model.first_project.postgres_sample_source_customers
22:02:58.913345 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:02:58.914200 [debug] [Thread-3  ]: finished collecting timing info
22:02:58.913610 [debug] [Thread-4  ]: Compiling seed.first_project.code-country
22:02:58.911572 [debug] [Thread-2  ]: finished collecting timing info
22:02:58.916076 [debug] [Thread-2  ]: Began executing node model.first_project.stg_customers
22:02:58.916171 [debug] [Thread-2  ]: finished collecting timing info
22:02:58.913955 [debug] [Thread-1  ]: finished collecting timing info
22:02:58.914338 [debug] [Thread-3  ]: Began executing node model.first_project.stg_orders
22:02:58.916901 [debug] [Thread-3  ]: finished collecting timing info
22:02:58.915920 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.code-country"
22:02:58.916438 [debug] [Thread-2  ]: Finished running node model.first_project.stg_customers
22:02:58.913827 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:02:58.911908 [debug] [Thread-6  ]: finished collecting timing info
22:02:58.922183 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
22:02:58.917139 [debug] [Thread-3  ]: Finished running node model.first_project.stg_orders
22:02:58.910865 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:02:58.917271 [debug] [Thread-4  ]: finished collecting timing info
22:02:58.917571 [debug] [Thread-10 ]: Began running node model.first_project.customer2
22:02:58.923245 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customer2"
22:02:58.922300 [debug] [Thread-6  ]: finished collecting timing info
22:02:58.923621 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
22:02:58.922683 [debug] [Thread-9  ]: Began running node model.first_project.customers
22:02:58.923877 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
22:02:58.923000 [debug] [Thread-4  ]: Began executing node seed.first_project.code-country
22:02:58.923334 [debug] [Thread-10 ]: Began compiling node model.first_project.customer2
22:02:58.924494 [debug] [Thread-10 ]: Compiling model.first_project.customer2
22:02:58.916772 [debug] [Thread-1  ]: Finished running node model.first_project.postgres_sample_source_customers
22:02:58.922871 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:02:58.927298 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:02:58.924195 [debug] [Thread-5  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:02:58.924264 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:02:58.935030 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:02:58.935150 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:02:58.926849 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customer2"
22:02:58.924106 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
22:02:58.934293 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:02:58.934715 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:02:58.924371 [debug] [Thread-4  ]: finished collecting timing info
22:02:58.935946 [debug] [Thread-4  ]: Finished running node seed.first_project.code-country
22:02:58.935237 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:02:58.935394 [debug] [Thread-9  ]: Compiling model.first_project.customers
22:02:58.935586 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:02:58.940433 [debug] [Thread-5  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:02:58.921979 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:02:58.940125 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
22:02:58.944144 [debug] [Thread-9  ]: finished collecting timing info
22:02:58.944325 [debug] [Thread-9  ]: Began executing node model.first_project.customers
22:02:58.944463 [debug] [Thread-9  ]: finished collecting timing info
22:02:58.943415 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:02:58.944812 [debug] [Thread-9  ]: Finished running node model.first_project.customers
22:02:58.940231 [debug] [Thread-10 ]: finished collecting timing info
22:02:58.945302 [debug] [Thread-10 ]: Began executing node model.first_project.customer2
22:02:58.945442 [debug] [Thread-10 ]: finished collecting timing info
22:02:58.945728 [debug] [Thread-10 ]: Finished running node model.first_project.customer2
22:02:58.946143 [debug] [Thread-10 ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:02:58.946388 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:02:58.946502 [debug] [Thread-10 ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:02:58.945829 [debug] [Thread-5  ]: finished collecting timing info
22:02:58.938358 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:02:58.945067 [debug] [Thread-8  ]: finished collecting timing info
22:02:58.946959 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:02:58.947046 [debug] [Thread-8  ]: finished collecting timing info
22:02:58.946768 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:02:58.947270 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:02:58.946591 [debug] [Thread-10 ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:02:58.940317 [debug] [Thread-7  ]: finished collecting timing info
22:02:58.950735 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:02:58.947439 [debug] [Thread-5  ]: finished collecting timing info
22:02:58.951569 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:02:58.950991 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:02:58.951130 [debug] [Thread-3  ]: finished collecting timing info
22:02:58.951794 [debug] [Thread-7  ]: finished collecting timing info
22:02:58.951944 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:02:58.952376 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:02:58.952517 [debug] [Thread-3  ]: finished collecting timing info
22:02:58.952936 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:02:58.952595 [debug] [Thread-10 ]: finished collecting timing info
22:02:58.953105 [debug] [Thread-10 ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:02:58.953186 [debug] [Thread-10 ]: finished collecting timing info
22:02:58.953370 [debug] [Thread-10 ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:02:58.954253 [debug] [MainThread]: Connection 'master' was properly closed.
22:02:58.954351 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
22:02:58.954413 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:02:58.954468 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
22:02:58.954520 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:02:58.954573 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
22:02:58.954625 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
22:02:58.954707 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
22:02:58.954804 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:02:58.954861 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:02:58.954916 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:02:58.957836 [info ] [MainThread]: Done.
22:02:58.961198 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:02:58.961402 [info ] [MainThread]: Building catalog
22:02:58.962843 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:02:58.967140 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:02:58.967293 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:02:58.967366 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:02:58.973590 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:02:58.973799 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:02:58.973901 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:02:58.988554 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.01 seconds
22:02:58.995672 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:02:58.996105 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:02:59.003344 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
22:02:59.003789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f533ba611c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53383d2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53383d22b0>]}
22:02:59.784255 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:02:59.784636 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 22:04:14.290742 | ab54eac4-f195-44cc-8e00-6e39c22cbed4 ==============================
22:04:14.290758 [info ] [MainThread]: Running with dbt=1.1.0
22:04:14.291198 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:04:14.291311 [debug] [MainThread]: Tracking: tracking
22:04:14.293647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00190a0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00190a0b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00190a05b0>]}
22:04:14.295474 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:04:14.295699 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:04:14.295979 [info ] [MainThread]: 
22:04:14.296204 [info ] [MainThread]: 
22:04:14.296614 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 22:08:33.523434 | fab22fca-1301-4bd5-83c9-6dca60951ff0 ==============================
22:08:33.523447 [info ] [MainThread]: Running with dbt=1.1.0
22:08:33.524098 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:08:33.524221 [debug] [MainThread]: Tracking: tracking
22:08:33.528729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa70d6d4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa70d6d4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa70d6d4130>]}
22:08:33.531013 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:08:33.531442 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:08:33.531586 [info ] [MainThread]: 
22:08:33.531681 [info ] [MainThread]: 
22:08:33.531776 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 22:26:03.702385 | 57d26b3c-b00c-4376-8635-264114b25454 ==============================
22:26:03.702398 [info ] [MainThread]: Running with dbt=1.1.0
22:26:03.702748 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:26:03.702865 [debug] [MainThread]: Tracking: tracking
22:26:03.705441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9b0c7ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9b0c5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9b0c54c0>]}
22:26:03.722050 [info ] [MainThread]: Unable to do partial parsing because profile has changed
22:26:03.722312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9b0c54c0>]}
22:26:03.740505 [debug] [MainThread]: Parsing macros/catalog.sql
22:26:03.742572 [debug] [MainThread]: Parsing macros/relations.sql
22:26:03.746414 [debug] [MainThread]: Parsing macros/adapters.sql
22:26:03.760420 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:26:03.761567 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:26:03.763054 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:26:03.765929 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:26:03.772615 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:26:03.781715 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:26:03.791391 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:26:03.794127 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:26:03.795099 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:26:03.795881 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:26:03.797480 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:26:03.799144 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:26:03.803232 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:26:03.807485 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:26:03.809176 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:26:03.818992 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:26:03.822609 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:26:03.823712 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:26:03.826378 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:26:03.827501 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:26:03.835018 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:26:03.845000 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:26:03.851388 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:26:03.852429 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:26:03.853897 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:26:03.854881 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:26:03.855755 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:26:03.861482 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:26:03.867059 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:26:03.868918 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:26:03.870319 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:26:03.871957 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:26:03.876066 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:26:03.878652 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:26:03.879237 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:26:03.879759 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:26:03.880208 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:26:03.881136 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:26:03.885957 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:26:03.888665 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:26:04.023563 [debug] [MainThread]: 1699: static parser successfully parsed erp/customer2.sql
22:26:04.031426 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
22:26:04.032864 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
22:26:04.034645 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
22:26:04.037484 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
22:26:04.040652 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
22:26:04.041884 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
22:26:04.091803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9b05c910>]}
22:26:04.095157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9b0c57c0>]}
22:26:04.095427 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:26:04.095583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9b07cf70>]}
22:26:04.096571 [info ] [MainThread]: 
22:26:04.096943 [debug] [MainThread]: Acquiring new postgres connection "master"
22:26:04.097688 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
22:26:04.104314 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
22:26:04.104430 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
22:26:04.104503 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:26:04.113549 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:26:04.114689 [debug] [ThreadPool]: On list_erp_oltp: Close
22:26:04.117794 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:26:04.122321 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:26:04.122455 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:26:04.122520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:26:04.126449 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:26:04.126604 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:26:04.126666 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:26:04.127966 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:26:04.128879 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:26:04.130830 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:26:04.136593 [debug] [MainThread]: Using postgres connection "master"
22:26:04.136778 [debug] [MainThread]: On master: BEGIN
22:26:04.136852 [debug] [MainThread]: Opening a new connection, currently in state init
22:26:04.141737 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:26:04.141953 [debug] [MainThread]: Using postgres connection "master"
22:26:04.142022 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:26:04.152854 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:26:04.154570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9b05cd60>]}
22:26:04.154902 [debug] [MainThread]: On master: ROLLBACK
22:26:04.155285 [debug] [MainThread]: Using postgres connection "master"
22:26:04.155429 [debug] [MainThread]: On master: BEGIN
22:26:04.156053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:26:04.156190 [debug] [MainThread]: On master: COMMIT
22:26:04.156268 [debug] [MainThread]: Using postgres connection "master"
22:26:04.156335 [debug] [MainThread]: On master: COMMIT
22:26:04.156487 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:26:04.156574 [debug] [MainThread]: On master: Close
22:26:04.156926 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:26:04.157123 [info ] [MainThread]: 
22:26:04.161067 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:26:04.161263 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
22:26:04.161514 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:26:04.161593 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:26:04.161680 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:26:04.163219 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:26:04.163364 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:26:04.163482 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:26:04.164803 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
22:26:04.165086 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:26:04.164587 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
22:26:04.165160 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:26:04.165514 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:26:04.166287 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:26:04.165421 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:26:04.163574 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:26:04.166801 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
22:26:04.166454 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:26:04.166620 [debug] [Thread-3  ]: finished collecting timing info
22:26:04.167220 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:26:04.167011 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:26:04.167109 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:26:04.164337 [debug] [Thread-1  ]: finished collecting timing info
22:26:04.183578 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:26:04.183336 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:26:04.176386 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:26:04.195231 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:26:04.196326 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:26:04.204015 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
22:26:04.204686 [debug] [Thread-4  ]: finished collecting timing info
22:26:04.204856 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:26:04.208263 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
22:26:04.208445 [debug] [Thread-2  ]: finished collecting timing info
22:26:04.209652 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:26:04.211555 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
22:26:04.211662 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:26:04.211117 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:26:04.210929 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
22:26:04.214359 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
22:26:04.211331 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:26:04.215294 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:26:04.215667 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:26:04.216425 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
22:26:04.215930 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
22:26:04.215832 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
22:26:04.216805 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:26:04.216631 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:26:04.216542 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:26:04.219507 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:26:04.219617 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:26:04.219698 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
22:26:04.222343 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
22:26:04.222546 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:26:04.222708 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
22:26:04.223046 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
22:26:04.223172 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:26:04.223230 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
22:26:04.223694 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
22:26:04.223816 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:26:04.223881 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
22:26:04.230413 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
22:26:04.234648 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:26:04.235106 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
22:26:04.235546 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.236787 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:26:04.236881 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
22:26:04.237132 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.242824 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.02 seconds
22:26:04.245120 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.02 seconds
22:26:04.245004 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:26:04.245210 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.02 seconds
22:26:04.249889 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:26:04.248502 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:26:04.249994 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
22:26:04.250570 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.247003 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:26:04.251790 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
22:26:04.250109 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
22:26:04.252232 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.251659 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:26:04.253345 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:26:04.253636 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
22:26:04.253905 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.253528 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
22:26:04.253432 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.248682 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:26:04.254548 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:26:04.256630 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:26:04.256437 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.257329 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:26:04.257434 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:26:04.256312 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:26:04.257587 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
22:26:04.257497 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:26:04.257916 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.256533 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:26:04.256710 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:26:04.258515 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:26:04.259815 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:26:04.259898 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:26:04.260339 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
22:26:04.263319 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:26:04.263419 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
22:26:04.263547 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
22:26:04.264069 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
22:26:04.265900 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:26:04.265014 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:26:04.266090 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
22:26:04.265989 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
22:26:04.264142 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:26:04.268267 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:26:04.268387 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
22:26:04.270332 [debug] [Thread-4  ]: finished collecting timing info
22:26:04.269551 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
22:26:04.269625 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
22:26:04.270490 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
22:26:04.272700 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d982b29d0>]}
22:26:04.271185 [debug] [Thread-2  ]: finished collecting timing info
22:26:04.269463 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
22:26:04.273847 [debug] [Thread-3  ]: finished collecting timing info
22:26:04.273977 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
22:26:04.274225 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d982a6f10>]}
22:26:04.274433 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
22:26:04.274687 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:26:04.272970 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.11s]
22:26:04.275037 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:26:04.273107 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:26:04.275209 [debug] [Thread-6  ]: Began running node model.first_project.customer2
22:26:04.273210 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
22:26:04.275418 [debug] [Thread-8  ]: Began running node model.first_project.customers
22:26:04.276299 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
22:26:04.276528 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
22:26:04.276599 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
22:26:04.276663 [debug] [Thread-8  ]: Compiling model.first_project.customers
22:26:04.278100 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
22:26:04.276125 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
22:26:04.279732 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
22:26:04.278400 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9ab58580>]}
22:26:04.279817 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
22:26:04.280299 [debug] [Thread-6  ]: Compiling model.first_project.customer2
22:26:04.280095 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
22:26:04.280209 [debug] [Thread-8  ]: finished collecting timing info
22:26:04.282150 [debug] [Thread-8  ]: Began executing node model.first_project.customers
22:26:04.283629 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
22:26:04.281865 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
22:26:04.282295 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:26:04.284012 [debug] [Thread-6  ]: finished collecting timing info
22:26:04.284141 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
22:26:04.285514 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
22:26:04.285705 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:26:04.285864 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
22:26:04.286068 [debug] [Thread-8  ]: Opening a new connection, currently in state init
22:26:04.275979 [debug] [Thread-1  ]: finished collecting timing info
22:26:04.285981 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:26:04.286529 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
22:26:04.286606 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:26:04.286278 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
22:26:04.290854 [debug] [Thread-8  ]: SQL status: BEGIN in 0.0 seconds
22:26:04.291022 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:26:04.291091 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:26:04.293216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9ab5b790>]}
22:26:04.293717 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
22:26:04.294111 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:26:04.294488 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
22:26:04.294666 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
22:26:04.295013 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:26:04.295099 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
22:26:04.295170 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
22:26:04.296758 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:26:04.297154 [debug] [Thread-10 ]: finished collecting timing info
22:26:04.297310 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
22:26:04.299934 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
22:26:04.300138 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
22:26:04.301464 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:26:04.301558 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
22:26:04.302852 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.303668 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
22:26:04.303831 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:26:04.303904 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
22:26:04.304236 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:26:04.304331 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
22:26:04.304399 [debug] [Thread-10 ]: Opening a new connection, currently in state init
22:26:04.304652 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
22:26:04.305669 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:26:04.305778 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
22:26:04.305866 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
22:26:04.305968 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:26:04.306098 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:26:04.306306 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
22:26:04.306994 [debug] [Thread-8  ]: finished collecting timing info
22:26:04.307101 [debug] [Thread-8  ]: On model.first_project.customers: Close
22:26:04.307378 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9821a640>]}
22:26:04.307677 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.03s]
22:26:04.307914 [debug] [Thread-8  ]: Finished running node model.first_project.customers
22:26:04.311065 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
22:26:04.312530 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:26:04.312630 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
22:26:04.315602 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.318832 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:26:04.318998 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
22:26:04.319831 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.320006 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
22:26:04.320939 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
22:26:04.321095 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:26:04.321203 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:26:04.321295 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
22:26:04.321388 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
22:26:04.322244 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
22:26:04.323557 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:26:04.323644 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
22:26:04.323909 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
22:26:04.324571 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
22:26:04.324654 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:26:04.324711 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
22:26:04.325264 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
22:26:04.326118 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:26:04.326228 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
22:26:04.326744 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
22:26:04.327614 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:26:04.327729 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
22:26:04.327913 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
22:26:04.329779 [debug] [Thread-10 ]: finished collecting timing info
22:26:04.329932 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
22:26:04.330078 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
22:26:04.331048 [debug] [Thread-6  ]: finished collecting timing info
22:26:04.331860 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d981d4b80>]}
22:26:04.335772 [debug] [Thread-6  ]: On model.first_project.customer2: Close
22:26:04.336199 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
22:26:04.338033 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
22:26:04.338359 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57d26b3c-b00c-4376-8635-264114b25454', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d98255730>]}
22:26:04.338990 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.06s]
22:26:04.339256 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
22:26:04.340631 [debug] [MainThread]: Acquiring new postgres connection "master"
22:26:04.340742 [debug] [MainThread]: Using postgres connection "master"
22:26:04.340804 [debug] [MainThread]: On master: BEGIN
22:26:04.340859 [debug] [MainThread]: Opening a new connection, currently in state closed
22:26:04.344424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:26:04.344543 [debug] [MainThread]: On master: COMMIT
22:26:04.344604 [debug] [MainThread]: Using postgres connection "master"
22:26:04.344658 [debug] [MainThread]: On master: COMMIT
22:26:04.344801 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:26:04.344887 [debug] [MainThread]: On master: Close
22:26:04.345174 [info ] [MainThread]: 
22:26:04.345351 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.25s.
22:26:04.345501 [debug] [MainThread]: Connection 'master' was properly closed.
22:26:04.345559 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
22:26:04.345612 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:26:04.345662 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
22:26:04.345712 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
22:26:04.345817 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:26:04.345872 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:26:04.345921 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:26:04.349913 [info ] [MainThread]: 
22:26:04.350200 [info ] [MainThread]: [32mCompleted successfully[0m
22:26:04.350653 [info ] [MainThread]: 
22:26:04.350852 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
22:26:04.351059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d982902b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9b05c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d9aae5190>]}


============================== 2022-06-10 22:26:52.002226 | 271461d7-e2ba-4e9f-96a7-a017ed5c7be8 ==============================
22:26:52.002240 [info ] [MainThread]: Running with dbt=1.1.0
22:26:52.002672 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:26:52.002830 [debug] [MainThread]: Tracking: tracking
22:26:52.005363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846cdbd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846cdbca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846cdbc6a0>]}
22:26:52.022958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:26:52.023153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:26:52.027220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '271461d7-e2ba-4e9f-96a7-a017ed5c7be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846cc70f10>]}
22:26:52.032705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '271461d7-e2ba-4e9f-96a7-a017ed5c7be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846cd5d640>]}
22:26:52.033013 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:26:52.033196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '271461d7-e2ba-4e9f-96a7-a017ed5c7be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846cdbd910>]}
22:26:52.034839 [info ] [MainThread]: 
22:26:52.035160 [debug] [MainThread]: Acquiring new postgres connection "master"
22:26:52.035970 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:26:52.044116 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:26:52.044332 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:26:52.044418 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:26:52.050453 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:26:52.050668 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:26:52.050799 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:26:52.052231 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:26:52.054030 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:26:52.054456 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:26:52.058315 [debug] [MainThread]: Using postgres connection "master"
22:26:52.058437 [debug] [MainThread]: On master: BEGIN
22:26:52.058521 [debug] [MainThread]: Opening a new connection, currently in state init
22:26:52.062841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:26:52.062953 [debug] [MainThread]: Using postgres connection "master"
22:26:52.063014 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:26:52.076493 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:26:52.077692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '271461d7-e2ba-4e9f-96a7-a017ed5c7be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846cdbc6d0>]}
22:26:52.077918 [debug] [MainThread]: On master: ROLLBACK
22:26:52.078155 [debug] [MainThread]: On master: Close
22:26:52.078456 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:26:52.078648 [info ] [MainThread]: 
22:26:52.083330 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:26:52.083607 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:26:52.083701 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:26:52.083782 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:26:52.085297 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:26:52.085728 [debug] [Thread-1  ]: finished collecting timing info
22:26:52.085942 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:26:52.086091 [debug] [Thread-1  ]: finished collecting timing info
22:26:52.086571 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:26:52.086844 [debug] [Thread-1  ]: Began running node model.first_project.postgres_sample_source_customers
22:26:52.087084 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:26:52.087226 [debug] [Thread-1  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:26:52.087308 [debug] [Thread-1  ]: Compiling model.first_project.postgres_sample_source_customers
22:26:52.088901 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:26:52.089158 [debug] [Thread-1  ]: finished collecting timing info
22:26:52.089294 [debug] [Thread-1  ]: Began executing node model.first_project.postgres_sample_source_customers
22:26:52.089362 [debug] [Thread-1  ]: finished collecting timing info
22:26:52.089566 [debug] [Thread-1  ]: Finished running node model.first_project.postgres_sample_source_customers
22:26:52.089799 [debug] [Thread-1  ]: Began running node model.first_project.stg_customers
22:26:52.089891 [debug] [Thread-2  ]: Began running node model.first_project.stg_orders
22:26:52.090742 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:26:52.090279 [debug] [Thread-3  ]: Began running node seed.first_project.code-country
22:26:52.091607 [debug] [Thread-3  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:26:52.091711 [debug] [Thread-3  ]: Began compiling node seed.first_project.code-country
22:26:52.091773 [debug] [Thread-3  ]: Compiling seed.first_project.code-country
22:26:52.090850 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_orders
22:26:52.092510 [debug] [Thread-2  ]: Compiling model.first_project.stg_orders
22:26:52.092387 [debug] [Thread-3  ]: Writing injected SQL for node "seed.first_project.code-country"
22:26:52.122959 [debug] [Thread-3  ]: finished collecting timing info
22:26:52.123155 [debug] [Thread-3  ]: Began executing node seed.first_project.code-country
22:26:52.123240 [debug] [Thread-3  ]: finished collecting timing info
22:26:52.090135 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:26:52.123542 [debug] [Thread-3  ]: Finished running node seed.first_project.code-country
22:26:52.090518 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:26:52.124721 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:26:52.124843 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:26:52.124406 [debug] [Thread-1  ]: Began compiling node model.first_project.stg_customers
22:26:52.090454 [debug] [Thread-5  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:26:52.125219 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:26:52.125292 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:26:52.125020 [debug] [Thread-1  ]: Compiling model.first_project.stg_customers
22:26:52.126019 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:26:52.125352 [debug] [Thread-5  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:26:52.124200 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:26:52.124930 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:26:52.090386 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
22:26:52.140807 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:26:52.140931 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
22:26:52.140453 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:26:52.141368 [debug] [Thread-6  ]: finished collecting timing info
22:26:52.131716 [debug] [Thread-1  ]: finished collecting timing info
22:26:52.141728 [debug] [Thread-1  ]: Began executing node model.first_project.stg_customers
22:26:52.141835 [debug] [Thread-1  ]: finished collecting timing info
22:26:52.141543 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:26:52.141004 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
22:26:52.143628 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:26:52.143832 [debug] [Thread-4  ]: finished collecting timing info
22:26:52.143958 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
22:26:52.142302 [debug] [Thread-6  ]: finished collecting timing info
22:26:52.144029 [debug] [Thread-4  ]: finished collecting timing info
22:26:52.144544 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
22:26:52.142090 [debug] [Thread-1  ]: Finished running node model.first_project.stg_customers
22:26:52.135307 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:26:52.144292 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:26:52.142174 [debug] [Thread-2  ]: finished collecting timing info
22:26:52.144906 [debug] [Thread-8  ]: Began running node model.first_project.customer2
22:26:52.145459 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customer2"
22:26:52.145646 [debug] [Thread-8  ]: Began compiling node model.first_project.customer2
22:26:52.145258 [debug] [Thread-2  ]: Began executing node model.first_project.stg_orders
22:26:52.144988 [debug] [Thread-9  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:26:52.145560 [debug] [Thread-5  ]: finished collecting timing info
22:26:52.145724 [debug] [Thread-8  ]: Compiling model.first_project.customer2
22:26:52.145051 [debug] [Thread-10 ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:26:52.147756 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:26:52.145986 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:26:52.146087 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:26:52.147503 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customer2"
22:26:52.147843 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:26:52.148229 [debug] [Thread-10 ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:26:52.147939 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:26:52.148050 [debug] [Thread-5  ]: finished collecting timing info
22:26:52.150868 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:26:52.148337 [debug] [Thread-8  ]: finished collecting timing info
22:26:52.150360 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:26:52.150563 [debug] [Thread-9  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:26:52.145819 [debug] [Thread-2  ]: finished collecting timing info
22:26:52.151206 [debug] [Thread-8  ]: Began executing node model.first_project.customer2
22:26:52.153991 [debug] [Thread-8  ]: finished collecting timing info
22:26:52.153589 [debug] [Thread-10 ]: finished collecting timing info
22:26:52.154306 [debug] [Thread-10 ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:26:52.154200 [debug] [Thread-8  ]: Finished running node model.first_project.customer2
22:26:52.153332 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:26:52.154391 [debug] [Thread-10 ]: finished collecting timing info
22:26:52.154768 [debug] [Thread-10 ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:26:52.153874 [debug] [Thread-2  ]: Finished running node model.first_project.stg_orders
22:26:52.154977 [debug] [Thread-9  ]: finished collecting timing info
22:26:52.155181 [debug] [Thread-3  ]: Began running node model.first_project.customers
22:26:52.155403 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.customers"
22:26:52.155476 [debug] [Thread-3  ]: Began compiling node model.first_project.customers
22:26:52.155537 [debug] [Thread-3  ]: Compiling model.first_project.customers
22:26:52.156831 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.customers"
22:26:52.157029 [debug] [Thread-3  ]: finished collecting timing info
22:26:52.157130 [debug] [Thread-3  ]: Began executing node model.first_project.customers
22:26:52.157204 [debug] [Thread-3  ]: finished collecting timing info
22:26:52.157389 [debug] [Thread-3  ]: Finished running node model.first_project.customers
22:26:52.155253 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:26:52.157585 [debug] [Thread-1  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:26:52.157690 [debug] [Thread-9  ]: finished collecting timing info
22:26:52.157874 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:26:52.158100 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:26:52.158204 [debug] [Thread-1  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:26:52.158387 [debug] [Thread-1  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:26:52.162812 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:26:52.163043 [debug] [Thread-1  ]: finished collecting timing info
22:26:52.163138 [debug] [Thread-1  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:26:52.163205 [debug] [Thread-1  ]: finished collecting timing info
22:26:52.163394 [debug] [Thread-1  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:26:52.164454 [debug] [MainThread]: Connection 'master' was properly closed.
22:26:52.164541 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:26:52.164603 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
22:26:52.164689 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:26:52.164748 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
22:26:52.164800 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
22:26:52.164851 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:26:52.164902 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:26:52.164952 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:26:52.165002 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
22:26:52.168401 [info ] [MainThread]: Done.
22:26:52.170137 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:26:52.170282 [info ] [MainThread]: Building catalog
22:26:52.171852 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:26:52.175844 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:26:52.175948 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:26:52.176013 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:26:52.183536 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:26:52.183765 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:26:52.183850 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:26:52.186350 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
22:26:52.193320 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:26:52.193738 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:26:52.199750 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
22:26:52.200178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846cdbd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846cc2ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846cc2cac0>]}
22:26:52.816483 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:26:52.816855 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 22:26:59.360505 | 253948e5-c260-4d2c-9f31-2ef2633f0d80 ==============================
22:26:59.360526 [info ] [MainThread]: Running with dbt=1.1.0
22:26:59.360981 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:26:59.361074 [debug] [MainThread]: Tracking: tracking
22:26:59.363476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c68bbc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c68bbb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c68bbb6a0>]}
22:26:59.365124 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:26:59.365315 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:26:59.365428 [info ] [MainThread]: 
22:26:59.365652 [info ] [MainThread]: 
22:26:59.365756 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 22:27:47.518641 | 772e36e1-e369-45b5-9b48-6ab92e2d898b ==============================
22:27:47.518656 [info ] [MainThread]: Running with dbt=1.1.0
22:27:47.519069 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:27:47.519158 [debug] [MainThread]: Tracking: tracking
22:27:47.521723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f9302880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f9300a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f93004c0>]}
22:27:47.541456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:27:47.542070 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
22:27:47.550948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '772e36e1-e369-45b5-9b48-6ab92e2d898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f91a20d0>]}
22:27:47.556571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '772e36e1-e369-45b5-9b48-6ab92e2d898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f91ede50>]}
22:27:47.556915 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:27:47.557207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772e36e1-e369-45b5-9b48-6ab92e2d898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f9302ee0>]}
22:27:47.559126 [info ] [MainThread]: 
22:27:47.559535 [debug] [MainThread]: Acquiring new postgres connection "master"
22:27:47.560990 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:27:47.567675 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:27:47.567868 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:27:47.567942 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:27:47.572684 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:27:47.572836 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:27:47.572904 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:27:47.574153 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:27:47.576003 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:27:47.576211 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:27:47.580946 [debug] [MainThread]: Using postgres connection "master"
22:27:47.581126 [debug] [MainThread]: On master: BEGIN
22:27:47.581202 [debug] [MainThread]: Opening a new connection, currently in state init
22:27:47.585225 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:27:47.585393 [debug] [MainThread]: Using postgres connection "master"
22:27:47.585461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:27:47.599933 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:27:47.600997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772e36e1-e369-45b5-9b48-6ab92e2d898b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f91edd30>]}
22:27:47.601272 [debug] [MainThread]: On master: ROLLBACK
22:27:47.601466 [debug] [MainThread]: On master: Close
22:27:47.601843 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:27:47.602005 [info ] [MainThread]: 
22:27:47.605390 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:27:47.605610 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:27:47.605707 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:27:47.605805 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:27:47.637327 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:27:47.637546 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:27:47.637906 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:27:47.639642 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:27:47.639741 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:27:47.639440 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:27:47.641251 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:27:47.641328 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:27:47.641897 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:27:47.640945 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:27:47.642184 [debug] [Thread-3  ]: finished collecting timing info
22:27:47.642398 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:27:47.642490 [debug] [Thread-3  ]: finished collecting timing info
22:27:47.639216 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:27:47.642938 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:27:47.642714 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:27:47.639531 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
22:27:47.643378 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:27:47.643021 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:27:47.643937 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:27:47.639114 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:27:47.643683 [debug] [Thread-7  ]: Began running node model.first_project.customer2
22:27:47.645205 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customer2"
22:27:47.645300 [debug] [Thread-7  ]: Began compiling node model.first_project.customer2
22:27:47.644895 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:27:47.645614 [debug] [Thread-4  ]: finished collecting timing info
22:27:47.645377 [debug] [Thread-7  ]: Compiling model.first_project.customer2
22:27:47.643802 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
22:27:47.647697 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
22:27:47.645727 [debug] [Thread-1  ]: finished collecting timing info
22:27:47.645845 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:27:47.647570 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customer2"
22:27:47.648369 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
22:27:47.648795 [debug] [Thread-5  ]: finished collecting timing info
22:27:47.648871 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
22:27:47.648941 [debug] [Thread-5  ]: finished collecting timing info
22:27:47.649155 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
22:27:47.642281 [debug] [Thread-2  ]: finished collecting timing info
22:27:47.649362 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:27:47.648522 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:27:47.649438 [debug] [Thread-2  ]: finished collecting timing info
22:27:47.649936 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:27:47.648638 [debug] [Thread-4  ]: finished collecting timing info
22:27:47.649554 [debug] [Thread-7  ]: finished collecting timing info
22:27:47.650312 [debug] [Thread-7  ]: Began executing node model.first_project.customer2
22:27:47.650170 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:27:47.650391 [debug] [Thread-7  ]: finished collecting timing info
22:27:47.650928 [debug] [Thread-7  ]: Finished running node model.first_project.customer2
22:27:47.650719 [debug] [Thread-9  ]: Began running node model.first_project.customers
22:27:47.651172 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
22:27:47.651250 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
22:27:47.651312 [debug] [Thread-9  ]: Compiling model.first_project.customers
22:27:47.652637 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
22:27:47.652849 [debug] [Thread-9  ]: finished collecting timing info
22:27:47.652940 [debug] [Thread-9  ]: Began executing node model.first_project.customers
22:27:47.653008 [debug] [Thread-9  ]: finished collecting timing info
22:27:47.653192 [debug] [Thread-9  ]: Finished running node model.first_project.customers
22:27:47.649701 [debug] [Thread-1  ]: finished collecting timing info
22:27:47.653441 [debug] [Thread-6  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:27:47.653671 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:27:47.653861 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:27:47.654052 [debug] [Thread-6  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:27:47.654126 [debug] [Thread-6  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:27:47.660251 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
22:27:47.661945 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:27:47.662053 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
22:27:47.662140 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
22:27:47.660430 [debug] [Thread-5  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:27:47.663597 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:27:47.663685 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:27:47.663357 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:27:47.663761 [debug] [Thread-5  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:27:47.660528 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:27:47.661682 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:27:47.670043 [debug] [Thread-6  ]: finished collecting timing info
22:27:47.669809 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:27:47.670274 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:27:47.670174 [debug] [Thread-6  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:27:47.670448 [debug] [Thread-6  ]: finished collecting timing info
22:27:47.670350 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:27:47.669620 [debug] [Thread-8  ]: finished collecting timing info
22:27:47.670667 [debug] [Thread-6  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:27:47.668995 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:27:47.674001 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:27:47.674123 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
22:27:47.674850 [debug] [Thread-8  ]: finished collecting timing info
22:27:47.675169 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
22:27:47.675488 [debug] [Thread-10 ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:27:47.675267 [debug] [Thread-5  ]: finished collecting timing info
22:27:47.675658 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:27:47.676026 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:27:47.676113 [debug] [Thread-10 ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:27:47.675900 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:27:47.675731 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:27:47.679789 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:27:47.679211 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:27:47.679898 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:27:47.680302 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:27:47.682155 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:27:47.674634 [debug] [Thread-2  ]: finished collecting timing info
22:27:47.682394 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:27:47.682644 [debug] [Thread-2  ]: finished collecting timing info
22:27:47.682488 [debug] [Thread-10 ]: finished collecting timing info
22:27:47.682927 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:27:47.679545 [debug] [Thread-5  ]: finished collecting timing info
22:27:47.683081 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:27:47.683168 [debug] [Thread-9  ]: finished collecting timing info
22:27:47.683691 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:27:47.683587 [debug] [Thread-10 ]: finished collecting timing info
22:27:47.683782 [debug] [Thread-9  ]: finished collecting timing info
22:27:47.684223 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:27:47.683442 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:27:47.684000 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:27:47.685302 [debug] [MainThread]: Connection 'master' was properly closed.
22:27:47.685396 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
22:27:47.685455 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
22:27:47.685509 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:27:47.685560 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
22:27:47.685611 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
22:27:47.685662 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:27:47.685721 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
22:27:47.685838 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:27:47.685894 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:27:47.685950 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:27:47.688565 [info ] [MainThread]: Done.
22:27:47.689946 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:27:47.690038 [info ] [MainThread]: Building catalog
22:27:47.691400 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:27:47.695844 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:27:47.696108 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:27:47.696216 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:27:47.700924 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:27:47.701074 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:27:47.701137 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:27:47.703268 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
22:27:47.711751 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:27:47.712198 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:27:47.719431 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
22:27:47.719842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f9302880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f91a2430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75f91a2460>]}
22:27:48.316691 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:27:48.317133 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 22:27:51.714727 | d174ca3e-d1b8-4cd6-81a8-4c5e0f0a8e61 ==============================
22:27:51.714746 [info ] [MainThread]: Running with dbt=1.1.0
22:27:51.715323 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:27:51.715435 [debug] [MainThread]: Tracking: tracking
22:27:51.718024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa65cb005e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa65e31bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa65cb00be0>]}
22:27:51.719692 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:27:51.719921 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:27:51.720208 [info ] [MainThread]: 
22:27:51.720402 [info ] [MainThread]: 
22:27:51.720791 [info ] [MainThread]: Press Ctrl+C to exit.
22:27:51.721161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa65cafd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa65cafde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa65cafda90>]}


============================== 2022-06-10 22:29:21.788050 | e2f8b3e2-16d7-45ba-88c7-0809fdef91ce ==============================
22:29:21.788063 [info ] [MainThread]: Running with dbt=1.1.0
22:29:21.788383 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:29:21.788465 [debug] [MainThread]: Tracking: tracking
22:29:21.791063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee07e1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee07e1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edefc59a0>]}
22:29:21.809749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:29:21.810215 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
22:29:21.852504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edef5beb0>]}
22:29:21.879651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee11a52e0>]}
22:29:21.879897 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:29:21.880082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee1197af0>]}
22:29:21.881045 [info ] [MainThread]: 
22:29:21.881373 [debug] [MainThread]: Acquiring new postgres connection "master"
22:29:21.882093 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
22:29:21.887637 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
22:29:21.887737 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
22:29:21.887803 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:29:21.893642 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:29:21.894580 [debug] [ThreadPool]: On list_erp_oltp: Close
22:29:21.897433 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:29:21.902684 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:29:21.902927 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:29:21.903011 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:29:21.908020 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:29:21.908490 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:29:21.909581 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:29:21.911151 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:29:21.912237 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:29:21.914107 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:29:21.917290 [debug] [MainThread]: Using postgres connection "master"
22:29:21.917444 [debug] [MainThread]: On master: BEGIN
22:29:21.917517 [debug] [MainThread]: Opening a new connection, currently in state init
22:29:21.921284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:29:21.921440 [debug] [MainThread]: Using postgres connection "master"
22:29:21.921509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:29:21.932156 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:29:21.933346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee11a5550>]}
22:29:21.933575 [debug] [MainThread]: On master: ROLLBACK
22:29:21.933839 [debug] [MainThread]: Using postgres connection "master"
22:29:21.933944 [debug] [MainThread]: On master: BEGIN
22:29:21.934211 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:29:21.934384 [debug] [MainThread]: On master: COMMIT
22:29:21.934458 [debug] [MainThread]: Using postgres connection "master"
22:29:21.934525 [debug] [MainThread]: On master: COMMIT
22:29:21.934661 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:29:21.934774 [debug] [MainThread]: On master: Close
22:29:21.935037 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:29:21.935176 [info ] [MainThread]: 
22:29:21.942058 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:29:21.942427 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:29:21.943226 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
22:29:21.943550 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:29:21.943003 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
22:29:21.942549 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:29:21.944121 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
22:29:21.944361 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:29:21.943924 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:29:21.944437 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:29:21.944657 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:29:21.945464 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:29:21.944534 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:29:21.943645 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:29:21.945930 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:29:21.945616 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:29:21.945786 [debug] [Thread-3  ]: finished collecting timing info
22:29:21.949602 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:29:21.947304 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:29:21.948544 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:29:21.942732 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:29:21.960296 [debug] [Thread-2  ]: finished collecting timing info
22:29:21.960620 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
22:29:21.960818 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:29:21.966443 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
22:29:21.964462 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:29:21.963929 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
22:29:21.966556 [debug] [Thread-1  ]: finished collecting timing info
22:29:21.967091 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:29:21.966916 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:29:21.966761 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:29:21.972381 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
22:29:21.984991 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
22:29:21.972825 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:29:21.972624 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:29:21.986524 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
22:29:21.986227 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:29:21.986619 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:29:21.987063 [debug] [Thread-4  ]: finished collecting timing info
22:29:21.987185 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:29:21.984760 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
22:29:21.989529 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
22:29:21.990065 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:29:21.990251 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:29:21.990398 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
22:29:21.990626 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
22:29:21.990827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:29:21.990969 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:29:21.993417 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
22:29:21.993692 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:29:21.993771 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
22:29:21.994356 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
22:29:21.994484 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:29:21.994548 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
22:29:21.998464 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:29:21.998703 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:29:21.998812 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
22:29:21.999126 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
22:29:22.003102 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:29:22.003346 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
22:29:22.004745 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:29:22.004827 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
22:29:22.003432 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
22:29:22.005973 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:29:22.006054 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
22:29:22.006157 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.007212 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:29:22.007313 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
22:29:22.007632 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.009321 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:29:22.009458 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
22:29:22.009569 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
22:29:22.009690 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:29:22.003518 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
22:29:22.009752 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
22:29:22.009903 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.013998 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:29:22.009974 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.014150 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
22:29:22.014323 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.019631 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:29:22.019721 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
22:29:22.018475 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:29:22.017096 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:29:22.020110 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:29:22.020194 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:29:22.014255 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:29:22.019939 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
22:29:22.020292 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:29:22.020375 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.021680 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:29:22.021799 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.021931 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:29:22.023484 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:29:22.023297 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:29:22.023689 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
22:29:22.022010 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:29:22.023391 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
22:29:22.027928 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:29:22.028089 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.028216 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
22:29:22.029927 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:29:22.030056 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
22:29:22.030815 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:29:22.031722 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:29:22.032095 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
22:29:22.031985 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:29:22.033209 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:29:22.031842 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
22:29:22.034259 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
22:29:22.034409 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
22:29:22.035376 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:29:22.036385 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
22:29:22.036210 [debug] [Thread-2  ]: finished collecting timing info
22:29:22.036545 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
22:29:22.036844 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ededf2af0>]}
22:29:22.037107 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
22:29:22.037424 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:29:22.036281 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:29:22.038080 [debug] [Thread-1  ]: finished collecting timing info
22:29:22.038171 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
22:29:22.038536 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee0dc63a0>]}
22:29:22.038837 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
22:29:22.039085 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:29:22.039823 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
22:29:22.039969 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
22:29:22.040197 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:29:22.040270 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
22:29:22.040348 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
22:29:22.041884 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:29:22.042134 [debug] [Thread-6  ]: finished collecting timing info
22:29:22.035523 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
22:29:22.042247 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
22:29:22.043167 [debug] [Thread-3  ]: finished collecting timing info
22:29:22.044666 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
22:29:22.045153 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:29:22.044911 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
22:29:22.045267 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
22:29:22.044784 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
22:29:22.046036 [debug] [Thread-4  ]: finished collecting timing info
22:29:22.046126 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
22:29:22.046410 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee11b68b0>]}
22:29:22.046646 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.08s]
22:29:22.046896 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:29:22.045392 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:29:22.048969 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edee272b0>]}
22:29:22.049220 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.10s]
22:29:22.049503 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:29:22.049892 [debug] [Thread-8  ]: Began running node model.first_project.customer2
22:29:22.050074 [info ] [Thread-8  ]: 6 of 7 START table model public.customer2 ...................................... [RUN]
22:29:22.050363 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customer2"
22:29:22.050464 [debug] [Thread-8  ]: Began compiling node model.first_project.customer2
22:29:22.050551 [debug] [Thread-8  ]: Compiling model.first_project.customer2
22:29:22.052493 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customer2"
22:29:22.052782 [debug] [Thread-8  ]: finished collecting timing info
22:29:22.052910 [debug] [Thread-8  ]: Began executing node model.first_project.customer2
22:29:22.056353 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customer2"
22:29:22.056516 [debug] [Thread-9  ]: Began running node model.first_project.customers
22:29:22.056727 [info ] [Thread-9  ]: 7 of 7 START view model public.customers ....................................... [RUN]
22:29:22.057057 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
22:29:22.057176 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
22:29:22.057261 [debug] [Thread-9  ]: Compiling model.first_project.customers
22:29:22.060056 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
22:29:22.060490 [debug] [Thread-9  ]: finished collecting timing info
22:29:22.060636 [debug] [Thread-9  ]: Began executing node model.first_project.customers
22:29:22.062104 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers"
22:29:22.062252 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
22:29:22.062396 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:29:22.062478 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
22:29:22.062590 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
22:29:22.062758 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:29:22.063561 [debug] [Thread-9  ]: On model.first_project.customers: BEGIN
22:29:22.063678 [debug] [Thread-8  ]: On model.first_project.customer2: BEGIN
22:29:22.063810 [debug] [Thread-9  ]: Opening a new connection, currently in state init
22:29:22.063921 [debug] [Thread-8  ]: Opening a new connection, currently in state init
22:29:22.065436 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
22:29:22.067020 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:29:22.067108 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
22:29:22.068349 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.069135 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
22:29:22.069225 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:29:22.069285 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
22:29:22.070189 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
22:29:22.071269 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:29:22.071369 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
22:29:22.073174 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
22:29:22.074454 [debug] [Thread-6  ]: finished collecting timing info
22:29:22.075038 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
22:29:22.075717 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edee12190>]}
22:29:22.076080 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
22:29:22.076468 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
22:29:22.077229 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
22:29:22.077442 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
22:29:22.077517 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:29:22.082038 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
22:29:22.083756 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
22:29:22.083897 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
22:29:22.084051 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
22:29:22.084172 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:29:22.084239 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:29:22.084547 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.085341 [debug] [Thread-9  ]: On model.first_project.customers: COMMIT
22:29:22.085431 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
22:29:22.085493 [debug] [Thread-9  ]: On model.first_project.customers: COMMIT
22:29:22.085737 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
22:29:22.087159 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:29:22.087269 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
22:29:22.087378 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
22:29:22.089837 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
22:29:22.089913 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.090020 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
22:29:22.091641 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:29:22.092145 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
22:29:22.092574 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
22:29:22.092783 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
22:29:22.093613 [debug] [Thread-9  ]: finished collecting timing info
22:29:22.094821 [debug] [Thread-9  ]: On model.first_project.customers: Close
22:29:22.095166 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edc53dfd0>]}
22:29:22.095407 [info ] [Thread-9  ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
22:29:22.095658 [debug] [Thread-9  ]: Finished running node model.first_project.customers
22:29:22.094668 [debug] [Thread-8  ]: On model.first_project.customer2: COMMIT
22:29:22.095869 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:29:22.095942 [debug] [Thread-8  ]: On model.first_project.customer2: COMMIT
22:29:22.097725 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
22:29:22.099676 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:29:22.099840 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
22:29:22.100914 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
22:29:22.101743 [debug] [Thread-8  ]: finished collecting timing info
22:29:22.101852 [debug] [Thread-8  ]: On model.first_project.customer2: Close
22:29:22.102193 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f8b3e2-16d7-45ba-88c7-0809fdef91ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edc520400>]}
22:29:22.102415 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.05s]
22:29:22.102656 [debug] [Thread-8  ]: Finished running node model.first_project.customer2
22:29:22.103829 [debug] [MainThread]: Acquiring new postgres connection "master"
22:29:22.103959 [debug] [MainThread]: Using postgres connection "master"
22:29:22.104051 [debug] [MainThread]: On master: BEGIN
22:29:22.104110 [debug] [MainThread]: Opening a new connection, currently in state closed
22:29:22.110607 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:29:22.110843 [debug] [MainThread]: On master: COMMIT
22:29:22.110926 [debug] [MainThread]: Using postgres connection "master"
22:29:22.110990 [debug] [MainThread]: On master: COMMIT
22:29:22.111129 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:29:22.111236 [debug] [MainThread]: On master: Close
22:29:22.111612 [info ] [MainThread]: 
22:29:22.111841 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.23s.
22:29:22.111973 [debug] [MainThread]: Connection 'master' was properly closed.
22:29:22.112030 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
22:29:22.112082 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
22:29:22.112132 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:29:22.112181 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
22:29:22.112231 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:29:22.112281 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:29:22.112331 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:29:22.115543 [info ] [MainThread]: 
22:29:22.115747 [info ] [MainThread]: [32mCompleted successfully[0m
22:29:22.115918 [info ] [MainThread]: 
22:29:22.116045 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
22:29:22.116235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee11b6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8edefcc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ee0842820>]}


============================== 2022-06-10 22:29:26.735978 | adf26017-06de-47f8-b911-9c7db619760f ==============================
22:29:26.735990 [info ] [MainThread]: Running with dbt=1.1.0
22:29:26.736353 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:29:26.736459 [debug] [MainThread]: Tracking: tracking
22:29:26.739047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6104b26f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6104b24a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6104b244c0>]}
22:29:26.757984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:29:26.758804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:29:26.763477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adf26017-06de-47f8-b911-9c7db619760f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61049d10d0>]}
22:29:26.767167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adf26017-06de-47f8-b911-9c7db619760f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6104a94ee0>]}
22:29:26.767409 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:29:26.767616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adf26017-06de-47f8-b911-9c7db619760f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6104b266d0>]}
22:29:26.768727 [info ] [MainThread]: 
22:29:26.769010 [debug] [MainThread]: Acquiring new postgres connection "master"
22:29:26.769722 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:29:26.780558 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:29:26.780746 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:29:26.780884 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:29:26.785753 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:29:26.785894 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:29:26.785984 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:29:26.787299 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:29:26.788486 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:29:26.789476 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:29:26.796292 [debug] [MainThread]: Using postgres connection "master"
22:29:26.796532 [debug] [MainThread]: On master: BEGIN
22:29:26.796614 [debug] [MainThread]: Opening a new connection, currently in state init
22:29:26.800891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:29:26.801091 [debug] [MainThread]: Using postgres connection "master"
22:29:26.801156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:29:26.811171 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:29:26.812234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adf26017-06de-47f8-b911-9c7db619760f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6104b15820>]}
22:29:26.812508 [debug] [MainThread]: On master: ROLLBACK
22:29:26.812720 [debug] [MainThread]: On master: Close
22:29:26.813044 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:29:26.813215 [info ] [MainThread]: 
22:29:26.817252 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:29:26.817496 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:29:26.817590 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:29:26.817669 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:29:26.819269 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:29:26.819508 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:29:26.819737 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:29:26.819817 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:29:26.819885 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:29:26.819995 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:29:26.821793 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:29:26.821877 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:29:26.821981 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:29:26.821547 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:29:26.823041 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:29:26.820153 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
22:29:26.823463 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:29:26.823819 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
22:29:26.825722 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
22:29:26.824029 [debug] [Thread-2  ]: finished collecting timing info
22:29:26.854040 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:29:26.820088 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:29:26.855056 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:29:26.855134 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:29:26.855220 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:29:26.854570 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
22:29:26.855828 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:29:26.856272 [debug] [Thread-4  ]: finished collecting timing info
22:29:26.856377 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:29:26.856473 [debug] [Thread-4  ]: finished collecting timing info
22:29:26.855996 [debug] [Thread-5  ]: finished collecting timing info
22:29:26.856862 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
22:29:26.856695 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:29:26.820238 [debug] [Thread-1  ]: finished collecting timing info
22:29:26.857142 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:29:26.857434 [debug] [Thread-1  ]: finished collecting timing info
22:29:26.856955 [debug] [Thread-5  ]: finished collecting timing info
22:29:26.854796 [debug] [Thread-2  ]: finished collecting timing info
22:29:26.858308 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:29:26.857695 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:29:26.858006 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
22:29:26.853735 [debug] [Thread-3  ]: finished collecting timing info
22:29:26.859741 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
22:29:26.860390 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:29:26.860477 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
22:29:26.860178 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:29:26.860543 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
22:29:26.862170 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:29:26.860019 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:29:26.860648 [debug] [Thread-3  ]: finished collecting timing info
22:29:26.859941 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:29:26.863139 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:29:26.863225 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:29:26.862952 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:29:26.863291 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:29:26.862681 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:29:26.871032 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:29:26.862427 [debug] [Thread-7  ]: finished collecting timing info
22:29:26.871482 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
22:29:26.871117 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:29:26.871231 [debug] [Thread-6  ]: Began running node model.first_project.customer2
22:29:26.871386 [debug] [Thread-4  ]: Began running node model.first_project.customers
22:29:26.871580 [debug] [Thread-7  ]: finished collecting timing info
22:29:26.876420 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
22:29:26.875545 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:29:26.875877 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
22:29:26.876127 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.customers"
22:29:26.870871 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:29:26.876716 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
22:29:26.876832 [debug] [Thread-4  ]: Began compiling node model.first_project.customers
22:29:26.877043 [debug] [Thread-6  ]: Compiling model.first_project.customer2
22:29:26.877181 [debug] [Thread-4  ]: Compiling model.first_project.customers
22:29:26.880566 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.customers"
22:29:26.878893 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
22:29:26.881623 [debug] [Thread-6  ]: finished collecting timing info
22:29:26.877278 [debug] [Thread-9  ]: finished collecting timing info
22:29:26.881882 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:29:26.881974 [debug] [Thread-9  ]: finished collecting timing info
22:29:26.881451 [debug] [Thread-10 ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:29:26.882425 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:29:26.882512 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:29:26.882210 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:29:26.880788 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:29:26.882945 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:29:26.882579 [debug] [Thread-10 ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:29:26.884922 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:29:26.881768 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
22:29:26.883043 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:29:26.885388 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:29:26.885189 [debug] [Thread-10 ]: finished collecting timing info
22:29:26.887385 [debug] [Thread-10 ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:29:26.887468 [debug] [Thread-10 ]: finished collecting timing info
22:29:26.881017 [debug] [Thread-4  ]: finished collecting timing info
22:29:26.887777 [debug] [Thread-4  ]: Began executing node model.first_project.customers
22:29:26.885291 [debug] [Thread-6  ]: finished collecting timing info
22:29:26.888092 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
22:29:26.887668 [debug] [Thread-10 ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:29:26.879102 [debug] [Thread-8  ]: finished collecting timing info
22:29:26.887240 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:29:26.888464 [debug] [Thread-1  ]: finished collecting timing info
22:29:26.888291 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:29:26.888552 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:29:26.888750 [debug] [Thread-1  ]: finished collecting timing info
22:29:26.888653 [debug] [Thread-8  ]: finished collecting timing info
22:29:26.888968 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:29:26.887863 [debug] [Thread-4  ]: finished collecting timing info
22:29:26.889198 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:29:26.889681 [debug] [Thread-4  ]: Finished running node model.first_project.customers
22:29:26.890379 [debug] [Thread-3  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:29:26.890565 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:29:26.890670 [debug] [Thread-3  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:29:26.890826 [debug] [Thread-3  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:29:26.898175 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:29:26.898322 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:29:26.898462 [debug] [Thread-7  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:29:26.899983 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:29:26.900086 [debug] [Thread-7  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:29:26.899680 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:29:26.900152 [debug] [Thread-7  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:29:26.898574 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:29:26.900256 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:29:26.904780 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:29:26.905123 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
22:29:26.905029 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:29:26.907935 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:29:26.908258 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:29:26.908668 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
22:29:26.911079 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:29:26.911225 [debug] [Thread-7  ]: finished collecting timing info
22:29:26.911400 [debug] [Thread-2  ]: finished collecting timing info
22:29:26.911741 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:29:26.911595 [debug] [Thread-7  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:29:26.911831 [debug] [Thread-2  ]: finished collecting timing info
22:29:26.912307 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:29:26.911961 [debug] [Thread-7  ]: finished collecting timing info
22:29:26.912665 [debug] [Thread-7  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:29:26.911479 [debug] [Thread-3  ]: finished collecting timing info
22:29:26.912034 [debug] [Thread-5  ]: finished collecting timing info
22:29:26.912849 [debug] [Thread-3  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:29:26.912949 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:29:26.913047 [debug] [Thread-3  ]: finished collecting timing info
22:29:26.913146 [debug] [Thread-5  ]: finished collecting timing info
22:29:26.913366 [debug] [Thread-3  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:29:26.913588 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:29:26.914554 [debug] [MainThread]: Connection 'master' was properly closed.
22:29:26.914640 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:29:26.914716 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
22:29:26.914789 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
22:29:26.914842 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
22:29:26.914892 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:29:26.914942 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:29:26.914992 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
22:29:26.915041 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
22:29:26.915090 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:29:26.915140 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
22:29:26.917925 [info ] [MainThread]: Done.
22:29:26.920305 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:29:26.920404 [info ] [MainThread]: Building catalog
22:29:26.921609 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:29:26.925778 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:29:26.925925 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:29:26.925993 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:29:26.929817 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:29:26.930034 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:29:26.930106 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:29:26.932470 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
22:29:26.938085 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:29:26.938511 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:29:26.949525 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
22:29:26.949923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6104b26f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61063335b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6104b193d0>]}
22:29:27.539414 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:29:27.539793 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 22:29:32.532895 | 7ce966e2-498d-4d08-b73b-cd39b03570e8 ==============================
22:29:32.532913 [info ] [MainThread]: Running with dbt=1.1.0
22:29:32.533424 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:29:32.533570 [debug] [MainThread]: Tracking: tracking
22:29:32.536494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39756ef3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3976f09f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39756ef160>]}
22:29:32.538163 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:29:32.538419 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:29:32.538584 [info ] [MainThread]: 
22:29:32.538686 [info ] [MainThread]: 
22:29:32.538827 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 22:31:08.430516 | 608d75dd-f532-4c92-8954-d293b298d160 ==============================
22:31:08.430530 [info ] [MainThread]: Running with dbt=1.1.0
22:31:08.431041 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:31:08.431133 [debug] [MainThread]: Tracking: tracking
22:31:08.433569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839f389a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839f38940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839f38b80>]}
22:31:08.458482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:31:08.458994 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
22:31:08.467869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839de70d0>]}
22:31:08.472889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839eadd60>]}
22:31:08.473380 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:31:08.473612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839eaddf0>]}
22:31:08.474906 [info ] [MainThread]: 
22:31:08.475310 [debug] [MainThread]: Acquiring new postgres connection "master"
22:31:08.476700 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
22:31:08.483646 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
22:31:08.483785 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
22:31:08.483852 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:31:08.492130 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:31:08.493295 [debug] [ThreadPool]: On list_erp_oltp: Close
22:31:08.495562 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:31:08.500424 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:31:08.500560 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:31:08.500624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:31:08.507479 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:31:08.507704 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:31:08.507772 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:31:08.509170 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:31:08.510273 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:31:08.510666 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:31:08.538424 [debug] [MainThread]: Using postgres connection "master"
22:31:08.538724 [debug] [MainThread]: On master: BEGIN
22:31:08.538912 [debug] [MainThread]: Opening a new connection, currently in state init
22:31:08.544289 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:31:08.544474 [debug] [MainThread]: Using postgres connection "master"
22:31:08.544575 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:31:08.555441 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:31:08.556585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839e58b50>]}
22:31:08.556895 [debug] [MainThread]: On master: ROLLBACK
22:31:08.557256 [debug] [MainThread]: Using postgres connection "master"
22:31:08.557377 [debug] [MainThread]: On master: BEGIN
22:31:08.557849 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:31:08.557973 [debug] [MainThread]: On master: COMMIT
22:31:08.558045 [debug] [MainThread]: Using postgres connection "master"
22:31:08.558108 [debug] [MainThread]: On master: COMMIT
22:31:08.558367 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:31:08.558495 [debug] [MainThread]: On master: Close
22:31:08.558837 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:31:08.558996 [info ] [MainThread]: 
22:31:08.562975 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:31:08.563229 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
22:31:08.563511 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:31:08.563636 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:31:08.563719 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:31:08.565152 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:31:08.565436 [debug] [Thread-1  ]: finished collecting timing info
22:31:08.565575 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:31:08.573487 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:31:08.573774 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
22:31:08.574155 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:31:08.574263 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:31:08.574342 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:31:08.575915 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:31:08.576185 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:31:08.576384 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
22:31:08.576650 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:31:08.576728 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:31:08.576826 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:31:08.577537 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:31:08.577787 [debug] [Thread-3  ]: finished collecting timing info
22:31:08.577928 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:31:08.583844 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:31:08.584156 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
22:31:08.584468 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:31:08.584580 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:31:08.584726 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:31:08.585489 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:31:08.591046 [debug] [Thread-4  ]: finished collecting timing info
22:31:08.591294 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:31:08.597107 [debug] [Thread-2  ]: finished collecting timing info
22:31:08.597370 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:31:08.600952 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
22:31:08.607164 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
22:31:08.607958 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
22:31:08.610592 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
22:31:08.611336 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:31:08.611799 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
22:31:08.611623 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:31:08.611905 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:31:08.612495 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:31:08.612111 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
22:31:08.612662 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:31:08.612595 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
22:31:08.613010 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:31:08.611476 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:31:08.613548 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
22:31:08.613622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:31:08.616598 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
22:31:08.616750 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:31:08.616928 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
22:31:08.620575 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
22:31:08.620883 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:31:08.620960 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
22:31:08.621339 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
22:31:08.627785 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
22:31:08.630738 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:31:08.631345 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
22:31:08.631262 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
22:31:08.631475 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:31:08.631144 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:31:08.631535 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
22:31:08.631691 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
22:31:08.632211 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.634092 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:31:08.634329 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
22:31:08.636320 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:31:08.634767 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
22:31:08.636431 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
22:31:08.634517 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.636556 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
22:31:08.638073 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:31:08.638635 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
22:31:08.638923 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.638518 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.638276 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:31:08.644753 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
22:31:08.638397 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.644544 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:31:08.645525 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:31:08.645671 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
22:31:08.645916 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:31:08.646135 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:31:08.646278 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.649623 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:31:08.650014 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:31:08.649783 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
22:31:08.651554 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:31:08.651644 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
22:31:08.650107 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:31:08.649860 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
22:31:08.643087 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:31:08.654914 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:31:08.655120 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.655274 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:31:08.658237 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:31:08.657167 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:31:08.655473 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
22:31:08.655359 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:31:08.659354 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:31:08.658476 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
22:31:08.659999 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.660856 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:31:08.661035 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:31:08.661102 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:31:08.660960 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
22:31:08.661753 [debug] [Thread-2  ]: finished collecting timing info
22:31:08.661938 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
22:31:08.662261 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
22:31:08.658365 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
22:31:08.663648 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:31:08.663982 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff838511850>]}
22:31:08.664057 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
22:31:08.666318 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:31:08.666496 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
22:31:08.666436 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:31:08.665376 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
22:31:08.668479 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:31:08.664771 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
22:31:08.669046 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
22:31:08.668191 [debug] [Thread-1  ]: finished collecting timing info
22:31:08.669682 [debug] [Thread-4  ]: finished collecting timing info
22:31:08.670188 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
22:31:08.670048 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
22:31:08.670520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839dcc640>]}
22:31:08.670765 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
22:31:08.671033 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:31:08.671333 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
22:31:08.671495 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
22:31:08.671749 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:31:08.671827 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
22:31:08.671895 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
22:31:08.669933 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
22:31:08.673518 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:31:08.674365 [debug] [Thread-3  ]: finished collecting timing info
22:31:08.674797 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
22:31:08.674578 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839d6f760>]}
22:31:08.675474 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.09s]
22:31:08.675256 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839d72dc0>]}
22:31:08.675000 [debug] [Thread-6  ]: finished collecting timing info
22:31:08.676180 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.10s]
22:31:08.676471 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:31:08.676575 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
22:31:08.676994 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:31:08.680442 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
22:31:08.680893 [debug] [Thread-8  ]: Began running node model.first_project.customer2
22:31:08.681078 [debug] [Thread-9  ]: Began running node model.first_project.customers
22:31:08.683421 [info ] [Thread-9  ]: 7 of 7 START view model public.customers ....................................... [RUN]
22:31:08.683673 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
22:31:08.683748 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
22:31:08.683815 [debug] [Thread-9  ]: Compiling model.first_project.customers
22:31:08.685253 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
22:31:08.685458 [debug] [Thread-9  ]: finished collecting timing info
22:31:08.685540 [debug] [Thread-9  ]: Began executing node model.first_project.customers
22:31:08.681225 [info ] [Thread-8  ]: 6 of 7 START table model public.customer2 ...................................... [RUN]
22:31:08.687207 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customer2"
22:31:08.687285 [debug] [Thread-8  ]: Began compiling node model.first_project.customer2
22:31:08.687348 [debug] [Thread-8  ]: Compiling model.first_project.customer2
22:31:08.686954 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers"
22:31:08.690078 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
22:31:08.689278 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customer2"
22:31:08.690247 [debug] [Thread-9  ]: On model.first_project.customers: BEGIN
22:31:08.690772 [debug] [Thread-9  ]: Opening a new connection, currently in state init
22:31:08.690553 [debug] [Thread-8  ]: finished collecting timing info
22:31:08.691007 [debug] [Thread-8  ]: Began executing node model.first_project.customer2
22:31:08.681451 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:31:08.692536 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customer2"
22:31:08.693222 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
22:31:08.693499 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:31:08.693639 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:31:08.693765 [debug] [Thread-8  ]: On model.first_project.customer2: BEGIN
22:31:08.694075 [debug] [Thread-8  ]: Opening a new connection, currently in state init
22:31:08.698057 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
22:31:08.698255 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
22:31:08.698331 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:31:08.700505 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
22:31:08.702977 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
22:31:08.703192 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
22:31:08.703666 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.704509 [debug] [Thread-9  ]: On model.first_project.customers: COMMIT
22:31:08.704666 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
22:31:08.704812 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
22:31:08.704992 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:31:08.705390 [debug] [Thread-9  ]: On model.first_project.customers: COMMIT
22:31:08.705551 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:31:08.709565 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
22:31:08.711604 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:31:08.711782 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
22:31:08.712039 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
22:31:08.713226 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
22:31:08.713333 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
22:31:08.713553 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:31:08.713615 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
22:31:08.713458 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
22:31:08.713717 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.715236 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:31:08.715332 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
22:31:08.715648 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
22:31:08.716431 [debug] [Thread-9  ]: finished collecting timing info
22:31:08.716520 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
22:31:08.717873 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:31:08.717975 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
22:31:08.716644 [debug] [Thread-9  ]: On model.first_project.customers: Close
22:31:08.718058 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.719612 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8384a15e0>]}
22:31:08.720639 [debug] [Thread-8  ]: On model.first_project.customer2: COMMIT
22:31:08.720819 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:31:08.721168 [info ] [Thread-9  ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
22:31:08.724029 [debug] [Thread-9  ]: Finished running node model.first_project.customers
22:31:08.723438 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
22:31:08.721377 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:31:08.724519 [debug] [Thread-8  ]: On model.first_project.customer2: COMMIT
22:31:08.724323 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:31:08.724820 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
22:31:08.726026 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
22:31:08.727259 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
22:31:08.727430 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
22:31:08.729683 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
22:31:08.729855 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
22:31:08.730843 [debug] [Thread-8  ]: finished collecting timing info
22:31:08.732097 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:31:08.732297 [debug] [Thread-8  ]: On model.first_project.customer2: Close
22:31:08.732409 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
22:31:08.733932 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
22:31:08.734278 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8384a1160>]}
22:31:08.735064 [debug] [Thread-6  ]: finished collecting timing info
22:31:08.735388 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.05s]
22:31:08.735525 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
22:31:08.735911 [debug] [Thread-8  ]: Finished running node model.first_project.customer2
22:31:08.737458 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608d75dd-f532-4c92-8954-d293b298d160', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839d69730>]}
22:31:08.737690 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
22:31:08.738041 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
22:31:08.740667 [debug] [MainThread]: Acquiring new postgres connection "master"
22:31:08.740892 [debug] [MainThread]: Using postgres connection "master"
22:31:08.740960 [debug] [MainThread]: On master: BEGIN
22:31:08.741016 [debug] [MainThread]: Opening a new connection, currently in state closed
22:31:08.744776 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:31:08.744944 [debug] [MainThread]: On master: COMMIT
22:31:08.745010 [debug] [MainThread]: Using postgres connection "master"
22:31:08.745069 [debug] [MainThread]: On master: COMMIT
22:31:08.745200 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:31:08.745291 [debug] [MainThread]: On master: Close
22:31:08.745647 [info ] [MainThread]: 
22:31:08.745809 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.27s.
22:31:08.745912 [debug] [MainThread]: Connection 'master' was properly closed.
22:31:08.745968 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
22:31:08.746020 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
22:31:08.746069 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:31:08.746120 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
22:31:08.746169 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:31:08.746219 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:31:08.746269 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:31:08.749564 [info ] [MainThread]: 
22:31:08.749801 [info ] [MainThread]: [32mCompleted successfully[0m
22:31:08.749981 [info ] [MainThread]: 
22:31:08.750090 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
22:31:08.750313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83bd32a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff839d74be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83c0b1d30>]}


============================== 2022-06-10 22:31:13.387374 | 1cf8d862-6d80-47b4-aa79-09e1c1322753 ==============================
22:31:13.387386 [info ] [MainThread]: Running with dbt=1.1.0
22:31:13.388001 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:31:13.388117 [debug] [MainThread]: Tracking: tracking
22:31:13.399227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff207cc55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2094e0f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff207cc5670>]}
22:31:13.426246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:31:13.426547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:31:13.431004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cf8d862-6d80-47b4-aa79-09e1c1322753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff207b7a0d0>]}
22:31:13.436829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cf8d862-6d80-47b4-aa79-09e1c1322753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff207c3cee0>]}
22:31:13.437066 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:31:13.437273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf8d862-6d80-47b4-aa79-09e1c1322753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff207bc9100>]}
22:31:13.439006 [info ] [MainThread]: 
22:31:13.439554 [debug] [MainThread]: Acquiring new postgres connection "master"
22:31:13.440398 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:31:13.446796 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:31:13.446960 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:31:13.447033 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:31:13.452034 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:31:13.452181 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:31:13.452251 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:31:13.453470 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:31:13.454849 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:31:13.455209 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:31:13.458177 [debug] [MainThread]: Using postgres connection "master"
22:31:13.458313 [debug] [MainThread]: On master: BEGIN
22:31:13.458378 [debug] [MainThread]: Opening a new connection, currently in state init
22:31:13.463577 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:31:13.463759 [debug] [MainThread]: Using postgres connection "master"
22:31:13.463830 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:31:13.475272 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:31:13.476351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf8d862-6d80-47b4-aa79-09e1c1322753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff207cbe460>]}
22:31:13.476562 [debug] [MainThread]: On master: ROLLBACK
22:31:13.476760 [debug] [MainThread]: On master: Close
22:31:13.477134 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:31:13.477299 [info ] [MainThread]: 
22:31:13.479907 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:31:13.480127 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:31:13.480217 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:31:13.480296 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:31:13.481746 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:31:13.482031 [debug] [Thread-1  ]: finished collecting timing info
22:31:13.482169 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:31:13.482256 [debug] [Thread-1  ]: finished collecting timing info
22:31:13.482481 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:31:13.482581 [debug] [Thread-1  ]: Began running node model.first_project.postgres_sample_source_customers
22:31:13.482794 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:31:13.483441 [debug] [Thread-2  ]: Began running node model.first_project.stg_customers
22:31:13.484106 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:31:13.484182 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_customers
22:31:13.484241 [debug] [Thread-2  ]: Compiling model.first_project.stg_customers
22:31:13.484884 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:31:13.485064 [debug] [Thread-2  ]: finished collecting timing info
22:31:13.485163 [debug] [Thread-2  ]: Began executing node model.first_project.stg_customers
22:31:13.485257 [debug] [Thread-2  ]: finished collecting timing info
22:31:13.485445 [debug] [Thread-2  ]: Finished running node model.first_project.stg_customers
22:31:13.483936 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:31:13.485618 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:31:13.485782 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:31:13.485860 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:31:13.483523 [debug] [Thread-3  ]: Began running node model.first_project.stg_orders
22:31:13.520480 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:31:13.520696 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_orders
22:31:13.521097 [debug] [Thread-3  ]: Compiling model.first_project.stg_orders
22:31:13.522768 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:31:13.483873 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:31:13.483653 [debug] [Thread-1  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:31:13.520951 [debug] [Thread-10 ]: Began running node model.first_project.customer2
22:31:13.523627 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customer2"
22:31:13.523718 [debug] [Thread-10 ]: Began compiling node model.first_project.customer2
22:31:13.523782 [debug] [Thread-10 ]: Compiling model.first_project.customer2
22:31:13.523362 [debug] [Thread-1  ]: Compiling model.first_project.postgres_sample_source_customers
22:31:13.483589 [debug] [Thread-4  ]: Began running node seed.first_project.code-country
22:31:13.527022 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:31:13.527113 [debug] [Thread-4  ]: Began compiling node seed.first_project.code-country
22:31:13.527175 [debug] [Thread-4  ]: Compiling seed.first_project.code-country
22:31:13.526705 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:31:13.483748 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
22:31:13.523204 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:31:13.525304 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customer2"
22:31:13.532204 [debug] [Thread-10 ]: finished collecting timing info
22:31:13.532290 [debug] [Thread-10 ]: Began executing node model.first_project.customer2
22:31:13.532358 [debug] [Thread-10 ]: finished collecting timing info
22:31:13.532594 [debug] [Thread-10 ]: Finished running node model.first_project.customer2
22:31:13.527853 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.code-country"
22:31:13.531992 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:31:13.532912 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:31:13.532736 [debug] [Thread-4  ]: finished collecting timing info
22:31:13.540426 [debug] [Thread-4  ]: Began executing node seed.first_project.code-country
22:31:13.540559 [debug] [Thread-4  ]: finished collecting timing info
22:31:13.540847 [debug] [Thread-4  ]: Finished running node seed.first_project.code-country
22:31:13.527952 [debug] [Thread-3  ]: finished collecting timing info
22:31:13.540177 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:31:13.531678 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:31:13.541268 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
22:31:13.541367 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
22:31:13.542638 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:31:13.540963 [debug] [Thread-3  ]: Began executing node model.first_project.stg_orders
22:31:13.543079 [debug] [Thread-3  ]: finished collecting timing info
22:31:13.543432 [debug] [Thread-3  ]: Finished running node model.first_project.stg_orders
22:31:13.531882 [debug] [Thread-1  ]: finished collecting timing info
22:31:13.543554 [debug] [Thread-1  ]: Began executing node model.first_project.postgres_sample_source_customers
22:31:13.542843 [debug] [Thread-7  ]: finished collecting timing info
22:31:13.543626 [debug] [Thread-1  ]: finished collecting timing info
22:31:13.544233 [debug] [Thread-1  ]: Finished running node model.first_project.postgres_sample_source_customers
22:31:13.542946 [debug] [Thread-6  ]: finished collecting timing info
22:31:13.543821 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:31:13.543980 [debug] [Thread-2  ]: Began running node model.first_project.customers
22:31:13.544726 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers"
22:31:13.544807 [debug] [Thread-2  ]: Began compiling node model.first_project.customers
22:31:13.544540 [debug] [Thread-7  ]: finished collecting timing info
22:31:13.544869 [debug] [Thread-2  ]: Compiling model.first_project.customers
22:31:13.546708 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers"
22:31:13.544340 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
22:31:13.546962 [debug] [Thread-6  ]: finished collecting timing info
22:31:13.531358 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:31:13.547272 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
22:31:13.545129 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:31:13.547449 [debug] [Thread-2  ]: finished collecting timing info
22:31:13.550089 [debug] [Thread-2  ]: Began executing node model.first_project.customers
22:31:13.549889 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:31:13.550415 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:31:13.550488 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:31:13.550547 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:31:13.552979 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:31:13.553257 [debug] [Thread-5  ]: finished collecting timing info
22:31:13.553382 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:31:13.553456 [debug] [Thread-5  ]: finished collecting timing info
22:31:13.553673 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:31:13.550173 [debug] [Thread-2  ]: finished collecting timing info
22:31:13.559225 [debug] [Thread-2  ]: Finished running node model.first_project.customers
22:31:13.548152 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:31:13.559657 [debug] [Thread-4  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:31:13.560306 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:31:13.560392 [debug] [Thread-4  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:31:13.560468 [debug] [Thread-4  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:31:13.560096 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:31:13.559805 [debug] [Thread-9  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:31:13.570051 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:31:13.570177 [debug] [Thread-9  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:31:13.569616 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:31:13.574936 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:31:13.559873 [debug] [Thread-1  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:31:13.577557 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:31:13.577671 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:31:13.577740 [debug] [Thread-1  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
22:31:13.577285 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:31:13.559744 [debug] [Thread-3  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:31:13.579624 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:31:13.570250 [debug] [Thread-9  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:31:13.571786 [debug] [Thread-8  ]: finished collecting timing info
22:31:13.588488 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:31:13.588684 [debug] [Thread-8  ]: finished collecting timing info
22:31:13.588990 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:31:13.574696 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:31:13.579887 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:31:13.589530 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:31:13.589748 [debug] [Thread-7  ]: finished collecting timing info
22:31:13.589922 [debug] [Thread-1  ]: finished collecting timing info
22:31:13.590113 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:31:13.590535 [debug] [Thread-3  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
22:31:13.590398 [debug] [Thread-1  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:31:13.592864 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:31:13.590261 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:31:13.593055 [debug] [Thread-4  ]: finished collecting timing info
22:31:13.593502 [debug] [Thread-4  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:31:13.593607 [debug] [Thread-4  ]: finished collecting timing info
22:31:13.593377 [debug] [Thread-7  ]: finished collecting timing info
22:31:13.593168 [debug] [Thread-1  ]: finished collecting timing info
22:31:13.594492 [debug] [Thread-1  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:31:13.593246 [debug] [Thread-9  ]: finished collecting timing info
22:31:13.594104 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:31:13.594181 [debug] [Thread-3  ]: finished collecting timing info
22:31:13.594750 [debug] [Thread-9  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:31:13.595051 [debug] [Thread-9  ]: finished collecting timing info
22:31:13.594946 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:31:13.595317 [debug] [Thread-9  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:31:13.593876 [debug] [Thread-4  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:31:13.595415 [debug] [Thread-3  ]: finished collecting timing info
22:31:13.595735 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:31:13.596785 [debug] [MainThread]: Connection 'master' was properly closed.
22:31:13.596912 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
22:31:13.596967 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:31:13.597016 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
22:31:13.597063 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
22:31:13.597130 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:31:13.597181 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:31:13.597229 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
22:31:13.597275 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:31:13.597322 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
22:31:13.597369 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:31:13.601560 [info ] [MainThread]: Done.
22:31:13.604008 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:31:13.604846 [info ] [MainThread]: Building catalog
22:31:13.608619 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:31:13.612774 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:31:13.612909 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:31:13.613098 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:31:13.618054 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:31:13.618195 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:31:13.618264 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:31:13.623921 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.01 seconds
22:31:13.630000 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:31:13.630334 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:31:13.640989 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
22:31:13.641470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff209564e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff207d18910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff207d18d30>]}
22:31:14.239596 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:31:14.240179 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 22:31:17.816922 | 9a0a62e2-6e0e-484e-befc-477c4e0e92ac ==============================
22:31:17.816935 [info ] [MainThread]: Running with dbt=1.1.0
22:31:17.817365 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:31:17.817471 [debug] [MainThread]: Tracking: tracking
22:31:17.820101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f042b2cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f042bd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f042bd580>]}
22:31:17.823170 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:31:17.823778 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:31:17.824064 [info ] [MainThread]: 
22:31:17.824563 [info ] [MainThread]: 
22:31:17.824702 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 22:33:36.381255 | 65d60556-63c9-4c8d-b3d2-bfdbd5055a9e ==============================
22:33:36.381269 [info ] [MainThread]: Running with dbt=1.1.0
22:33:36.381660 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:33:36.381756 [debug] [MainThread]: Tracking: tracking
22:33:36.384508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbf9b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbf9bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbf9bd60>]}
22:33:36.408227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:33:36.408501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:33:36.413301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbe520d0>]}
22:33:36.420789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbea0e50>]}
22:33:36.421124 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:33:36.421315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbea3040>]}
22:33:36.422439 [info ] [MainThread]: 
22:33:36.422828 [debug] [MainThread]: Acquiring new postgres connection "master"
22:33:36.423695 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
22:33:36.430778 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
22:33:36.430912 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
22:33:36.431019 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:33:36.437682 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:33:36.439311 [debug] [ThreadPool]: On list_erp_oltp: Close
22:33:36.443444 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:33:36.447741 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:33:36.447919 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:33:36.447991 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:33:36.452922 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:33:36.453156 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:33:36.453239 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:33:36.454793 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:33:36.455882 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:33:36.456231 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:33:36.460065 [debug] [MainThread]: Using postgres connection "master"
22:33:36.460187 [debug] [MainThread]: On master: BEGIN
22:33:36.460312 [debug] [MainThread]: Opening a new connection, currently in state init
22:33:36.464767 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:33:36.464900 [debug] [MainThread]: Using postgres connection "master"
22:33:36.464972 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:33:36.476747 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:33:36.477935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbf5df70>]}
22:33:36.478198 [debug] [MainThread]: On master: ROLLBACK
22:33:36.478437 [debug] [MainThread]: Using postgres connection "master"
22:33:36.478538 [debug] [MainThread]: On master: BEGIN
22:33:36.478891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:33:36.479030 [debug] [MainThread]: On master: COMMIT
22:33:36.479102 [debug] [MainThread]: Using postgres connection "master"
22:33:36.479167 [debug] [MainThread]: On master: COMMIT
22:33:36.479296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:33:36.479394 [debug] [MainThread]: On master: Close
22:33:36.479724 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:33:36.479908 [info ] [MainThread]: 
22:33:36.484811 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:33:36.485099 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
22:33:36.485433 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:33:36.485557 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:33:36.485669 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:33:36.487440 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:33:36.487646 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:33:36.487841 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:33:36.488416 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
22:33:36.488169 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
22:33:36.487960 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:33:36.491748 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
22:33:36.492076 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:33:36.492169 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:33:36.492240 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:33:36.489980 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:33:36.493872 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:33:36.493613 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:33:36.489665 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:33:36.494094 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:33:36.491067 [debug] [Thread-1  ]: finished collecting timing info
22:33:36.494477 [debug] [Thread-4  ]: finished collecting timing info
22:33:36.494700 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:33:36.527239 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:33:36.528512 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:33:36.528749 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:33:36.529513 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:33:36.551794 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:33:36.556689 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
22:33:36.557293 [debug] [Thread-3  ]: finished collecting timing info
22:33:36.557495 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:33:36.559010 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
22:33:36.559237 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:33:36.559357 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
22:33:36.559424 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:33:36.559766 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:33:36.559863 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
22:33:36.559924 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:33:36.562208 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
22:33:36.562418 [debug] [Thread-2  ]: finished collecting timing info
22:33:36.562918 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:33:36.564367 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
22:33:36.564714 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:33:36.565161 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
22:33:36.565330 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:33:36.564851 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:33:36.565764 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
22:33:36.566087 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:33:36.566017 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
22:33:36.566223 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:33:36.566283 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
22:33:36.565910 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
22:33:36.566406 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:33:36.566483 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
22:33:36.568211 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
22:33:36.572558 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:33:36.572697 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
22:33:36.573585 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
22:33:36.574917 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:33:36.575006 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
22:33:36.572976 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
22:33:36.575222 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:33:36.575289 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
22:33:36.575113 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.576576 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:33:36.576706 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.576877 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
22:33:36.579498 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:33:36.579841 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
22:33:36.580218 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.581667 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:33:36.586279 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
22:33:36.586072 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:33:36.580399 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
22:33:36.586522 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:33:36.586892 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.587307 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:33:36.589708 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:33:36.589798 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
22:33:36.590148 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:33:36.590261 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
22:33:36.589854 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.591088 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:33:36.591185 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:33:36.590059 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
22:33:36.591249 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:33:36.591358 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
22:33:36.591515 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
22:33:36.594819 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:33:36.596182 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:33:36.596557 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
22:33:36.596295 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.596449 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
22:33:36.597310 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:33:36.597550 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:33:36.597614 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:33:36.597406 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.596354 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
22:33:36.601306 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:33:36.600124 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
22:33:36.601451 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
22:33:36.599985 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:33:36.602560 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
22:33:36.602391 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
22:33:36.602237 [debug] [Thread-4  ]: finished collecting timing info
22:33:36.603693 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:33:36.604141 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
22:33:36.603922 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.604024 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
22:33:36.603846 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
22:33:36.608129 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:33:36.608311 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
22:33:36.610036 [debug] [Thread-3  ]: finished collecting timing info
22:33:36.611244 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
22:33:36.612652 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fd7ba6d0>]}
22:33:36.611120 [debug] [Thread-2  ]: finished collecting timing info
22:33:36.612891 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
22:33:36.613385 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:33:36.610446 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:33:36.613029 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
22:33:36.610336 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbdd8f40>]}
22:33:36.613673 [debug] [Thread-6  ]: Began running node model.first_project.customer2
22:33:36.615347 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
22:33:36.614931 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fb5a6670>]}
22:33:36.615797 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.13s]
22:33:36.615602 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
22:33:36.616135 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
22:33:36.616029 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:33:36.615162 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.12s]
22:33:36.616222 [debug] [Thread-6  ]: Compiling model.first_project.customer2
22:33:36.618503 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
22:33:36.618901 [debug] [Thread-6  ]: finished collecting timing info
22:33:36.619053 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
22:33:36.616526 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:33:36.620641 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
22:33:36.621192 [debug] [Thread-8  ]: Began running node model.first_project.customers
22:33:36.621352 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
22:33:36.621630 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
22:33:36.621712 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
22:33:36.621797 [debug] [Thread-8  ]: Compiling model.first_project.customers
22:33:36.613762 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:33:36.623276 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
22:33:36.623666 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:33:36.623934 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
22:33:36.625768 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:33:36.626058 [debug] [Thread-8  ]: finished collecting timing info
22:33:36.626581 [debug] [Thread-8  ]: Began executing node model.first_project.customers
22:33:36.626747 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:33:36.628296 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
22:33:36.629318 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:33:36.629643 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:33:36.629859 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
22:33:36.629931 [debug] [Thread-8  ]: Opening a new connection, currently in state init
22:33:36.629748 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
22:33:36.631373 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
22:33:36.631491 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:33:36.631576 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:33:36.631978 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:33:36.632822 [debug] [Thread-1  ]: finished collecting timing info
22:33:36.632938 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
22:33:36.633253 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbff2e20>]}
22:33:36.633480 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
22:33:36.633908 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:33:36.634599 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
22:33:36.634802 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
22:33:36.635150 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:33:36.635240 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
22:33:36.635316 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
22:33:36.637006 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:33:36.637183 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
22:33:36.638646 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:33:36.638759 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
22:33:36.639446 [debug] [Thread-10 ]: finished collecting timing info
22:33:36.639590 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
22:33:36.642121 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
22:33:36.642312 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.644245 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:33:36.644347 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
22:33:36.644612 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.645656 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
22:33:36.645751 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:33:36.645867 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
22:33:36.646162 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:33:36.646047 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
22:33:36.646237 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:33:36.645977 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:33:36.646403 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
22:33:36.646470 [debug] [Thread-10 ]: Opening a new connection, currently in state init
22:33:36.647040 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
22:33:36.647944 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:33:36.648032 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
22:33:36.648713 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
22:33:36.650055 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:33:36.650159 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
22:33:36.650257 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
22:33:36.651278 [debug] [Thread-6  ]: finished collecting timing info
22:33:36.651631 [debug] [Thread-6  ]: On model.first_project.customer2: Close
22:33:36.652009 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbe52d60>]}
22:33:36.652149 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.654890 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.04s]
22:33:36.655988 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
22:33:36.656270 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:33:36.656492 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
22:33:36.656585 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
22:33:36.657705 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
22:33:36.657827 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:33:36.657906 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
22:33:36.658081 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
22:33:36.659263 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:33:36.659344 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
22:33:36.659546 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
22:33:36.660257 [debug] [Thread-8  ]: finished collecting timing info
22:33:36.660370 [debug] [Thread-8  ]: On model.first_project.customers: Close
22:33:36.660656 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fb58de80>]}
22:33:36.660906 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
22:33:36.661153 [debug] [Thread-8  ]: Finished running node model.first_project.customers
22:33:36.663297 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.01 seconds
22:33:36.664692 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:33:36.664785 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
22:33:36.665047 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
22:33:36.665784 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
22:33:36.665881 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:33:36.665946 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
22:33:36.667261 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
22:33:36.669124 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:33:36.669305 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
22:33:36.669647 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
22:33:36.670464 [debug] [Thread-10 ]: finished collecting timing info
22:33:36.670588 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
22:33:36.673866 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d60556-63c9-4c8d-b3d2-bfdbd5055a9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbdd1190>]}
22:33:36.674233 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
22:33:36.674565 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
22:33:36.676154 [debug] [MainThread]: Acquiring new postgres connection "master"
22:33:36.676320 [debug] [MainThread]: Using postgres connection "master"
22:33:36.676388 [debug] [MainThread]: On master: BEGIN
22:33:36.676466 [debug] [MainThread]: Opening a new connection, currently in state closed
22:33:36.681276 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:33:36.681446 [debug] [MainThread]: On master: COMMIT
22:33:36.681514 [debug] [MainThread]: Using postgres connection "master"
22:33:36.681573 [debug] [MainThread]: On master: COMMIT
22:33:36.681696 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:33:36.681783 [debug] [MainThread]: On master: Close
22:33:36.682055 [info ] [MainThread]: 
22:33:36.682202 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.26s.
22:33:36.682327 [debug] [MainThread]: Connection 'master' was properly closed.
22:33:36.682388 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
22:33:36.682441 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:33:36.682492 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
22:33:36.682543 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
22:33:36.682594 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:33:36.682644 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:33:36.682694 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:33:36.686707 [info ] [MainThread]: 
22:33:36.687013 [info ] [MainThread]: [32mCompleted successfully[0m
22:33:36.687189 [info ] [MainThread]: 
22:33:36.687358 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
22:33:36.687571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67f852d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fb5aed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67fbde5fd0>]}


============================== 2022-06-10 22:33:40.343407 | e8601d48-7ee8-414d-8311-6f3b5261a8e3 ==============================
22:33:40.343420 [info ] [MainThread]: Running with dbt=1.1.0
22:33:40.343796 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:33:40.344142 [debug] [MainThread]: Tracking: tracking
22:33:40.347296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c36651880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c366503a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c366505b0>]}
22:33:40.349056 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:33:40.349352 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:33:40.349470 [info ] [MainThread]: 
22:33:40.349670 [info ] [MainThread]: 
22:33:40.349874 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 22:34:07.535393 | 4f5f29cc-571f-4bf1-b6d5-504cc72fd182 ==============================
22:34:07.535405 [info ] [MainThread]: Running with dbt=1.1.0
22:34:07.535737 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:34:07.535849 [debug] [MainThread]: Tracking: tracking
22:34:07.538208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418df94610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418df93a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418df936a0>]}
22:34:07.558250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:34:07.558424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:34:07.563443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f5f29cc-571f-4bf1-b6d5-504cc72fd182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418de4b0d0>]}
22:34:07.568903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f5f29cc-571f-4bf1-b6d5-504cc72fd182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418df0feb0>]}
22:34:07.569273 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:34:07.569439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f5f29cc-571f-4bf1-b6d5-504cc72fd182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418df94e80>]}
22:34:07.570760 [info ] [MainThread]: 
22:34:07.571151 [debug] [MainThread]: Acquiring new postgres connection "master"
22:34:07.571986 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:34:07.578030 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:34:07.578134 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:34:07.578206 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:34:07.585512 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:34:07.585725 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:34:07.585801 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:34:07.587361 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:34:07.588402 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:34:07.589475 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:34:07.593521 [debug] [MainThread]: Using postgres connection "master"
22:34:07.593677 [debug] [MainThread]: On master: BEGIN
22:34:07.593740 [debug] [MainThread]: Opening a new connection, currently in state init
22:34:07.597274 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:34:07.597394 [debug] [MainThread]: Using postgres connection "master"
22:34:07.597459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:34:07.608114 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:34:07.609104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f5f29cc-571f-4bf1-b6d5-504cc72fd182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418df93d90>]}
22:34:07.609309 [debug] [MainThread]: On master: ROLLBACK
22:34:07.609500 [debug] [MainThread]: On master: Close
22:34:07.609823 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:34:07.609992 [info ] [MainThread]: 
22:34:07.614685 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:34:07.614897 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:34:07.615147 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:34:07.615703 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:34:07.615795 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:34:07.617663 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:34:07.615585 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:34:07.615290 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:34:07.618317 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:34:07.618398 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:34:07.618000 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:34:07.615350 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
22:34:07.619993 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:34:07.620072 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
22:34:07.620133 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
22:34:07.619739 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:34:07.615227 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:34:07.626208 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:34:07.626388 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:34:07.626466 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:34:07.625758 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:34:07.618486 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:34:07.653444 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:34:07.621006 [debug] [Thread-1  ]: finished collecting timing info
22:34:07.620889 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
22:34:07.653716 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:34:07.654171 [debug] [Thread-1  ]: finished collecting timing info
22:34:07.653932 [debug] [Thread-4  ]: finished collecting timing info
22:34:07.654608 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:34:07.654453 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:34:07.652556 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:34:07.654031 [debug] [Thread-5  ]: finished collecting timing info
22:34:07.655304 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
22:34:07.655397 [debug] [Thread-5  ]: finished collecting timing info
22:34:07.655606 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
22:34:07.654697 [debug] [Thread-4  ]: finished collecting timing info
22:34:07.655841 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:34:07.654971 [debug] [Thread-2  ]: finished collecting timing info
22:34:07.655948 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:34:07.656019 [debug] [Thread-2  ]: finished collecting timing info
22:34:07.656187 [debug] [Thread-3  ]: finished collecting timing info
22:34:07.656504 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:34:07.656697 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
22:34:07.657272 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:34:07.657362 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
22:34:07.657430 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
22:34:07.658640 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:34:07.658869 [debug] [Thread-7  ]: finished collecting timing info
22:34:07.658971 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
22:34:07.659061 [debug] [Thread-7  ]: finished collecting timing info
22:34:07.659243 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
22:34:07.656821 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:34:07.659651 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:34:07.659753 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:34:07.659815 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:34:07.656887 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:34:07.665254 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:34:07.665348 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:34:07.665415 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:34:07.668992 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:34:07.669244 [debug] [Thread-9  ]: finished collecting timing info
22:34:07.669373 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:34:07.669454 [debug] [Thread-9  ]: finished collecting timing info
22:34:07.669671 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:34:07.656970 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:34:07.669789 [debug] [Thread-3  ]: finished collecting timing info
22:34:07.669985 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:34:07.672180 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:34:07.672288 [debug] [Thread-6  ]: Began running node model.first_project.customer2
22:34:07.672571 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
22:34:07.672658 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
22:34:07.672722 [debug] [Thread-6  ]: Compiling model.first_project.customer2
22:34:07.674027 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
22:34:07.672361 [debug] [Thread-1  ]: Began running node model.first_project.customers
22:34:07.674243 [debug] [Thread-5  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:34:07.674869 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:34:07.674573 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
22:34:07.675061 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
22:34:07.675145 [debug] [Thread-1  ]: Compiling model.first_project.customers
22:34:07.674366 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:34:07.676831 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:34:07.676917 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:34:07.676385 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
22:34:07.677190 [debug] [Thread-1  ]: finished collecting timing info
22:34:07.677277 [debug] [Thread-1  ]: Began executing node model.first_project.customers
22:34:07.676981 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:34:07.679338 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:34:07.677365 [debug] [Thread-1  ]: finished collecting timing info
22:34:07.679679 [debug] [Thread-1  ]: Finished running node model.first_project.customers
22:34:07.676546 [debug] [Thread-8  ]: finished collecting timing info
22:34:07.674961 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:34:07.674663 [debug] [Thread-6  ]: finished collecting timing info
22:34:07.681231 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
22:34:07.681334 [debug] [Thread-6  ]: finished collecting timing info
22:34:07.680661 [debug] [Thread-5  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:34:07.680973 [debug] [Thread-7  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:34:07.680911 [debug] [Thread-2  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:34:07.684085 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:34:07.684174 [debug] [Thread-2  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:34:07.684286 [debug] [Thread-2  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:34:07.681541 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
22:34:07.680466 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:34:07.683566 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:34:07.683848 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:34:07.690014 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:34:07.690125 [debug] [Thread-7  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
22:34:07.681087 [debug] [Thread-3  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:34:07.689722 [debug] [Thread-8  ]: finished collecting timing info
22:34:07.692644 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:34:07.680791 [debug] [Thread-4  ]: finished collecting timing info
22:34:07.695188 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:34:07.695266 [debug] [Thread-4  ]: finished collecting timing info
22:34:07.692867 [debug] [Thread-5  ]: finished collecting timing info
22:34:07.695589 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:34:07.695724 [debug] [Thread-5  ]: finished collecting timing info
22:34:07.695436 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:34:07.681030 [debug] [Thread-9  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:34:07.696269 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:34:07.696347 [debug] [Thread-9  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:34:07.695926 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:34:07.694642 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:34:07.696108 [debug] [Thread-7  ]: finished collecting timing info
22:34:07.693157 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:34:07.696408 [debug] [Thread-9  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:34:07.695034 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:34:07.696711 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:34:07.696874 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:34:07.702822 [debug] [Thread-3  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
22:34:07.702262 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:34:07.702610 [debug] [Thread-7  ]: finished collecting timing info
22:34:07.704696 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:34:07.697018 [debug] [Thread-2  ]: finished collecting timing info
22:34:07.705054 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:34:07.705290 [debug] [Thread-9  ]: finished collecting timing info
22:34:07.705515 [debug] [Thread-3  ]: finished collecting timing info
22:34:07.706053 [debug] [Thread-3  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:34:07.706142 [debug] [Thread-3  ]: finished collecting timing info
22:34:07.705885 [debug] [Thread-9  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:34:07.706332 [debug] [Thread-3  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:34:07.705662 [debug] [Thread-2  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:34:07.706492 [debug] [Thread-9  ]: finished collecting timing info
22:34:07.706701 [debug] [Thread-2  ]: finished collecting timing info
22:34:07.707000 [debug] [Thread-9  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:34:07.707279 [debug] [Thread-2  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:34:07.708458 [debug] [MainThread]: Connection 'master' was properly closed.
22:34:07.708558 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:34:07.708630 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
22:34:07.708681 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
22:34:07.708728 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:34:07.708774 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
22:34:07.708819 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
22:34:07.708864 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
22:34:07.708908 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:34:07.708953 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:34:07.711809 [info ] [MainThread]: Done.
22:34:07.713495 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:34:07.713592 [info ] [MainThread]: Building catalog
22:34:07.715066 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:34:07.718919 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:34:07.719014 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:34:07.719073 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:34:07.722783 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:34:07.722895 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:34:07.722957 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:34:07.725531 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
22:34:07.731690 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:34:07.733090 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:34:07.740498 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
22:34:07.740868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418df94610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418fe50b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f418f7ae820>]}
22:34:08.356620 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:34:08.357537 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 22:34:11.583855 | e01df393-7ab9-4890-9482-994148966b78 ==============================
22:34:11.583868 [info ] [MainThread]: Running with dbt=1.1.0
22:34:11.584423 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:34:11.584519 [debug] [MainThread]: Tracking: tracking
22:34:11.586951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96441acb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96441ac940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96441ac9a0>]}
22:34:11.588842 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:34:11.589267 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:34:11.589528 [info ] [MainThread]: 
22:34:11.589973 [info ] [MainThread]: 
22:34:11.590109 [info ] [MainThread]: Press Ctrl+C to exit.
22:34:11.590488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96441ac970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f964419e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f964419e7f0>]}


============================== 2022-06-10 22:34:55.507708 | 0cbb7719-7f82-4689-8a8d-6088d99d939f ==============================
22:34:55.507721 [info ] [MainThread]: Running with dbt=1.1.0
22:34:55.508097 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:34:55.508201 [debug] [MainThread]: Tracking: tracking
22:34:55.515119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21920c8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21920c6a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21920c6a60>]}
22:34:55.534155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:34:55.534419 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:34:55.539582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2191f710d0>]}
22:34:55.543597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2192027ee0>]}
22:34:55.543840 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:34:55.544008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2191fc1100>]}
22:34:55.545513 [info ] [MainThread]: 
22:34:55.545827 [debug] [MainThread]: Acquiring new postgres connection "master"
22:34:55.546707 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
22:34:55.554902 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
22:34:55.555099 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
22:34:55.555178 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:34:55.560995 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:34:55.562121 [debug] [ThreadPool]: On list_erp_oltp: Close
22:34:55.564145 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:34:55.567999 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:34:55.568177 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:34:55.568245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:34:55.572161 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:34:55.572331 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:34:55.572399 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:34:55.573762 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:34:55.574772 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:34:55.574981 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:34:55.578122 [debug] [MainThread]: Using postgres connection "master"
22:34:55.578463 [debug] [MainThread]: On master: BEGIN
22:34:55.578556 [debug] [MainThread]: Opening a new connection, currently in state init
22:34:55.583030 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:34:55.583233 [debug] [MainThread]: Using postgres connection "master"
22:34:55.583305 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:34:55.595621 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:34:55.597095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219207dbb0>]}
22:34:55.597348 [debug] [MainThread]: On master: ROLLBACK
22:34:55.597616 [debug] [MainThread]: Using postgres connection "master"
22:34:55.597737 [debug] [MainThread]: On master: BEGIN
22:34:55.598033 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:34:55.598145 [debug] [MainThread]: On master: COMMIT
22:34:55.598229 [debug] [MainThread]: Using postgres connection "master"
22:34:55.598330 [debug] [MainThread]: On master: COMMIT
22:34:55.599490 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:34:55.599633 [debug] [MainThread]: On master: Close
22:34:55.600049 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:34:55.600327 [info ] [MainThread]: 
22:34:55.603839 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:34:55.604090 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
22:34:55.604544 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:34:55.604672 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:34:55.604760 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:34:55.606351 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:34:55.606664 [debug] [Thread-1  ]: finished collecting timing info
22:34:55.606874 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:34:55.607006 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:34:55.607127 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:34:55.607217 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:34:55.657534 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
22:34:55.657279 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
22:34:55.646827 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
22:34:55.660414 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:34:55.658325 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:34:55.660782 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:34:55.660569 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:34:55.661018 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:34:55.660903 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:34:55.663924 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:34:55.663070 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:34:55.657891 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:34:55.656936 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
22:34:55.664218 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:34:55.664961 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:34:55.664749 [debug] [Thread-3  ]: finished collecting timing info
22:34:55.665863 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:34:55.664633 [debug] [Thread-2  ]: finished collecting timing info
22:34:55.666108 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:34:55.666391 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:34:55.666582 [debug] [Thread-4  ]: finished collecting timing info
22:34:55.677826 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:34:55.677662 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
22:34:55.679539 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:34:55.666777 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:34:55.679406 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
22:34:55.677463 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
22:34:55.683413 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
22:34:55.684010 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:34:55.684159 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:34:55.684350 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
22:34:55.684465 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
22:34:55.684604 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:34:55.684756 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:34:55.684853 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:34:55.686192 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
22:34:55.686404 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:34:55.686597 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:34:55.686653 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
22:34:55.686505 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:34:55.687888 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
22:34:55.692246 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:34:55.692422 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
22:34:55.692895 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.693053 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
22:34:55.695156 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:34:55.696255 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:34:55.696870 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
22:34:55.697155 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
22:34:55.698525 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.706096 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
22:34:55.707570 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:34:55.709363 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:34:55.709603 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
22:34:55.710272 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:34:55.710353 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
22:34:55.710146 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
22:34:55.710774 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.710024 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
22:34:55.712705 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:34:55.712552 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:34:55.712809 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
22:34:55.712903 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
22:34:55.715562 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:34:55.713014 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
22:34:55.715750 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
22:34:55.717512 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:34:55.717766 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
22:34:55.715910 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
22:34:55.717647 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.709864 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:34:55.718658 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:34:55.719495 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.721252 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:34:55.721354 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
22:34:55.719843 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:34:55.719574 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.722833 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:34:55.721502 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:34:55.719681 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:34:55.722960 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.723059 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
22:34:55.724387 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:34:55.724589 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:34:55.724689 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:34:55.724879 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.725676 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:34:55.725800 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:34:55.725873 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:34:55.725978 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
22:34:55.729319 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:34:55.729487 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
22:34:55.729610 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
22:34:55.730956 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:34:55.729781 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
22:34:55.729704 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
22:34:55.733901 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:34:55.732548 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:34:55.734161 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
22:34:55.731085 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
22:34:55.732797 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
22:34:55.735178 [debug] [Thread-4  ]: finished collecting timing info
22:34:55.735327 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
22:34:55.735782 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
22:34:55.736653 [debug] [Thread-3  ]: finished collecting timing info
22:34:55.737099 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21916ccf10>]}
22:34:55.737193 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
22:34:55.734040 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
22:34:55.737394 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
22:34:55.738147 [debug] [Thread-2  ]: finished collecting timing info
22:34:55.739613 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
22:34:55.740033 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21916cc490>]}
22:34:55.740295 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.08s]
22:34:55.740996 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:34:55.738383 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.08s]
22:34:55.741482 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:34:55.742142 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:34:55.742989 [debug] [Thread-1  ]: finished collecting timing info
22:34:55.743278 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2193916b80>]}
22:34:55.743389 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
22:34:55.743651 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.09s]
22:34:55.745326 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2191ef88e0>]}
22:34:55.745579 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.14s]
22:34:55.745779 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:34:55.746120 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:34:55.746472 [debug] [Thread-6  ]: Began running node model.first_project.customer2
22:34:55.746778 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
22:34:55.747063 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
22:34:55.747146 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
22:34:55.747219 [debug] [Thread-6  ]: Compiling model.first_project.customer2
22:34:55.746566 [debug] [Thread-7  ]: Began running node model.first_project.customers
22:34:55.750627 [info ] [Thread-7  ]: 6 of 7 START view model public.customers ....................................... [RUN]
22:34:55.750979 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
22:34:55.751077 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
22:34:55.751151 [debug] [Thread-7  ]: Compiling model.first_project.customers
22:34:55.752849 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
22:34:55.753171 [debug] [Thread-7  ]: finished collecting timing info
22:34:55.753319 [debug] [Thread-7  ]: Began executing node model.first_project.customers
22:34:55.754966 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
22:34:55.755246 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
22:34:55.755361 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
22:34:55.755429 [debug] [Thread-7  ]: Opening a new connection, currently in state init
22:34:55.750419 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
22:34:55.750097 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
22:34:55.756484 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
22:34:55.757333 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:34:55.757500 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
22:34:55.757840 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
22:34:55.759840 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:34:55.760037 [debug] [Thread-6  ]: finished collecting timing info
22:34:55.760362 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
22:34:55.762129 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
22:34:55.762351 [debug] [Thread-9  ]: finished collecting timing info
22:34:55.762950 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
22:34:55.762787 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:34:55.765122 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
22:34:55.765282 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:34:55.764847 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
22:34:55.766849 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:34:55.767002 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
22:34:55.767069 [debug] [Thread-9  ]: Opening a new connection, currently in state init
22:34:55.770408 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
22:34:55.770638 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
22:34:55.770781 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:34:55.772994 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
22:34:55.775713 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
22:34:55.775891 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
22:34:55.776493 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.777668 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
22:34:55.777804 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
22:34:55.777872 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
22:34:55.779928 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
22:34:55.780072 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:34:55.780136 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
22:34:55.781117 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
22:34:55.783271 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:34:55.783453 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
22:34:55.783620 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
22:34:55.784713 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
22:34:55.784879 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
22:34:55.785674 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
22:34:55.786872 [debug] [Thread-7  ]: finished collecting timing info
22:34:55.786995 [debug] [Thread-7  ]: On model.first_project.customers: Close
22:34:55.787318 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219064eac0>]}
22:34:55.787564 [info ] [Thread-7  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
22:34:55.787840 [debug] [Thread-7  ]: Finished running node model.first_project.customers
22:34:55.786039 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.789847 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
22:34:55.789951 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:34:55.790017 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
22:34:55.790228 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
22:34:55.790428 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:34:55.790504 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:34:55.792435 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
22:34:55.793532 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:34:55.793657 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
22:34:55.793903 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
22:34:55.794837 [debug] [Thread-9  ]: finished collecting timing info
22:34:55.794958 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
22:34:55.795271 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2191eef5e0>]}
22:34:55.795504 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
22:34:55.795774 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
22:34:55.798969 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
22:34:55.800855 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:34:55.800993 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
22:34:55.801468 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.806214 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:34:55.806499 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
22:34:55.807139 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:34:55.808186 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
22:34:55.808291 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:34:55.808359 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
22:34:55.810263 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
22:34:55.811533 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:34:55.811643 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
22:34:55.813117 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
22:34:55.813968 [debug] [Thread-6  ]: finished collecting timing info
22:34:55.814102 [debug] [Thread-6  ]: On model.first_project.customer2: Close
22:34:55.815185 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cbb7719-7f82-4689-8a8d-6088d99d939f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2191ef88e0>]}
22:34:55.815773 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.07s]
22:34:55.816276 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
22:34:55.817847 [debug] [MainThread]: Acquiring new postgres connection "master"
22:34:55.818008 [debug] [MainThread]: Using postgres connection "master"
22:34:55.818077 [debug] [MainThread]: On master: BEGIN
22:34:55.818135 [debug] [MainThread]: Opening a new connection, currently in state closed
22:34:55.822495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:34:55.822692 [debug] [MainThread]: On master: COMMIT
22:34:55.822821 [debug] [MainThread]: Using postgres connection "master"
22:34:55.822897 [debug] [MainThread]: On master: COMMIT
22:34:55.823048 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:34:55.823200 [debug] [MainThread]: On master: Close
22:34:55.823581 [info ] [MainThread]: 
22:34:55.823745 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.28s.
22:34:55.823860 [debug] [MainThread]: Connection 'master' was properly closed.
22:34:55.823920 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
22:34:55.823974 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
22:34:55.824027 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:34:55.824081 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
22:34:55.824136 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:34:55.824189 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:34:55.824241 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:34:55.827560 [info ] [MainThread]: 
22:34:55.828101 [info ] [MainThread]: [32mCompleted successfully[0m
22:34:55.832525 [info ] [MainThread]: 
22:34:55.833226 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
22:34:55.834955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2191fc1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2193988df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2191f04160>]}


============================== 2022-06-10 22:34:59.929325 | aff2744b-6493-4143-8371-c861c32d5291 ==============================
22:34:59.929343 [info ] [MainThread]: Running with dbt=1.1.0
22:34:59.929765 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:34:59.929860 [debug] [MainThread]: Tracking: tracking
22:34:59.932192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8739347520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8739352910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8739352700>]}
22:34:59.952381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:34:59.952585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:34:59.959226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aff2744b-6493-4143-8371-c861c32d5291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87391fe0d0>]}
22:34:59.963884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aff2744b-6493-4143-8371-c861c32d5291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873924d040>]}
22:34:59.964175 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:34:59.964330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff2744b-6493-4143-8371-c861c32d5291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87393474f0>]}
22:34:59.965836 [info ] [MainThread]: 
22:34:59.966398 [debug] [MainThread]: Acquiring new postgres connection "master"
22:34:59.967256 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:34:59.974046 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:34:59.974165 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:34:59.974233 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:34:59.981176 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:34:59.981302 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:34:59.981361 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:34:59.982878 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:34:59.984025 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:34:59.984208 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:34:59.987320 [debug] [MainThread]: Using postgres connection "master"
22:34:59.987434 [debug] [MainThread]: On master: BEGIN
22:34:59.987496 [debug] [MainThread]: Opening a new connection, currently in state init
22:34:59.994641 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:34:59.994875 [debug] [MainThread]: Using postgres connection "master"
22:34:59.994948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:35:00.011663 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
22:35:00.012940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff2744b-6493-4143-8371-c861c32d5291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8739352d90>]}
22:35:00.013194 [debug] [MainThread]: On master: ROLLBACK
22:35:00.013504 [debug] [MainThread]: On master: Close
22:35:00.013917 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:35:00.014078 [info ] [MainThread]: 
22:35:00.021184 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:35:00.021550 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:35:00.021676 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:35:00.021766 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:35:00.023814 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:35:00.024209 [debug] [Thread-1  ]: finished collecting timing info
22:35:00.026796 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:35:00.027673 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:35:00.027092 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:35:00.028072 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:35:00.027771 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:35:00.028311 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:35:00.030261 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:35:00.028192 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:35:00.030517 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:35:00.026988 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:35:00.032868 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:35:00.032270 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:35:00.027198 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
22:35:00.033001 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:35:00.033823 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:35:00.033212 [debug] [Thread-2  ]: finished collecting timing info
22:35:00.033437 [debug] [Thread-4  ]: finished collecting timing info
22:35:00.059619 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:35:00.027370 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:35:00.058291 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:35:00.058871 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:35:00.059822 [debug] [Thread-4  ]: finished collecting timing info
22:35:00.060468 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:35:00.059947 [debug] [Thread-1  ]: finished collecting timing info
22:35:00.060065 [debug] [Thread-2  ]: finished collecting timing info
22:35:00.061213 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:35:00.060856 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:35:00.033700 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:35:00.061315 [debug] [Thread-3  ]: finished collecting timing info
22:35:00.061675 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
22:35:00.062247 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:35:00.062332 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
22:35:00.061940 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
22:35:00.062403 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
22:35:00.064160 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:35:00.061837 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:35:00.064928 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:35:00.062510 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
22:35:00.061767 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:35:00.066147 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:35:00.066240 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:35:00.065903 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
22:35:00.065040 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:35:00.066653 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:35:00.066314 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:35:00.078097 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:35:00.066560 [debug] [Thread-7  ]: finished collecting timing info
22:35:00.066427 [debug] [Thread-5  ]: finished collecting timing info
22:35:00.062058 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:35:00.078320 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
22:35:00.079749 [debug] [Thread-7  ]: finished collecting timing info
22:35:00.079428 [debug] [Thread-8  ]: finished collecting timing info
22:35:00.079542 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
22:35:00.080011 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
22:35:00.080232 [debug] [Thread-5  ]: finished collecting timing info
22:35:00.080890 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
22:35:00.080113 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:35:00.079663 [debug] [Thread-3  ]: finished collecting timing info
22:35:00.080543 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:35:00.080653 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:35:00.073068 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:35:00.081101 [debug] [Thread-8  ]: finished collecting timing info
22:35:00.081531 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:35:00.082094 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:35:00.081711 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:35:00.082297 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:35:00.082172 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:35:00.081335 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:35:00.082393 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:35:00.086426 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:35:00.081994 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:35:00.084512 [debug] [Thread-9  ]: finished collecting timing info
22:35:00.084403 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:35:00.086772 [debug] [Thread-1  ]: Began running node model.first_project.customer2
22:35:00.087309 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
22:35:00.086931 [debug] [Thread-4  ]: finished collecting timing info
22:35:00.087385 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
22:35:00.087589 [debug] [Thread-1  ]: Compiling model.first_project.customer2
22:35:00.088867 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
22:35:00.089041 [debug] [Thread-1  ]: finished collecting timing info
22:35:00.089154 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
22:35:00.089259 [debug] [Thread-1  ]: finished collecting timing info
22:35:00.087490 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:35:00.086851 [debug] [Thread-10 ]: Began running node model.first_project.customers
22:35:00.089766 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
22:35:00.089844 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
22:35:00.089579 [debug] [Thread-4  ]: finished collecting timing info
22:35:00.089445 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
22:35:00.089906 [debug] [Thread-10 ]: Compiling model.first_project.customers
22:35:00.087106 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:35:00.091844 [debug] [Thread-9  ]: finished collecting timing info
22:35:00.091687 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
22:35:00.092244 [debug] [Thread-10 ]: finished collecting timing info
22:35:00.090193 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:35:00.092063 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:35:00.092344 [debug] [Thread-10 ]: Began executing node model.first_project.customers
22:35:00.092583 [debug] [Thread-10 ]: finished collecting timing info
22:35:00.092777 [debug] [Thread-10 ]: Finished running node model.first_project.customers
22:35:00.090330 [debug] [Thread-6  ]: finished collecting timing info
22:35:00.092921 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:35:00.093224 [debug] [Thread-6  ]: finished collecting timing info
22:35:00.093347 [debug] [Thread-2  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:35:00.093586 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:35:00.093661 [debug] [Thread-5  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:35:00.093820 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:35:00.094282 [debug] [Thread-2  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:35:00.093974 [debug] [Thread-7  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:35:00.094495 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:35:00.094353 [debug] [Thread-2  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:35:00.093903 [debug] [Thread-3  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:35:00.094568 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:35:00.102864 [debug] [Thread-7  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
22:35:00.102442 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:35:00.105379 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:35:00.094192 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:35:00.105813 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:35:00.105921 [debug] [Thread-5  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
22:35:00.102718 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:35:00.107830 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:35:00.107990 [debug] [Thread-2  ]: finished collecting timing info
22:35:00.108102 [debug] [Thread-7  ]: finished collecting timing info
22:35:00.109902 [debug] [Thread-7  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:35:00.110007 [debug] [Thread-7  ]: finished collecting timing info
22:35:00.109684 [debug] [Thread-5  ]: finished collecting timing info
22:35:00.110218 [debug] [Thread-7  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:35:00.108243 [debug] [Thread-3  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:35:00.110614 [debug] [Thread-3  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:35:00.110373 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:35:00.109428 [debug] [Thread-2  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:35:00.115672 [debug] [Thread-2  ]: finished collecting timing info
22:35:00.115520 [debug] [Thread-5  ]: finished collecting timing info
22:35:00.115903 [debug] [Thread-2  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:35:00.115273 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:35:00.116191 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:35:00.116769 [debug] [Thread-3  ]: finished collecting timing info
22:35:00.116912 [debug] [Thread-3  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:35:00.116987 [debug] [Thread-3  ]: finished collecting timing info
22:35:00.117211 [debug] [Thread-3  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:35:00.118304 [debug] [MainThread]: Connection 'master' was properly closed.
22:35:00.118407 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:35:00.118467 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
22:35:00.118542 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
22:35:00.118594 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:35:00.118644 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
22:35:00.118693 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
22:35:00.118742 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
22:35:00.118834 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
22:35:00.118922 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:35:00.118981 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:35:00.122632 [info ] [MainThread]: Done.
22:35:00.124230 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:35:00.124355 [info ] [MainThread]: Building catalog
22:35:00.125776 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:35:00.130950 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:35:00.131061 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:35:00.131158 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:35:00.140320 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:35:00.140542 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:35:00.140610 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:35:00.142839 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
22:35:00.150668 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:35:00.151092 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:35:00.157431 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
22:35:00.159950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8739347520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87381633d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f873b4c5b20>]}
22:35:00.748152 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:35:00.749094 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 22:35:04.410233 | 77a519dc-ad94-4222-9e51-5c1ad97752b7 ==============================
22:35:04.410250 [info ] [MainThread]: Running with dbt=1.1.0
22:35:04.410781 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:35:04.410894 [debug] [MainThread]: Tracking: tracking
22:35:04.413277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9210c9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9210c9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9210c95e0>]}
22:35:04.414959 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:35:04.415198 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:35:04.415339 [info ] [MainThread]: 
22:35:04.415490 [info ] [MainThread]: 
22:35:04.415631 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 22:49:55.548959 | 8f8527a2-000e-47cc-bd4e-fd9722a1b1c9 ==============================
22:49:55.548970 [info ] [MainThread]: Running with dbt=1.1.0
22:49:55.549351 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:49:55.549451 [debug] [MainThread]: Tracking: tracking
22:49:55.551810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72830a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb728308a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7283084c0>]}
22:49:55.570462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:49:55.570651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:49:55.585695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7281b30d0>]}
22:49:55.589788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb728201ee0>]}
22:49:55.590054 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:49:55.590240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb728204100>]}
22:49:55.592173 [info ] [MainThread]: 
22:49:55.592606 [debug] [MainThread]: Acquiring new postgres connection "master"
22:49:55.593500 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
22:49:55.600394 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
22:49:55.600497 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
22:49:55.600562 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:49:55.607279 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:49:55.608397 [debug] [ThreadPool]: On list_erp_oltp: Close
22:49:55.609659 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:49:55.614105 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:49:55.614253 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:49:55.614320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:49:55.619616 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:49:55.619777 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:49:55.619846 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:49:55.621151 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:49:55.622344 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:49:55.622537 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:49:55.626016 [debug] [MainThread]: Using postgres connection "master"
22:49:55.626225 [debug] [MainThread]: On master: BEGIN
22:49:55.626300 [debug] [MainThread]: Opening a new connection, currently in state init
22:49:55.631759 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:49:55.631918 [debug] [MainThread]: Using postgres connection "master"
22:49:55.632025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:49:55.643139 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:49:55.644187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7282bf190>]}
22:49:55.644416 [debug] [MainThread]: On master: ROLLBACK
22:49:55.644781 [debug] [MainThread]: Using postgres connection "master"
22:49:55.644886 [debug] [MainThread]: On master: BEGIN
22:49:55.645362 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:49:55.645470 [debug] [MainThread]: On master: COMMIT
22:49:55.645537 [debug] [MainThread]: Using postgres connection "master"
22:49:55.645638 [debug] [MainThread]: On master: COMMIT
22:49:55.645868 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:49:55.645977 [debug] [MainThread]: On master: Close
22:49:55.646307 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:49:55.646457 [info ] [MainThread]: 
22:49:55.651452 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:49:55.651657 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
22:49:55.651906 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:49:55.651989 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:49:55.652066 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:49:55.653566 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:49:55.653820 [debug] [Thread-1  ]: finished collecting timing info
22:49:55.653962 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:49:55.659920 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:49:55.660097 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
22:49:55.692779 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:49:55.693143 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:49:55.693248 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:49:55.695337 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:49:55.695614 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:49:55.695836 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
22:49:55.696048 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:49:55.702552 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
22:49:55.696326 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:49:55.702838 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:49:55.703066 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:49:55.709101 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:49:55.710353 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:49:55.708785 [debug] [Thread-2  ]: finished collecting timing info
22:49:55.712717 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:49:55.710173 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:49:55.724964 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:49:55.725534 [debug] [Thread-3  ]: finished collecting timing info
22:49:55.723614 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
22:49:55.726051 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:49:55.725724 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:49:55.709906 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
22:49:55.726170 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
22:49:55.711190 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:49:55.727669 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
22:49:55.728687 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:49:55.728804 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
22:49:55.728431 [debug] [Thread-4  ]: finished collecting timing info
22:49:55.728937 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:49:55.728206 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:49:55.730388 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
22:49:55.728865 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:49:55.727984 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:49:55.730166 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
22:49:55.731165 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:49:55.730473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:49:55.731306 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
22:49:55.731509 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:49:55.735730 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
22:49:55.735877 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:49:55.735941 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
22:49:55.736968 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
22:49:55.737088 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:49:55.737165 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
22:49:55.737269 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
22:49:55.737334 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:49:55.737390 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
22:49:55.738213 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
22:49:55.743106 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:49:55.743361 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
22:49:55.745289 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:49:55.745391 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
22:49:55.743574 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
22:49:55.745966 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
22:49:55.747315 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:49:55.747402 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
22:49:55.747530 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.748568 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:49:55.748665 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
22:49:55.748759 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.749847 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:49:55.749933 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.750028 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
22:49:55.750218 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.756038 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:49:55.756130 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
22:49:55.754904 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:49:55.756263 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
22:49:55.756439 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.757429 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:49:55.757574 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:49:55.757653 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:49:55.750293 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
22:49:55.754696 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:49:55.757816 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
22:49:55.757991 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:49:55.759355 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:49:55.759688 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
22:49:55.759815 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.759559 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:49:55.759988 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.761067 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:49:55.762303 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:49:55.762431 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
22:49:55.765262 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:49:55.762673 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
22:49:55.762550 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:49:55.765603 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:49:55.765471 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
22:49:55.765855 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.768722 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:49:55.768815 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:49:55.768874 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:49:55.765382 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
22:49:55.769913 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:49:55.770017 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
22:49:55.770104 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
22:49:55.771024 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:49:55.771153 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:49:55.772191 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:49:55.771314 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
22:49:55.772946 [debug] [Thread-2  ]: finished collecting timing info
22:49:55.772279 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
22:49:55.771241 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
22:49:55.773078 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
22:49:55.774881 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb729b7a2b0>]}
22:49:55.775132 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
22:49:55.771392 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
22:49:55.775446 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:49:55.776029 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
22:49:55.777587 [debug] [Thread-1  ]: finished collecting timing info
22:49:55.777697 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
22:49:55.777971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb727903460>]}
22:49:55.778168 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
22:49:55.774365 [debug] [Thread-3  ]: finished collecting timing info
22:49:55.779580 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
22:49:55.779696 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
22:49:55.781904 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72a1b5220>]}
22:49:55.780525 [debug] [Thread-4  ]: finished collecting timing info
22:49:55.782096 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.09s]
22:49:55.782454 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:49:55.782218 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
22:49:55.783019 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7281e5190>]}
22:49:55.782757 [debug] [Thread-6  ]: Began running node model.first_project.customer2
22:49:55.783179 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
22:49:55.783392 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
22:49:55.783461 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
22:49:55.783531 [debug] [Thread-6  ]: Compiling model.first_project.customer2
22:49:55.779850 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:49:55.785019 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
22:49:55.785752 [debug] [Thread-6  ]: finished collecting timing info
22:49:55.785884 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
22:49:55.785537 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
22:49:55.789835 [info ] [Thread-8  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
22:49:55.790110 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:49:55.790195 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
22:49:55.790262 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
22:49:55.789649 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
22:49:55.792584 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:49:55.792171 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:49:55.792736 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
22:49:55.792921 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:49:55.793114 [debug] [Thread-8  ]: finished collecting timing info
22:49:55.793218 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
22:49:55.785266 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.08s]
22:49:55.794576 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
22:49:55.795007 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:49:55.795180 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:49:55.795544 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
22:49:55.795625 [debug] [Thread-8  ]: Opening a new connection, currently in state init
22:49:55.795967 [debug] [Thread-10 ]: Began running node model.first_project.customers
22:49:55.796110 [info ] [Thread-10 ]: 7 of 7 START view model public.customers ....................................... [RUN]
22:49:55.796343 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
22:49:55.796420 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
22:49:55.796503 [debug] [Thread-10 ]: Compiling model.first_project.customers
22:49:55.797893 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
22:49:55.798077 [debug] [Thread-10 ]: finished collecting timing info
22:49:55.798201 [debug] [Thread-10 ]: Began executing node model.first_project.customers
22:49:55.800467 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
22:49:55.800672 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
22:49:55.800791 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
22:49:55.800855 [debug] [Thread-10 ]: Opening a new connection, currently in state init
22:49:55.801759 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
22:49:55.801878 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:49:55.801943 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:49:55.804439 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
22:49:55.804559 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:49:55.804642 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
22:49:55.805487 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
22:49:55.809977 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:49:55.810221 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
22:49:55.810582 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
22:49:55.812226 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:49:55.812337 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
22:49:55.812487 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.813303 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
22:49:55.813383 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:49:55.813439 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
22:49:55.815079 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.817189 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:49:55.817409 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
22:49:55.817560 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
22:49:55.819523 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:49:55.819618 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
22:49:55.819706 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.819827 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
22:49:55.820689 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
22:49:55.820821 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
22:49:55.821082 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:49:55.820991 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:49:55.821185 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
22:49:55.822141 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
22:49:55.820894 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
22:49:55.823089 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:49:55.823200 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
22:49:55.826529 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
22:49:55.824993 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
22:49:55.826651 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
22:49:55.824510 [debug] [Thread-8  ]: finished collecting timing info
22:49:55.826903 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
22:49:55.827214 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72a0f8310>]}
22:49:55.827460 [info ] [Thread-8  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
22:49:55.827842 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
22:49:55.830261 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
22:49:55.831043 [debug] [Thread-6  ]: finished collecting timing info
22:49:55.831166 [debug] [Thread-6  ]: On model.first_project.customer2: Close
22:49:55.831248 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
22:49:55.832033 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
22:49:55.832119 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
22:49:55.832180 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
22:49:55.832792 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72a945a00>]}
22:49:55.833199 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
22:49:55.834548 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.05s]
22:49:55.835622 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
22:49:55.837480 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
22:49:55.837708 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
22:49:55.837809 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
22:49:55.839646 [debug] [Thread-10 ]: finished collecting timing info
22:49:55.839782 [debug] [Thread-10 ]: On model.first_project.customers: Close
22:49:55.840109 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f8527a2-000e-47cc-bd4e-fd9722a1b1c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72402d550>]}
22:49:55.840382 [info ] [Thread-10 ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
22:49:55.840707 [debug] [Thread-10 ]: Finished running node model.first_project.customers
22:49:55.843413 [debug] [MainThread]: Acquiring new postgres connection "master"
22:49:55.843612 [debug] [MainThread]: Using postgres connection "master"
22:49:55.843685 [debug] [MainThread]: On master: BEGIN
22:49:55.843740 [debug] [MainThread]: Opening a new connection, currently in state closed
22:49:55.847486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:49:55.847638 [debug] [MainThread]: On master: COMMIT
22:49:55.847699 [debug] [MainThread]: Using postgres connection "master"
22:49:55.847755 [debug] [MainThread]: On master: COMMIT
22:49:55.847923 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:49:55.848016 [debug] [MainThread]: On master: Close
22:49:55.848349 [info ] [MainThread]: 
22:49:55.848559 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.26s.
22:49:55.848692 [debug] [MainThread]: Connection 'master' was properly closed.
22:49:55.848750 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
22:49:55.848802 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
22:49:55.848855 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:49:55.848907 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
22:49:55.848958 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:49:55.849029 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:49:55.849082 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:49:55.852011 [info ] [MainThread]: 
22:49:55.852205 [info ] [MainThread]: [32mCompleted successfully[0m
22:49:55.852364 [info ] [MainThread]: 
22:49:55.852483 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
22:49:55.852663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb728204070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb728201bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb728147460>]}


============================== 2022-06-10 22:50:51.467649 | 508321d5-f23f-41ed-a6f1-33cd0dd1952e ==============================
22:50:51.467667 [info ] [MainThread]: Running with dbt=1.1.0
22:50:51.468071 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:50:51.468208 [debug] [MainThread]: Tracking: tracking
22:50:51.470681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d15a0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d159ea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d159e4c0>]}
22:50:51.493386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:50:51.493579 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:50:51.499161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '508321d5-f23f-41ed-a6f1-33cd0dd1952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d144a0d0>]}
22:50:51.502950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '508321d5-f23f-41ed-a6f1-33cd0dd1952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d1526ee0>]}
22:50:51.503221 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:50:51.503362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '508321d5-f23f-41ed-a6f1-33cd0dd1952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d15a07c0>]}
22:50:51.504486 [info ] [MainThread]: 
22:50:51.504768 [debug] [MainThread]: Acquiring new postgres connection "master"
22:50:51.505659 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:50:51.514720 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:50:51.514957 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:50:51.515036 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:50:51.519863 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:50:51.520012 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:50:51.520092 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:50:51.521356 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:50:51.522683 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:50:51.523125 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:50:51.527972 [debug] [MainThread]: Using postgres connection "master"
22:50:51.528154 [debug] [MainThread]: On master: BEGIN
22:50:51.528229 [debug] [MainThread]: Opening a new connection, currently in state init
22:50:51.532115 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:50:51.532253 [debug] [MainThread]: Using postgres connection "master"
22:50:51.532344 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:50:51.543069 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:50:51.544280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '508321d5-f23f-41ed-a6f1-33cd0dd1952e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d158f820>]}
22:50:51.544536 [debug] [MainThread]: On master: ROLLBACK
22:50:51.544807 [debug] [MainThread]: On master: Close
22:50:51.545170 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:50:51.545377 [info ] [MainThread]: 
22:50:51.549740 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:50:51.549996 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:50:51.550091 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:50:51.550220 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:50:51.551766 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:50:51.551934 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:50:51.552181 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:50:51.552312 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:50:51.552760 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:50:51.552843 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:50:51.552554 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:50:51.552392 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:50:51.553273 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:50:51.553358 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:50:51.552998 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:50:51.552459 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
22:50:51.554941 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:50:51.555055 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
22:50:51.555122 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
22:50:51.554688 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:50:51.552907 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:50:51.553419 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:50:51.590689 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:50:51.556497 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
22:50:51.591069 [debug] [Thread-5  ]: finished collecting timing info
22:50:51.589077 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:50:51.553497 [debug] [Thread-1  ]: finished collecting timing info
22:50:51.557001 [debug] [Thread-2  ]: finished collecting timing info
22:50:51.591707 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:50:51.591407 [debug] [Thread-4  ]: finished collecting timing info
22:50:51.592024 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:50:51.591281 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
22:50:51.591817 [debug] [Thread-3  ]: finished collecting timing info
22:50:51.591925 [debug] [Thread-2  ]: finished collecting timing info
22:50:51.592102 [debug] [Thread-4  ]: finished collecting timing info
22:50:51.592892 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:50:51.592193 [debug] [Thread-5  ]: finished collecting timing info
22:50:51.591566 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:50:51.592611 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:50:51.593172 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
22:50:51.593353 [debug] [Thread-1  ]: finished collecting timing info
22:50:51.593793 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:50:51.592284 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:50:51.594045 [debug] [Thread-3  ]: finished collecting timing info
22:50:51.594131 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
22:50:51.594662 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:50:51.594760 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
22:50:51.594833 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
22:50:51.596145 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:50:51.596361 [debug] [Thread-7  ]: finished collecting timing info
22:50:51.596470 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
22:50:51.596542 [debug] [Thread-7  ]: finished collecting timing info
22:50:51.596756 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
22:50:51.594197 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:51.597105 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:50:51.597287 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:51.597365 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:51.594255 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:51.604999 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:50:51.604679 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:50:51.605136 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:51.605879 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:51.605251 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:51.611777 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:50:51.611882 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:51.611953 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:51.611402 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:50:51.613925 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:50:51.605345 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:51.614266 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:50:51.614354 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:51.614481 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:51.614619 [debug] [Thread-9  ]: finished collecting timing info
22:50:51.616601 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:50:51.616988 [debug] [Thread-4  ]: finished collecting timing info
22:50:51.617086 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:51.616760 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:51.617198 [debug] [Thread-4  ]: finished collecting timing info
22:50:51.617723 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:51.605782 [debug] [Thread-8  ]: finished collecting timing info
22:50:51.617378 [debug] [Thread-9  ]: finished collecting timing info
22:50:51.617493 [debug] [Thread-6  ]: finished collecting timing info
22:50:51.618248 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:51.618341 [debug] [Thread-6  ]: finished collecting timing info
22:50:51.618142 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:51.618542 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:51.594489 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:50:51.617904 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:51.619758 [debug] [Thread-5  ]: Began running node model.first_project.customer2
22:50:51.619850 [debug] [Thread-1  ]: Began running node model.first_project.customers
22:50:51.620274 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
22:50:51.620087 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customer2"
22:50:51.620357 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
22:50:51.620531 [debug] [Thread-1  ]: Compiling model.first_project.customers
22:50:51.620443 [debug] [Thread-5  ]: Began compiling node model.first_project.customer2
22:50:51.621842 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
22:50:51.622201 [debug] [Thread-1  ]: finished collecting timing info
22:50:51.621981 [debug] [Thread-5  ]: Compiling model.first_project.customer2
22:50:51.622360 [debug] [Thread-1  ]: Began executing node model.first_project.customers
22:50:51.624042 [debug] [Thread-1  ]: finished collecting timing info
22:50:51.623877 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customer2"
22:50:51.624296 [debug] [Thread-1  ]: Finished running node model.first_project.customers
22:50:51.619929 [debug] [Thread-8  ]: finished collecting timing info
22:50:51.624708 [debug] [Thread-7  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:50:51.625353 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:50:51.625034 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:50:51.625482 [debug] [Thread-7  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:50:51.625950 [debug] [Thread-7  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:50:51.625555 [debug] [Thread-4  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:51.632552 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:50:51.625793 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:50:51.633722 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:50:51.633784 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
22:50:51.625622 [debug] [Thread-5  ]: finished collecting timing info
22:50:51.636466 [debug] [Thread-5  ]: Began executing node model.first_project.customer2
22:50:51.636587 [debug] [Thread-5  ]: finished collecting timing info
22:50:51.636888 [debug] [Thread-5  ]: Finished running node model.first_project.customer2
22:50:51.633488 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:50:51.636290 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:50:51.633635 [debug] [Thread-4  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:51.637183 [debug] [Thread-4  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:51.624924 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:51.625869 [debug] [Thread-9  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:50:51.642360 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:50:51.641972 [debug] [Thread-2  ]: finished collecting timing info
22:50:51.641743 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:50:51.642483 [debug] [Thread-7  ]: finished collecting timing info
22:50:51.642586 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:50:51.642748 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:50:51.643140 [debug] [Thread-2  ]: finished collecting timing info
22:50:51.643020 [debug] [Thread-9  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
22:50:51.642916 [debug] [Thread-7  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:50:51.643236 [debug] [Thread-4  ]: finished collecting timing info
22:50:51.643556 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:50:51.646173 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:50:51.646325 [debug] [Thread-7  ]: finished collecting timing info
22:50:51.646441 [debug] [Thread-4  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:51.646990 [debug] [Thread-7  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:50:51.647192 [debug] [Thread-4  ]: finished collecting timing info
22:50:51.647585 [debug] [Thread-4  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:51.647705 [debug] [Thread-9  ]: finished collecting timing info
22:50:51.647810 [debug] [Thread-9  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:50:51.647879 [debug] [Thread-9  ]: finished collecting timing info
22:50:51.648126 [debug] [Thread-9  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:50:51.649780 [debug] [MainThread]: Connection 'master' was properly closed.
22:50:51.649865 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:50:51.649921 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
22:50:51.649972 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:50:51.650022 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:50:51.650073 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:50:51.650123 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
22:50:51.650173 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
22:50:51.650222 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
22:50:51.650271 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:50:51.653111 [info ] [MainThread]: Done.
22:50:51.654854 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:50:51.654978 [info ] [MainThread]: Building catalog
22:50:51.656859 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:50:51.661279 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:50:51.661534 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:50:51.661623 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:50:51.665478 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
22:50:51.665637 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:50:51.665707 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:50:51.671256 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.01 seconds
22:50:51.677828 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:50:51.678172 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:50:51.686406 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
22:50:51.686842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d15a0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d3392f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d3392880>]}
22:50:52.276200 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:50:52.276573 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 22:50:56.668711 | 9acf832a-3aad-42ca-9ab6-2eba98883ddc ==============================
22:50:56.668725 [info ] [MainThread]: Running with dbt=1.1.0
22:50:56.669041 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:50:56.669124 [debug] [MainThread]: Tracking: tracking
22:50:56.671579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff2790cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff279b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcff279b580>]}
22:50:56.673771 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:50:56.674994 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:50:56.675217 [info ] [MainThread]: 
22:50:56.675427 [info ] [MainThread]: 
22:50:56.675618 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 22:57:02.952114 | 83dd814f-fc2b-44d2-b013-cf0ac9830efd ==============================
22:57:02.952127 [info ] [MainThread]: Running with dbt=1.1.0
22:57:02.952590 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:57:02.952678 [debug] [MainThread]: Tracking: tracking
22:57:02.954970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71470543a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714886df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7147054160>]}
22:57:02.973095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:57:02.973474 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
22:57:02.982220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7146f040d0>]}
22:57:02.986984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7146f55dc0>]}
22:57:02.987328 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:57:02.987512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714886df40>]}
22:57:02.988752 [info ] [MainThread]: 
22:57:02.989123 [debug] [MainThread]: Acquiring new postgres connection "master"
22:57:02.989889 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
22:57:02.996061 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
22:57:02.996469 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
22:57:02.996610 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:57:03.002133 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
22:57:03.003031 [debug] [ThreadPool]: On list_erp_oltp: Close
22:57:03.004113 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:57:03.007813 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:57:03.007913 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:57:03.007976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
22:57:03.013501 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:57:03.013712 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:57:03.013796 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:57:03.015183 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:57:03.016259 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:57:03.016464 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:57:03.043283 [debug] [MainThread]: Using postgres connection "master"
22:57:03.043439 [debug] [MainThread]: On master: BEGIN
22:57:03.043496 [debug] [MainThread]: Opening a new connection, currently in state init
22:57:03.048370 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:57:03.048566 [debug] [MainThread]: Using postgres connection "master"
22:57:03.048648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:57:03.058540 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:57:03.059490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7148913a00>]}
22:57:03.059683 [debug] [MainThread]: On master: ROLLBACK
22:57:03.059993 [debug] [MainThread]: Using postgres connection "master"
22:57:03.060089 [debug] [MainThread]: On master: BEGIN
22:57:03.060465 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:57:03.060563 [debug] [MainThread]: On master: COMMIT
22:57:03.060630 [debug] [MainThread]: Using postgres connection "master"
22:57:03.060699 [debug] [MainThread]: On master: COMMIT
22:57:03.060955 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:57:03.061061 [debug] [MainThread]: On master: Close
22:57:03.061324 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:57:03.061477 [info ] [MainThread]: 
22:57:03.066305 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:57:03.066507 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
22:57:03.066845 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:57:03.066963 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:57:03.067072 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:57:03.067466 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:57:03.068901 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:57:03.067348 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
22:57:03.069258 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:57:03.069330 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:57:03.069393 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:57:03.067207 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:57:03.070842 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
22:57:03.070635 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:57:03.067145 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:57:03.071282 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
22:57:03.071568 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:57:03.071632 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:57:03.071688 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:57:03.071857 [debug] [Thread-2  ]: finished collecting timing info
22:57:03.071072 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:57:03.073713 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:57:03.073825 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:57:03.073480 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:57:03.074398 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:57:03.073257 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:57:03.089894 [debug] [Thread-3  ]: finished collecting timing info
22:57:03.090026 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:57:03.089618 [debug] [Thread-4  ]: finished collecting timing info
22:57:03.093126 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:57:03.089220 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
22:57:03.092906 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
22:57:03.073349 [debug] [Thread-1  ]: finished collecting timing info
22:57:03.094703 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
22:57:03.095150 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:57:03.100998 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:57:03.101186 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
22:57:03.101254 [debug] [Thread-3  ]: Opening a new connection, currently in state init
22:57:03.101522 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:57:03.101696 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
22:57:03.101760 [debug] [Thread-2  ]: Opening a new connection, currently in state init
22:57:03.101943 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:57:03.102046 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
22:57:03.102102 [debug] [Thread-4  ]: Opening a new connection, currently in state init
22:57:03.111807 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
22:57:03.112456 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:57:03.112674 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
22:57:03.112877 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
22:57:03.113342 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:57:03.113433 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
22:57:03.113204 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:57:03.112989 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
22:57:03.113664 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:57:03.113556 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
22:57:03.113096 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
22:57:03.113730 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
22:57:03.113944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
22:57:03.116711 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
22:57:03.121887 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:57:03.122464 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
22:57:03.122355 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
22:57:03.122065 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
22:57:03.125365 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:57:03.124115 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:57:03.125459 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
22:57:03.126070 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.125558 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
22:57:03.125637 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.127182 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:57:03.128481 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
22:57:03.122580 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
22:57:03.128619 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:57:03.128702 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
22:57:03.128335 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:57:03.129566 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
22:57:03.129941 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.130059 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.131483 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:57:03.135527 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
22:57:03.131649 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
22:57:03.136694 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:57:03.131570 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.137517 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:57:03.136787 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
22:57:03.136859 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.138276 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:57:03.138370 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:57:03.139455 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
22:57:03.135376 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:57:03.138445 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.139615 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:57:03.141191 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
22:57:03.140972 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:57:03.141114 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
22:57:03.144114 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
22:57:03.141429 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
22:57:03.144231 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
22:57:03.145145 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
22:57:03.144330 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
22:57:03.137623 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:57:03.146170 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
22:57:03.145334 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.145247 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
22:57:03.149494 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:57:03.149685 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
22:57:03.149782 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
22:57:03.150603 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:57:03.152773 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
22:57:03.152579 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
22:57:03.152894 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
22:57:03.151474 [debug] [Thread-3  ]: finished collecting timing info
22:57:03.153058 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
22:57:03.153380 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714922e370>]}
22:57:03.153691 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.08s]
22:57:03.152672 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
22:57:03.154110 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:57:03.154212 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
22:57:03.155266 [debug] [Thread-2  ]: finished collecting timing info
22:57:03.155681 [debug] [Thread-6  ]: Began running node model.first_project.customer2
22:57:03.157109 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
22:57:03.156862 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
22:57:03.156703 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
22:57:03.157353 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
22:57:03.158666 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
22:57:03.158763 [debug] [Thread-6  ]: Compiling model.first_project.customer2
22:57:03.156944 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
22:57:03.160964 [debug] [Thread-4  ]: finished collecting timing info
22:57:03.160246 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
22:57:03.161353 [debug] [Thread-6  ]: finished collecting timing info
22:57:03.157636 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71492367c0>]}
22:57:03.161667 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
22:57:03.161455 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
22:57:03.158566 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
22:57:03.161881 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:57:03.161078 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
22:57:03.164603 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71445c6af0>]}
22:57:03.166144 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.09s]
22:57:03.167320 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:57:03.167659 [debug] [Thread-8  ]: Began running node model.first_project.customers
22:57:03.167864 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
22:57:03.168166 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
22:57:03.168248 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
22:57:03.168398 [debug] [Thread-8  ]: Compiling model.first_project.customers
22:57:03.170120 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
22:57:03.170556 [debug] [Thread-8  ]: finished collecting timing info
22:57:03.170690 [debug] [Thread-8  ]: Began executing node model.first_project.customers
22:57:03.164121 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
22:57:03.172422 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:57:03.172131 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
22:57:03.172536 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
22:57:03.172772 [debug] [Thread-6  ]: Opening a new connection, currently in state init
22:57:03.173777 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:57:03.173897 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
22:57:03.173987 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
22:57:03.174919 [debug] [Thread-1  ]: finished collecting timing info
22:57:03.175090 [debug] [Thread-8  ]: Opening a new connection, currently in state init
22:57:03.175221 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
22:57:03.175664 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7146ea3490>]}
22:57:03.175882 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
22:57:03.176105 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:57:03.176376 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
22:57:03.176532 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
22:57:03.176764 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:57:03.176835 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
22:57:03.176901 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
22:57:03.178266 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:57:03.178489 [debug] [Thread-10 ]: finished collecting timing info
22:57:03.178756 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
22:57:03.180410 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
22:57:03.180771 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
22:57:03.184203 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:57:03.184334 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:57:03.185361 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:57:03.185497 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
22:57:03.185564 [debug] [Thread-10 ]: Opening a new connection, currently in state init
22:57:03.186695 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
22:57:03.188415 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:57:03.188510 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
22:57:03.189640 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.191220 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:57:03.191323 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
22:57:03.191569 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.192377 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
22:57:03.192465 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:57:03.192523 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
22:57:03.192882 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
22:57:03.192989 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:57:03.193066 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
22:57:03.193915 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
22:57:03.194940 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
22:57:03.195081 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
22:57:03.195253 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
22:57:03.199388 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:57:03.199588 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
22:57:03.199812 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
22:57:03.200705 [debug] [Thread-6  ]: finished collecting timing info
22:57:03.200931 [debug] [Thread-6  ]: On model.first_project.customer2: Close
22:57:03.201306 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7146eae880>]}
22:57:03.201474 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.202892 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.04s]
22:57:03.203765 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
22:57:03.204147 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:57:03.204231 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
22:57:03.204417 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
22:57:03.205303 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
22:57:03.205413 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:57:03.205491 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
22:57:03.206372 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
22:57:03.207821 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:57:03.207910 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
22:57:03.208004 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
22:57:03.209869 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
22:57:03.209961 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
22:57:03.210153 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
22:57:03.210758 [debug] [Thread-8  ]: finished collecting timing info
22:57:03.210903 [debug] [Thread-8  ]: On model.first_project.customers: Close
22:57:03.210989 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
22:57:03.211686 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
22:57:03.211772 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:57:03.211832 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
22:57:03.212730 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71445b87f0>]}
22:57:03.213263 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
22:57:03.213932 [debug] [Thread-8  ]: Finished running node model.first_project.customers
22:57:03.217217 [debug] [Thread-10 ]: SQL status: COMMIT in 0.01 seconds
22:57:03.218668 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
22:57:03.218828 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
22:57:03.219113 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
22:57:03.219807 [debug] [Thread-10 ]: finished collecting timing info
22:57:03.219923 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
22:57:03.220217 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83dd814f-fc2b-44d2-b013-cf0ac9830efd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71445ff5b0>]}
22:57:03.220508 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
22:57:03.220804 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
22:57:03.221970 [debug] [MainThread]: Acquiring new postgres connection "master"
22:57:03.222081 [debug] [MainThread]: Using postgres connection "master"
22:57:03.222144 [debug] [MainThread]: On master: BEGIN
22:57:03.222198 [debug] [MainThread]: Opening a new connection, currently in state closed
22:57:03.225641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:57:03.225753 [debug] [MainThread]: On master: COMMIT
22:57:03.225814 [debug] [MainThread]: Using postgres connection "master"
22:57:03.225869 [debug] [MainThread]: On master: COMMIT
22:57:03.226027 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
22:57:03.226114 [debug] [MainThread]: On master: Close
22:57:03.226388 [info ] [MainThread]: 
22:57:03.226519 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.24s.
22:57:03.226618 [debug] [MainThread]: Connection 'master' was properly closed.
22:57:03.226668 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
22:57:03.226719 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
22:57:03.226828 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
22:57:03.226879 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:57:03.226930 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
22:57:03.226980 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:57:03.227029 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:57:03.232515 [info ] [MainThread]: 
22:57:03.232850 [info ] [MainThread]: [32mCompleted successfully[0m
22:57:03.233033 [info ] [MainThread]: 
22:57:03.233150 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
22:57:03.233347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7146ed0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714704c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7148e43820>]}


============================== 2022-06-10 22:57:08.950117 | 07f139ad-fbdf-4ab4-bb13-918b69a1d2c3 ==============================
22:57:08.950145 [info ] [MainThread]: Running with dbt=1.1.0
22:57:08.950560 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:57:08.950664 [debug] [MainThread]: Tracking: tracking
22:57:08.953120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41b509610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41b509d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41b5089a0>]}
22:57:08.971676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
22:57:08.971857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
22:57:08.975948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07f139ad-fbdf-4ab4-bb13-918b69a1d2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41b3c30d0>]}
22:57:08.981938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07f139ad-fbdf-4ab4-bb13-918b69a1d2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41b486eb0>]}
22:57:08.982236 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:57:08.982411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f139ad-fbdf-4ab4-bb13-918b69a1d2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41b4110d0>]}
22:57:08.983683 [info ] [MainThread]: 
22:57:08.984070 [debug] [MainThread]: Acquiring new postgres connection "master"
22:57:08.984899 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:57:08.991885 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:57:08.991985 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:57:08.992050 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:57:08.998259 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:57:08.998592 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:57:08.998675 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:57:08.999919 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
22:57:09.000959 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:57:09.001109 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:57:09.004110 [debug] [MainThread]: Using postgres connection "master"
22:57:09.004221 [debug] [MainThread]: On master: BEGIN
22:57:09.004288 [debug] [MainThread]: Opening a new connection, currently in state init
22:57:09.010003 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:57:09.010165 [debug] [MainThread]: Using postgres connection "master"
22:57:09.010263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:57:09.020674 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
22:57:09.021694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f139ad-fbdf-4ab4-bb13-918b69a1d2c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd41b508520>]}
22:57:09.021917 [debug] [MainThread]: On master: ROLLBACK
22:57:09.022215 [debug] [MainThread]: On master: Close
22:57:09.022605 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:57:09.022848 [info ] [MainThread]: 
22:57:09.027361 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:57:09.027602 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:57:09.027692 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:57:09.027814 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:57:09.029747 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:57:09.030155 [debug] [Thread-1  ]: finished collecting timing info
22:57:09.030300 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:57:09.030390 [debug] [Thread-1  ]: finished collecting timing info
22:57:09.030695 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:57:09.030850 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:57:09.031250 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:57:09.031329 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:57:09.031395 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:57:09.032793 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:57:09.033015 [debug] [Thread-2  ]: finished collecting timing info
22:57:09.033105 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:57:09.033172 [debug] [Thread-2  ]: finished collecting timing info
22:57:09.033362 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:57:09.030979 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:57:09.033711 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:57:09.033864 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:57:09.033941 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:57:09.030919 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:57:09.035271 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:57:09.035043 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:57:09.031041 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
22:57:09.035824 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:57:09.036160 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
22:57:09.035938 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
22:57:09.036546 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:57:09.036626 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
22:57:09.035348 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:57:09.036246 [debug] [Thread-4  ]: finished collecting timing info
22:57:09.036360 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
22:57:09.036688 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
22:57:09.071838 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:57:09.036028 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:57:09.036769 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:57:09.036860 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:57:09.069910 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
22:57:09.036093 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:57:09.073761 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:57:09.072846 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:57:09.073087 [debug] [Thread-4  ]: finished collecting timing info
22:57:09.074267 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:57:09.073256 [debug] [Thread-7  ]: finished collecting timing info
22:57:09.073854 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:57:09.074482 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:57:09.073466 [debug] [Thread-5  ]: finished collecting timing info
22:57:09.072112 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:57:09.080820 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:57:09.074630 [debug] [Thread-3  ]: finished collecting timing info
22:57:09.081467 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:57:09.081591 [debug] [Thread-3  ]: finished collecting timing info
22:57:09.080917 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:57:09.081235 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:57:09.074398 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
22:57:09.081850 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:57:09.080601 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
22:57:09.086907 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:57:09.087271 [debug] [Thread-7  ]: finished collecting timing info
22:57:09.087603 [debug] [Thread-5  ]: finished collecting timing info
22:57:09.087787 [debug] [Thread-6  ]: Began running node model.first_project.customer2
22:57:09.089870 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
22:57:09.089980 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
22:57:09.090072 [debug] [Thread-6  ]: Compiling model.first_project.customer2
22:57:09.088343 [debug] [Thread-9  ]: finished collecting timing info
22:57:09.089616 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
22:57:09.087930 [debug] [Thread-2  ]: Began running node model.first_project.customers
22:57:09.091927 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers"
22:57:09.092036 [debug] [Thread-2  ]: Began compiling node model.first_project.customers
22:57:09.092101 [debug] [Thread-2  ]: Compiling model.first_project.customers
22:57:09.091471 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
22:57:09.093602 [debug] [Thread-6  ]: finished collecting timing info
22:57:09.093700 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
22:57:09.088177 [debug] [Thread-8  ]: finished collecting timing info
22:57:09.093930 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:57:09.094060 [debug] [Thread-8  ]: finished collecting timing info
22:57:09.093769 [debug] [Thread-6  ]: finished collecting timing info
22:57:09.094547 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
22:57:09.088687 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
22:57:09.093289 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers"
22:57:09.091688 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:57:09.094271 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:57:09.095008 [debug] [Thread-10 ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:57:09.095737 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:57:09.095296 [debug] [Thread-9  ]: finished collecting timing info
22:57:09.095415 [debug] [Thread-2  ]: finished collecting timing info
22:57:09.095825 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:57:09.096261 [debug] [Thread-10 ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:57:09.096074 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:57:09.098231 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:57:09.098600 [debug] [Thread-10 ]: finished collecting timing info
22:57:09.098742 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:57:09.098821 [debug] [Thread-10 ]: finished collecting timing info
22:57:09.099022 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:57:09.095102 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:57:09.099187 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:57:09.099254 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:57:09.099309 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:57:09.101118 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:57:09.096183 [debug] [Thread-2  ]: Began executing node model.first_project.customers
22:57:09.101459 [debug] [Thread-2  ]: finished collecting timing info
22:57:09.101655 [debug] [Thread-2  ]: Finished running node model.first_project.customers
22:57:09.101363 [debug] [Thread-4  ]: finished collecting timing info
22:57:09.101906 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:57:09.102172 [debug] [Thread-4  ]: finished collecting timing info
22:57:09.102083 [debug] [Thread-5  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:57:09.101991 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:57:09.102949 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:57:09.103042 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:57:09.103107 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:57:09.102658 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:57:09.102360 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:57:09.102435 [debug] [Thread-6  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:57:09.110221 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:57:09.109821 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:57:09.109967 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:57:09.110439 [debug] [Thread-5  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
22:57:09.102491 [debug] [Thread-7  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:57:09.112319 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:57:09.110305 [debug] [Thread-6  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:57:09.112572 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:57:09.112816 [debug] [Thread-6  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:57:09.112939 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:57:09.117861 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:57:09.118027 [debug] [Thread-7  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
22:57:09.120074 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
22:57:09.118156 [debug] [Thread-5  ]: finished collecting timing info
22:57:09.120563 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:57:09.120648 [debug] [Thread-5  ]: finished collecting timing info
22:57:09.120413 [debug] [Thread-6  ]: finished collecting timing info
22:57:09.120854 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:57:09.120322 [debug] [Thread-7  ]: finished collecting timing info
22:57:09.121144 [debug] [Thread-7  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:57:09.120956 [debug] [Thread-6  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:57:09.121231 [debug] [Thread-7  ]: finished collecting timing info
22:57:09.121550 [debug] [Thread-7  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
22:57:09.121334 [debug] [Thread-6  ]: finished collecting timing info
22:57:09.118214 [debug] [Thread-1  ]: finished collecting timing info
22:57:09.121840 [debug] [Thread-6  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:57:09.121936 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:57:09.122125 [debug] [Thread-1  ]: finished collecting timing info
22:57:09.122313 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:57:09.123259 [debug] [MainThread]: Connection 'master' was properly closed.
22:57:09.123343 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
22:57:09.123396 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:57:09.123445 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
22:57:09.123492 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
22:57:09.123539 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
22:57:09.123586 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
22:57:09.123632 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
22:57:09.123679 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
22:57:09.123725 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:57:09.123772 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:57:09.126530 [info ] [MainThread]: Done.
22:57:09.128053 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:57:09.128171 [info ] [MainThread]: Building catalog
22:57:09.130748 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:57:09.134555 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:57:09.134653 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:57:09.134743 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:57:09.145307 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:57:09.145549 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:57:09.145646 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:57:09.148241 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
22:57:09.155574 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:57:09.156042 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:57:09.161864 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
22:57:09.162341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4182fb3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4182fba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4182fb8e0>]}
22:57:09.800888 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:57:09.801235 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 22:57:14.588251 | 8faa205e-322c-4887-b7fd-749a752de183 ==============================
22:57:14.588268 [info ] [MainThread]: Running with dbt=1.1.0
22:57:14.588770 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:57:14.588861 [debug] [MainThread]: Tracking: tracking
22:57:14.591839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff865cbf3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8674d9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff865cbf370>]}
22:57:14.593535 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:57:14.594008 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:57:14.594296 [info ] [MainThread]: 
22:57:14.594439 [info ] [MainThread]: 
22:57:14.594654 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 23:04:19.885859 | 9cb9dc55-072d-403e-bb2d-81b06a642cce ==============================
23:04:19.885873 [info ] [MainThread]: Running with dbt=1.1.0
23:04:19.886214 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:04:19.886298 [debug] [MainThread]: Tracking: tracking
23:04:19.888551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58b4083d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58b406a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58b4064c0>]}
23:04:19.909625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
23:04:19.910059 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/docs.md
23:04:19.918824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58b2c40d0>]}
23:04:19.927415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58b368d30>]}
23:04:19.927728 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
23:04:19.927903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58b368ee0>]}
23:04:19.929139 [info ] [MainThread]: 
23:04:19.929526 [debug] [MainThread]: Acquiring new postgres connection "master"
23:04:19.930367 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
23:04:19.938368 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
23:04:19.939549 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
23:04:19.939713 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:04:19.953317 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
23:04:19.954321 [debug] [ThreadPool]: On list_erp_oltp: Close
23:04:19.955500 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:04:19.959819 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:04:19.959921 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:04:19.959982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:04:19.963861 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
23:04:19.963980 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:04:19.964044 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:04:19.965354 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
23:04:19.966248 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:04:19.966408 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:04:19.970269 [debug] [MainThread]: Using postgres connection "master"
23:04:19.970460 [debug] [MainThread]: On master: BEGIN
23:04:19.970528 [debug] [MainThread]: Opening a new connection, currently in state init
23:04:19.974357 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:04:19.974506 [debug] [MainThread]: Using postgres connection "master"
23:04:19.974568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:04:19.991085 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
23:04:19.992544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58b3016d0>]}
23:04:19.992825 [debug] [MainThread]: On master: ROLLBACK
23:04:19.993101 [debug] [MainThread]: Using postgres connection "master"
23:04:19.993201 [debug] [MainThread]: On master: BEGIN
23:04:19.993389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:04:19.993483 [debug] [MainThread]: On master: COMMIT
23:04:19.993551 [debug] [MainThread]: Using postgres connection "master"
23:04:19.993617 [debug] [MainThread]: On master: COMMIT
23:04:19.993764 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:04:19.993879 [debug] [MainThread]: On master: Close
23:04:19.994233 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:04:19.994414 [info ] [MainThread]: 
23:04:19.998117 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:04:19.998368 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
23:04:19.998695 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:04:19.998838 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:04:19.998953 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:04:20.030232 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:04:20.030506 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
23:04:20.030715 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:04:20.030885 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
23:04:20.031017 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:04:20.031113 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
23:04:20.031489 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:04:20.031590 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:04:20.034889 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:04:20.037164 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:04:20.037726 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:04:20.037864 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:04:20.037990 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:04:20.038798 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:04:20.039175 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:04:20.039486 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:04:20.039562 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:04:20.039654 [debug] [Thread-2  ]: finished collecting timing info
23:04:20.041949 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:04:20.041058 [debug] [Thread-3  ]: finished collecting timing info
23:04:20.054041 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:04:20.040759 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:04:20.041726 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:04:20.060007 [debug] [Thread-1  ]: finished collecting timing info
23:04:20.060208 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:04:20.072603 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
23:04:20.072958 [debug] [Thread-4  ]: finished collecting timing info
23:04:20.073136 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:04:20.074595 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
23:04:20.074895 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:04:20.075050 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
23:04:20.075126 [debug] [Thread-4  ]: Opening a new connection, currently in state init
23:04:20.076008 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
23:04:20.081407 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:04:20.081539 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
23:04:20.081606 [debug] [Thread-3  ]: Opening a new connection, currently in state init
23:04:20.089678 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
23:04:20.089856 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
23:04:20.090057 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:04:20.090138 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
23:04:20.090261 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:04:20.091467 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
23:04:20.090696 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:04:20.091624 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
23:04:20.091771 [debug] [Thread-2  ]: Opening a new connection, currently in state init
23:04:20.091866 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
23:04:20.096386 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:04:20.096467 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
23:04:20.095845 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:04:20.096810 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
23:04:20.092060 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
23:04:20.096931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:04:20.097111 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.100663 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:04:20.101011 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
23:04:20.101773 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
23:04:20.104103 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:04:20.104572 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.104682 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
23:04:20.110145 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
23:04:20.110261 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.110402 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:04:20.111838 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
23:04:20.112337 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:04:20.112161 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
23:04:20.112411 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
23:04:20.111725 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:04:20.113055 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
23:04:20.113433 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.114245 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
23:04:20.114334 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:04:20.114423 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
23:04:20.114797 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
23:04:20.119353 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
23:04:20.118373 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
23:04:20.118211 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:04:20.121732 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:04:20.122167 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
23:04:20.121979 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
23:04:20.122313 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:04:20.122409 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
23:04:20.120342 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:04:20.122062 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
23:04:20.122539 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
23:04:20.124109 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
23:04:20.124973 [debug] [Thread-4  ]: finished collecting timing info
23:04:20.125065 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
23:04:20.125152 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.125241 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
23:04:20.126484 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:04:20.128448 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
23:04:20.127698 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:04:20.128594 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
23:04:20.128887 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.128355 [debug] [Thread-3  ]: finished collecting timing info
23:04:20.129510 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
23:04:20.129744 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:04:20.129630 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
23:04:20.129825 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
23:04:20.131016 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58d5d9610>]}
23:04:20.125345 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
23:04:20.131745 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
23:04:20.131522 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.132668 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:04:20.131382 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.09s]
23:04:20.133335 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58d5d9880>]}
23:04:20.134731 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:04:20.134905 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
23:04:20.135369 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.09s]
23:04:20.135493 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
23:04:20.135659 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:04:20.136540 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:04:20.136919 [debug] [Thread-6  ]: Began running node model.first_project.customer2
23:04:20.137610 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
23:04:20.137175 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
23:04:20.137467 [debug] [Thread-8  ]: Began running node model.first_project.customers
23:04:20.139606 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
23:04:20.139853 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
23:04:20.138529 [debug] [Thread-2  ]: finished collecting timing info
23:04:20.139949 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
23:04:20.140172 [debug] [Thread-8  ]: Compiling model.first_project.customers
23:04:20.141708 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
23:04:20.140062 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
23:04:20.137856 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
23:04:20.143026 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
23:04:20.143101 [debug] [Thread-6  ]: Compiling model.first_project.customer2
23:04:20.144525 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
23:04:20.144827 [debug] [Thread-6  ]: finished collecting timing info
23:04:20.144932 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
23:04:20.142102 [debug] [Thread-8  ]: finished collecting timing info
23:04:20.137085 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.150332 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
23:04:20.142914 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58b3e8be0>]}
23:04:20.150610 [debug] [Thread-8  ]: Began executing node model.first_project.customers
23:04:20.154125 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
23:04:20.156339 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:04:20.154779 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
23:04:20.156521 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
23:04:20.154511 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
23:04:20.156877 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:04:20.156429 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
23:04:20.156193 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
23:04:20.161265 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:04:20.160771 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
23:04:20.165790 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:04:20.165908 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
23:04:20.156600 [debug] [Thread-6  ]: Opening a new connection, currently in state init
23:04:20.164600 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
23:04:20.167053 [debug] [Thread-8  ]: Opening a new connection, currently in state init
23:04:20.168625 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
23:04:20.170595 [debug] [Thread-1  ]: finished collecting timing info
23:04:20.170817 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
23:04:20.172367 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58814c760>]}
23:04:20.172667 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.17s]
23:04:20.172943 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
23:04:20.173230 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:04:20.176937 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
23:04:20.177187 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
23:04:20.177589 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:04:20.173352 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:04:20.178029 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
23:04:20.177698 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
23:04:20.178199 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
23:04:20.179986 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:04:20.180347 [debug] [Thread-10 ]: finished collecting timing info
23:04:20.180543 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
23:04:20.182112 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
23:04:20.182313 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
23:04:20.182458 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
23:04:20.182527 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
23:04:20.182864 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:04:20.183000 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
23:04:20.183068 [debug] [Thread-10 ]: Opening a new connection, currently in state init
23:04:20.185327 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
23:04:20.187479 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
23:04:20.187665 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
23:04:20.187801 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
23:04:20.189251 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:04:20.189550 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
23:04:20.189810 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.191044 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
23:04:20.191150 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.191298 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
23:04:20.192580 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.192196 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
23:04:20.196042 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:04:20.196168 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
23:04:20.193499 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
23:04:20.199631 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
23:04:20.199767 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
23:04:20.200342 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
23:04:20.201144 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:04:20.201424 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
23:04:20.201807 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
23:04:20.204677 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:04:20.204848 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
23:04:20.204960 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
23:04:20.205076 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
23:04:20.205956 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
23:04:20.207356 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:04:20.207641 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
23:04:20.207536 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
23:04:20.207441 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
23:04:20.208348 [debug] [Thread-8  ]: finished collecting timing info
23:04:20.208476 [debug] [Thread-8  ]: On model.first_project.customers: Close
23:04:20.209694 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
23:04:20.210365 [debug] [Thread-6  ]: finished collecting timing info
23:04:20.210472 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
23:04:20.211555 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
23:04:20.210846 [debug] [Thread-6  ]: On model.first_project.customer2: Close
23:04:20.211654 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:04:20.211777 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
23:04:20.210747 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58819cc70>]}
23:04:20.212036 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
23:04:20.212410 [debug] [Thread-8  ]: Finished running node model.first_project.customers
23:04:20.213246 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd588133d90>]}
23:04:20.214038 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.08s]
23:04:20.214268 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
23:04:20.214917 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
23:04:20.215877 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:04:20.215979 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
23:04:20.216193 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
23:04:20.217544 [debug] [Thread-10 ]: finished collecting timing info
23:04:20.217769 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
23:04:20.218206 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9cb9dc55-072d-403e-bb2d-81b06a642cce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58814bee0>]}
23:04:20.218523 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
23:04:20.218919 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
23:04:20.220475 [debug] [MainThread]: Acquiring new postgres connection "master"
23:04:20.220601 [debug] [MainThread]: Using postgres connection "master"
23:04:20.220667 [debug] [MainThread]: On master: BEGIN
23:04:20.220726 [debug] [MainThread]: Opening a new connection, currently in state closed
23:04:20.230480 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:04:20.230883 [debug] [MainThread]: On master: COMMIT
23:04:20.230975 [debug] [MainThread]: Using postgres connection "master"
23:04:20.231061 [debug] [MainThread]: On master: COMMIT
23:04:20.231262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:04:20.231374 [debug] [MainThread]: On master: Close
23:04:20.231843 [info ] [MainThread]: 
23:04:20.232051 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.30s.
23:04:20.232177 [debug] [MainThread]: Connection 'master' was properly closed.
23:04:20.232240 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
23:04:20.232296 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
23:04:20.232350 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
23:04:20.232404 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
23:04:20.232457 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
23:04:20.232535 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:04:20.232589 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
23:04:20.236637 [info ] [MainThread]: 
23:04:20.236963 [info ] [MainThread]: [32mCompleted successfully[0m
23:04:20.237142 [info ] [MainThread]: 
23:04:20.237251 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
23:04:20.237438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58b4066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58a9f25b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd58a9f2820>]}


============================== 2022-06-10 23:04:29.290221 | 44ad8892-fd4a-4989-9c4d-3194fff2a24f ==============================
23:04:29.290238 [info ] [MainThread]: Running with dbt=1.1.0
23:04:29.290633 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:04:29.290777 [debug] [MainThread]: Tracking: tracking
23:04:29.293112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f389f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f387a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f3874c0>]}
23:04:29.311567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:04:29.311746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:04:29.321503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44ad8892-fd4a-4989-9c4d-3194fff2a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f2340d0>]}
23:04:29.325791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44ad8892-fd4a-4989-9c4d-3194fff2a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f283160>]}
23:04:29.326049 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
23:04:29.326252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44ad8892-fd4a-4989-9c4d-3194fff2a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f389880>]}
23:04:29.327550 [info ] [MainThread]: 
23:04:29.327889 [debug] [MainThread]: Acquiring new postgres connection "master"
23:04:29.329680 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:04:29.341893 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:04:29.342151 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:04:29.342234 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:04:29.347935 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:04:29.348113 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:04:29.348190 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:04:29.351557 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
23:04:29.352863 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:04:29.353222 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:04:29.360997 [debug] [MainThread]: Using postgres connection "master"
23:04:29.361231 [debug] [MainThread]: On master: BEGIN
23:04:29.361299 [debug] [MainThread]: Opening a new connection, currently in state init
23:04:29.365110 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:04:29.365271 [debug] [MainThread]: Using postgres connection "master"
23:04:29.365339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:04:29.376967 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
23:04:29.378230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44ad8892-fd4a-4989-9c4d-3194fff2a24f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f30fe80>]}
23:04:29.378473 [debug] [MainThread]: On master: ROLLBACK
23:04:29.378877 [debug] [MainThread]: On master: Close
23:04:29.379211 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:04:29.380580 [info ] [MainThread]: 
23:04:29.384197 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:04:29.384566 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:04:29.384717 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:04:29.384804 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:04:29.386506 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:04:29.386866 [debug] [Thread-1  ]: finished collecting timing info
23:04:29.386995 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:04:29.387079 [debug] [Thread-1  ]: finished collecting timing info
23:04:29.387379 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:04:29.387474 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:04:29.387869 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:04:29.387975 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:04:29.388043 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:04:29.389389 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:04:29.389590 [debug] [Thread-2  ]: finished collecting timing info
23:04:29.389727 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:04:29.389842 [debug] [Thread-2  ]: finished collecting timing info
23:04:29.390041 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:04:29.387594 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:04:29.390421 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:04:29.390499 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:04:29.390563 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:04:29.391839 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:04:29.392073 [debug] [Thread-4  ]: finished collecting timing info
23:04:29.392198 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:04:29.392278 [debug] [Thread-4  ]: finished collecting timing info
23:04:29.392534 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:04:29.387537 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:04:29.392764 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:04:29.392849 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:04:29.392913 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:04:29.387655 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
23:04:29.430220 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:04:29.430366 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
23:04:29.430438 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
23:04:29.431255 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
23:04:29.431372 [debug] [Thread-5  ]: finished collecting timing info
23:04:29.431436 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
23:04:29.431503 [debug] [Thread-5  ]: finished collecting timing info
23:04:29.432185 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:04:29.432509 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
23:04:29.432872 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
23:04:29.433017 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:04:29.434576 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:04:29.434853 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:04:29.434942 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:04:29.433791 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:04:29.440361 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
23:04:29.440508 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
23:04:29.441672 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:04:29.442058 [debug] [Thread-7  ]: finished collecting timing info
23:04:29.433104 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:04:29.442220 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
23:04:29.434141 [debug] [Thread-3  ]: finished collecting timing info
23:04:29.442541 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:04:29.446298 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:04:29.446366 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:04:29.446049 [debug] [Thread-7  ]: finished collecting timing info
23:04:29.451866 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
23:04:29.445823 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:04:29.451011 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:04:29.446206 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:04:29.452790 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:04:29.452991 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:04:29.453624 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:04:29.454142 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:04:29.454221 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:04:29.453966 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:04:29.456705 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:04:29.456780 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:04:29.458636 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:04:29.456555 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:04:29.458908 [debug] [Thread-6  ]: finished collecting timing info
23:04:29.459034 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:04:29.459102 [debug] [Thread-6  ]: finished collecting timing info
23:04:29.459290 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:04:29.453341 [debug] [Thread-3  ]: finished collecting timing info
23:04:29.454043 [debug] [Thread-9  ]: finished collecting timing info
23:04:29.459918 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:04:29.459642 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:04:29.459782 [debug] [Thread-2  ]: finished collecting timing info
23:04:29.460328 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:04:29.460499 [debug] [Thread-2  ]: finished collecting timing info
23:04:29.460257 [debug] [Thread-1  ]: Began running node model.first_project.customer2
23:04:29.460967 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
23:04:29.460406 [debug] [Thread-10 ]: Began running node model.first_project.customers
23:04:29.461045 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
23:04:29.461322 [debug] [Thread-1  ]: Compiling model.first_project.customer2
23:04:29.462596 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
23:04:29.460806 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:04:29.461226 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
23:04:29.462991 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
23:04:29.463119 [debug] [Thread-10 ]: Compiling model.first_project.customers
23:04:29.462817 [debug] [Thread-1  ]: finished collecting timing info
23:04:29.459994 [debug] [Thread-9  ]: finished collecting timing info
23:04:29.464394 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
23:04:29.464969 [debug] [Thread-10 ]: finished collecting timing info
23:04:29.464538 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
23:04:29.465068 [debug] [Thread-10 ]: Began executing node model.first_project.customers
23:04:29.465294 [debug] [Thread-10 ]: finished collecting timing info
23:04:29.465487 [debug] [Thread-10 ]: Finished running node model.first_project.customers
23:04:29.465188 [debug] [Thread-1  ]: finished collecting timing info
23:04:29.464794 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:04:29.466269 [debug] [Thread-9  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:04:29.465956 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
23:04:29.466099 [debug] [Thread-4  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:04:29.466787 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:04:29.466905 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:04:29.453780 [debug] [Thread-8  ]: finished collecting timing info
23:04:29.467127 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:04:29.466985 [debug] [Thread-4  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
23:04:29.469451 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:04:29.469681 [debug] [Thread-4  ]: finished collecting timing info
23:04:29.466475 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:04:29.470254 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:04:29.470147 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:04:29.470435 [debug] [Thread-4  ]: finished collecting timing info
23:04:29.470665 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:04:29.470342 [debug] [Thread-9  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
23:04:29.472607 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:04:29.466155 [debug] [Thread-6  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:04:29.466039 [debug] [Thread-7  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:04:29.467220 [debug] [Thread-8  ]: finished collecting timing info
23:04:29.472834 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:04:29.473023 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:04:29.473270 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:04:29.473389 [debug] [Thread-6  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:04:29.473519 [debug] [Thread-7  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:04:29.473703 [debug] [Thread-6  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:04:29.473793 [debug] [Thread-9  ]: finished collecting timing info
23:04:29.478470 [debug] [Thread-9  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:04:29.478575 [debug] [Thread-9  ]: finished collecting timing info
23:04:29.478793 [debug] [Thread-9  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:04:29.473878 [debug] [Thread-7  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:04:29.478326 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:04:29.484984 [debug] [Thread-6  ]: finished collecting timing info
23:04:29.485155 [debug] [Thread-6  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:04:29.485236 [debug] [Thread-6  ]: finished collecting timing info
23:04:29.485483 [debug] [Thread-6  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:04:29.488189 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:04:29.488543 [debug] [Thread-7  ]: finished collecting timing info
23:04:29.488683 [debug] [Thread-7  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:04:29.488755 [debug] [Thread-7  ]: finished collecting timing info
23:04:29.488976 [debug] [Thread-7  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:04:29.490130 [debug] [MainThread]: Connection 'master' was properly closed.
23:04:29.490224 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
23:04:29.490284 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:04:29.490338 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
23:04:29.490390 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
23:04:29.490442 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
23:04:29.490494 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
23:04:29.490546 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:04:29.490597 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
23:04:29.490647 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:04:29.490698 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:04:29.493668 [info ] [MainThread]: Done.
23:04:29.495223 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:04:29.495315 [info ] [MainThread]: Building catalog
23:04:29.496908 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:04:29.502763 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:04:29.502970 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:04:29.503041 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:04:29.507009 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
23:04:29.507195 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:04:29.507263 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:04:29.512893 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.01 seconds
23:04:29.519308 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:04:29.519969 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:04:29.527764 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
23:04:29.528184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90f389f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb910b9ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb910b9a130>]}
23:04:30.126695 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:04:30.127113 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 23:04:33.557025 | 432a4db8-c900-4eec-87f3-70c06ef98755 ==============================
23:04:33.557038 [info ] [MainThread]: Running with dbt=1.1.0
23:04:33.557428 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:04:33.557530 [debug] [MainThread]: Tracking: tracking
23:04:33.560047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19125ca550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19125ca8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19125cae20>]}
23:04:33.561930 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:04:33.562128 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:04:33.562313 [info ] [MainThread]: 
23:04:33.562417 [info ] [MainThread]: 
23:04:33.562645 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 23:06:20.205303 | e55dc6bd-dac8-4f77-b3c1-948f72c6ae21 ==============================
23:06:20.205316 [info ] [MainThread]: Running with dbt=1.1.0
23:06:20.205767 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:06:20.205863 [debug] [MainThread]: Tracking: tracking
23:06:20.212368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9680937eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96809376a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96809377c0>]}
23:06:20.228056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96808fa070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9680869610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9680869520>]}


============================== 2022-06-10 23:07:54.953413 | 98c4b7cc-360b-443f-b96d-916a0d6dc148 ==============================
23:07:54.953427 [info ] [MainThread]: Running with dbt=1.1.0
23:07:54.953765 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:07:54.953858 [debug] [MainThread]: Tracking: tracking
23:07:54.956429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae702c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae702aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae702a4c0>]}
23:07:54.977125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
23:07:54.977766 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
23:07:54.978085 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/docs.md
23:07:54.986669 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
23:07:55.054970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98c4b7cc-360b-443f-b96d-916a0d6dc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae702a160>]}
23:07:55.058501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98c4b7cc-360b-443f-b96d-916a0d6dc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae6fda220>]}
23:07:55.058708 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
23:07:55.058880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98c4b7cc-360b-443f-b96d-916a0d6dc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae702c6d0>]}
23:07:55.059977 [info ] [MainThread]: 
23:07:55.060266 [debug] [MainThread]: Acquiring new postgres connection "master"
23:07:55.061107 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:07:55.067686 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:07:55.067830 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:07:55.067904 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:07:55.073795 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:07:55.073954 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:07:55.074024 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:07:55.075389 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
23:07:55.076341 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:07:55.076553 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:07:55.079465 [debug] [MainThread]: Using postgres connection "master"
23:07:55.079631 [debug] [MainThread]: On master: BEGIN
23:07:55.079700 [debug] [MainThread]: Opening a new connection, currently in state init
23:07:55.084562 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:07:55.084759 [debug] [MainThread]: Using postgres connection "master"
23:07:55.084835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:07:55.095305 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
23:07:55.096566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98c4b7cc-360b-443f-b96d-916a0d6dc148', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae6fdad00>]}
23:07:55.096825 [debug] [MainThread]: On master: ROLLBACK
23:07:55.097274 [debug] [MainThread]: On master: Close
23:07:55.097706 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:07:55.097969 [info ] [MainThread]: 
23:07:55.101647 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:07:55.102043 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:07:55.102168 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:07:55.102265 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:07:55.103887 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:07:55.104151 [debug] [Thread-1  ]: finished collecting timing info
23:07:55.104297 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:07:55.104848 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:07:55.104934 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:07:55.105003 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:07:55.106289 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:07:55.106485 [debug] [Thread-2  ]: finished collecting timing info
23:07:55.104534 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
23:07:55.106819 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:07:55.106902 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
23:07:55.106966 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
23:07:55.107698 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
23:07:55.107827 [debug] [Thread-5  ]: finished collecting timing info
23:07:55.107900 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
23:07:55.107975 [debug] [Thread-5  ]: finished collecting timing info
23:07:55.108183 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
23:07:55.104375 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:07:55.108488 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:07:55.108606 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:07:55.108680 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:07:55.109714 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:07:55.109887 [debug] [Thread-3  ]: finished collecting timing info
23:07:55.109991 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:07:55.110064 [debug] [Thread-3  ]: finished collecting timing info
23:07:55.110253 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:07:55.104450 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:07:55.110533 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:07:55.110613 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:07:55.110674 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:07:55.112605 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:07:55.106579 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:07:55.113365 [debug] [Thread-2  ]: finished collecting timing info
23:07:55.113696 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:07:55.113806 [debug] [Thread-2  ]: Began running node model.first_project.customer2
23:07:55.114123 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customer2"
23:07:55.114258 [debug] [Thread-2  ]: Began compiling node model.first_project.customer2
23:07:55.114333 [debug] [Thread-2  ]: Compiling model.first_project.customer2
23:07:55.115945 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customer2"
23:07:55.104612 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:07:55.116329 [debug] [Thread-1  ]: finished collecting timing info
23:07:55.116556 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:07:55.113018 [debug] [Thread-4  ]: finished collecting timing info
23:07:55.116663 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:07:55.116729 [debug] [Thread-4  ]: finished collecting timing info
23:07:55.116906 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:07:55.116184 [debug] [Thread-2  ]: finished collecting timing info
23:07:55.116994 [debug] [Thread-2  ]: Began executing node model.first_project.customer2
23:07:55.117055 [debug] [Thread-2  ]: finished collecting timing info
23:07:55.117257 [debug] [Thread-2  ]: Finished running node model.first_project.customer2
23:07:55.119877 [debug] [Thread-8  ]: Began running node model.first_project.customers
23:07:55.120253 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
23:07:55.120353 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
23:07:55.120438 [debug] [Thread-8  ]: Compiling model.first_project.customers
23:07:55.122363 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
23:07:55.122669 [debug] [Thread-8  ]: finished collecting timing info
23:07:55.122855 [debug] [Thread-8  ]: Began executing node model.first_project.customers
23:07:55.122969 [debug] [Thread-8  ]: finished collecting timing info
23:07:55.123218 [debug] [Thread-8  ]: Finished running node model.first_project.customers
23:07:55.123317 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
23:07:55.123451 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:07:55.123516 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
23:07:55.123576 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
23:07:55.124792 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:07:55.125030 [debug] [Thread-8  ]: finished collecting timing info
23:07:55.125265 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
23:07:55.125348 [debug] [Thread-8  ]: finished collecting timing info
23:07:55.125561 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
23:07:55.126135 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:07:55.126275 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:07:55.126369 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:07:55.126474 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:07:55.126707 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:07:55.127058 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:07:55.135555 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:07:55.135736 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:07:55.127233 [debug] [Thread-5  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:07:55.139803 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:07:55.139982 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:07:55.140047 [debug] [Thread-5  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
23:07:55.135286 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:07:55.127167 [debug] [Thread-6  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:07:55.127291 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:07:55.142350 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:07:55.127355 [debug] [Thread-1  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:07:55.143636 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:07:55.143737 [debug] [Thread-1  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:07:55.143808 [debug] [Thread-1  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:07:55.139565 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:07:55.143143 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:07:55.150254 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:07:55.127418 [debug] [Thread-4  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:07:55.150607 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:07:55.150720 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:07:55.150832 [debug] [Thread-4  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
23:07:55.150010 [debug] [Thread-5  ]: finished collecting timing info
23:07:55.150343 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:07:55.153188 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:07:55.142722 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:07:55.155963 [debug] [Thread-6  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:07:55.156048 [debug] [Thread-6  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:07:55.155867 [debug] [Thread-5  ]: finished collecting timing info
23:07:55.153062 [debug] [Thread-9  ]: finished collecting timing info
23:07:55.155717 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:07:55.163320 [debug] [Thread-3  ]: finished collecting timing info
23:07:55.127478 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:07:55.161549 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:07:55.152935 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:07:55.149511 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:07:55.162812 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:07:55.163012 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:07:55.163684 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:07:55.164443 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:07:55.164537 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:07:55.164170 [debug] [Thread-4  ]: finished collecting timing info
23:07:55.167001 [debug] [Thread-4  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:07:55.167092 [debug] [Thread-4  ]: finished collecting timing info
23:07:55.166870 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:07:55.143422 [debug] [Thread-8  ]: finished collecting timing info
23:07:55.167313 [debug] [Thread-4  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:07:55.167382 [debug] [Thread-1  ]: finished collecting timing info
23:07:55.168022 [debug] [Thread-1  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:07:55.168116 [debug] [Thread-1  ]: finished collecting timing info
23:07:55.168315 [debug] [Thread-1  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:07:55.167728 [debug] [Thread-2  ]: finished collecting timing info
23:07:55.169483 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:07:55.163484 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:07:55.169721 [debug] [Thread-3  ]: finished collecting timing info
23:07:55.169932 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:07:55.169598 [debug] [Thread-2  ]: finished collecting timing info
23:07:55.170277 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:07:55.167838 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:07:55.164287 [debug] [Thread-9  ]: finished collecting timing info
23:07:55.170683 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:07:55.170410 [debug] [Thread-8  ]: finished collecting timing info
23:07:55.167539 [debug] [Thread-6  ]: finished collecting timing info
23:07:55.171070 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:07:55.171176 [debug] [Thread-6  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:07:55.171345 [debug] [Thread-6  ]: finished collecting timing info
23:07:55.171531 [debug] [Thread-6  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:07:55.172391 [debug] [MainThread]: Connection 'master' was properly closed.
23:07:55.172477 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:07:55.172533 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:07:55.172610 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
23:07:55.172661 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
23:07:55.172712 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
23:07:55.172763 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:07:55.172812 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
23:07:55.172861 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
23:07:55.175747 [info ] [MainThread]: Done.
23:07:55.177258 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:07:55.177354 [info ] [MainThread]: Building catalog
23:07:55.178924 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:07:55.183048 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:07:55.183163 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:07:55.183240 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:07:55.187833 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
23:07:55.187956 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:07:55.188020 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:07:55.191173 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
23:07:55.198050 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:07:55.198455 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:07:55.204535 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
23:07:55.204981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae702c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae6fda760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcae6fda6d0>]}
23:07:55.799841 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:07:55.800208 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 23:07:59.886607 | 4eb55ecb-c1c3-41e0-aba1-b329786a9bbf ==============================
23:07:59.886634 [info ] [MainThread]: Running with dbt=1.1.0
23:07:59.887657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:07:59.887796 [debug] [MainThread]: Tracking: tracking
23:07:59.890966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26bb42b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26bcc45f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26bb42b790>]}
23:07:59.893144 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:07:59.893354 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:07:59.893468 [info ] [MainThread]: 
23:07:59.893605 [info ] [MainThread]: 
23:07:59.893729 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-10 23:11:17.311663 | 22eb03bf-a1a9-40c2-9eea-63c17850e367 ==============================
23:11:17.311678 [info ] [MainThread]: Running with dbt=1.1.0
23:11:17.312055 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:11:17.312157 [debug] [MainThread]: Tracking: tracking
23:11:17.314796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4692d5dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4692d5ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4692d5c700>]}
23:11:17.334834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:11:17.335050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:11:17.339762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22eb03bf-a1a9-40c2-9eea-63c17850e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4692c140d0>]}
23:11:17.344338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22eb03bf-a1a9-40c2-9eea-63c17850e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4692c63130>]}
23:11:17.344858 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
23:11:17.345631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22eb03bf-a1a9-40c2-9eea-63c17850e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4692d5d400>]}
23:11:17.347327 [info ] [MainThread]: 
23:11:17.347758 [debug] [MainThread]: Acquiring new postgres connection "master"
23:11:17.348648 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:11:17.357306 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:11:17.357528 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:11:17.357601 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:11:17.364105 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:11:17.364292 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:11:17.364369 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:11:17.365794 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
23:11:17.366849 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:11:17.367138 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:11:17.370003 [debug] [MainThread]: Using postgres connection "master"
23:11:17.370115 [debug] [MainThread]: On master: BEGIN
23:11:17.370179 [debug] [MainThread]: Opening a new connection, currently in state init
23:11:17.376787 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:11:17.377115 [debug] [MainThread]: Using postgres connection "master"
23:11:17.377259 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:11:17.387911 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
23:11:17.389765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22eb03bf-a1a9-40c2-9eea-63c17850e367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4692cf0e50>]}
23:11:17.390469 [debug] [MainThread]: On master: ROLLBACK
23:11:17.391035 [debug] [MainThread]: On master: Close
23:11:17.391500 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:11:17.391705 [info ] [MainThread]: 
23:11:17.396580 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:11:17.396839 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:11:17.396934 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:11:17.397018 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:11:17.398556 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:11:17.399560 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:11:17.399764 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:11:17.399845 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:11:17.400157 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:11:17.401630 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:11:17.403341 [debug] [Thread-2  ]: finished collecting timing info
23:11:17.403517 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:11:17.404000 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:11:17.404077 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:11:17.404141 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:11:17.405297 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:11:17.403808 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:11:17.403693 [debug] [Thread-1  ]: finished collecting timing info
23:11:17.405531 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:11:17.405982 [debug] [Thread-3  ]: finished collecting timing info
23:11:17.408505 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:11:17.408635 [debug] [Thread-3  ]: finished collecting timing info
23:11:17.408953 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:11:17.408367 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:11:17.406195 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
23:11:17.409923 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:11:17.410018 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
23:11:17.410120 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
23:11:17.409535 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:11:17.437609 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:11:17.438381 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:11:17.407957 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:11:17.439996 [debug] [Thread-1  ]: finished collecting timing info
23:11:17.439161 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
23:11:17.440488 [debug] [Thread-5  ]: finished collecting timing info
23:11:17.439772 [debug] [Thread-7  ]: Began running node model.first_project.customer2
23:11:17.440853 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customer2"
23:11:17.441000 [debug] [Thread-7  ]: Began compiling node model.first_project.customer2
23:11:17.441070 [debug] [Thread-7  ]: Compiling model.first_project.customer2
23:11:17.440587 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
23:11:17.442643 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customer2"
23:11:17.439618 [debug] [Thread-4  ]: finished collecting timing info
23:11:17.443183 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:11:17.443254 [debug] [Thread-4  ]: finished collecting timing info
23:11:17.442811 [debug] [Thread-5  ]: finished collecting timing info
23:11:17.443036 [debug] [Thread-7  ]: finished collecting timing info
23:11:17.443835 [debug] [Thread-7  ]: Began executing node model.first_project.customer2
23:11:17.443909 [debug] [Thread-7  ]: finished collecting timing info
23:11:17.444088 [debug] [Thread-7  ]: Finished running node model.first_project.customer2
23:11:17.443731 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
23:11:17.443471 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:11:17.407732 [debug] [Thread-2  ]: finished collecting timing info
23:11:17.444482 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:11:17.440331 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:11:17.444908 [debug] [Thread-9  ]: Began running node model.first_project.customers
23:11:17.445096 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
23:11:17.445168 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
23:11:17.445226 [debug] [Thread-9  ]: Compiling model.first_project.customers
23:11:17.446680 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
23:11:17.446912 [debug] [Thread-9  ]: finished collecting timing info
23:11:17.447135 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
23:11:17.447666 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:11:17.447351 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:11:17.447453 [debug] [Thread-9  ]: Began executing node model.first_project.customers
23:11:17.448038 [debug] [Thread-9  ]: finished collecting timing info
23:11:17.447210 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:11:17.447926 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:11:17.448524 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:11:17.448405 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:11:17.448723 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:11:17.448837 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:11:17.448598 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:11:17.447742 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
23:11:17.448245 [debug] [Thread-9  ]: Finished running node model.first_project.customers
23:11:17.456624 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:11:17.460305 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:11:17.460476 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
23:11:17.462598 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:11:17.461104 [debug] [Thread-5  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:11:17.461241 [debug] [Thread-4  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:11:17.463277 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:11:17.463484 [debug] [Thread-4  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:11:17.462896 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:11:17.461329 [debug] [Thread-2  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:11:17.463389 [debug] [Thread-3  ]: finished collecting timing info
23:11:17.460954 [debug] [Thread-7  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:11:17.464409 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:11:17.463691 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:11:17.463793 [debug] [Thread-10 ]: finished collecting timing info
23:11:17.464666 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
23:11:17.464740 [debug] [Thread-10 ]: finished collecting timing info
23:11:17.464242 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:11:17.464486 [debug] [Thread-7  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:11:17.465163 [debug] [Thread-7  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:11:17.464572 [debug] [Thread-5  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
23:11:17.464973 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
23:11:17.464034 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:11:17.464159 [debug] [Thread-6  ]: finished collecting timing info
23:11:17.465072 [debug] [Thread-3  ]: finished collecting timing info
23:11:17.463567 [debug] [Thread-4  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:11:17.472108 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:11:17.474367 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:11:17.474798 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:11:17.480555 [debug] [Thread-2  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
23:11:17.475158 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:11:17.475262 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:11:17.483571 [debug] [Thread-6  ]: finished collecting timing info
23:11:17.480235 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:11:17.475016 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:11:17.483092 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:11:17.483372 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:11:17.475567 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:11:17.483681 [debug] [Thread-7  ]: finished collecting timing info
23:11:17.483939 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:11:17.484261 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:11:17.485137 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:11:17.484603 [debug] [Thread-2  ]: finished collecting timing info
23:11:17.484690 [debug] [Thread-4  ]: finished collecting timing info
23:11:17.484830 [debug] [Thread-5  ]: finished collecting timing info
23:11:17.484974 [debug] [Thread-7  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:11:17.485220 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:11:17.487549 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:11:17.485315 [debug] [Thread-2  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:11:17.484449 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:11:17.485509 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:11:17.485419 [debug] [Thread-4  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:11:17.488178 [debug] [Thread-4  ]: finished collecting timing info
23:11:17.487732 [debug] [Thread-2  ]: finished collecting timing info
23:11:17.487838 [debug] [Thread-8  ]: finished collecting timing info
23:11:17.488799 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:11:17.488920 [debug] [Thread-8  ]: finished collecting timing info
23:11:17.489267 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:11:17.488390 [debug] [Thread-4  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:11:17.488635 [debug] [Thread-2  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:11:17.487966 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:11:17.485605 [debug] [Thread-7  ]: finished collecting timing info
23:11:17.492335 [debug] [Thread-7  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:11:17.492007 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:11:17.488070 [debug] [Thread-5  ]: finished collecting timing info
23:11:17.492747 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:11:17.492958 [debug] [Thread-9  ]: finished collecting timing info
23:11:17.493080 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:11:17.493157 [debug] [Thread-9  ]: finished collecting timing info
23:11:17.493350 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:11:17.494302 [debug] [MainThread]: Connection 'master' was properly closed.
23:11:17.494385 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
23:11:17.494458 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
23:11:17.494510 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
23:11:17.494559 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:11:17.494608 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
23:11:17.494656 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
23:11:17.494707 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:11:17.494787 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
23:11:17.494836 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:11:17.494883 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
23:11:17.497685 [info ] [MainThread]: Done.
23:11:17.499166 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:11:17.499337 [info ] [MainThread]: Building catalog
23:11:17.500599 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:11:17.504708 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:11:17.504807 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:11:17.504870 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:11:17.510799 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:11:17.510968 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:11:17.511036 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:11:17.513069 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
23:11:17.521705 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:11:17.522255 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:11:17.530557 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
23:11:17.531085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4692d5dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4694c16a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4694b5cee0>]}
23:11:18.112259 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:11:18.112603 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-10 23:11:21.841684 | 1a9b0905-8b69-4de6-a896-ee844d16c8d4 ==============================
23:11:21.841712 [info ] [MainThread]: Running with dbt=1.1.0
23:11:21.842102 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:11:21.842190 [debug] [MainThread]: Tracking: tracking
23:11:21.844718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd0f2c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd0f2b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadd0f2b6a0>]}
23:11:21.846348 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:11:21.846535 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:11:21.846666 [info ] [MainThread]: 
23:11:21.846789 [info ] [MainThread]: 
23:11:21.846908 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-11 11:02:14.518028 | 03c2fefa-f8f5-4d1d-8d9b-41210d66dedb ==============================
11:02:14.518047 [info ] [MainThread]: Running with dbt=1.1.0
11:02:14.519064 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
11:02:14.519166 [debug] [MainThread]: Tracking: tracking
11:02:14.521939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf882a5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf883e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf883e580>]}
11:02:14.554504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
11:02:14.555175 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
11:02:14.555586 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customer2.sql
11:02:14.564496 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
11:02:14.575186 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
11:02:14.576282 [debug] [MainThread]: 1699: static parser successfully parsed erp/customer2.sql
11:02:14.634257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03c2fefa-f8f5-4d1d-8d9b-41210d66dedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf883e130>]}
11:02:14.637903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03c2fefa-f8f5-4d1d-8d9b-41210d66dedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf8723670>]}
11:02:14.638143 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
11:02:14.638313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03c2fefa-f8f5-4d1d-8d9b-41210d66dedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf8723640>]}
11:02:14.639647 [info ] [MainThread]: 
11:02:14.639963 [debug] [MainThread]: Acquiring new postgres connection "master"
11:02:14.643338 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
11:02:14.651216 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:02:14.651566 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
11:02:14.651663 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:02:14.677936 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
11:02:14.678138 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:02:14.678210 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
11:02:14.695721 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.02 seconds
11:02:14.696970 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
11:02:14.697264 [debug] [ThreadPool]: On list_erp_oltp_public: Close
11:02:14.701400 [debug] [MainThread]: Using postgres connection "master"
11:02:14.701710 [debug] [MainThread]: On master: BEGIN
11:02:14.701791 [debug] [MainThread]: Opening a new connection, currently in state init
11:02:14.705848 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
11:02:14.706072 [debug] [MainThread]: Using postgres connection "master"
11:02:14.706150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
11:02:14.724562 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
11:02:14.726000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03c2fefa-f8f5-4d1d-8d9b-41210d66dedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf87ec130>]}
11:02:14.726307 [debug] [MainThread]: On master: ROLLBACK
11:02:14.726739 [debug] [MainThread]: On master: Close
11:02:14.727430 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
11:02:14.727711 [info ] [MainThread]: 
11:02:14.735156 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
11:02:14.735634 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
11:02:14.735812 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
11:02:14.735914 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
11:02:14.737529 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
11:02:14.739045 [debug] [Thread-1  ]: finished collecting timing info
11:02:14.737879 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
11:02:14.739665 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
11:02:14.739756 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
11:02:14.737690 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
11:02:14.739856 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
11:02:14.741048 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
11:02:14.741265 [debug] [Thread-3  ]: finished collecting timing info
11:02:14.741377 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
11:02:14.740230 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
11:02:14.741477 [debug] [Thread-3  ]: finished collecting timing info
11:02:14.741891 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
11:02:14.738369 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
11:02:14.742111 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
11:02:14.741594 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
11:02:14.738090 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
11:02:14.743226 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
11:02:14.743306 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
11:02:14.742849 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
11:02:14.743027 [debug] [Thread-7  ]: Began running node model.first_project.customer2
11:02:14.745092 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customer2"
11:02:14.745190 [debug] [Thread-7  ]: Began compiling node model.first_project.customer2
11:02:14.745262 [debug] [Thread-7  ]: Compiling model.first_project.customer2
11:02:14.744833 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
11:02:14.742201 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
11:02:14.749329 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
11:02:14.748994 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customer2"
11:02:14.739177 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
11:02:14.750613 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
11:02:14.752326 [debug] [Thread-5  ]: finished collecting timing info
11:02:14.751724 [debug] [Thread-1  ]: finished collecting timing info
11:02:14.753296 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
11:02:14.743398 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
11:02:14.755190 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
11:02:14.752457 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
11:02:14.752164 [debug] [Thread-7  ]: finished collecting timing info
11:02:14.752543 [debug] [Thread-2  ]: finished collecting timing info
11:02:14.756437 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
11:02:14.755876 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
11:02:14.756803 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
11:02:14.756912 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
11:02:14.756153 [debug] [Thread-5  ]: finished collecting timing info
11:02:14.756296 [debug] [Thread-7  ]: Began executing node model.first_project.customer2
11:02:14.756534 [debug] [Thread-2  ]: finished collecting timing info
11:02:14.757662 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
11:02:14.757002 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
11:02:14.759264 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
11:02:14.755984 [debug] [Thread-10 ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:14.757279 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
11:02:14.757404 [debug] [Thread-7  ]: finished collecting timing info
11:02:14.755659 [debug] [Thread-4  ]: finished collecting timing info
11:02:14.756056 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:14.760645 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
11:02:14.760748 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:14.760819 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:14.760420 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
11:02:14.759682 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
11:02:14.765289 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:14.765393 [debug] [Thread-10 ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:14.760019 [debug] [Thread-9  ]: finished collecting timing info
11:02:14.773262 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
11:02:14.773460 [debug] [Thread-9  ]: finished collecting timing info
11:02:14.773762 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
11:02:14.765099 [debug] [Thread-4  ]: finished collecting timing info
11:02:14.774122 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
11:02:14.764843 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
11:02:14.774466 [debug] [Thread-6  ]: finished collecting timing info
11:02:14.774640 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:14.774724 [debug] [Thread-6  ]: finished collecting timing info
11:02:14.774940 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:14.760307 [debug] [Thread-7  ]: Finished running node model.first_project.customer2
11:02:14.775284 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
11:02:14.775590 [debug] [Thread-8  ]: Began running node model.first_project.customers
11:02:14.775737 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:14.775882 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:14.776542 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
11:02:14.776326 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
11:02:14.776062 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
11:02:14.776654 [debug] [Thread-10 ]: finished collecting timing info
11:02:14.776756 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:14.776874 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:14.776979 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
11:02:14.777098 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:14.777205 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:14.777340 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:14.782775 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
11:02:14.777602 [debug] [Thread-10 ]: finished collecting timing info
11:02:14.777457 [debug] [Thread-8  ]: Compiling model.first_project.customers
11:02:14.780085 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
11:02:14.783794 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:14.786812 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
11:02:14.787831 [debug] [Thread-8  ]: finished collecting timing info
11:02:14.787420 [debug] [Thread-3  ]: finished collecting timing info
11:02:14.787958 [debug] [Thread-8  ]: Began executing node model.first_project.customers
11:02:14.788250 [debug] [Thread-8  ]: finished collecting timing info
11:02:14.788082 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:14.788656 [debug] [Thread-8  ]: Finished running node model.first_project.customers
11:02:14.787133 [debug] [Thread-1  ]: finished collecting timing info
11:02:14.788843 [debug] [Thread-3  ]: finished collecting timing info
11:02:14.789005 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:14.789295 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:14.789629 [debug] [Thread-5  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:14.790330 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
11:02:14.790445 [debug] [Thread-5  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:14.790518 [debug] [Thread-5  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:14.789767 [debug] [Thread-1  ]: finished collecting timing info
11:02:14.790014 [debug] [Thread-4  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:14.789928 [debug] [Thread-9  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:14.797411 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
11:02:14.797519 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:14.797674 [debug] [Thread-9  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:14.797165 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
11:02:14.803683 [debug] [Thread-4  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:14.803891 [debug] [Thread-4  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:14.790075 [debug] [Thread-6  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:14.803467 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
11:02:14.796859 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:14.796479 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
11:02:14.810481 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
11:02:14.810829 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
11:02:14.811452 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:14.811724 [debug] [Thread-6  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:14.814174 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
11:02:14.814480 [debug] [Thread-4  ]: finished collecting timing info
11:02:14.814634 [debug] [Thread-6  ]: finished collecting timing info
11:02:14.814796 [debug] [Thread-9  ]: finished collecting timing info
11:02:14.814886 [debug] [Thread-4  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:14.815009 [debug] [Thread-6  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:14.815718 [debug] [Thread-6  ]: finished collecting timing info
11:02:14.815348 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:14.816247 [debug] [Thread-9  ]: finished collecting timing info
11:02:14.816062 [debug] [Thread-6  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:14.815207 [debug] [Thread-5  ]: finished collecting timing info
11:02:14.815566 [debug] [Thread-4  ]: finished collecting timing info
11:02:14.817097 [debug] [Thread-4  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:14.816801 [debug] [Thread-5  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:14.816545 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:14.817309 [debug] [Thread-5  ]: finished collecting timing info
11:02:14.817656 [debug] [Thread-5  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:14.818696 [debug] [MainThread]: Connection 'master' was properly closed.
11:02:14.818793 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
11:02:14.818856 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
11:02:14.818912 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
11:02:14.818978 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
11:02:14.819044 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
11:02:14.819098 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
11:02:14.819153 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
11:02:14.819207 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
11:02:14.819261 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
11:02:14.819314 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
11:02:14.822548 [info ] [MainThread]: Done.
11:02:14.822960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf81f1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf882a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3bf882aa60>]}


============================== 2022-06-11 11:02:24.828825 | d318e73c-f1e0-4f7d-a56d-32fa3b5e7e47 ==============================
11:02:24.828839 [info ] [MainThread]: Running with dbt=1.1.0
11:02:24.829217 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
11:02:24.829347 [debug] [MainThread]: Tracking: tracking
11:02:24.831969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454436d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454434a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24544344c0>]}
11:02:24.850956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:02:24.851150 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:02:24.856197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd318e73c-f1e0-4f7d-a56d-32fa3b5e7e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24542df0d0>]}
11:02:24.860363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd318e73c-f1e0-4f7d-a56d-32fa3b5e7e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454330130>]}
11:02:24.860758 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
11:02:24.860951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd318e73c-f1e0-4f7d-a56d-32fa3b5e7e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454436550>]}
11:02:24.862365 [info ] [MainThread]: 
11:02:24.862805 [debug] [MainThread]: Acquiring new postgres connection "master"
11:02:24.863598 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
11:02:24.869471 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:02:24.869588 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
11:02:24.869782 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:02:24.875101 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
11:02:24.875312 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:02:24.875457 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
11:02:24.876754 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
11:02:24.877945 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
11:02:24.878162 [debug] [ThreadPool]: On list_erp_oltp_public: Close
11:02:24.880904 [debug] [MainThread]: Using postgres connection "master"
11:02:24.881019 [debug] [MainThread]: On master: BEGIN
11:02:24.881085 [debug] [MainThread]: Opening a new connection, currently in state init
11:02:24.884524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
11:02:24.884628 [debug] [MainThread]: Using postgres connection "master"
11:02:24.884689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
11:02:24.895550 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
11:02:24.896597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd318e73c-f1e0-4f7d-a56d-32fa3b5e7e47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24543a4e80>]}
11:02:24.896875 [debug] [MainThread]: On master: ROLLBACK
11:02:24.897484 [debug] [MainThread]: On master: Close
11:02:24.897888 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
11:02:24.898070 [info ] [MainThread]: 
11:02:24.905563 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
11:02:24.905934 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
11:02:24.906065 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
11:02:24.906163 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
11:02:24.907717 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
11:02:24.907872 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
11:02:24.907997 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
11:02:24.908606 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
11:02:24.908693 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
11:02:24.908398 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
11:02:24.908759 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
11:02:24.909581 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
11:02:24.909818 [debug] [Thread-3  ]: finished collecting timing info
11:02:24.908871 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
11:02:24.908142 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
11:02:24.910380 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
11:02:24.910463 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
11:02:24.910526 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
11:02:24.910190 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
11:02:24.908080 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
11:02:24.940115 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
11:02:24.911610 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
11:02:24.910075 [debug] [Thread-1  ]: finished collecting timing info
11:02:24.941735 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
11:02:24.941838 [debug] [Thread-1  ]: finished collecting timing info
11:02:24.940435 [debug] [Thread-5  ]: finished collecting timing info
11:02:24.941559 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
11:02:24.942097 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
11:02:24.940294 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
11:02:24.942515 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
11:02:24.942223 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
11:02:24.909969 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
11:02:24.943788 [debug] [Thread-3  ]: finished collecting timing info
11:02:24.943464 [debug] [Thread-5  ]: finished collecting timing info
11:02:24.944292 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
11:02:24.943634 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:24.944498 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
11:02:24.943231 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
11:02:24.944921 [debug] [Thread-4  ]: finished collecting timing info
11:02:24.943694 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:24.945199 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
11:02:24.944621 [debug] [Thread-2  ]: finished collecting timing info
11:02:24.944706 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:24.945028 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
11:02:24.945555 [debug] [Thread-4  ]: finished collecting timing info
11:02:24.945277 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:24.945837 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:24.945373 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
11:02:24.945465 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:24.945754 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
11:02:24.944009 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
11:02:24.943558 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
11:02:24.951524 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
11:02:24.951650 [debug] [Thread-2  ]: finished collecting timing info
11:02:24.957207 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
11:02:24.957729 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
11:02:24.957943 [debug] [Thread-6  ]: Began running node model.first_project.customer2
11:02:24.958055 [debug] [Thread-1  ]: Began running node model.first_project.customers
11:02:24.959198 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
11:02:24.958596 [debug] [Thread-9  ]: finished collecting timing info
11:02:24.958809 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
11:02:24.959002 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
11:02:24.958432 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
11:02:24.959282 [debug] [Thread-8  ]: finished collecting timing info
11:02:24.959417 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
11:02:24.959524 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:24.959626 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
11:02:24.959716 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
11:02:24.961508 [debug] [Thread-6  ]: Compiling model.first_project.customer2
11:02:24.959974 [debug] [Thread-1  ]: Compiling model.first_project.customers
11:02:24.960085 [debug] [Thread-9  ]: finished collecting timing info
11:02:24.961359 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
11:02:24.962784 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
11:02:24.965274 [debug] [Thread-6  ]: finished collecting timing info
11:02:24.964649 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
11:02:24.964989 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:24.959887 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:24.965400 [debug] [Thread-7  ]: finished collecting timing info
11:02:24.965497 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
11:02:24.965792 [debug] [Thread-1  ]: finished collecting timing info
11:02:24.965911 [debug] [Thread-8  ]: finished collecting timing info
11:02:24.966014 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
11:02:24.966110 [debug] [Thread-6  ]: finished collecting timing info
11:02:24.966202 [debug] [Thread-1  ]: Began executing node model.first_project.customers
11:02:24.966429 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:24.966552 [debug] [Thread-7  ]: finished collecting timing info
11:02:24.966819 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
11:02:24.966925 [debug] [Thread-1  ]: finished collecting timing info
11:02:24.967635 [debug] [Thread-1  ]: Finished running node model.first_project.customers
11:02:24.967279 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
11:02:24.967934 [debug] [Thread-5  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:24.968023 [debug] [Thread-4  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:24.968555 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
11:02:24.968302 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
11:02:24.968787 [debug] [Thread-5  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:24.968115 [debug] [Thread-3  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:24.969083 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
11:02:24.969159 [debug] [Thread-3  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:24.968381 [debug] [Thread-10 ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:24.969387 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
11:02:24.969461 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:24.969219 [debug] [Thread-3  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:24.968632 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:24.968699 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:24.969523 [debug] [Thread-10 ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:24.978267 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
11:02:24.968931 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:24.975735 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
11:02:24.975950 [debug] [Thread-4  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:24.976181 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
11:02:24.968861 [debug] [Thread-5  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:24.978537 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
11:02:24.980631 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
11:02:24.980894 [debug] [Thread-10 ]: finished collecting timing info
11:02:24.989486 [debug] [Thread-10 ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:24.989654 [debug] [Thread-10 ]: finished collecting timing info
11:02:24.989114 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
11:02:24.989277 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:24.990228 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:24.989979 [debug] [Thread-10 ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:24.981140 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:24.990064 [debug] [Thread-4  ]: finished collecting timing info
11:02:24.981021 [debug] [Thread-3  ]: finished collecting timing info
11:02:24.990361 [debug] [Thread-5  ]: finished collecting timing info
11:02:24.992386 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
11:02:24.993132 [debug] [Thread-9  ]: finished collecting timing info
11:02:24.992721 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:24.992834 [debug] [Thread-3  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:24.992933 [debug] [Thread-5  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:24.993266 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:24.993666 [debug] [Thread-9  ]: finished collecting timing info
11:02:24.993366 [debug] [Thread-4  ]: finished collecting timing info
11:02:24.993474 [debug] [Thread-3  ]: finished collecting timing info
11:02:24.993569 [debug] [Thread-5  ]: finished collecting timing info
11:02:24.993889 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:24.992619 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:24.994121 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:24.994365 [debug] [Thread-3  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:24.994588 [debug] [Thread-5  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:24.996730 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
11:02:24.997296 [debug] [Thread-2  ]: finished collecting timing info
11:02:24.997415 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:24.997547 [debug] [Thread-2  ]: finished collecting timing info
11:02:24.997765 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:24.998756 [debug] [MainThread]: Connection 'master' was properly closed.
11:02:24.998842 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
11:02:24.998898 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
11:02:24.998950 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
11:02:24.999001 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
11:02:24.999050 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
11:02:24.999122 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
11:02:24.999172 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
11:02:24.999221 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
11:02:24.999271 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
11:02:24.999321 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
11:02:25.002240 [info ] [MainThread]: Done.
11:02:25.006012 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
11:02:25.006185 [info ] [MainThread]: Building catalog
11:02:25.007570 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
11:02:25.011603 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
11:02:25.011713 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
11:02:25.011803 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:02:25.017341 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
11:02:25.017555 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
11:02:25.017664 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
11:02:25.030494 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.01 seconds
11:02:25.037151 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
11:02:25.038134 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
11:02:25.045397 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
11:02:25.045875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2454436d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24501eb1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f245660fc40>]}
11:02:25.632400 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
11:02:25.632772 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-11 11:02:47.622158 | 7aee05df-1581-4513-8899-01017a7d9434 ==============================
11:02:47.622172 [info ] [MainThread]: Running with dbt=1.1.0
11:02:47.622585 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:02:47.622699 [debug] [MainThread]: Tracking: tracking
11:02:47.624992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe6686d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe666a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe666700>]}
11:02:47.646127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:02:47.646310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:02:47.652097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe5100d0>]}
11:02:47.658040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe562130>]}
11:02:47.658525 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
11:02:47.658759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe562040>]}
11:02:47.660650 [info ] [MainThread]: 
11:02:47.661095 [debug] [MainThread]: Acquiring new postgres connection "master"
11:02:47.661940 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
11:02:47.669342 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
11:02:47.669547 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
11:02:47.669628 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:02:47.674302 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
11:02:47.675192 [debug] [ThreadPool]: On list_erp_oltp: Close
11:02:47.676202 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
11:02:47.679488 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:02:47.679645 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
11:02:47.679730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:02:47.683782 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
11:02:47.683999 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:02:47.684095 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
11:02:47.685350 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
11:02:47.686259 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
11:02:47.686443 [debug] [ThreadPool]: On list_erp_oltp_public: Close
11:02:47.689461 [debug] [MainThread]: Using postgres connection "master"
11:02:47.690847 [debug] [MainThread]: On master: BEGIN
11:02:47.690946 [debug] [MainThread]: Opening a new connection, currently in state init
11:02:47.694867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
11:02:47.695039 [debug] [MainThread]: Using postgres connection "master"
11:02:47.695112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
11:02:47.706793 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
11:02:47.708076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe657640>]}
11:02:47.708321 [debug] [MainThread]: On master: ROLLBACK
11:02:47.708555 [debug] [MainThread]: Using postgres connection "master"
11:02:47.708652 [debug] [MainThread]: On master: BEGIN
11:02:47.708863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
11:02:47.709071 [debug] [MainThread]: On master: COMMIT
11:02:47.709142 [debug] [MainThread]: Using postgres connection "master"
11:02:47.709203 [debug] [MainThread]: On master: COMMIT
11:02:47.709326 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:02:47.709422 [debug] [MainThread]: On master: Close
11:02:47.709680 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
11:02:47.709837 [info ] [MainThread]: 
11:02:47.717826 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
11:02:47.718250 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
11:02:47.718556 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
11:02:47.718644 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
11:02:47.718726 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
11:02:47.720383 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
11:02:47.720558 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
11:02:47.720732 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
11:02:47.721133 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
11:02:47.720968 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
11:02:47.720816 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
11:02:47.721847 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
11:02:47.722063 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
11:02:47.721703 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
11:02:47.722269 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
11:02:47.722351 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
11:02:47.724098 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
11:02:47.722159 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
11:02:47.724534 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
11:02:47.724325 [debug] [Thread-2  ]: finished collecting timing info
11:02:47.721399 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
11:02:47.753662 [debug] [Thread-1  ]: finished collecting timing info
11:02:47.754925 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
11:02:47.754159 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
11:02:47.765481 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
11:02:47.766619 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
11:02:47.753904 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
11:02:47.754811 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
11:02:47.772418 [debug] [Thread-3  ]: finished collecting timing info
11:02:47.772712 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
11:02:47.782453 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
11:02:47.782778 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
11:02:47.784582 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
11:02:47.784894 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:02:47.785060 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
11:02:47.785178 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:02:47.785276 [debug] [Thread-3  ]: Opening a new connection, currently in state init
11:02:47.785386 [debug] [Thread-4  ]: finished collecting timing info
11:02:47.785496 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:02:47.786388 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
11:02:47.786278 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
11:02:47.785571 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
11:02:47.788049 [debug] [Thread-2  ]: Opening a new connection, currently in state init
11:02:47.787874 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
11:02:47.786469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:02:47.789239 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:02:47.789329 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
11:02:47.789387 [debug] [Thread-4  ]: Opening a new connection, currently in state init
11:02:47.792544 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
11:02:47.792662 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:02:47.792729 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
11:02:47.793207 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
11:02:47.793303 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:02:47.793366 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
11:02:47.793671 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
11:02:47.793768 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:02:47.793832 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
11:02:47.797977 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
11:02:47.798163 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:02:47.798230 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
11:02:47.801586 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
11:02:47.805380 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:02:47.805504 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
11:02:47.807301 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:02:47.807407 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
11:02:47.805712 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
11:02:47.805802 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
11:02:47.808714 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:02:47.808813 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
11:02:47.809067 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
11:02:47.810351 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:02:47.810841 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
11:02:47.810635 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.810464 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.810930 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.815304 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:02:47.812867 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.816661 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:02:47.815465 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
11:02:47.812747 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:02:47.816936 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
11:02:47.816767 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
11:02:47.817373 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.813991 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:02:47.817231 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.821124 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
11:02:47.821261 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.822905 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
11:02:47.823017 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:02:47.822249 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:02:47.822093 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
11:02:47.823316 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:02:47.823421 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
11:02:47.823207 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
11:02:47.823096 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
11:02:47.821387 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
11:02:47.824219 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.827709 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
11:02:47.827802 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
11:02:47.828773 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:02:47.827965 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
11:02:47.833017 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:02:47.831929 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:02:47.833105 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
11:02:47.827868 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
11:02:47.834162 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:02:47.833200 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
11:02:47.834251 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
11:02:47.832093 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
11:02:47.835189 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
11:02:47.836197 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:02:47.836298 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
11:02:47.836949 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
11:02:47.837725 [debug] [Thread-2  ]: finished collecting timing info
11:02:47.837832 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
11:02:47.838075 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
11:02:47.839239 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe6529a0>]}
11:02:47.839506 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
11:02:47.839764 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
11:02:47.838153 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
11:02:47.838816 [debug] [Thread-3  ]: finished collecting timing info
11:02:47.840476 [debug] [Thread-4  ]: finished collecting timing info
11:02:47.840865 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
11:02:47.841115 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fdc81fd0>]}
11:02:47.841302 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.12s]
11:02:47.841506 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
11:02:47.840608 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
11:02:47.840747 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
11:02:47.842200 [debug] [Thread-1  ]: finished collecting timing info
11:02:47.842363 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
11:02:47.843400 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe4892b0>]}
11:02:47.843604 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
11:02:47.843832 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81ffed82b0>]}
11:02:47.844084 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
11:02:47.844292 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
11:02:47.844684 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
11:02:47.844804 [debug] [Thread-6  ]: Began running node model.first_project.customer2
11:02:47.845095 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
11:02:47.845336 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
11:02:47.845411 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
11:02:47.845477 [debug] [Thread-6  ]: Compiling model.first_project.customer2
11:02:47.847071 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
11:02:47.844878 [debug] [Thread-7  ]: Began running node model.first_project.customers
11:02:47.847441 [debug] [Thread-6  ]: finished collecting timing info
11:02:47.847623 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
11:02:47.847777 [info ] [Thread-7  ]: 6 of 7 START view model public.customers ....................................... [RUN]
11:02:47.848063 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
11:02:47.848718 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
11:02:47.848384 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
11:02:47.848800 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
11:02:47.849038 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
11:02:47.848898 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
11:02:47.850326 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
11:02:47.850715 [debug] [Thread-9  ]: finished collecting timing info
11:02:47.850852 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
11:02:47.847926 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
11:02:47.850475 [debug] [Thread-7  ]: Compiling model.first_project.customers
11:02:47.853480 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
11:02:47.857897 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
11:02:47.857475 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
11:02:47.857993 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
11:02:47.855088 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
11:02:47.858160 [debug] [Thread-9  ]: Opening a new connection, currently in state init
11:02:47.858385 [debug] [Thread-7  ]: finished collecting timing info
11:02:47.858567 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:02:47.858792 [debug] [Thread-7  ]: Began executing node model.first_project.customers
11:02:47.859278 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
11:02:47.860599 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
11:02:47.860735 [debug] [Thread-6  ]: Opening a new connection, currently in state init
11:02:47.861045 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
11:02:47.861152 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
11:02:47.861208 [debug] [Thread-7  ]: Opening a new connection, currently in state init
11:02:47.865371 [debug] [Thread-6  ]: SQL status: BEGIN in 0.0 seconds
11:02:47.865611 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:02:47.865722 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
11:02:47.867533 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
11:02:47.867699 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
11:02:47.867767 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
11:02:47.868815 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
11:02:47.868956 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
11:02:47.869023 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    


with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
11:02:47.869298 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
11:02:47.871818 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
11:02:47.871958 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
11:02:47.872069 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
11:02:47.873383 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
11:02:47.873933 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
11:02:47.875546 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.876426 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
11:02:47.876556 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.876662 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
11:02:47.877526 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
11:02:47.877654 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
11:02:47.877769 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
11:02:47.877911 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
11:02:47.878976 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
11:02:47.880210 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
11:02:47.880314 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
11:02:47.880405 [debug] [Thread-7  ]: SQL status: COMMIT in 0.0 seconds
11:02:47.882544 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:02:47.883992 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
11:02:47.883819 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
11:02:47.880497 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
11:02:47.884142 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
11:02:47.884506 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
11:02:47.884606 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
11:02:47.885349 [debug] [Thread-9  ]: finished collecting timing info
11:02:47.885505 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.886142 [debug] [Thread-7  ]: finished collecting timing info
11:02:47.887525 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:02:47.887786 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
11:02:47.887678 [debug] [Thread-7  ]: On model.first_project.customers: Close
11:02:47.886328 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
11:02:47.888148 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fc3ef9a0>]}
11:02:47.888401 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
11:02:47.888642 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
11:02:47.889495 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fc345940>]}
11:02:47.889699 [info ] [Thread-7  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
11:02:47.889949 [debug] [Thread-7  ]: Finished running node model.first_project.customers
11:02:47.891301 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
11:02:47.892166 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
11:02:47.892267 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:02:47.892333 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
11:02:47.893140 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
11:02:47.894047 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:02:47.894144 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
11:02:47.895072 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
11:02:47.895715 [debug] [Thread-6  ]: finished collecting timing info
11:02:47.895824 [debug] [Thread-6  ]: On model.first_project.customer2: Close
11:02:47.896104 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aee05df-1581-4513-8899-01017a7d9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fc3adb20>]}
11:02:47.896308 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.05s]
11:02:47.896524 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
11:02:47.899968 [debug] [MainThread]: Acquiring new postgres connection "master"
11:02:47.900186 [debug] [MainThread]: Using postgres connection "master"
11:02:47.900260 [debug] [MainThread]: On master: BEGIN
11:02:47.900316 [debug] [MainThread]: Opening a new connection, currently in state closed
11:02:47.904012 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
11:02:47.904163 [debug] [MainThread]: On master: COMMIT
11:02:47.904224 [debug] [MainThread]: Using postgres connection "master"
11:02:47.904280 [debug] [MainThread]: On master: COMMIT
11:02:47.904434 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:02:47.904534 [debug] [MainThread]: On master: Close
11:02:47.904823 [info ] [MainThread]: 
11:02:47.904984 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.24s.
11:02:47.905096 [debug] [MainThread]: Connection 'master' was properly closed.
11:02:47.905155 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
11:02:47.905219 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
11:02:47.905275 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
11:02:47.905329 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
11:02:47.905382 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
11:02:47.905435 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
11:02:47.905542 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
11:02:47.909999 [info ] [MainThread]: 
11:02:47.910244 [info ] [MainThread]: [32mCompleted successfully[0m
11:02:47.910408 [info ] [MainThread]: 
11:02:47.910524 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
11:02:47.910827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe55ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe55fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81fe4a6c40>]}


============================== 2022-06-11 11:02:54.246865 | b308d553-6739-41ca-bff2-21d5147ea36a ==============================
11:02:54.246878 [info ] [MainThread]: Running with dbt=1.1.0
11:02:54.247301 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
11:02:54.247434 [debug] [MainThread]: Tracking: tracking
11:02:54.249811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e582af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e5829a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e5829700>]}
11:02:54.283068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:02:54.283548 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:02:54.288813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b308d553-6739-41ca-bff2-21d5147ea36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e56e00d0>]}
11:02:54.292739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b308d553-6739-41ca-bff2-21d5147ea36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e5730100>]}
11:02:54.293032 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
11:02:54.293319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b308d553-6739-41ca-bff2-21d5147ea36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e582a610>]}
11:02:54.294532 [info ] [MainThread]: 
11:02:54.294869 [debug] [MainThread]: Acquiring new postgres connection "master"
11:02:54.295680 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
11:02:54.302577 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:02:54.302837 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
11:02:54.302921 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:02:54.308614 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
11:02:54.308812 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:02:54.308933 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
11:02:54.310275 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
11:02:54.311339 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
11:02:54.311650 [debug] [ThreadPool]: On list_erp_oltp_public: Close
11:02:54.314462 [debug] [MainThread]: Using postgres connection "master"
11:02:54.314566 [debug] [MainThread]: On master: BEGIN
11:02:54.314644 [debug] [MainThread]: Opening a new connection, currently in state init
11:02:54.320383 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:02:54.320620 [debug] [MainThread]: Using postgres connection "master"
11:02:54.320693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
11:02:54.330165 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
11:02:54.331219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b308d553-6739-41ca-bff2-21d5147ea36a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e57a5e50>]}
11:02:54.331527 [debug] [MainThread]: On master: ROLLBACK
11:02:54.331839 [debug] [MainThread]: On master: Close
11:02:54.332216 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
11:02:54.332470 [info ] [MainThread]: 
11:02:54.337871 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
11:02:54.338229 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
11:02:54.338342 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
11:02:54.338422 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
11:02:54.340055 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
11:02:54.340400 [debug] [Thread-1  ]: finished collecting timing info
11:02:54.340508 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
11:02:54.340782 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
11:02:54.340993 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
11:02:54.340887 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
11:02:54.340602 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
11:02:54.341074 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
11:02:54.342985 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
11:02:54.343188 [debug] [Thread-2  ]: finished collecting timing info
11:02:54.341494 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
11:02:54.341207 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
11:02:54.343670 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
11:02:54.343364 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
11:02:54.343844 [debug] [Thread-2  ]: finished collecting timing info
11:02:54.343751 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
11:02:54.344155 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
11:02:54.345219 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
11:02:54.344063 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
11:02:54.341635 [debug] [Thread-1  ]: finished collecting timing info
11:02:54.345341 [debug] [Thread-5  ]: finished collecting timing info
11:02:54.345779 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
11:02:54.345617 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
11:02:54.341142 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
11:02:54.345858 [debug] [Thread-5  ]: finished collecting timing info
11:02:54.346660 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
11:02:54.343480 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
11:02:54.346800 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
11:02:54.346436 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:54.375800 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
11:02:54.375897 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:54.375964 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:54.375477 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
11:02:54.346197 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
11:02:54.346376 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:54.346308 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
11:02:54.383725 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
11:02:54.383846 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
11:02:54.383473 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
11:02:54.383242 [debug] [Thread-3  ]: finished collecting timing info
11:02:54.383992 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
11:02:54.386165 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
11:02:54.386445 [debug] [Thread-7  ]: finished collecting timing info
11:02:54.384237 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:54.386722 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:54.383029 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
11:02:54.382686 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
11:02:54.386604 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
11:02:54.392005 [debug] [Thread-7  ]: finished collecting timing info
11:02:54.391667 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
11:02:54.391808 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
11:02:54.393121 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
11:02:54.392318 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
11:02:54.392436 [debug] [Thread-9  ]: finished collecting timing info
11:02:54.384498 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
11:02:54.393278 [debug] [Thread-8  ]: finished collecting timing info
11:02:54.393480 [debug] [Thread-4  ]: finished collecting timing info
11:02:54.393745 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:54.393918 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:54.394687 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
11:02:54.394766 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:54.394280 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:54.394382 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
11:02:54.394489 [debug] [Thread-9  ]: finished collecting timing info
11:02:54.394832 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:54.394085 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:54.394189 [debug] [Thread-3  ]: finished collecting timing info
11:02:54.394915 [debug] [Thread-8  ]: finished collecting timing info
11:02:54.395009 [debug] [Thread-4  ]: finished collecting timing info
11:02:54.395237 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:02:54.397145 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
11:02:54.397391 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
11:02:54.397668 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
11:02:54.397893 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:02:54.398117 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
11:02:54.398345 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:54.398520 [debug] [Thread-6  ]: finished collecting timing info
11:02:54.398809 [debug] [Thread-10 ]: Began running node model.first_project.customer2
11:02:54.399011 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:54.399315 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customer2"
11:02:54.401738 [debug] [Thread-10 ]: Began compiling node model.first_project.customer2
11:02:54.401411 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
11:02:54.401597 [debug] [Thread-7  ]: Began running node model.first_project.customers
11:02:54.401822 [debug] [Thread-10 ]: Compiling model.first_project.customer2
11:02:54.403781 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customer2"
11:02:54.402052 [debug] [Thread-2  ]: finished collecting timing info
11:02:54.399142 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:54.403984 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:54.404382 [debug] [Thread-2  ]: finished collecting timing info
11:02:54.404162 [debug] [Thread-10 ]: finished collecting timing info
11:02:54.404696 [debug] [Thread-10 ]: Began executing node model.first_project.customer2
11:02:54.404594 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:02:54.402323 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
11:02:54.404780 [debug] [Thread-10 ]: finished collecting timing info
11:02:54.405202 [debug] [Thread-10 ]: Finished running node model.first_project.customer2
11:02:54.404957 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
11:02:54.404284 [debug] [Thread-6  ]: finished collecting timing info
11:02:54.405395 [debug] [Thread-7  ]: Compiling model.first_project.customers
11:02:54.405612 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:02:54.407548 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
11:02:54.407848 [debug] [Thread-7  ]: finished collecting timing info
11:02:54.407962 [debug] [Thread-7  ]: Began executing node model.first_project.customers
11:02:54.408031 [debug] [Thread-7  ]: finished collecting timing info
11:02:54.408235 [debug] [Thread-7  ]: Finished running node model.first_project.customers
11:02:54.408604 [debug] [Thread-9  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:54.408717 [debug] [Thread-3  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:54.408877 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
11:02:54.409303 [debug] [Thread-9  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:54.409044 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:54.409205 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
11:02:54.408956 [debug] [Thread-8  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:54.409516 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
11:02:54.409861 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:54.409615 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:54.409922 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:54.411972 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
11:02:54.412167 [debug] [Thread-5  ]: finished collecting timing info
11:02:54.410009 [debug] [Thread-3  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:54.412329 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:54.414320 [debug] [Thread-5  ]: finished collecting timing info
11:02:54.414524 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:02:54.409779 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
11:02:54.414678 [debug] [Thread-8  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:54.414161 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
11:02:54.414752 [debug] [Thread-8  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:54.409375 [debug] [Thread-9  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:54.419725 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
11:02:54.427377 [debug] [Thread-3  ]: finished collecting timing info
11:02:54.427533 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:54.427644 [debug] [Thread-3  ]: finished collecting timing info
11:02:54.428031 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:02:54.427752 [debug] [Thread-8  ]: finished collecting timing info
11:02:54.427070 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
11:02:54.428266 [debug] [Thread-8  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:54.428423 [debug] [Thread-8  ]: finished collecting timing info
11:02:54.428643 [debug] [Thread-8  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:02:54.428879 [debug] [Thread-9  ]: finished collecting timing info
11:02:54.428981 [debug] [Thread-9  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:54.429052 [debug] [Thread-9  ]: finished collecting timing info
11:02:54.429245 [debug] [Thread-9  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:02:54.430124 [debug] [MainThread]: Connection 'master' was properly closed.
11:02:54.430210 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
11:02:54.430268 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
11:02:54.430320 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
11:02:54.430370 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
11:02:54.430421 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
11:02:54.430471 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
11:02:54.430535 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
11:02:54.430591 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
11:02:54.430641 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
11:02:54.430690 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
11:02:54.433359 [info ] [MainThread]: Done.
11:02:54.435241 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
11:02:54.435618 [info ] [MainThread]: Building catalog
11:02:54.436886 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
11:02:54.440865 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
11:02:54.440976 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
11:02:54.441047 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:02:54.445505 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
11:02:54.445646 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
11:02:54.445715 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
11:02:54.447777 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
11:02:54.453693 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
11:02:54.455505 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
11:02:54.461758 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
11:02:54.462139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e582af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e56614f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93e5661160>]}
11:02:55.067210 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
11:02:55.067684 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-11 11:05:49.340316 | 645c56c1-9423-4593-89ea-052f8f236a95 ==============================
11:05:49.340328 [info ] [MainThread]: Running with dbt=1.1.0
11:05:49.340755 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:05:49.340853 [debug] [MainThread]: Tracking: tracking
11:05:49.342915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8671ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8671f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8671fe20>]}
11:05:49.360119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
11:05:49.360503 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/customers2.sql
11:05:49.360758 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_orders.sql
11:05:49.360905 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
11:05:49.368888 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
11:05:49.377932 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
11:05:49.379367 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
11:05:49.425698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8671e040>]}
11:05:49.428885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce86610370>]}
11:05:49.429097 [info ] [MainThread]: Found 8 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
11:05:49.429236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce86610430>]}
11:05:49.430189 [info ] [MainThread]: 
11:05:49.430540 [debug] [MainThread]: Acquiring new postgres connection "master"
11:05:49.431354 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
11:05:49.437010 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
11:05:49.437144 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
11:05:49.437224 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:05:49.443895 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
11:05:49.444704 [debug] [ThreadPool]: On list_erp_oltp: Close
11:05:49.446468 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
11:05:49.450393 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:05:49.450818 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
11:05:49.450955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:05:49.455642 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
11:05:49.455820 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:05:49.455888 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
11:05:49.457171 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
11:05:49.458037 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
11:05:49.458255 [debug] [ThreadPool]: On list_erp_oltp_public: Close
11:05:49.460997 [debug] [MainThread]: Using postgres connection "master"
11:05:49.461107 [debug] [MainThread]: On master: BEGIN
11:05:49.461171 [debug] [MainThread]: Opening a new connection, currently in state init
11:05:49.465965 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
11:05:49.466143 [debug] [MainThread]: Using postgres connection "master"
11:05:49.466213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
11:05:49.475885 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
11:05:49.476937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8668c8b0>]}
11:05:49.477205 [debug] [MainThread]: On master: ROLLBACK
11:05:49.477493 [debug] [MainThread]: Using postgres connection "master"
11:05:49.477591 [debug] [MainThread]: On master: BEGIN
11:05:49.478028 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
11:05:49.478130 [debug] [MainThread]: On master: COMMIT
11:05:49.478196 [debug] [MainThread]: Using postgres connection "master"
11:05:49.478254 [debug] [MainThread]: On master: COMMIT
11:05:49.478439 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:05:49.478544 [debug] [MainThread]: On master: Close
11:05:49.478868 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
11:05:49.479115 [info ] [MainThread]: 
11:05:49.482231 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
11:05:49.482407 [info ] [Thread-1  ]: 1 of 8 START table model public.my_first_dbt_model ............................. [RUN]
11:05:49.482668 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
11:05:49.482759 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
11:05:49.482841 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
11:05:49.484427 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
11:05:49.484703 [debug] [Thread-1  ]: finished collecting timing info
11:05:49.484880 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
11:05:49.492630 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
11:05:49.492795 [info ] [Thread-2  ]: 2 of 8 START view model public.postgres_sample_source_customers ................ [RUN]
11:05:49.492914 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
11:05:49.493267 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
11:05:49.502979 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
11:05:49.493365 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
11:05:49.503314 [info ] [Thread-4  ]: 4 of 8 START view model public.stg_orders ...................................... [RUN]
11:05:49.502555 [info ] [Thread-3  ]: 3 of 8 START view model public.stg_customers ................................... [RUN]
11:05:49.503085 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
11:05:49.505441 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
11:05:49.505679 [debug] [Thread-2  ]: finished collecting timing info
11:05:49.505780 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
11:05:49.503996 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
11:05:49.503670 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
11:05:49.502100 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
11:05:49.511278 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
11:05:49.511406 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
11:05:49.515921 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
11:05:49.515745 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
11:05:49.517481 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
11:05:49.516597 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
11:05:49.515490 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
11:05:49.517912 [debug] [Thread-3  ]: finished collecting timing info
11:05:49.518530 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
11:05:49.520163 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
11:05:49.521097 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:05:49.521452 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
11:05:49.521298 [debug] [Thread-4  ]: finished collecting timing info
11:05:49.521548 [debug] [Thread-3  ]: Opening a new connection, currently in state init
11:05:49.518222 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:05:49.521711 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
11:05:49.522099 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:05:49.524863 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
11:05:49.524739 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
11:05:49.523110 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
11:05:49.525332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:05:49.525589 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:05:49.525700 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
11:05:49.525768 [debug] [Thread-4  ]: Opening a new connection, currently in state init
11:05:49.524944 [debug] [Thread-2  ]: Opening a new connection, currently in state init
11:05:49.528607 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
11:05:49.528730 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:05:49.528798 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
11:05:49.530012 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
11:05:49.534777 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:05:49.535112 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
11:05:49.535669 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
11:05:49.535867 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
11:05:49.536138 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:05:49.536024 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:05:49.536216 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
11:05:49.536488 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
11:05:49.536301 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
11:05:49.536577 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:05:49.536705 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
11:05:49.535952 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.538152 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:05:49.538242 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
11:05:49.538336 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
11:05:49.539446 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
11:05:49.543708 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:05:49.543801 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
11:05:49.542432 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:05:49.540932 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:05:49.544030 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
11:05:49.543914 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
11:05:49.544387 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.545495 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:05:49.545699 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
11:05:49.545603 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.539524 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
11:05:49.546749 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:05:49.546865 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.548825 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:05:49.547242 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
11:05:49.546935 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.548924 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
11:05:49.548992 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.554038 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
11:05:49.553249 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.554907 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
11:05:49.554132 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:05:49.554211 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.557908 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
11:05:49.558018 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:05:49.555090 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
11:05:49.555007 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:05:49.558434 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
11:05:49.553084 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
11:05:49.558118 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
11:05:49.558609 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:05:49.558870 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
11:05:49.559195 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
11:05:49.561750 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
11:05:49.561845 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
11:05:49.562714 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
11:05:49.563809 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
11:05:49.563904 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
11:05:49.563993 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
11:05:49.566228 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
11:05:49.564876 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
11:05:49.566468 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
11:05:49.566319 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
11:05:49.564072 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
11:05:49.564138 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
11:05:49.567307 [debug] [Thread-3  ]: finished collecting timing info
11:05:49.567556 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
11:05:49.567892 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8851e610>]}
11:05:49.568112 [info ] [Thread-3  ]: 3 of 8 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.06s]
11:05:49.568338 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
11:05:49.568610 [debug] [Thread-6  ]: Began running node model.first_project.customer2
11:05:49.568747 [info ] [Thread-6  ]: 5 of 8 START table model public.customer2 ...................................... [RUN]
11:05:49.568984 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
11:05:49.569059 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
11:05:49.569132 [debug] [Thread-6  ]: Compiling model.first_project.customer2
11:05:49.570584 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
11:05:49.570740 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
11:05:49.570882 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
11:05:49.572375 [debug] [Thread-2  ]: finished collecting timing info
11:05:49.571655 [debug] [Thread-4  ]: finished collecting timing info
11:05:49.572758 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
11:05:49.570984 [debug] [Thread-7  ]: Began running node model.first_project.customers2
11:05:49.572936 [info ] [Thread-7  ]: 6 of 8 START table model public.customers2 ..................................... [RUN]
11:05:49.573172 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
11:05:49.573248 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
11:05:49.573315 [debug] [Thread-7  ]: Compiling model.first_project.customers2
11:05:49.571773 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
11:05:49.574740 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
11:05:49.575811 [debug] [Thread-7  ]: finished collecting timing info
11:05:49.575904 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
11:05:49.574971 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8851e8e0>]}
11:05:49.577520 [info ] [Thread-4  ]: 4 of 8 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.07s]
11:05:49.577275 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers2"
11:05:49.572495 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
11:05:49.572627 [debug] [Thread-6  ]: finished collecting timing info
11:05:49.578131 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
11:05:49.579633 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
11:05:49.578033 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce84108eb0>]}
11:05:49.579872 [info ] [Thread-2  ]: 2 of 8 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.08s]
11:05:49.580067 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
11:05:49.577853 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
11:05:49.575601 [debug] [Thread-1  ]: finished collecting timing info
11:05:49.581360 [debug] [Thread-9  ]: Began running node model.first_project.customers
11:05:49.581969 [info ] [Thread-9  ]: 7 of 8 START view model public.customers ....................................... [RUN]
11:05:49.581791 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
11:05:49.582260 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
11:05:49.582459 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
11:05:49.582550 [debug] [Thread-9  ]: Compiling model.first_project.customers
11:05:49.584941 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
11:05:49.581646 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
11:05:49.585357 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce865f65b0>]}
11:05:49.585573 [debug] [Thread-9  ]: finished collecting timing info
11:05:49.586131 [debug] [Thread-9  ]: Began executing node model.first_project.customers
11:05:49.585674 [debug] [Thread-7  ]: On model.first_project.customers2: BEGIN
11:05:49.587729 [debug] [Thread-7  ]: Opening a new connection, currently in state init
11:05:49.585762 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:05:49.588152 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
11:05:49.588232 [debug] [Thread-6  ]: Opening a new connection, currently in state init
11:05:49.587590 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers"
11:05:49.586008 [info ] [Thread-1  ]: 1 of 8 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
11:05:49.588818 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
11:05:49.589167 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
11:05:49.589287 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
11:05:49.589384 [debug] [Thread-9  ]: On model.first_project.customers: BEGIN
11:05:49.589546 [info ] [Thread-5  ]: 8 of 8 START view model public.my_second_dbt_model ............................. [RUN]
11:05:49.589649 [debug] [Thread-9  ]: Opening a new connection, currently in state init
11:05:49.589915 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
11:05:49.590118 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
11:05:49.590194 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
11:05:49.591430 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
11:05:49.591627 [debug] [Thread-5  ]: finished collecting timing info
11:05:49.591744 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
11:05:49.593775 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
11:05:49.594188 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
11:05:49.594303 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:05:49.594374 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
11:05:49.595772 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
11:05:49.595882 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
11:05:49.595944 [debug] [Thread-5  ]: Opening a new connection, currently in state init
11:05:49.598845 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
11:05:49.601075 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:05:49.601413 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
11:05:49.601515 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
11:05:49.601633 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
11:05:49.601693 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    


with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
11:05:49.603437 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
11:05:49.603613 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
11:05:49.603688 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
11:05:49.603776 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.607112 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:05:49.607245 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.01 seconds
11:05:49.608923 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
11:05:49.609010 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
11:05:49.607382 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
11:05:49.607492 [debug] [Thread-7  ]: SQL status: SELECT 100 in 0.0 seconds
11:05:49.610284 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
11:05:49.610372 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
11:05:49.607625 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
11:05:49.610587 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
11:05:49.610658 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
11:05:49.610469 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.610798 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.611758 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
11:05:49.612804 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
11:05:49.612983 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.613989 [debug] [Thread-9  ]: On model.first_project.customers: COMMIT
11:05:49.614074 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
11:05:49.613229 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
11:05:49.615345 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
11:05:49.615459 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
11:05:49.614133 [debug] [Thread-9  ]: On model.first_project.customers: COMMIT
11:05:49.613329 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
11:05:49.613107 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:05:49.615620 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
11:05:49.615793 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
11:05:49.616084 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
11:05:49.617737 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
11:05:49.617955 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
11:05:49.618028 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
11:05:49.618404 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
11:05:49.619385 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
11:05:49.619559 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
11:05:49.619799 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
11:05:49.620643 [debug] [Thread-9  ]: finished collecting timing info
11:05:49.620762 [debug] [Thread-9  ]: On model.first_project.customers: Close
11:05:49.621060 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce86721790>]}
11:05:49.621294 [info ] [Thread-9  ]: 7 of 8 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
11:05:49.621562 [debug] [Thread-9  ]: Finished running node model.first_project.customers
11:05:49.621809 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
11:05:49.622656 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
11:05:49.622742 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
11:05:49.622964 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
11:05:49.624014 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
11:05:49.624125 [debug] [Thread-7  ]: SQL status: DROP TABLE in 0.0 seconds
11:05:49.624207 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
11:05:49.624275 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
11:05:49.625182 [debug] [Thread-7  ]: finished collecting timing info
11:05:49.627444 [debug] [Thread-7  ]: On model.first_project.customers2: Close
11:05:49.627787 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8671d640>]}
11:05:49.628019 [info ] [Thread-7  ]: 6 of 8 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.05s]
11:05:49.627204 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
11:05:49.628243 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
11:05:49.628440 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
11:05:49.629091 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
11:05:49.629723 [debug] [Thread-5  ]: finished collecting timing info
11:05:49.629838 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
11:05:49.630074 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce6c7b9fa0>]}
11:05:49.630273 [info ] [Thread-5  ]: 8 of 8 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
11:05:49.630538 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
11:05:49.631860 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
11:05:49.632519 [debug] [Thread-6  ]: finished collecting timing info
11:05:49.632633 [debug] [Thread-6  ]: On model.first_project.customer2: Close
11:05:49.632872 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '645c56c1-9423-4593-89ea-052f8f236a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8403ca30>]}
11:05:49.633060 [info ] [Thread-6  ]: 5 of 8 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.06s]
11:05:49.633323 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
11:05:49.634604 [debug] [MainThread]: Acquiring new postgres connection "master"
11:05:49.634761 [debug] [MainThread]: Using postgres connection "master"
11:05:49.634829 [debug] [MainThread]: On master: BEGIN
11:05:49.634887 [debug] [MainThread]: Opening a new connection, currently in state closed
11:05:49.639902 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
11:05:49.640102 [debug] [MainThread]: On master: COMMIT
11:05:49.640176 [debug] [MainThread]: Using postgres connection "master"
11:05:49.640240 [debug] [MainThread]: On master: COMMIT
11:05:49.640408 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
11:05:49.640560 [debug] [MainThread]: On master: Close
11:05:49.640947 [info ] [MainThread]: 
11:05:49.641164 [info ] [MainThread]: Finished running 5 view models, 3 table models in 0.21s.
11:05:49.641301 [debug] [MainThread]: Connection 'master' was properly closed.
11:05:49.641365 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
11:05:49.641422 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
11:05:49.641478 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
11:05:49.641533 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
11:05:49.641586 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
11:05:49.641647 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
11:05:49.641703 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
11:05:49.641758 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
11:05:49.644845 [info ] [MainThread]: 
11:05:49.645047 [info ] [MainThread]: [32mCompleted successfully[0m
11:05:49.645214 [info ] [MainThread]: 
11:05:49.645338 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
11:05:49.645523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce866104c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce861be910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce8668ce50>]}


============================== 2022-06-11 11:05:59.456814 | f2a6e959-0c75-43bd-b08c-2a358541654f ==============================
11:05:59.456826 [info ] [MainThread]: Running with dbt=1.1.0
11:05:59.457280 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
11:05:59.457374 [debug] [MainThread]: Tracking: tracking
11:05:59.459663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ff3143a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8300b2ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ff314a00>]}
11:05:59.477174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
11:05:59.477374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
11:05:59.481406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2a6e959-0c75-43bd-b08c-2a358541654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ff1c80d0>]}
11:05:59.485219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2a6e959-0c75-43bd-b08c-2a358541654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ff217550>]}
11:05:59.485467 [info ] [MainThread]: Found 8 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
11:05:59.485650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a6e959-0c75-43bd-b08c-2a358541654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ff2175e0>]}
11:05:59.486811 [info ] [MainThread]: 
11:05:59.487158 [debug] [MainThread]: Acquiring new postgres connection "master"
11:05:59.488100 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
11:05:59.496920 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:05:59.497118 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
11:05:59.497194 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:05:59.502691 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
11:05:59.502845 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
11:05:59.502912 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
11:05:59.504195 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
11:05:59.505557 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
11:05:59.506324 [debug] [ThreadPool]: On list_erp_oltp_public: Close
11:05:59.510120 [debug] [MainThread]: Using postgres connection "master"
11:05:59.510276 [debug] [MainThread]: On master: BEGIN
11:05:59.510345 [debug] [MainThread]: Opening a new connection, currently in state init
11:05:59.515617 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
11:05:59.515768 [debug] [MainThread]: Using postgres connection "master"
11:05:59.515838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
11:05:59.527222 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
11:05:59.528341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2a6e959-0c75-43bd-b08c-2a358541654f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82ff30c910>]}
11:05:59.528545 [debug] [MainThread]: On master: ROLLBACK
11:05:59.528855 [debug] [MainThread]: On master: Close
11:05:59.529175 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
11:05:59.529365 [info ] [MainThread]: 
11:05:59.533406 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
11:05:59.533634 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
11:05:59.533729 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
11:05:59.533804 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
11:05:59.535270 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
11:05:59.535583 [debug] [Thread-1  ]: finished collecting timing info
11:05:59.535720 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
11:05:59.535836 [debug] [Thread-1  ]: finished collecting timing info
11:05:59.536186 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
11:05:59.536305 [debug] [Thread-1  ]: Began running node model.first_project.postgres_sample_source_customers
11:05:59.536477 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
11:05:59.536556 [debug] [Thread-1  ]: Began compiling node model.first_project.postgres_sample_source_customers
11:05:59.536662 [debug] [Thread-2  ]: Began running node model.first_project.stg_customers
11:05:59.536838 [debug] [Thread-3  ]: Began running node model.first_project.stg_orders
11:05:59.537537 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_orders"
11:05:59.537619 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_orders
11:05:59.537233 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_customers"
11:05:59.536902 [debug] [Thread-4  ]: Began running node seed.first_project.code-country
11:05:59.538374 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.code-country"
11:05:59.538557 [debug] [Thread-4  ]: Began compiling node seed.first_project.code-country
11:05:59.538645 [debug] [Thread-4  ]: Compiling seed.first_project.code-country
11:05:59.537682 [debug] [Thread-3  ]: Compiling model.first_project.stg_orders
11:05:59.537943 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:05:59.538029 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_customers
11:05:59.541087 [debug] [Thread-2  ]: Compiling model.first_project.stg_customers
11:05:59.539984 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.code-country"
11:05:59.565455 [debug] [Thread-4  ]: finished collecting timing info
11:05:59.537854 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:05:59.540713 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_orders"
11:05:59.540969 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
11:05:59.566944 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:05:59.567043 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
11:05:59.537778 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
11:05:59.565609 [debug] [Thread-4  ]: Began executing node seed.first_project.code-country
11:05:59.566196 [debug] [Thread-3  ]: finished collecting timing info
11:05:59.573558 [debug] [Thread-3  ]: Began executing node model.first_project.stg_orders
11:05:59.573657 [debug] [Thread-3  ]: finished collecting timing info
11:05:59.573878 [debug] [Thread-3  ]: Finished running node model.first_project.stg_orders
11:05:59.565851 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
11:05:59.573229 [debug] [Thread-4  ]: finished collecting timing info
11:05:59.574302 [debug] [Thread-4  ]: Finished running node seed.first_project.code-country
11:05:59.573385 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
11:05:59.572993 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
11:05:59.574587 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
11:05:59.574678 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
11:05:59.573985 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:05:59.576153 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:05:59.575881 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
11:05:59.581248 [debug] [Thread-6  ]: finished collecting timing info
11:05:59.536766 [debug] [Thread-1  ]: Compiling model.first_project.postgres_sample_source_customers
11:05:59.580910 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
11:05:59.581402 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
11:05:59.582950 [debug] [Thread-6  ]: finished collecting timing info
11:05:59.582563 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
11:05:59.582768 [debug] [Thread-8  ]: finished collecting timing info
11:05:59.583151 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
11:05:59.566804 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_customers"
11:05:59.583510 [debug] [Thread-7  ]: finished collecting timing info
11:05:59.584185 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:05:59.583839 [debug] [Thread-1  ]: finished collecting timing info
11:05:59.584028 [debug] [Thread-2  ]: finished collecting timing info
11:05:59.584827 [debug] [Thread-2  ]: Began executing node model.first_project.stg_customers
11:05:59.584918 [debug] [Thread-2  ]: finished collecting timing info
11:05:59.584568 [debug] [Thread-10 ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:05:59.585372 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
11:05:59.585456 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:05:59.585521 [debug] [Thread-10 ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:05:59.584267 [debug] [Thread-7  ]: finished collecting timing info
11:05:59.587730 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
11:05:59.583678 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:05:59.584656 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:05:59.584726 [debug] [Thread-1  ]: Began executing node model.first_project.postgres_sample_source_customers
11:05:59.587354 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
11:05:59.587876 [debug] [Thread-8  ]: finished collecting timing info
11:05:59.588730 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
11:05:59.585111 [debug] [Thread-2  ]: Finished running node model.first_project.stg_customers
11:05:59.588338 [debug] [Thread-1  ]: finished collecting timing info
11:05:59.588171 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
11:05:59.589075 [debug] [Thread-1  ]: Finished running node model.first_project.postgres_sample_source_customers
11:05:59.589303 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:05:59.589831 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:05:59.589502 [debug] [Thread-3  ]: Began running node model.first_project.customer2
11:05:59.589620 [debug] [Thread-4  ]: Began running node model.first_project.customers
11:05:59.589712 [debug] [Thread-1  ]: Began running node model.first_project.customers2
11:05:59.591684 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
11:05:59.592441 [debug] [Thread-5  ]: finished collecting timing info
11:05:59.592528 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:05:59.591907 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.customer2"
11:05:59.592714 [debug] [Thread-3  ]: Began compiling node model.first_project.customer2
11:05:59.592621 [debug] [Thread-5  ]: finished collecting timing info
11:05:59.593007 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
11:05:59.592092 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.customers"
11:05:59.592789 [debug] [Thread-3  ]: Compiling model.first_project.customer2
11:05:59.594559 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.customer2"
11:05:59.589409 [debug] [Thread-10 ]: finished collecting timing info
11:05:59.592266 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
11:05:59.594747 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:05:59.595129 [debug] [Thread-10 ]: finished collecting timing info
11:05:59.594911 [debug] [Thread-3  ]: finished collecting timing info
11:05:59.595451 [debug] [Thread-3  ]: Began executing node model.first_project.customer2
11:05:59.595339 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
11:05:59.593175 [debug] [Thread-4  ]: Began compiling node model.first_project.customers
11:05:59.595529 [debug] [Thread-3  ]: finished collecting timing info
11:05:59.595861 [debug] [Thread-3  ]: Finished running node model.first_project.customer2
11:05:59.595638 [debug] [Thread-4  ]: Compiling model.first_project.customers
11:05:59.595031 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
11:05:59.597742 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.customers"
11:05:59.597993 [debug] [Thread-1  ]: Compiling model.first_project.customers2
11:05:59.599224 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
11:05:59.599456 [debug] [Thread-4  ]: finished collecting timing info
11:05:59.599563 [debug] [Thread-4  ]: Began executing node model.first_project.customers
11:05:59.599644 [debug] [Thread-4  ]: finished collecting timing info
11:05:59.599881 [debug] [Thread-4  ]: Finished running node model.first_project.customers
11:05:59.599976 [debug] [Thread-1  ]: finished collecting timing info
11:05:59.600234 [debug] [Thread-9  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:05:59.600325 [debug] [Thread-7  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:05:59.600970 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
11:05:59.601067 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:05:59.601137 [debug] [Thread-7  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
11:05:59.600687 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
11:05:59.602888 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
11:05:59.600455 [debug] [Thread-2  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:05:59.603272 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
11:05:59.603365 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:05:59.603029 [debug] [Thread-9  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:05:59.600397 [debug] [Thread-8  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:05:59.603774 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
11:05:59.603858 [debug] [Thread-8  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:05:59.603589 [debug] [Thread-9  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:05:59.603474 [debug] [Thread-2  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
11:05:59.613912 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
11:05:59.603940 [debug] [Thread-8  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:05:59.609194 [debug] [Thread-7  ]: finished collecting timing info
11:05:59.618518 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:05:59.618626 [debug] [Thread-7  ]: finished collecting timing info
11:05:59.600517 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
11:05:59.619007 [debug] [Thread-1  ]: finished collecting timing info
11:05:59.619223 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
11:05:59.618849 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
11:05:59.619562 [debug] [Thread-2  ]: finished collecting timing info
11:05:59.619694 [debug] [Thread-2  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:05:59.619764 [debug] [Thread-2  ]: finished collecting timing info
11:05:59.619932 [debug] [Thread-2  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
11:05:59.611959 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
11:05:59.620132 [debug] [Thread-9  ]: finished collecting timing info
11:05:59.620210 [debug] [Thread-9  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:05:59.620360 [debug] [Thread-9  ]: finished collecting timing info
11:05:59.620537 [debug] [Thread-9  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
11:05:59.618237 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
11:05:59.620718 [debug] [Thread-8  ]: finished collecting timing info
11:05:59.620801 [debug] [Thread-8  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:05:59.620909 [debug] [Thread-8  ]: finished collecting timing info
11:05:59.621073 [debug] [Thread-8  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
11:05:59.622109 [debug] [MainThread]: Connection 'master' was properly closed.
11:05:59.622216 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
11:05:59.622296 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
11:05:59.622353 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
11:05:59.622403 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
11:05:59.622451 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
11:05:59.622500 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
11:05:59.622548 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
11:05:59.622597 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
11:05:59.622645 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
11:05:59.622694 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
11:05:59.625990 [info ] [MainThread]: Done.
11:05:59.627444 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
11:05:59.627539 [info ] [MainThread]: Building catalog
11:05:59.629021 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
11:05:59.632823 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
11:05:59.632928 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
11:05:59.633037 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:05:59.636589 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
11:05:59.636693 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
11:05:59.636756 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
11:05:59.641747 [debug] [ThreadPool]: SQL status: SELECT 83 in 0.0 seconds
11:05:59.647819 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
11:05:59.648274 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
11:05:59.655599 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first-project-dbt/target/catalog.json
11:05:59.655999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8300b2ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8300b2ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82fc0e1760>]}
11:06:00.292856 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
11:06:00.294055 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-11 11:06:21.566715 | 50ce7c15-3858-4fc1-837c-8ff228d1aa66 ==============================
11:06:21.566729 [info ] [MainThread]: Running with dbt=1.1.0
11:06:21.567124 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
11:06:21.567228 [debug] [MainThread]: Tracking: tracking
11:06:21.569451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6747189610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6747188880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6747188700>]}
11:06:21.570981 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
11:06:21.571147 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
11:06:21.571265 [info ] [MainThread]: 
11:06:21.571366 [info ] [MainThread]: 
11:06:21.571502 [info ] [MainThread]: Press Ctrl+C to exit.
