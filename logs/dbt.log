

============================== 2022-06-04 13:42:24.650737 | 6b323608-63a3-4df5-b7d4-d9efa9a2596e ==============================
13:42:24.650748 [info ] [MainThread]: Running with dbt=1.1.0
13:42:24.651104 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:42:24.651195 [debug] [MainThread]: Tracking: tracking
13:42:24.657220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe745dac9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe745dacc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe745daca60>]}
13:42:24.706669 [debug] [MainThread]: Executing "git --help"
13:42:24.722570 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:42:24.722920 [debug] [MainThread]: STDERR: "b''"
13:42:24.726093 [debug] [MainThread]: Acquiring new postgres connection "debug"
13:42:24.726416 [debug] [MainThread]: Using postgres connection "debug"
13:42:24.726495 [debug] [MainThread]: On debug: select 1 as id
13:42:24.726557 [debug] [MainThread]: Opening a new connection, currently in state init
13:42:24.731342 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
13:42:24.732267 [debug] [MainThread]: On debug: Close
13:42:24.732572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7445b2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7445b0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7445b0b20>]}
13:42:25.322233 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-04 14:18:18.532766 | 5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1 ==============================
14:18:18.532784 [info ] [MainThread]: Running with dbt=1.1.0
14:18:18.533251 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:18:18.533386 [debug] [MainThread]: Tracking: tracking
14:18:18.536053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bca45820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bca45fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bca45d30>]}
14:18:18.544313 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
14:18:18.544588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc9fa550>]}
14:18:18.550959 [debug] [MainThread]: Parsing macros/catalog.sql
14:18:18.553103 [debug] [MainThread]: Parsing macros/relations.sql
14:18:18.554054 [debug] [MainThread]: Parsing macros/adapters.sql
14:18:18.570141 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
14:18:18.571297 [debug] [MainThread]: Parsing macros/materializations/configs.sql
14:18:18.572821 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
14:18:18.575119 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
14:18:18.581761 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
14:18:18.591095 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
14:18:18.601676 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
14:18:18.604568 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
14:18:18.605622 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
14:18:18.606402 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
14:18:18.607756 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
14:18:18.609315 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
14:18:18.613381 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
14:18:18.618018 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
14:18:18.619784 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
14:18:18.630181 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
14:18:18.634123 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
14:18:18.635320 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
14:18:18.638119 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
14:18:18.639304 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
14:18:18.647897 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
14:18:18.658965 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
14:18:18.666156 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
14:18:18.667478 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
14:18:18.669079 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
14:18:18.670046 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
14:18:18.670893 [debug] [MainThread]: Parsing macros/adapters/columns.sql
14:18:18.676828 [debug] [MainThread]: Parsing macros/adapters/relation.sql
14:18:18.682272 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
14:18:18.684046 [debug] [MainThread]: Parsing macros/adapters/schema.sql
14:18:18.685442 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
14:18:18.687136 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
14:18:18.691969 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
14:18:18.695284 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
14:18:18.696295 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
14:18:18.697035 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
14:18:18.697511 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
14:18:18.698336 [debug] [MainThread]: Parsing macros/etc/datetime.sql
14:18:18.703124 [debug] [MainThread]: Parsing macros/etc/statement.sql
14:18:18.705846 [debug] [MainThread]: Parsing tests/generic/builtin.sql
14:18:18.844098 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:18:18.852666 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
14:18:18.855249 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
14:18:18.899770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc54d0d0>]}
14:18:18.904742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bec19400>]}
14:18:18.905097 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:18:18.905307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bec19430>]}
14:18:18.906413 [info ] [MainThread]: 
14:18:18.907017 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:18.907880 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:18:18.920036 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:18:18.921031 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:18:18.921219 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:18.931964 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:18:18.934173 [debug] [ThreadPool]: On list_erp_oltp: Close
14:18:18.937411 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:18:18.946485 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:18.946826 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:18:18.946978 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:18.952868 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:18:18.953090 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:18.953199 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:18:18.956666 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
14:18:18.957826 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:18:18.958121 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:18:18.960966 [debug] [MainThread]: Using postgres connection "master"
14:18:18.961096 [debug] [MainThread]: On master: BEGIN
14:18:18.961177 [debug] [MainThread]: Opening a new connection, currently in state init
14:18:18.973860 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:18:18.974056 [debug] [MainThread]: Using postgres connection "master"
14:18:18.974133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:18:18.983825 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
14:18:18.984743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56beb9b940>]}
14:18:18.984998 [debug] [MainThread]: On master: ROLLBACK
14:18:18.985242 [debug] [MainThread]: Using postgres connection "master"
14:18:18.985345 [debug] [MainThread]: On master: BEGIN
14:18:18.985572 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:18.985718 [debug] [MainThread]: On master: COMMIT
14:18:18.985787 [debug] [MainThread]: Using postgres connection "master"
14:18:18.985843 [debug] [MainThread]: On master: COMMIT
14:18:18.986009 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:18.986109 [debug] [MainThread]: On master: Close
14:18:18.986388 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:18:18.986593 [info ] [MainThread]: 
14:18:18.990757 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:18:18.991014 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:18:18.991269 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:18:18.991351 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:18:18.991449 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:18:18.992276 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:18:18.992575 [debug] [Thread-1  ]: finished collecting timing info
14:18:18.992673 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:18:19.000332 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:18:19.000668 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:18:19.000995 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:18:19.001091 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:18:19.001321 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:18:19.003063 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:18:19.003342 [debug] [Thread-2  ]: finished collecting timing info
14:18:19.003435 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:18:19.036594 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:18:19.039316 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:18:19.040163 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:19.040300 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:18:19.040408 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:18:19.040640 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:19.041193 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:18:19.041277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:19.044201 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
14:18:19.044312 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:19.044379 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:18:19.050787 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:18:19.051042 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:19.051163 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    customers.sql
with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name
  from erp_oltp.public.clientes
)
select * from customers
  );
14:18:19.051467 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "customers"
LINE 4:     customers.sql
            ^

14:18:19.051674 [debug] [Thread-1  ]: On model.first_project.customers: ROLLBACK
14:18:19.052007 [debug] [Thread-1  ]: finished collecting timing info
14:18:19.052146 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:18:19.052474 [debug] [Thread-1  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "customers"
  LINE 4:     customers.sql
              ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
14:18:19.052759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc47f7c0>]}
14:18:19.053044 [error] [Thread-1  ]: 1 of 3 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.06s]
14:18:19.053485 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:18:19.053633 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
14:18:19.058664 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:19.058854 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:18:19.059289 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:19.066696 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:19.066874 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:19.066947 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:19.069046 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:18:19.073530 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:19.073732 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:18:19.074079 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:18:19.074830 [debug] [Thread-2  ]: finished collecting timing info
14:18:19.074970 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:18:19.075334 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc46dd00>]}
14:18:19.075564 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
14:18:19.075801 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:18:19.076386 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:18:19.076538 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:18:19.076767 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:18:19.076843 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:18:19.076915 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:18:19.078296 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:18:19.078544 [debug] [Thread-4  ]: finished collecting timing info
14:18:19.078690 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:18:19.081370 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:18:19.081729 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:19.081909 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:18:19.081996 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:18:19.087429 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:18:19.087667 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:19.087770 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:18:19.090345 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:18:19.091933 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:19.092038 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:18:19.092298 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:19.093058 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:19.093150 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:19.093215 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:19.093978 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:18:19.094858 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:19.094948 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:18:19.095447 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:19.097700 [debug] [Thread-4  ]: finished collecting timing info
14:18:19.097883 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:18:19.098333 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d2f89e6-7a04-4890-bf0e-fd42c7acd1f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc4528b0>]}
14:18:19.098595 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
14:18:19.098865 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:18:19.100654 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:19.100813 [debug] [MainThread]: Using postgres connection "master"
14:18:19.100886 [debug] [MainThread]: On master: BEGIN
14:18:19.100945 [debug] [MainThread]: Opening a new connection, currently in state closed
14:18:19.104906 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:19.105031 [debug] [MainThread]: On master: COMMIT
14:18:19.105096 [debug] [MainThread]: Using postgres connection "master"
14:18:19.105180 [debug] [MainThread]: On master: COMMIT
14:18:19.105318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:19.105404 [debug] [MainThread]: On master: Close
14:18:19.105691 [info ] [MainThread]: 
14:18:19.105850 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.20s.
14:18:19.105961 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:19.106019 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:18:19.106072 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:18:19.106174 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:18:19.108707 [info ] [MainThread]: 
14:18:19.109833 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
14:18:19.110002 [info ] [MainThread]: 
14:18:19.110127 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
14:18:19.110231 [error] [MainThread]:   syntax error at or near "customers"
14:18:19.110327 [error] [MainThread]:   LINE 4:     customers.sql
14:18:19.110737 [error] [MainThread]:               ^
14:18:19.110836 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
14:18:19.110942 [info ] [MainThread]: 
14:18:19.111064 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
14:18:19.111233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bca4b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56be309dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56bc4603a0>]}


============================== 2022-06-04 14:18:49.503431 | a3fe30c9-6c9a-4221-86a5-0eb7293f7b06 ==============================
14:18:49.503446 [info ] [MainThread]: Running with dbt=1.1.0
14:18:49.503794 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:18:49.503882 [debug] [MainThread]: Tracking: tracking
14:18:49.506648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d5c4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d5c4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d5c4040>]}
14:18:49.526360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:18:49.526707 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
14:18:49.534902 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:18:49.556912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d0880d0>]}
14:18:49.560211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d54eeb0>]}
14:18:49.560438 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:18:49.560622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d54ee80>]}
14:18:49.561906 [info ] [MainThread]: 
14:18:49.562419 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:49.563176 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:18:49.571718 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:18:49.571952 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:18:49.572038 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:49.577345 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:18:49.578684 [debug] [ThreadPool]: On list_erp_oltp: Close
14:18:49.579592 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:18:49.583481 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:49.583663 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:18:49.583743 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:49.588500 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:18:49.588684 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:49.588756 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:18:49.590174 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
14:18:49.591118 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:18:49.591317 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:18:49.622492 [debug] [MainThread]: Using postgres connection "master"
14:18:49.622677 [debug] [MainThread]: On master: BEGIN
14:18:49.622744 [debug] [MainThread]: Opening a new connection, currently in state init
14:18:49.627249 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:49.627410 [debug] [MainThread]: Using postgres connection "master"
14:18:49.627481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:18:49.636451 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
14:18:49.637635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1ee4a970>]}
14:18:49.637922 [debug] [MainThread]: On master: ROLLBACK
14:18:49.638233 [debug] [MainThread]: Using postgres connection "master"
14:18:49.638339 [debug] [MainThread]: On master: BEGIN
14:18:49.638799 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:49.638909 [debug] [MainThread]: On master: COMMIT
14:18:49.638981 [debug] [MainThread]: Using postgres connection "master"
14:18:49.639040 [debug] [MainThread]: On master: COMMIT
14:18:49.639273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:49.639388 [debug] [MainThread]: On master: Close
14:18:49.639669 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:18:49.639845 [info ] [MainThread]: 
14:18:49.644137 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:18:49.644372 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:18:49.644802 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:18:49.644962 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:18:49.645109 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:18:49.646201 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:18:49.646444 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:18:49.646721 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:18:49.647020 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:18:49.647107 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:18:49.647177 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:18:49.648568 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:18:49.648816 [debug] [Thread-2  ]: finished collecting timing info
14:18:49.648955 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:18:49.665671 [debug] [Thread-1  ]: finished collecting timing info
14:18:49.669766 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:18:49.670137 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:18:49.683864 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:18:49.684289 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.684410 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:18:49.684484 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:18:49.684705 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:49.684820 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:18:49.684921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:49.689469 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:18:49.689652 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:49.689732 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name
  from erp_oltp.public.clientes
)
select * from customers
  );
14:18:49.690344 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:18:49.690458 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.690521 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:18:49.691488 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:18:49.696896 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.697070 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:18:49.698556 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:49.698663 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:18:49.697213 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:18:49.699108 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:49.702967 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:18:49.703082 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:49.703160 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:18:49.703306 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:49.704544 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.704675 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:18:49.705025 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:49.708288 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:49.708418 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.708482 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:49.708624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
14:18:49.711700 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:49.711852 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:18:49.712030 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:18:49.712192 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:49.713702 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:49.714526 [debug] [Thread-1  ]: finished collecting timing info
14:18:49.714659 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:18:49.714826 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:18:49.717187 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d5aa130>]}
14:18:49.717502 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
14:18:49.717945 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:18:49.718048 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:18:49.719982 [debug] [Thread-2  ]: finished collecting timing info
14:18:49.720097 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:18:49.721429 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d01c6a0>]}
14:18:49.721653 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
14:18:49.721893 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:18:49.722248 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:18:49.722396 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:18:49.722638 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:18:49.722717 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:18:49.722787 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:18:49.724060 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:18:49.724282 [debug] [Thread-4  ]: finished collecting timing info
14:18:49.724387 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:18:49.725760 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:18:49.726195 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:49.726305 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:18:49.726370 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:18:49.731816 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:18:49.731968 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:49.732062 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:18:49.733018 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:18:49.734678 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:49.734775 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:18:49.735100 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:49.735915 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:49.736003 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:49.736065 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:49.736693 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:18:49.737650 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:49.737778 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:18:49.737967 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:49.738578 [debug] [Thread-4  ]: finished collecting timing info
14:18:49.738687 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:18:49.741152 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3fe30c9-6c9a-4221-86a5-0eb7293f7b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1f79b700>]}
14:18:49.741416 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
14:18:49.741804 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:18:49.745249 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:49.745487 [debug] [MainThread]: Using postgres connection "master"
14:18:49.745559 [debug] [MainThread]: On master: BEGIN
14:18:49.745650 [debug] [MainThread]: Opening a new connection, currently in state closed
14:18:49.755131 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:18:49.755297 [debug] [MainThread]: On master: COMMIT
14:18:49.755359 [debug] [MainThread]: Using postgres connection "master"
14:18:49.755416 [debug] [MainThread]: On master: COMMIT
14:18:49.755660 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:49.755781 [debug] [MainThread]: On master: Close
14:18:49.756115 [info ] [MainThread]: 
14:18:49.756268 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.19s.
14:18:49.756371 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:49.756423 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:18:49.756472 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:18:49.756519 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:18:49.760118 [info ] [MainThread]: 
14:18:49.760341 [info ] [MainThread]: [32mCompleted successfully[0m
14:18:49.760499 [info ] [MainThread]: 
14:18:49.760610 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:18:49.760790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1d54ea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1edd35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb1f734d90>]}


============================== 2022-06-04 14:30:52.103022 | 77030143-cfa1-428e-a15c-ddd1e8749edb ==============================
14:30:52.103036 [info ] [MainThread]: Running with dbt=1.1.0
14:30:52.103437 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:30:52.103531 [debug] [MainThread]: Tracking: tracking
14:30:52.106151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1679bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1679bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1679b040>]}
14:30:52.141138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:30:52.143942 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
14:30:52.152273 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:30:52.175743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1625f0d0>]}
14:30:52.179809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c16727eb0>]}
14:30:52.180064 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:30:52.180235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c16727e80>]}
14:30:52.181208 [info ] [MainThread]: 
14:30:52.181556 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:52.182576 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:30:52.189798 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:30:52.190024 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:30:52.190120 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:52.197568 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:30:52.198699 [debug] [ThreadPool]: On list_erp_oltp: Close
14:30:52.199902 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:30:52.204097 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:52.204247 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:30:52.204321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:30:52.211031 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:30:52.211471 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:52.211791 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:30:52.214785 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:30:52.215803 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:30:52.216033 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:30:52.245423 [debug] [MainThread]: Using postgres connection "master"
14:30:52.245713 [debug] [MainThread]: On master: BEGIN
14:30:52.245810 [debug] [MainThread]: Opening a new connection, currently in state init
14:30:52.250751 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:52.250913 [debug] [MainThread]: Using postgres connection "master"
14:30:52.250980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:30:52.260035 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:30:52.261199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c166e2580>]}
14:30:52.261480 [debug] [MainThread]: On master: ROLLBACK
14:30:52.261834 [debug] [MainThread]: Using postgres connection "master"
14:30:52.261967 [debug] [MainThread]: On master: BEGIN
14:30:52.262268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:52.262431 [debug] [MainThread]: On master: COMMIT
14:30:52.262552 [debug] [MainThread]: Using postgres connection "master"
14:30:52.262668 [debug] [MainThread]: On master: COMMIT
14:30:52.262877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:52.263036 [debug] [MainThread]: On master: Close
14:30:52.263474 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:30:52.263671 [info ] [MainThread]: 
14:30:52.270088 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:30:52.270336 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:30:52.270645 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:30:52.270772 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:30:52.270861 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:30:52.271681 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:30:52.271970 [debug] [Thread-1  ]: finished collecting timing info
14:30:52.272112 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:30:52.278884 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:30:52.279142 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:30:52.279438 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:30:52.279514 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:30:52.279579 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:30:52.281012 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:30:52.292876 [debug] [Thread-2  ]: finished collecting timing info
14:30:52.293376 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:30:52.303729 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:30:52.311971 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:30:52.312374 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.312484 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:30:52.312559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:52.312966 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.313485 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:30:52.313552 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:30:52.317027 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
14:30:52.317270 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.317372 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
14:30:52.317517 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
14:30:52.317713 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.317864 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:30:52.318811 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:30:52.323059 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.323168 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:30:52.323274 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:30:52.325249 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.325410 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:52.325568 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
14:30:52.327330 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.327530 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:30:52.327894 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:52.330143 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.330347 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:30:52.330484 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:52.336549 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:52.336703 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
14:30:52.336855 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.337702 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:30:52.338006 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.337888 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:52.338086 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:30:52.341614 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:30:52.345478 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:52.345617 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:30:52.345723 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
14:30:52.346700 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:52.346797 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:30:52.347145 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:30:52.348103 [debug] [Thread-2  ]: finished collecting timing info
14:30:52.348220 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:30:52.348317 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:52.350212 [debug] [Thread-1  ]: finished collecting timing info
14:30:52.350506 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c16219a90>]}
14:30:52.350647 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:30:52.350924 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
14:30:52.351243 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:30:52.351468 [debug] [Thread-2  ]: Began running node model.first_project.my_second_dbt_model
14:30:52.351597 [info ] [Thread-2  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:30:52.351891 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:30:52.351976 [debug] [Thread-2  ]: Began compiling node model.first_project.my_second_dbt_model
14:30:52.352050 [debug] [Thread-2  ]: Compiling model.first_project.my_second_dbt_model
14:30:52.353399 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:30:52.353749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1621d970>]}
14:30:52.354000 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
14:30:52.354227 [debug] [Thread-2  ]: finished collecting timing info
14:30:52.354391 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:30:52.354485 [debug] [Thread-2  ]: Began executing node model.first_project.my_second_dbt_model
14:30:52.356787 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:30:52.357191 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:52.357324 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: BEGIN
14:30:52.357426 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:52.364612 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:30:52.364792 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:52.364881 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:30:52.365892 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:52.367346 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:52.367448 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:30:52.367709 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:52.368704 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:52.368797 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:52.368873 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:52.371236 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:30:52.372962 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:52.373089 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:30:52.373434 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:52.374400 [debug] [Thread-2  ]: finished collecting timing info
14:30:52.374573 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: Close
14:30:52.375215 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77030143-cfa1-428e-a15c-ddd1e8749edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c161c8910>]}
14:30:52.375712 [info ] [Thread-2  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
14:30:52.376165 [debug] [Thread-2  ]: Finished running node model.first_project.my_second_dbt_model
14:30:52.377242 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:52.377358 [debug] [MainThread]: Using postgres connection "master"
14:30:52.377422 [debug] [MainThread]: On master: BEGIN
14:30:52.377480 [debug] [MainThread]: Opening a new connection, currently in state closed
14:30:52.383587 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:30:52.383732 [debug] [MainThread]: On master: COMMIT
14:30:52.383798 [debug] [MainThread]: Using postgres connection "master"
14:30:52.383857 [debug] [MainThread]: On master: COMMIT
14:30:52.384026 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:52.384125 [debug] [MainThread]: On master: Close
14:30:52.384400 [info ] [MainThread]: 
14:30:52.384593 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.20s.
14:30:52.384707 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:52.384782 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:30:52.384850 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:30:52.388822 [info ] [MainThread]: 
14:30:52.389298 [info ] [MainThread]: [32mCompleted successfully[0m
14:30:52.389457 [info ] [MainThread]: 
14:30:52.389563 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:30:52.389810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c180210a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1858a160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1890bf10>]}


============================== 2022-06-04 14:46:38.123061 | 33057868-0c1f-4dd6-a2fc-4b5c5399cc18 ==============================
14:46:38.123075 [info ] [MainThread]: Running with dbt=1.1.0
14:46:38.123442 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:46:38.123535 [debug] [MainThread]: Tracking: tracking
14:46:38.126558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f434b8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f434b85b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f434b8610>]}
14:46:38.149214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:46:38.149811 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
14:46:38.158053 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:46:38.174741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42f870d0>]}
14:46:38.178498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f43450d00>]}
14:46:38.178740 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:46:38.178932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f43450e80>]}
14:46:38.179901 [info ] [MainThread]: 
14:46:38.180249 [debug] [MainThread]: Acquiring new postgres connection "master"
14:46:38.181394 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:46:38.188081 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:46:38.188281 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:46:38.188356 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:38.194362 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:46:38.195757 [debug] [ThreadPool]: On list_erp_oltp: Close
14:46:38.196818 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:46:38.201028 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:46:38.201202 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:46:38.201281 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:38.205494 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:46:38.205719 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:46:38.205848 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:46:38.207314 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:46:38.208227 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:46:38.208482 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:46:38.234532 [debug] [MainThread]: Using postgres connection "master"
14:46:38.234749 [debug] [MainThread]: On master: BEGIN
14:46:38.234844 [debug] [MainThread]: Opening a new connection, currently in state init
14:46:38.240047 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:46:38.240196 [debug] [MainThread]: Using postgres connection "master"
14:46:38.240266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:46:38.248941 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:46:38.250206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42f6a0a0>]}
14:46:38.250452 [debug] [MainThread]: On master: ROLLBACK
14:46:38.250801 [debug] [MainThread]: Using postgres connection "master"
14:46:38.250959 [debug] [MainThread]: On master: BEGIN
14:46:38.251308 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:46:38.251430 [debug] [MainThread]: On master: COMMIT
14:46:38.251521 [debug] [MainThread]: Using postgres connection "master"
14:46:38.251656 [debug] [MainThread]: On master: COMMIT
14:46:38.251880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:46:38.252038 [debug] [MainThread]: On master: Close
14:46:38.252438 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:46:38.252707 [info ] [MainThread]: 
14:46:38.257429 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:46:38.257831 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:46:38.258004 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:46:38.258389 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:46:38.258621 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:46:38.259041 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:46:38.259120 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:46:38.259200 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:46:38.258749 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:46:38.261170 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:46:38.261320 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:46:38.262088 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:46:38.262425 [debug] [Thread-2  ]: finished collecting timing info
14:46:38.262522 [debug] [Thread-1  ]: finished collecting timing info
14:46:38.262623 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:46:38.262727 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:46:38.292632 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:46:38.293101 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.293254 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:46:38.293323 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:46:38.300330 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:46:38.300923 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.301130 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:46:38.301249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:46:38.302657 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:46:38.302807 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.302878 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:46:38.303997 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:46:38.308763 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.310444 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:46:38.311051 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:38.313097 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.313248 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:46:38.313640 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:38.313791 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:46:38.319843 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.319971 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
14:46:38.322997 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:46:38.323227 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.323313 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:46:38.324867 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:46:38.330394 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:38.330585 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:46:38.332370 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.332544 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
14:46:38.330712 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:46:38.333940 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:38.335977 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.336145 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:46:38.336285 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:46:38.336960 [debug] [Thread-2  ]: finished collecting timing info
14:46:38.337053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:38.337840 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:46:38.337930 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.338006 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:46:38.337171 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:46:38.338356 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42f3e4c0>]}
14:46:38.338572 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
14:46:38.339791 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:46:38.340116 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:46:38.340278 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:46:38.340536 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:46:38.340619 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:46:38.340687 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:46:38.342142 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:46:38.342310 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:46:38.343165 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:38.343260 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:46:38.343378 [debug] [Thread-4  ]: finished collecting timing info
14:46:38.343499 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:46:38.344819 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:46:38.344965 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:46:38.345869 [debug] [Thread-1  ]: finished collecting timing info
14:46:38.346039 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:46:38.346195 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:38.346310 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:46:38.346426 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:46:38.347337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f42f03730>]}
14:46:38.347574 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.09s]
14:46:38.347961 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:46:38.351568 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:46:38.351797 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:38.351887 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:46:38.352809 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:46:38.354398 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:38.354502 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:46:38.354875 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:38.355718 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:46:38.355813 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:38.355875 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:46:38.356444 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:46:38.357327 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:38.357409 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:46:38.357682 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:46:38.358311 [debug] [Thread-4  ]: finished collecting timing info
14:46:38.358429 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:46:38.358775 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33057868-0c1f-4dd6-a2fc-4b5c5399cc18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f44cd07c0>]}
14:46:38.360552 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
14:46:38.360853 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:46:38.362541 [debug] [MainThread]: Acquiring new postgres connection "master"
14:46:38.362691 [debug] [MainThread]: Using postgres connection "master"
14:46:38.362760 [debug] [MainThread]: On master: BEGIN
14:46:38.362819 [debug] [MainThread]: Opening a new connection, currently in state closed
14:46:38.368087 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:46:38.368313 [debug] [MainThread]: On master: COMMIT
14:46:38.368392 [debug] [MainThread]: Using postgres connection "master"
14:46:38.368513 [debug] [MainThread]: On master: COMMIT
14:46:38.368766 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:46:38.368875 [debug] [MainThread]: On master: Close
14:46:38.369191 [info ] [MainThread]: 
14:46:38.369389 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.19s.
14:46:38.369566 [debug] [MainThread]: Connection 'master' was properly closed.
14:46:38.369650 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:46:38.369707 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:46:38.369760 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:46:38.372558 [info ] [MainThread]: 
14:46:38.372756 [info ] [MainThread]: [32mCompleted successfully[0m
14:46:38.372930 [info ] [MainThread]: 
14:46:38.373060 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:46:38.373256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f452b5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f452b32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f45634f40>]}


============================== 2022-06-04 16:30:18.958262 | 6ce328bc-fba4-4d35-900a-c36ed5de5ab6 ==============================
16:30:18.958276 [info ] [MainThread]: Running with dbt=1.1.0
16:30:18.959663 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:30:18.959782 [debug] [MainThread]: Tracking: tracking
16:30:18.962513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a82100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a82c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a82e20>]}
16:30:18.977567 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:30:18.977893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a868b0>]}
16:30:19.000852 [debug] [MainThread]: Parsing macros/catalog.sql
16:30:19.003032 [debug] [MainThread]: Parsing macros/relations.sql
16:30:19.004018 [debug] [MainThread]: Parsing macros/adapters.sql
16:30:19.019681 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:30:19.020978 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:30:19.022600 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:30:19.025202 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:30:19.031879 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:30:19.042073 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:30:19.053322 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:30:19.056441 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:30:19.057512 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:30:19.058383 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:30:19.060003 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:30:19.062021 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:30:19.067298 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:30:19.072567 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:30:19.075483 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:30:19.086519 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:30:19.090774 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:30:19.092070 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:30:19.095519 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:30:19.096728 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:30:19.114974 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:30:19.125890 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:30:19.132397 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:30:19.133727 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:30:19.135923 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:30:19.136978 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:30:19.137914 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:30:19.144515 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:30:19.150941 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:30:19.153145 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:30:19.155052 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:30:19.157247 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:30:19.162618 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:30:19.166097 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:30:19.166937 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:30:19.167520 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:30:19.167982 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:30:19.168903 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:30:19.176261 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:30:19.179466 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:30:19.330619 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:30:19.339192 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:30:19.340729 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:30:19.376276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7183348ca0>]}
16:30:19.379341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a829a0>]}
16:30:19.379580 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:30:19.379743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71833489d0>]}
16:30:19.380589 [info ] [MainThread]: 
16:30:19.380947 [debug] [MainThread]: Acquiring new postgres connection "master"
16:30:19.381617 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:30:19.388532 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:30:19.388647 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:30:19.388719 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:30:19.404762 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
16:30:19.405991 [debug] [ThreadPool]: On list_erp_oltp: Close
16:30:19.407518 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:30:19.411184 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:30:19.411377 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:30:19.411449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:30:19.417059 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:30:19.417274 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:30:19.417384 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:30:19.420218 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:30:19.421276 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:30:19.421620 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:30:19.424639 [debug] [MainThread]: Using postgres connection "master"
16:30:19.424790 [debug] [MainThread]: On master: BEGIN
16:30:19.424909 [debug] [MainThread]: Opening a new connection, currently in state init
16:30:19.429438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:19.429633 [debug] [MainThread]: Using postgres connection "master"
16:30:19.429709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:30:19.438947 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:30:19.440001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71846cd130>]}
16:30:19.440258 [debug] [MainThread]: On master: ROLLBACK
16:30:19.440555 [debug] [MainThread]: Using postgres connection "master"
16:30:19.440675 [debug] [MainThread]: On master: BEGIN
16:30:19.441195 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:19.441317 [debug] [MainThread]: On master: COMMIT
16:30:19.441395 [debug] [MainThread]: Using postgres connection "master"
16:30:19.441465 [debug] [MainThread]: On master: COMMIT
16:30:19.441648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:30:19.441799 [debug] [MainThread]: On master: Close
16:30:19.442110 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:30:19.442284 [info ] [MainThread]: 
16:30:19.448667 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:30:19.448850 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:30:19.449069 [info ] [Thread-1  ]: 1 of 3 START table model public.customers ...................................... [RUN]
16:30:19.449279 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:30:19.449608 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:30:19.449913 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:30:19.450035 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:30:19.450147 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:30:19.450259 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:30:19.450352 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:30:19.451555 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:30:19.453049 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:30:19.453385 [debug] [Thread-2  ]: finished collecting timing info
16:30:19.453533 [debug] [Thread-1  ]: finished collecting timing info
16:30:19.453637 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:30:19.453749 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:30:19.490362 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:30:19.491680 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:30:19.492496 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.492608 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:30:19.492683 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:30:19.492222 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.492957 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:30:19.493057 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:30:19.498446 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:30:19.498661 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.498730 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:30:19.499096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:30:19.499293 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.499411 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:30:19.507125 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
16:30:19.511889 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.512126 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
16:30:19.512294 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:30:19.513876 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.514897 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:30:19.515604 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:19.517105 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.517276 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:30:19.517449 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:19.518754 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.518844 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:30:19.519123 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:19.519221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:19.527528 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:30:19.527642 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.529311 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:30:19.529457 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:30:19.529581 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.529724 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:30:19.531617 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:30:19.535364 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:19.535535 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:30:19.535716 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:30:19.536881 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:19.536991 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:30:19.539277 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
16:30:19.540284 [debug] [Thread-1  ]: finished collecting timing info
16:30:19.540413 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:30:19.540620 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:30:19.541542 [debug] [Thread-2  ]: finished collecting timing info
16:30:19.541693 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:30:19.542120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71804a2df0>]}
16:30:19.542374 [info ] [Thread-1  ]: 1 of 3 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.09s]
16:30:19.542640 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:30:19.543550 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71846cd4f0>]}
16:30:19.543766 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
16:30:19.544931 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:30:19.545330 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:30:19.545551 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:30:19.545865 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:30:19.545954 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:30:19.546025 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:30:19.547372 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:30:19.547612 [debug] [Thread-4  ]: finished collecting timing info
16:30:19.547756 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:30:19.561692 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:30:19.562254 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:19.562420 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:30:19.562494 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:30:19.567433 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
16:30:19.567581 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:19.567651 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:30:19.569977 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:30:19.571580 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:19.571681 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:30:19.571980 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:19.572706 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:30:19.572787 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:19.572849 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:30:19.573681 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:30:19.575919 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:19.576074 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:30:19.576592 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:30:19.577708 [debug] [Thread-4  ]: finished collecting timing info
16:30:19.578000 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:30:19.578543 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ce328bc-fba4-4d35-900a-c36ed5de5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f718150b550>]}
16:30:19.578868 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
16:30:19.579216 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:30:19.580510 [debug] [MainThread]: Acquiring new postgres connection "master"
16:30:19.580621 [debug] [MainThread]: Using postgres connection "master"
16:30:19.580687 [debug] [MainThread]: On master: BEGIN
16:30:19.580743 [debug] [MainThread]: Opening a new connection, currently in state closed
16:30:19.585432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:19.585607 [debug] [MainThread]: On master: COMMIT
16:30:19.585740 [debug] [MainThread]: Using postgres connection "master"
16:30:19.585840 [debug] [MainThread]: On master: COMMIT
16:30:19.585992 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:30:19.586104 [debug] [MainThread]: On master: Close
16:30:19.586373 [info ] [MainThread]: 
16:30:19.586514 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.21s.
16:30:19.586620 [debug] [MainThread]: Connection 'master' was properly closed.
16:30:19.586675 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:30:19.586725 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:30:19.586776 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:30:19.589288 [info ] [MainThread]: 
16:30:19.589447 [info ] [MainThread]: [32mCompleted successfully[0m
16:30:19.589591 [info ] [MainThread]: 
16:30:19.589700 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:30:19.589867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a56190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7181a1dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71838dd7f0>]}


============================== 2022-06-04 16:35:31.829290 | d404547e-a259-4006-a988-d6855cbe208b ==============================
16:35:31.829305 [info ] [MainThread]: Running with dbt=1.1.0
16:35:31.829713 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:35:31.829815 [debug] [MainThread]: Tracking: tracking
16:35:31.832636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76481664c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7648166d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76481666d0>]}
16:35:31.845645 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:35:31.845915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764816dd60>]}
16:35:31.853333 [debug] [MainThread]: Parsing macros/catalog.sql
16:35:31.855566 [debug] [MainThread]: Parsing macros/relations.sql
16:35:31.856543 [debug] [MainThread]: Parsing macros/adapters.sql
16:35:31.881666 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:35:31.882855 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:35:31.884239 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:35:31.886595 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:35:31.892652 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:35:31.901807 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:35:31.912529 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:35:31.915397 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:35:31.916380 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:35:31.917154 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:35:31.918608 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:35:31.920173 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:35:31.924199 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:35:31.928545 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:35:31.930413 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:35:31.940723 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:35:31.944990 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:35:31.946206 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:35:31.948850 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:35:31.949939 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:35:31.957206 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:35:31.967020 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:35:31.973453 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:35:31.974521 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:35:31.976456 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:35:31.977600 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:35:31.978600 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:35:31.984867 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:35:31.991276 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:35:31.994525 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:35:31.996260 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:35:31.998066 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:35:32.002278 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:35:32.004874 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:35:32.005387 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:35:32.005905 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:35:32.006301 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:35:32.007079 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:35:32.012481 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:35:32.015283 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:35:32.151340 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:35:32.159878 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:35:32.161778 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:35:32.192389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7649a30cd0>]}
16:35:32.207773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76499860d0>]}
16:35:32.208261 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:35:32.208653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7649a30c10>]}
16:35:32.209708 [info ] [MainThread]: 
16:35:32.210012 [debug] [MainThread]: Acquiring new postgres connection "master"
16:35:32.210646 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:35:32.217762 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:35:32.217920 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:35:32.218046 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:35:32.225621 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:35:32.226860 [debug] [ThreadPool]: On list_erp_oltp: Close
16:35:32.234953 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:35:32.246159 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:35:32.246367 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:35:32.246446 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:35:32.252911 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:35:32.253116 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:35:32.253194 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:35:32.254852 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:35:32.256016 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:35:32.256322 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:35:32.259950 [debug] [MainThread]: Using postgres connection "master"
16:35:32.260152 [debug] [MainThread]: On master: BEGIN
16:35:32.260223 [debug] [MainThread]: Opening a new connection, currently in state init
16:35:32.265388 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:35:32.265553 [debug] [MainThread]: Using postgres connection "master"
16:35:32.265624 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:35:32.273940 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:35:32.275137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7648106e20>]}
16:35:32.275535 [debug] [MainThread]: On master: ROLLBACK
16:35:32.275969 [debug] [MainThread]: Using postgres connection "master"
16:35:32.276117 [debug] [MainThread]: On master: BEGIN
16:35:32.276699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:35:32.276882 [debug] [MainThread]: On master: COMMIT
16:35:32.276994 [debug] [MainThread]: Using postgres connection "master"
16:35:32.277062 [debug] [MainThread]: On master: COMMIT
16:35:32.277235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:35:32.277324 [debug] [MainThread]: On master: Close
16:35:32.277657 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:35:32.277946 [info ] [MainThread]: 
16:35:32.281584 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:35:32.281804 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
16:35:32.282129 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:35:32.282225 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:35:32.282302 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:35:32.283447 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:35:32.283689 [debug] [Thread-1  ]: finished collecting timing info
16:35:32.284835 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:35:32.285090 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:35:32.285311 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:35:32.285383 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:35:32.285444 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:35:32.286798 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:35:32.287049 [debug] [Thread-2  ]: finished collecting timing info
16:35:32.287160 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:35:32.284966 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:35:32.321423 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:35:32.322338 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:35:32.322772 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.322977 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.323175 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:35:32.323456 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:35:32.323791 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:35:32.323589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:32.329963 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:35:32.330170 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.330271 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:35:32.330669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:35:32.330822 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.330902 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:35:32.331271 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:35:32.336076 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.336264 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
16:35:32.336386 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:35:32.337926 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.338156 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:35:32.338482 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:32.338585 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:32.339873 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.341899 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.342145 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:35:32.342286 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:35:32.343054 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:32.348420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:35:32.349855 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:35:32.350700 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:35:32.350874 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.350995 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.351104 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:35:32.351215 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:35:32.352263 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:35:32.355406 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:32.355546 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:35:32.355650 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:35:32.356716 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:32.356863 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:35:32.358512 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
16:35:32.359357 [debug] [Thread-1  ]: finished collecting timing info
16:35:32.359488 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:35:32.359598 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:35:32.360288 [debug] [Thread-2  ]: finished collecting timing info
16:35:32.360423 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:35:32.360709 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764adbd3d0>]}
16:35:32.361082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647c168e0>]}
16:35:32.362090 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
16:35:32.362347 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
16:35:32.362783 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:35:32.362949 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:35:32.363278 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:35:32.363413 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:35:32.363646 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:35:32.363725 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:35:32.363835 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:35:32.365398 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:35:32.365855 [debug] [Thread-4  ]: finished collecting timing info
16:35:32.366010 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:35:32.368217 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:35:32.368597 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:32.368705 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:35:32.368774 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:35:32.372857 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
16:35:32.372990 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:32.373074 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:35:32.375203 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:35:32.376693 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:32.376820 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:35:32.377150 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:32.377882 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:35:32.377993 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:32.378073 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:35:32.378880 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:35:32.379930 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:32.380031 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:35:32.380259 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:35:32.381114 [debug] [Thread-4  ]: finished collecting timing info
16:35:32.381240 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:35:32.381639 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd404547e-a259-4006-a988-d6855cbe208b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76443079a0>]}
16:35:32.381911 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
16:35:32.383438 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:35:32.385811 [debug] [MainThread]: Acquiring new postgres connection "master"
16:35:32.385979 [debug] [MainThread]: Using postgres connection "master"
16:35:32.386053 [debug] [MainThread]: On master: BEGIN
16:35:32.386115 [debug] [MainThread]: Opening a new connection, currently in state closed
16:35:32.392455 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:35:32.392657 [debug] [MainThread]: On master: COMMIT
16:35:32.392729 [debug] [MainThread]: Using postgres connection "master"
16:35:32.392791 [debug] [MainThread]: On master: COMMIT
16:35:32.393136 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:35:32.393331 [debug] [MainThread]: On master: Close
16:35:32.393704 [info ] [MainThread]: 
16:35:32.393906 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.18s.
16:35:32.394096 [debug] [MainThread]: Connection 'master' was properly closed.
16:35:32.394162 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:35:32.394215 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:35:32.394267 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:35:32.397162 [info ] [MainThread]: 
16:35:32.397331 [info ] [MainThread]: [32mCompleted successfully[0m
16:35:32.397479 [info ] [MainThread]: 
16:35:32.397592 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:35:32.397865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76481067c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647be6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647be6d60>]}


============================== 2022-06-04 16:36:23.602053 | eb1bd2d1-89ce-44ad-96f1-f9401d216a9b ==============================
16:36:23.602067 [info ] [MainThread]: Running with dbt=1.1.0
16:36:23.602414 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:36:23.602511 [debug] [MainThread]: Tracking: tracking
16:36:23.604904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad771efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad771e0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad771efa0>]}
16:36:23.620896 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:36:23.621179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad771d9d0>]}
16:36:23.626862 [debug] [MainThread]: Parsing macros/catalog.sql
16:36:23.629043 [debug] [MainThread]: Parsing macros/relations.sql
16:36:23.631087 [debug] [MainThread]: Parsing macros/adapters.sql
16:36:23.644240 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:36:23.645404 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:36:23.647209 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:36:23.649916 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:36:23.656516 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:36:23.667444 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:36:23.679248 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:36:23.682319 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:36:23.683645 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:36:23.684608 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:36:23.686225 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:36:23.687938 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:36:23.693312 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:36:23.698177 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:36:23.700367 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:36:23.710398 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:36:23.714523 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:36:23.716109 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:36:23.719422 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:36:23.720572 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:36:23.728120 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:36:23.739105 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:36:23.745971 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:36:23.747098 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:36:23.749498 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:36:23.750487 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:36:23.751378 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:36:23.757347 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:36:23.762991 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:36:23.766115 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:36:23.767618 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:36:23.769188 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:36:23.773146 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:36:23.775942 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:36:23.776512 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:36:23.777126 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:36:23.777825 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:36:23.778682 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:36:23.783963 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:36:23.786715 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:36:23.930295 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:36:23.939001 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:36:23.940627 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:36:23.973179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad76c2be0>]}
16:36:23.976664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad771ebe0>]}
16:36:23.976955 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:36:23.977132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad76c2c40>]}
16:36:23.978069 [info ] [MainThread]: 
16:36:23.978401 [debug] [MainThread]: Acquiring new postgres connection "master"
16:36:23.979148 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:36:23.986593 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:36:23.986767 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:36:23.986853 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:36:23.993326 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:36:23.994588 [debug] [ThreadPool]: On list_erp_oltp: Close
16:36:23.996994 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:36:24.002029 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:36:24.002216 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:36:24.002299 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:36:24.008390 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:36:24.008578 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:36:24.008655 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:36:24.010721 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:36:24.012149 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:36:24.012486 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:36:24.016129 [debug] [MainThread]: Using postgres connection "master"
16:36:24.016523 [debug] [MainThread]: On master: BEGIN
16:36:24.016646 [debug] [MainThread]: Opening a new connection, currently in state init
16:36:24.021685 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:36:24.021895 [debug] [MainThread]: Using postgres connection "master"
16:36:24.021970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:36:24.029846 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:36:24.030947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad76bc340>]}
16:36:24.031198 [debug] [MainThread]: On master: ROLLBACK
16:36:24.031463 [debug] [MainThread]: Using postgres connection "master"
16:36:24.031607 [debug] [MainThread]: On master: BEGIN
16:36:24.032102 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:36:24.032222 [debug] [MainThread]: On master: COMMIT
16:36:24.032302 [debug] [MainThread]: Using postgres connection "master"
16:36:24.032373 [debug] [MainThread]: On master: COMMIT
16:36:24.032598 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:36:24.032806 [debug] [MainThread]: On master: Close
16:36:24.033342 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:36:24.033661 [info ] [MainThread]: 
16:36:24.041445 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:36:24.041689 [info ] [Thread-1  ]: 1 of 3 START table model public.customers ...................................... [RUN]
16:36:24.041989 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:36:24.042079 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:36:24.042156 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:36:24.043321 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:36:24.043641 [debug] [Thread-1  ]: finished collecting timing info
16:36:24.043780 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:36:24.045649 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:36:24.051105 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:36:24.051522 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:36:24.057006 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:36:24.057152 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:36:24.058650 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:36:24.065277 [debug] [Thread-2  ]: finished collecting timing info
16:36:24.065900 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:36:24.070897 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:36:24.072057 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:36:24.072410 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.072576 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:36:24.072646 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:36:24.072836 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.073152 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:36:24.073239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:36:24.079718 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:36:24.080025 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.080341 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:36:24.081302 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:36:24.081417 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.081487 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:36:24.084713 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
16:36:24.089158 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.089303 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:36:24.089429 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
16:36:24.090822 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.090927 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:36:24.091221 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:24.092402 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.092481 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:36:24.092990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:24.094228 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.094326 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:36:24.094439 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:24.101604 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:36:24.101781 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:36:24.102848 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:36:24.102966 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.103034 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:36:24.101914 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.103159 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:36:24.105125 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:36:24.108150 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:24.108354 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:36:24.108288 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:36:24.109382 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:24.109632 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:36:24.109538 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
16:36:24.110749 [debug] [Thread-1  ]: finished collecting timing info
16:36:24.110868 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:36:24.111003 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:36:24.111773 [debug] [Thread-2  ]: finished collecting timing info
16:36:24.111993 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:36:24.112328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad76a46a0>]}
16:36:24.114148 [info ] [Thread-1  ]: 1 of 3 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.07s]
16:36:24.114670 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:36:24.116439 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad7694910>]}
16:36:24.116727 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
16:36:24.117051 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:36:24.117448 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:36:24.117601 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:36:24.117947 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:36:24.118062 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:36:24.118140 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:36:24.119664 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:36:24.119989 [debug] [Thread-4  ]: finished collecting timing info
16:36:24.120100 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:36:24.136581 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:36:24.137482 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:24.137818 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:36:24.137925 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:36:24.143298 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:36:24.143488 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:24.143569 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:36:24.144873 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:36:24.146461 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:24.146591 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:36:24.146916 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:24.147690 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:36:24.147840 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:24.147933 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:36:24.148521 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:36:24.152440 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:24.152652 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:36:24.153132 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:36:24.155098 [debug] [Thread-4  ]: finished collecting timing info
16:36:24.155304 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:36:24.155659 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1bd2d1-89ce-44ad-96f1-f9401d216a9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad7236370>]}
16:36:24.155900 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
16:36:24.156163 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:36:24.157223 [debug] [MainThread]: Acquiring new postgres connection "master"
16:36:24.157343 [debug] [MainThread]: Using postgres connection "master"
16:36:24.157409 [debug] [MainThread]: On master: BEGIN
16:36:24.157467 [debug] [MainThread]: Opening a new connection, currently in state closed
16:36:24.161245 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:36:24.161393 [debug] [MainThread]: On master: COMMIT
16:36:24.161460 [debug] [MainThread]: Using postgres connection "master"
16:36:24.161518 [debug] [MainThread]: On master: COMMIT
16:36:24.161642 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:36:24.161727 [debug] [MainThread]: On master: Close
16:36:24.162017 [info ] [MainThread]: 
16:36:24.162169 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.18s.
16:36:24.162275 [debug] [MainThread]: Connection 'master' was properly closed.
16:36:24.162331 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:36:24.162382 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:36:24.162432 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:36:24.165293 [info ] [MainThread]: 
16:36:24.165492 [info ] [MainThread]: [32mCompleted successfully[0m
16:36:24.165673 [info ] [MainThread]: 
16:36:24.165808 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:36:24.166250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad8fe5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad72362e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ad719ce20>]}


============================== 2022-06-04 16:37:17.701914 | bcda9422-e321-432a-a2b6-6b293733e52b ==============================
16:37:17.701932 [info ] [MainThread]: Running with dbt=1.1.0
16:37:17.702574 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:37:17.702757 [debug] [MainThread]: Tracking: tracking
16:37:17.707252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab486070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab486040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab4862b0>]}
16:37:17.733766 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:37:17.734279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab48e520>]}
16:37:17.745115 [debug] [MainThread]: Parsing macros/catalog.sql
16:37:17.748665 [debug] [MainThread]: Parsing macros/relations.sql
16:37:17.749912 [debug] [MainThread]: Parsing macros/adapters.sql
16:37:17.773382 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:37:17.774872 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:37:17.777619 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:37:17.780522 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:37:17.787195 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:37:17.798286 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:37:17.809258 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:37:17.812843 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:37:17.814079 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:37:17.814976 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:37:17.816553 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:37:17.818346 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:37:17.822874 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:37:17.828328 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:37:17.830470 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:37:17.841228 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:37:17.845630 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:37:17.847094 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:37:17.850059 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:37:17.851242 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:37:17.860338 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:37:17.872034 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:37:17.880430 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:37:17.881766 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:37:17.883387 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:37:17.884508 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:37:17.885566 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:37:17.892642 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:37:17.899682 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:37:17.901778 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:37:17.903343 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:37:17.905189 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:37:17.909719 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:37:17.913248 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:37:17.913911 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:37:17.914495 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:37:17.914966 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:37:17.915901 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:37:17.929622 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:37:17.932515 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:37:18.072096 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:37:18.080255 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:37:18.082682 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:37:18.119439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeacd499a0>]}
16:37:18.122683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab4455b0>]}
16:37:18.122895 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:37:18.123050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeacd49a60>]}
16:37:18.123949 [info ] [MainThread]: 
16:37:18.124226 [debug] [MainThread]: Acquiring new postgres connection "master"
16:37:18.125132 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:37:18.131428 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:37:18.131594 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:37:18.131670 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:37:18.140075 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:37:18.141325 [debug] [ThreadPool]: On list_erp_oltp: Close
16:37:18.143183 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:37:18.148125 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:37:18.148344 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:37:18.148419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:37:18.154731 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:37:18.154956 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:37:18.155069 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:37:18.157296 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:37:18.158834 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:37:18.159460 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:37:18.163350 [debug] [MainThread]: Using postgres connection "master"
16:37:18.163531 [debug] [MainThread]: On master: BEGIN
16:37:18.163598 [debug] [MainThread]: Opening a new connection, currently in state init
16:37:18.167735 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:37:18.167897 [debug] [MainThread]: Using postgres connection "master"
16:37:18.167965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:37:18.176557 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:37:18.177622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab4205e0>]}
16:37:18.177894 [debug] [MainThread]: On master: ROLLBACK
16:37:18.178200 [debug] [MainThread]: Using postgres connection "master"
16:37:18.178314 [debug] [MainThread]: On master: BEGIN
16:37:18.178591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:37:18.178705 [debug] [MainThread]: On master: COMMIT
16:37:18.178780 [debug] [MainThread]: Using postgres connection "master"
16:37:18.178874 [debug] [MainThread]: On master: COMMIT
16:37:18.179012 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:37:18.179105 [debug] [MainThread]: On master: Close
16:37:18.179451 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:37:18.179620 [info ] [MainThread]: 
16:37:18.182990 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:37:18.183181 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
16:37:18.183475 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:37:18.183569 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:37:18.183647 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:37:18.184920 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:37:18.185190 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:37:18.185416 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:37:18.185687 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:37:18.185784 [debug] [Thread-1  ]: finished collecting timing info
16:37:18.185891 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:37:18.186013 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:37:18.186117 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:37:18.198927 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:37:18.199241 [debug] [Thread-2  ]: finished collecting timing info
16:37:18.199389 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:37:18.219925 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:37:18.220316 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.220468 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:37:18.220535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:37:18.223907 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:37:18.224201 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.224343 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:37:18.224405 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:37:18.225826 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:37:18.226042 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.226116 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:37:18.227847 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
16:37:18.231897 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.232214 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:37:18.232611 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:37:18.232736 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.232852 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:37:18.232979 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:37:18.235433 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.235544 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:37:18.235631 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:37:18.237152 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.237275 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:37:18.237366 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:37:18.241200 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:37:18.241405 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.241512 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:37:18.241656 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:37:18.243334 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.243488 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:37:18.243640 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:37:18.247474 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:37:18.247684 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:37:18.247928 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:37:18.251073 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:37:18.251206 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
16:37:18.251305 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.251988 [debug] [Thread-1  ]: finished collecting timing info
16:37:18.252129 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:37:18.252270 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:37:18.254066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeaaf8b580>]}
16:37:18.254311 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
16:37:18.254543 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:37:18.254804 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:37:18.255684 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:37:18.255784 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:37:18.256937 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:37:18.257601 [debug] [Thread-2  ]: finished collecting timing info
16:37:18.257715 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:37:18.257978 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeaaf678b0>]}
16:37:18.259509 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
16:37:18.259786 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:37:18.260194 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:37:18.260337 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:37:18.260572 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:37:18.260651 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:37:18.260719 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:37:18.262153 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:37:18.262388 [debug] [Thread-4  ]: finished collecting timing info
16:37:18.262522 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:37:18.264329 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:37:18.264529 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:37:18.264644 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:37:18.264702 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:37:18.272350 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:37:18.272543 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:37:18.272622 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:37:18.273527 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:37:18.275314 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:37:18.275610 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:37:18.276136 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:37:18.277142 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:37:18.277251 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:37:18.277319 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:37:18.278013 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:37:18.279024 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:37:18.279115 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:37:18.279316 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:37:18.279972 [debug] [Thread-4  ]: finished collecting timing info
16:37:18.280080 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:37:18.280432 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcda9422-e321-432a-a2b6-6b293733e52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea8688c10>]}
16:37:18.280666 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
16:37:18.281032 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:37:18.282438 [debug] [MainThread]: Acquiring new postgres connection "master"
16:37:18.282556 [debug] [MainThread]: Using postgres connection "master"
16:37:18.282619 [debug] [MainThread]: On master: BEGIN
16:37:18.282676 [debug] [MainThread]: Opening a new connection, currently in state closed
16:37:18.288456 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:37:18.288672 [debug] [MainThread]: On master: COMMIT
16:37:18.288750 [debug] [MainThread]: Using postgres connection "master"
16:37:18.288814 [debug] [MainThread]: On master: COMMIT
16:37:18.289006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:37:18.289111 [debug] [MainThread]: On master: Close
16:37:18.289427 [info ] [MainThread]: 
16:37:18.289580 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.17s.
16:37:18.289709 [debug] [MainThread]: Connection 'master' was properly closed.
16:37:18.289764 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:37:18.289817 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:37:18.289870 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:37:18.293234 [info ] [MainThread]: 
16:37:18.293518 [info ] [MainThread]: [32mCompleted successfully[0m
16:37:18.293717 [info ] [MainThread]: 
16:37:18.295164 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:37:18.295396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeab420df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeaaeffdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdeaaeff8b0>]}


============================== 2022-06-04 16:42:27.366546 | 68e51c5c-19e4-4b39-9896-a5006d48cb9c ==============================
16:42:27.366560 [info ] [MainThread]: Running with dbt=1.1.0
16:42:27.366931 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:42:27.367026 [debug] [MainThread]: Tracking: tracking
16:42:27.369602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8be2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8be2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8be21f0>]}
16:42:27.391475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
16:42:27.391767 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/customer2.sql
16:42:27.399233 [debug] [MainThread]: 1699: static parser successfully parsed erp/customer2.sql
16:42:27.413881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f86b90d0>]}
16:42:27.417472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8b84eb0>]}
16:42:27.417721 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:42:27.417887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8b84dc0>]}
16:42:27.418877 [info ] [MainThread]: 
16:42:27.419215 [debug] [MainThread]: Acquiring new postgres connection "master"
16:42:27.423079 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:42:27.430953 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:42:27.431143 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:42:27.431218 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:42:27.437034 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:42:27.438248 [debug] [ThreadPool]: On list_erp_oltp: Close
16:42:27.439470 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:42:27.443480 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:42:27.443606 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:42:27.443673 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:42:27.447399 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:42:27.447541 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:42:27.447615 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:42:27.449086 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:42:27.450272 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:42:27.450488 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:42:27.479885 [debug] [MainThread]: Using postgres connection "master"
16:42:27.480088 [debug] [MainThread]: On master: BEGIN
16:42:27.480174 [debug] [MainThread]: Opening a new connection, currently in state init
16:42:27.484841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:42:27.484995 [debug] [MainThread]: Using postgres connection "master"
16:42:27.485087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:42:27.493074 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:42:27.494059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8b46ee0>]}
16:42:27.494331 [debug] [MainThread]: On master: ROLLBACK
16:42:27.494801 [debug] [MainThread]: Using postgres connection "master"
16:42:27.494896 [debug] [MainThread]: On master: BEGIN
16:42:27.495162 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:42:27.495253 [debug] [MainThread]: On master: COMMIT
16:42:27.495312 [debug] [MainThread]: Using postgres connection "master"
16:42:27.495369 [debug] [MainThread]: On master: COMMIT
16:42:27.495515 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:42:27.495601 [debug] [MainThread]: On master: Close
16:42:27.495850 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:42:27.495991 [info ] [MainThread]: 
16:42:27.502130 [debug] [Thread-1  ]: Began running node model.first_project.customer2
16:42:27.502391 [info ] [Thread-1  ]: 1 of 4 START table model public.customer2 ...................................... [RUN]
16:42:27.502697 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
16:42:27.502794 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
16:42:27.502871 [debug] [Thread-1  ]: Compiling model.first_project.customer2
16:42:27.504333 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
16:42:27.504626 [debug] [Thread-1  ]: finished collecting timing info
16:42:27.504751 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
16:42:27.510373 [debug] [Thread-2  ]: Began running node model.first_project.customers
16:42:27.510533 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
16:42:27.515972 [info ] [Thread-2  ]: 2 of 4 START view model public.customers ....................................... [RUN]
16:42:27.526180 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
16:42:27.526331 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
16:42:27.526810 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers"
16:42:27.527264 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:42:27.527426 [debug] [Thread-2  ]: Began compiling node model.first_project.customers
16:42:27.527543 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
16:42:27.527649 [debug] [Thread-2  ]: Compiling model.first_project.customers
16:42:27.527781 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
16:42:27.528564 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers"
16:42:27.530257 [debug] [Thread-2  ]: finished collecting timing info
16:42:27.530375 [debug] [Thread-2  ]: Began executing node model.first_project.customers
16:42:27.529978 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:42:27.528683 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
16:42:27.543564 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
16:42:27.543694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:42:27.544104 [debug] [Thread-3  ]: finished collecting timing info
16:42:27.544285 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
16:42:27.543409 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers"
16:42:27.546504 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:42:27.546964 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.547102 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.547213 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
16:42:27.547325 [debug] [Thread-2  ]: On model.first_project.customers: BEGIN
16:42:27.547432 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:42:27.547763 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:42:27.551467 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:42:27.551596 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
16:42:27.551691 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:42:27.556993 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
16:42:27.561062 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
16:42:27.561422 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
16:42:27.561873 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:27.568215 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
16:42:27.574747 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
16:42:27.575713 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.575550 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.575836 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:42:27.575421 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
16:42:27.575943 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:42:27.576103 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
16:42:27.576246 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
16:42:27.577325 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
16:42:27.578754 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.578867 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
16:42:27.580370 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.579025 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:42:27.580468 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:42:27.578958 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:42:27.583289 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
16:42:27.583405 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:27.589111 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.587199 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
16:42:27.589281 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:42:27.583492 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
16:42:27.591051 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.591608 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
16:42:27.591731 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:42:27.592653 [debug] [Thread-1  ]: finished collecting timing info
16:42:27.592996 [debug] [Thread-1  ]: On model.first_project.customer2: Close
16:42:27.593317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f86815b0>]}
16:42:27.593561 [info ] [Thread-1  ]: 1 of 4 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.09s]
16:42:27.592774 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:27.595831 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
16:42:27.595929 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.594999 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:27.595995 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
16:42:27.594879 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
16:42:27.597087 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
16:42:27.597446 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.597527 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
16:42:27.598495 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
16:42:27.599616 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:27.599724 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:42:27.601612 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:42:27.601939 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
16:42:27.603375 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
16:42:27.605166 [debug] [Thread-3  ]: finished collecting timing info
16:42:27.605707 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:42:27.605979 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
16:42:27.608891 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f86371f0>]}
16:42:27.609744 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
16:42:27.610436 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
16:42:27.610976 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
16:42:27.611278 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
16:42:27.611923 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:42:27.612201 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
16:42:27.612439 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
16:42:27.612648 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
16:42:27.619976 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:42:27.620478 [debug] [Thread-5  ]: finished collecting timing info
16:42:27.620709 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
16:42:27.615245 [debug] [Thread-2  ]: finished collecting timing info
16:42:27.629084 [debug] [Thread-2  ]: On model.first_project.customers: Close
16:42:27.632074 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f86185b0>]}
16:42:27.625849 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:42:27.633296 [info ] [Thread-2  ]: 2 of 4 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.11s]
16:42:27.635597 [debug] [Thread-2  ]: Finished running node model.first_project.customers
16:42:27.636124 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:27.636300 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
16:42:27.636399 [debug] [Thread-5  ]: Opening a new connection, currently in state init
16:42:27.642581 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
16:42:27.642823 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:27.642949 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:42:27.644940 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
16:42:27.650478 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:27.650710 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:42:27.651177 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:27.652071 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
16:42:27.652213 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:27.652309 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
16:42:27.653099 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
16:42:27.656053 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:27.656303 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:42:27.656664 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
16:42:27.657670 [debug] [Thread-5  ]: finished collecting timing info
16:42:27.657931 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
16:42:27.662762 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68e51c5c-19e4-4b39-9896-a5006d48cb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f85c5910>]}
16:42:27.663213 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
16:42:27.663553 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
16:42:27.665466 [debug] [MainThread]: Acquiring new postgres connection "master"
16:42:27.665637 [debug] [MainThread]: Using postgres connection "master"
16:42:27.665714 [debug] [MainThread]: On master: BEGIN
16:42:27.665777 [debug] [MainThread]: Opening a new connection, currently in state closed
16:42:27.669746 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:42:27.669912 [debug] [MainThread]: On master: COMMIT
16:42:27.669984 [debug] [MainThread]: Using postgres connection "master"
16:42:27.670075 [debug] [MainThread]: On master: COMMIT
16:42:27.670257 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:42:27.670350 [debug] [MainThread]: On master: Close
16:42:27.670682 [info ] [MainThread]: 
16:42:27.670919 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0.25s.
16:42:27.671220 [debug] [MainThread]: Connection 'master' was properly closed.
16:42:27.671294 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:42:27.671352 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
16:42:27.671408 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:42:27.671464 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:42:27.675620 [info ] [MainThread]: 
16:42:27.675924 [info ] [MainThread]: [32mCompleted successfully[0m
16:42:27.676361 [info ] [MainThread]: 
16:42:27.677148 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
16:42:27.677375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f8aefeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fad5b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8fad5b820>]}


============================== 2022-06-04 17:03:17.203794 | a9b0e3c3-0ed2-48fa-87d7-842fb48322b1 ==============================
17:03:17.203806 [info ] [MainThread]: Running with dbt=1.1.0
17:03:17.204204 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:03:17.204305 [debug] [MainThread]: Tracking: tracking
17:03:17.206713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bd75100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bd75c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bd75e20>]}
17:03:17.229424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bd79df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bcdba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f821bcdb910>]}


============================== 2022-06-04 17:03:50.393766 | 15aef3a4-7875-4808-b99e-38c3acad6253 ==============================
17:03:50.393785 [info ] [MainThread]: Running with dbt=1.1.0
17:03:50.394278 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:03:50.394407 [debug] [MainThread]: Tracking: tracking
17:03:50.397754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81ebc3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81ebc35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81ebc32e0>]}
17:03:50.424005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:03:50.424379 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/schema.yml
17:03:50.452996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81ea7a0d0>]}
17:03:50.456397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81eb2adf0>]}
17:03:50.456652 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:03:50.456895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81eb2adc0>]}
17:03:50.457908 [info ] [MainThread]: 
17:03:50.458266 [debug] [MainThread]: Acquiring new postgres connection "master"
17:03:50.459060 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:03:50.466840 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:03:50.467018 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:03:50.467090 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:03:50.474448 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:03:50.475710 [debug] [ThreadPool]: On list_erp_oltp: Close
17:03:50.476837 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:03:50.481231 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:03:50.481399 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:03:50.481464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:03:50.488321 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:03:50.488581 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:03:50.488683 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:03:50.490459 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:03:50.491671 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:03:50.492028 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:03:50.497081 [debug] [MainThread]: Using postgres connection "master"
17:03:50.497298 [debug] [MainThread]: On master: BEGIN
17:03:50.497372 [debug] [MainThread]: Opening a new connection, currently in state init
17:03:50.503026 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:03:50.503207 [debug] [MainThread]: Using postgres connection "master"
17:03:50.503301 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:03:50.512801 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:03:50.514038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81eb86640>]}
17:03:50.514417 [debug] [MainThread]: On master: ROLLBACK
17:03:50.514789 [debug] [MainThread]: Using postgres connection "master"
17:03:50.514899 [debug] [MainThread]: On master: BEGIN
17:03:50.515110 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:03:50.515230 [debug] [MainThread]: On master: COMMIT
17:03:50.515322 [debug] [MainThread]: Using postgres connection "master"
17:03:50.515396 [debug] [MainThread]: On master: COMMIT
17:03:50.515538 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:03:50.515647 [debug] [MainThread]: On master: Close
17:03:50.515956 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:03:50.516117 [info ] [MainThread]: 
17:03:50.555194 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:03:50.555453 [debug] [Thread-2  ]: Began running node model.first_project.customers
17:03:50.556107 [info ] [Thread-2  ]: 2 of 4 START view model public.customers ....................................... [RUN]
17:03:50.555856 [info ] [Thread-1  ]: 1 of 4 START table model public.customer2 ...................................... [RUN]
17:03:50.556446 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers"
17:03:50.557214 [debug] [Thread-2  ]: Began compiling node model.first_project.customers
17:03:50.557506 [debug] [Thread-2  ]: Compiling model.first_project.customers
17:03:50.556883 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:03:50.559070 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:03:50.555577 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:03:50.559446 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
17:03:50.559191 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:03:50.559722 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:03:50.562084 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:03:50.561751 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:03:50.562199 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:03:50.564727 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:03:50.558842 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers"
17:03:50.565111 [debug] [Thread-2  ]: finished collecting timing info
17:03:50.565251 [debug] [Thread-3  ]: finished collecting timing info
17:03:50.565362 [debug] [Thread-2  ]: Began executing node model.first_project.customers
17:03:50.565473 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:03:50.596637 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers"
17:03:50.602247 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:03:50.602873 [debug] [Thread-1  ]: finished collecting timing info
17:03:50.603277 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:03:50.604989 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:03:50.605284 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.605489 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:03:50.605564 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:03:50.605848 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.606131 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:03:50.606211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:03:50.606021 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.606596 [debug] [Thread-2  ]: On model.first_project.customers: BEGIN
17:03:50.606670 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:03:50.610960 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
17:03:50.611225 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.611355 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:03:50.612752 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:03:50.613012 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:03:50.613122 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.613291 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.613412 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:03:50.613539 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:03:50.613977 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
17:03:50.619129 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.619760 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
17:03:50.624758 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.622484 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.01 seconds
17:03:50.625006 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:03:50.622315 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:03:50.626618 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.627050 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:03:50.627567 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.627856 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.630110 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.630307 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.633217 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.631906 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:03:50.633354 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:03:50.631716 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.633698 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.634837 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.642387 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:03:50.641369 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:03:50.642557 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.642836 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:03:50.642688 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.642979 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:03:50.634918 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:03:50.643582 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.644586 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
17:03:50.644964 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:03:50.645093 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.648334 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:03:50.648475 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:03:50.649737 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:50.648722 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:03:50.649835 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:03:50.648593 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
17:03:50.651097 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:03:50.652035 [debug] [Thread-1  ]: finished collecting timing info
17:03:50.652182 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:03:50.652269 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:03:50.653411 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:03:50.653508 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:03:50.652359 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
17:03:50.655288 [debug] [Thread-3  ]: finished collecting timing info
17:03:50.655433 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:03:50.655771 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff820dab130>]}
17:03:50.656089 [info ] [Thread-1  ]: 1 of 4 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.10s]
17:03:50.656365 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:03:50.657233 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff821815a00>]}
17:03:50.657468 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
17:03:50.657581 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:03:50.658026 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:03:50.658710 [debug] [Thread-2  ]: finished collecting timing info
17:03:50.659049 [debug] [Thread-2  ]: On model.first_project.customers: Close
17:03:50.659155 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:03:50.659319 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
17:03:50.659585 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:03:50.659678 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:03:50.659757 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:03:50.661357 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:03:50.661633 [debug] [Thread-5  ]: finished collecting timing info
17:03:50.661755 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:03:50.663292 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:03:50.663622 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81eacfd90>]}
17:03:50.663894 [info ] [Thread-2  ]: 2 of 4 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.11s]
17:03:50.664151 [debug] [Thread-2  ]: Finished running node model.first_project.customers
17:03:50.664893 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:50.664987 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:03:50.665053 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:03:50.669467 [debug] [Thread-5  ]: SQL status: BEGIN in 0.0 seconds
17:03:50.669602 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:50.669675 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:03:50.670580 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:03:50.672426 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:50.672526 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:03:50.672776 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:50.673614 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:03:50.673706 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:50.675120 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:03:50.676889 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:03:50.680922 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:50.681172 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:03:50.681593 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:03:50.682542 [debug] [Thread-5  ]: finished collecting timing info
17:03:50.682713 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:03:50.698069 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15aef3a4-7875-4808-b99e-38c3acad6253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81c1d0250>]}
17:03:50.698597 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
17:03:50.698946 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:03:50.701178 [debug] [MainThread]: Acquiring new postgres connection "master"
17:03:50.701426 [debug] [MainThread]: Using postgres connection "master"
17:03:50.701523 [debug] [MainThread]: On master: BEGIN
17:03:50.701583 [debug] [MainThread]: Opening a new connection, currently in state closed
17:03:50.706830 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:03:50.707012 [debug] [MainThread]: On master: COMMIT
17:03:50.707080 [debug] [MainThread]: Using postgres connection "master"
17:03:50.707143 [debug] [MainThread]: On master: COMMIT
17:03:50.707282 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:03:50.707376 [debug] [MainThread]: On master: Close
17:03:50.707818 [info ] [MainThread]: 
17:03:50.707989 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0.25s.
17:03:50.708098 [debug] [MainThread]: Connection 'master' was properly closed.
17:03:50.708154 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:03:50.708205 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:03:50.708255 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:03:50.708305 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:03:50.712062 [info ] [MainThread]: 
17:03:50.712413 [info ] [MainThread]: [32mCompleted successfully[0m
17:03:50.726659 [info ] [MainThread]: 
17:03:50.726779 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
17:03:50.727001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81ea4dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81eb2a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff81c164f40>]}


============================== 2022-06-04 17:10:22.067660 | c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5 ==============================
17:10:22.067673 [info ] [MainThread]: Running with dbt=1.1.0
17:10:22.068016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:10:22.068096 [debug] [MainThread]: Tracking: tracking
17:10:22.070313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263df22100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263df22c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263df22e20>]}
17:10:22.093598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:10:22.094112 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/postgres_sample_source_customers.sql
17:10:22.109119 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
17:10:22.124016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263d9f60d0>]}
17:10:22.127423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263de8ad90>]}
17:10:22.127643 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:10:22.127798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263de8af10>]}
17:10:22.128877 [info ] [MainThread]: 
17:10:22.129543 [debug] [MainThread]: Acquiring new postgres connection "master"
17:10:22.130469 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:10:22.138911 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:10:22.139108 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:10:22.139190 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:10:22.144812 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:10:22.146375 [debug] [ThreadPool]: On list_erp_oltp: Close
17:10:22.147376 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:10:22.151184 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:10:22.151294 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:10:22.151364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:10:22.160093 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:10:22.160377 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:10:22.160480 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:10:22.162080 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:10:22.163383 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:10:22.163736 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:10:22.207297 [debug] [MainThread]: Using postgres connection "master"
17:10:22.207486 [debug] [MainThread]: On master: BEGIN
17:10:22.207549 [debug] [MainThread]: Opening a new connection, currently in state init
17:10:22.211532 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:10:22.211683 [debug] [MainThread]: Using postgres connection "master"
17:10:22.211753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:10:22.221585 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:10:22.222681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263df28fa0>]}
17:10:22.222949 [debug] [MainThread]: On master: ROLLBACK
17:10:22.223354 [debug] [MainThread]: Using postgres connection "master"
17:10:22.223470 [debug] [MainThread]: On master: BEGIN
17:10:22.224925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:10:22.225045 [debug] [MainThread]: On master: COMMIT
17:10:22.225122 [debug] [MainThread]: Using postgres connection "master"
17:10:22.225189 [debug] [MainThread]: On master: COMMIT
17:10:22.225347 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:10:22.225445 [debug] [MainThread]: On master: Close
17:10:22.225812 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:10:22.226058 [info ] [MainThread]: 
17:10:22.230333 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:10:22.230561 [info ] [Thread-1  ]: 1 of 5 START table model public.customer2 ...................................... [RUN]
17:10:22.230884 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:10:22.230996 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:10:22.231167 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:10:22.232664 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:10:22.232971 [debug] [Thread-1  ]: finished collecting timing info
17:10:22.233166 [debug] [Thread-2  ]: Began running node model.first_project.customers
17:10:22.233287 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:10:22.233860 [info ] [Thread-3  ]: 3 of 5 START table model public.my_first_dbt_model ............................. [RUN]
17:10:22.234223 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:10:22.233621 [info ] [Thread-2  ]: 2 of 5 START view model public.customers ....................................... [RUN]
17:10:22.233367 [debug] [Thread-4  ]: Began running node model.first_project.postgres_sample_source_customers
17:10:22.234869 [info ] [Thread-4  ]: 4 of 5 START view model public.postgres_sample_source_customers ................ [RUN]
17:10:22.235115 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.234683 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers"
17:10:22.235191 [debug] [Thread-4  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:10:22.235413 [debug] [Thread-4  ]: Compiling model.first_project.postgres_sample_source_customers
17:10:22.234342 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:10:22.237023 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:10:22.236893 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:10:22.238655 [debug] [Thread-4  ]: finished collecting timing info
17:10:22.238761 [debug] [Thread-4  ]: Began executing node model.first_project.postgres_sample_source_customers
17:10:22.235298 [debug] [Thread-2  ]: Began compiling node model.first_project.customers
17:10:22.250927 [debug] [Thread-2  ]: Compiling model.first_project.customers
17:10:22.233443 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:10:22.238343 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:10:22.257208 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers"
17:10:22.280411 [debug] [Thread-3  ]: finished collecting timing info
17:10:22.278635 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:10:22.280738 [debug] [Thread-2  ]: finished collecting timing info
17:10:22.260153 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:10:22.280978 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:10:22.281248 [debug] [Thread-2  ]: Began executing node model.first_project.customers
17:10:22.281471 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.284026 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:10:22.286522 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers"
17:10:22.286721 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.287105 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:10:22.287184 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:10:22.287506 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.287615 [debug] [Thread-2  ]: On model.first_project.customers: BEGIN
17:10:22.287681 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:10:22.286852 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:10:22.288142 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.288329 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:10:22.288442 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:10:22.288632 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:10:22.295728 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:10:22.296038 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.296207 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:10:22.299139 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:10:22.299394 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.299574 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:10:22.299786 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:10:22.299888 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.299951 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:10:22.300740 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:10:22.300928 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.300994 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:10:22.301361 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
17:10:22.306788 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
17:10:22.306956 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.01 seconds
17:10:22.308335 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.310656 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:10:22.310293 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.310801 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:10:22.308479 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.310533 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:10:22.310909 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:10:22.312266 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.312462 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:10:22.312854 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:22.317972 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:10:22.318108 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
17:10:22.318234 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.320011 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:10:22.318423 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
17:10:22.321276 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.318316 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:10:22.321402 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:10:22.319883 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.323561 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:10:22.323901 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:22.323316 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.328118 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:10:22.328249 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:22.329641 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
17:10:22.328511 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:10:22.329738 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.329900 [debug] [Thread-2  ]: On model.first_project.customers: COMMIT
17:10:22.328317 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
17:10:22.328662 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.333366 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:10:22.334696 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers"
17:10:22.333487 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:22.336339 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:10:22.334861 [debug] [Thread-2  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:10:22.333254 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:22.336650 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:10:22.336963 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:22.333665 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:10:22.336462 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.337789 [debug] [Thread-4  ]: finished collecting timing info
17:10:22.338018 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:10:22.338459 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:22.339480 [debug] [Thread-2  ]: finished collecting timing info
17:10:22.339596 [debug] [Thread-2  ]: On model.first_project.customers: Close
17:10:22.340146 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263d9ab4f0>]}
17:10:22.338614 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: Close
17:10:22.340302 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:10:22.340565 [info ] [Thread-2  ]: 2 of 5 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.11s]
17:10:22.343482 [debug] [Thread-2  ]: Finished running node model.first_project.customers
17:10:22.342993 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:22.343863 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263d957df0>]}
17:10:22.345215 [info ] [Thread-4  ]: 4 of 5 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
17:10:22.344883 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:10:22.343969 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:10:22.347955 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:10:22.348061 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:10:22.345520 [debug] [Thread-4  ]: Finished running node model.first_project.postgres_sample_source_customers
17:10:22.348165 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
17:10:22.349712 [debug] [Thread-3  ]: finished collecting timing info
17:10:22.349842 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:10:22.349937 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:10:22.351696 [debug] [Thread-1  ]: finished collecting timing info
17:10:22.351993 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263d9abf40>]}
17:10:22.352104 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:10:22.352380 [info ] [Thread-3  ]: 3 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
17:10:22.355118 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:10:22.355387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263d972580>]}
17:10:22.355754 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
17:10:22.355980 [info ] [Thread-1  ]: 1 of 5 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.12s]
17:10:22.356145 [info ] [Thread-6  ]: 5 of 5 START view model public.my_second_dbt_model ............................. [RUN]
17:10:22.356484 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:10:22.356825 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:10:22.357056 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
17:10:22.357153 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
17:10:22.358658 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:10:22.358903 [debug] [Thread-6  ]: finished collecting timing info
17:10:22.359020 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
17:10:22.360385 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:10:22.360585 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:22.360687 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
17:10:22.360751 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:10:22.367737 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:10:22.367942 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:22.368016 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:10:22.368954 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:10:22.373606 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:22.373772 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:10:22.378580 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:22.380577 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:10:22.380854 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:22.380979 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:10:22.382333 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:10:22.383529 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:22.383652 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:10:22.384765 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:22.387308 [debug] [Thread-6  ]: finished collecting timing info
17:10:22.387444 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
17:10:22.387903 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c491a8dc-c5aa-4c9e-92ea-fba963bc6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f263c096f10>]}
17:10:22.388212 [info ] [Thread-6  ]: 5 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:10:22.388542 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
17:10:22.389794 [debug] [MainThread]: Acquiring new postgres connection "master"
17:10:22.389913 [debug] [MainThread]: Using postgres connection "master"
17:10:22.389987 [debug] [MainThread]: On master: BEGIN
17:10:22.390096 [debug] [MainThread]: Opening a new connection, currently in state closed
17:10:22.395199 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:10:22.395345 [debug] [MainThread]: On master: COMMIT
17:10:22.395418 [debug] [MainThread]: Using postgres connection "master"
17:10:22.395548 [debug] [MainThread]: On master: COMMIT
17:10:22.395876 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:10:22.396075 [debug] [MainThread]: On master: Close
17:10:22.396674 [info ] [MainThread]: 
17:10:22.396996 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0.27s.
17:10:22.397127 [debug] [MainThread]: Connection 'master' was properly closed.
17:10:22.397190 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:10:22.397247 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:10:22.397303 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:10:22.397358 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:10:22.397412 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:10:22.401113 [info ] [MainThread]: 
17:10:22.401309 [info ] [MainThread]: [32mCompleted successfully[0m
17:10:22.401448 [info ] [MainThread]: 
17:10:22.401546 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
17:10:22.401725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26400a3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26400a3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26400a3af0>]}


============================== 2022-06-04 17:20:18.078822 | aa2af42c-41e1-4e18-a871-43b0ebc1f279 ==============================
17:20:18.078834 [info ] [MainThread]: Running with dbt=1.1.0
17:20:18.079218 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:20:18.079314 [debug] [MainThread]: Tracking: tracking
17:20:18.081850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbdd0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbdd0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbdd0e20>]}
17:20:18.103206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
17:20:18.103613 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_customers.sql
17:20:18.103810 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:20:18.116041 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:20:18.130333 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:20:18.137197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb8ab0d0>]}
17:20:18.141189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbd3fb80>]}
17:20:18.141518 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:20:18.141742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbd3fe80>]}
17:20:18.143024 [info ] [MainThread]: 
17:20:18.143438 [debug] [MainThread]: Acquiring new postgres connection "master"
17:20:18.145019 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:20:18.160344 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:20:18.160539 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:20:18.160615 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:20:18.166974 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:20:18.167988 [debug] [ThreadPool]: On list_erp_oltp: Close
17:20:18.170993 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:20:18.176544 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:20:18.176729 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:20:18.176840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:20:18.186191 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:20:18.186448 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:20:18.186549 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:20:18.188103 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
17:20:18.189271 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:20:18.189734 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:20:18.222815 [debug] [MainThread]: Using postgres connection "master"
17:20:18.223289 [debug] [MainThread]: On master: BEGIN
17:20:18.223428 [debug] [MainThread]: Opening a new connection, currently in state init
17:20:18.227469 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:20:18.227621 [debug] [MainThread]: Using postgres connection "master"
17:20:18.227681 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:20:18.237011 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
17:20:18.238283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbdd7190>]}
17:20:18.238602 [debug] [MainThread]: On master: ROLLBACK
17:20:18.238824 [debug] [MainThread]: Using postgres connection "master"
17:20:18.238919 [debug] [MainThread]: On master: BEGIN
17:20:18.239163 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:20:18.239317 [debug] [MainThread]: On master: COMMIT
17:20:18.239444 [debug] [MainThread]: Using postgres connection "master"
17:20:18.239695 [debug] [MainThread]: On master: COMMIT
17:20:18.240008 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:20:18.240174 [debug] [MainThread]: On master: Close
17:20:18.240531 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:20:18.240722 [info ] [MainThread]: 
17:20:18.245311 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:20:18.245538 [info ] [Thread-1  ]: 1 of 6 START table model public.customer2 ...................................... [RUN]
17:20:18.245847 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:20:18.245946 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:20:18.246033 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:20:18.247577 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:20:18.247843 [debug] [Thread-1  ]: finished collecting timing info
17:20:18.248002 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:20:18.256029 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:20:18.256526 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:20:18.267328 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:20:18.267690 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.267778 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:20:18.267876 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:20:18.256939 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:20:18.256679 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:20:18.269534 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:20:18.275216 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:20:18.280936 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:20:18.281251 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:20:18.282335 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:20:18.281906 [debug] [Thread-3  ]: finished collecting timing info
17:20:18.282429 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:20:18.282771 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:20:18.282616 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:20:18.283617 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:20:18.281572 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:20:18.297521 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:20:18.298249 [debug] [Thread-4  ]: finished collecting timing info
17:20:18.303700 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:20:18.305939 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:20:18.298402 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:20:18.308039 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:20:18.308549 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.308872 [debug] [Thread-2  ]: finished collecting timing info
17:20:18.309133 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.309791 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:20:18.309885 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:20:18.309532 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:20:18.309286 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:20:18.309639 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:20:18.312772 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:20:18.312903 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:20:18.312623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:20:18.312363 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:20:18.313587 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.313695 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:20:18.313763 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:20:18.319332 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:20:18.319530 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.319604 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:20:18.320419 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:20:18.320565 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:20:18.320673 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.320819 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:20:18.321117 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

select * from customers
  );
17:20:18.320965 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:20:18.321352 [debug] [Thread-4  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 13: select * from customers
         ^

17:20:18.321448 [debug] [Thread-4  ]: On model.first_project.stg_customers: ROLLBACK
17:20:18.321623 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
17:20:18.326885 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.327058 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:20:18.327772 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:20:18.327913 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.327977 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:20:18.328397 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
17:20:18.330054 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.330363 [debug] [Thread-4  ]: finished collecting timing info
17:20:18.330789 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:20:18.330616 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:20:18.331078 [debug] [Thread-4  ]: Database Error in model stg_customers (models/erp/stg_customers.sql)
  syntax error at or near "select"
  LINE 13: select * from customers
           ^
  compiled SQL at target/run/first_project/models/erp/stg_customers.sql
17:20:18.331424 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd87b9640>]}
17:20:18.331651 [error] [Thread-4  ]: 4 of 6 ERROR creating view model public.stg_customers .......................... [[31mERROR[0m in 0.05s]
17:20:18.331891 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:20:18.332299 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:20:18.332417 [info ] [Thread-6  ]: 5 of 6 SKIP relation public.customers .......................................... [[33mSKIP[0m]
17:20:18.332598 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:20:18.333176 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:18.330472 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:18.335664 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.337338 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.337561 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
17:20:18.339438 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.337947 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:20:18.339573 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:20:18.337728 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:20:18.340565 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:18.346867 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
17:20:18.351932 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:20:18.352238 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:20:18.354825 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.353351 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.355037 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:20:18.354926 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:20:18.353179 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:20:18.355567 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.355723 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:20:18.356519 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:20:18.360372 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:18.360549 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:20:18.361457 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:20:18.362600 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:20:18.362745 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.363002 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:20:18.362914 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:20:18.363392 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:20:18.365086 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:18.366137 [debug] [Thread-2  ]: finished collecting timing info
17:20:18.366374 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:20:18.370644 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:20:18.366584 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:20:18.366466 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:20:18.372553 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdea1a1c0>]}
17:20:18.370882 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:20:18.373665 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
17:20:18.374769 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:20:18.375936 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:20:18.377061 [debug] [Thread-3  ]: finished collecting timing info
17:20:18.377497 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:20:18.377899 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:20:18.378832 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:20:18.378612 [debug] [Thread-1  ]: finished collecting timing info
17:20:18.379140 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:20:18.379389 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:20:18.379271 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:20:18.379479 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:20:18.381109 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:20:18.377786 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:20:18.381431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbd46370>]}
17:20:18.381690 [debug] [Thread-8  ]: finished collecting timing info
17:20:18.383665 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:20:18.383523 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.14s]
17:20:18.386204 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:20:18.386762 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:18.386469 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:20:18.386861 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:20:18.387058 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:20:18.383278 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb804e20>]}
17:20:18.387898 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
17:20:18.388530 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:20:18.396798 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:20:18.397077 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:18.397230 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:20:18.398249 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:20:18.399861 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:18.399985 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:20:18.400301 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:18.401124 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:20:18.401226 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:18.401293 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:20:18.403146 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:20:18.405172 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:18.405274 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:20:18.405510 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:20:18.408042 [debug] [Thread-8  ]: finished collecting timing info
17:20:18.408265 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:20:18.408643 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2af42c-41e1-4e18-a871-43b0ebc1f279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdb8043a0>]}
17:20:18.408979 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:20:18.409418 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:20:18.410729 [debug] [MainThread]: Acquiring new postgres connection "master"
17:20:18.410863 [debug] [MainThread]: Using postgres connection "master"
17:20:18.410941 [debug] [MainThread]: On master: BEGIN
17:20:18.411007 [debug] [MainThread]: Opening a new connection, currently in state closed
17:20:18.414951 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:20:18.415098 [debug] [MainThread]: On master: COMMIT
17:20:18.415173 [debug] [MainThread]: Using postgres connection "master"
17:20:18.415237 [debug] [MainThread]: On master: COMMIT
17:20:18.415388 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:20:18.415481 [debug] [MainThread]: On master: Close
17:20:18.415747 [info ] [MainThread]: 
17:20:18.415896 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.27s.
17:20:18.416040 [debug] [MainThread]: Connection 'master' was properly closed.
17:20:18.416099 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:20:18.416154 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:20:18.416208 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:20:18.416291 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:20:18.416347 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:20:18.419518 [info ] [MainThread]: 
17:20:18.419748 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:20:18.419900 [info ] [MainThread]: 
17:20:18.420023 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/erp/stg_customers.sql)[0m
17:20:18.420146 [error] [MainThread]:   syntax error at or near "select"
17:20:18.420250 [error] [MainThread]:   LINE 13: select * from customers
17:20:18.420356 [error] [MainThread]:            ^
17:20:18.420469 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/stg_customers.sql
17:20:18.420595 [info ] [MainThread]: 
17:20:18.420721 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
17:20:18.420974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbdd7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facdbd3f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7facd874c6a0>]}


============================== 2022-06-04 17:22:18.955952 | e8a22e45-a943-4086-be68-a98431f3bbc5 ==============================
17:22:18.955971 [info ] [MainThread]: Running with dbt=1.1.0
17:22:18.956511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:22:18.956658 [debug] [MainThread]: Tracking: tracking
17:22:18.971319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8fd4d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8fd4dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8fd4de20>]}
17:22:18.995248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:22:18.995603 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
17:22:19.006031 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:22:19.021888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f8210d0>]}
17:22:19.026659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8fcc0d90>]}
17:22:19.026961 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:22:19.027168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8fcc0e20>]}
17:22:19.028279 [info ] [MainThread]: 
17:22:19.028622 [debug] [MainThread]: Acquiring new postgres connection "master"
17:22:19.029489 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:22:19.041201 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:22:19.041380 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:22:19.041453 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:22:19.051072 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:22:19.052182 [debug] [ThreadPool]: On list_erp_oltp: Close
17:22:19.055680 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:22:19.060570 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:22:19.060706 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:22:19.060772 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:22:19.066469 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:22:19.066811 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:22:19.067050 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:22:19.068729 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
17:22:19.070053 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:22:19.070480 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:22:19.102618 [debug] [MainThread]: Using postgres connection "master"
17:22:19.103010 [debug] [MainThread]: On master: BEGIN
17:22:19.103107 [debug] [MainThread]: Opening a new connection, currently in state init
17:22:19.107020 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:22:19.107380 [debug] [MainThread]: Using postgres connection "master"
17:22:19.107457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:22:19.116475 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
17:22:19.117525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a9156ddf0>]}
17:22:19.117769 [debug] [MainThread]: On master: ROLLBACK
17:22:19.117982 [debug] [MainThread]: Using postgres connection "master"
17:22:19.118071 [debug] [MainThread]: On master: BEGIN
17:22:19.118251 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:22:19.118338 [debug] [MainThread]: On master: COMMIT
17:22:19.118415 [debug] [MainThread]: Using postgres connection "master"
17:22:19.118485 [debug] [MainThread]: On master: COMMIT
17:22:19.118605 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:22:19.118694 [debug] [MainThread]: On master: Close
17:22:19.118970 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:22:19.119211 [info ] [MainThread]: 
17:22:19.123378 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:22:19.123628 [info ] [Thread-1  ]: 1 of 6 START table model public.customer2 ...................................... [RUN]
17:22:19.123944 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:22:19.124035 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:22:19.124112 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:22:19.125556 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:22:19.125721 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:22:19.125882 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:22:19.126118 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:22:19.126275 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:22:19.126394 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:22:19.126917 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:22:19.126717 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:22:19.126559 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:22:19.127029 [debug] [Thread-1  ]: finished collecting timing info
17:22:19.127297 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:22:19.127561 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.127664 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:22:19.127788 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:22:19.127891 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:22:19.127982 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:22:19.129361 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:22:19.150005 [debug] [Thread-2  ]: finished collecting timing info
17:22:19.146771 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:22:19.150152 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:22:19.136215 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:22:19.156191 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:22:19.151524 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:22:19.156607 [debug] [Thread-4  ]: finished collecting timing info
17:22:19.156846 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:22:19.155239 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:22:19.162544 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.162161 [debug] [Thread-3  ]: finished collecting timing info
17:22:19.149623 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:22:19.168232 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.167896 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:22:19.162646 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:22:19.171186 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:22:19.168339 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:22:19.170932 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:22:19.172171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:22:19.172624 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.172735 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:22:19.172813 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:22:19.168482 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:22:19.173992 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:19.174085 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:22:19.174144 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:22:19.178639 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
17:22:19.178792 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:19.178890 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)

select * from customers
  );
17:22:19.179309 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:22:19.179415 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.179477 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:22:19.180287 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:19.184283 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:19.184416 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:22:19.184613 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
17:22:19.186407 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.186527 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:22:19.187242 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:22:19.187520 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.187590 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:22:19.187735 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:22:19.187866 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.192301 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.192517 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:22:19.188773 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
17:22:19.194000 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.194113 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:22:19.188111 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.188656 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.198357 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:22:19.198605 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:22:19.198713 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.200636 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.200824 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:22:19.198927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:22:19.204404 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:22:19.204512 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.206057 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:22:19.206151 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.204906 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
17:22:19.206216 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:22:19.204603 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.208391 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:22:19.199069 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:19.208540 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:22:19.207824 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.209036 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:22:19.209642 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.211744 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.211975 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.212143 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.212246 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.212385 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:22:19.217606 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:19.220526 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:22:19.220211 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:19.220675 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:22:19.220964 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:19.218740 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:22:19.221969 [debug] [Thread-4  ]: finished collecting timing info
17:22:19.222076 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.224728 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:22:19.222480 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:22:19.225720 [debug] [Thread-2  ]: finished collecting timing info
17:22:19.225834 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:22:19.222379 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:22:19.227598 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f7e6fd0>]}
17:22:19.222613 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:22:19.224935 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.228648 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:22:19.230084 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f7e61c0>]}
17:22:19.230310 [info ] [Thread-4  ]: 4 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.10s]
17:22:19.228208 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
17:22:19.230492 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.230763 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:22:19.230844 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:22:19.232065 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:19.232309 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:22:19.233272 [debug] [Thread-1  ]: finished collecting timing info
17:22:19.233783 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:22:19.235412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f77a7f0>]}
17:22:19.235770 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.11s]
17:22:19.236103 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:22:19.236510 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:22:19.236674 [info ] [Thread-6  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:22:19.236964 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
17:22:19.237047 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
17:22:19.237114 [debug] [Thread-6  ]: Compiling model.first_project.customers
17:22:19.238468 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
17:22:19.238686 [debug] [Thread-6  ]: finished collecting timing info
17:22:19.233539 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:22:19.238817 [debug] [Thread-6  ]: Began executing node model.first_project.customers
17:22:19.238995 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
17:22:19.243866 [info ] [Thread-7  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:22:19.244151 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:22:19.244230 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
17:22:19.244297 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
17:22:19.243554 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
17:22:19.245713 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:22:19.246260 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.246362 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
17:22:19.246442 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:22:19.246753 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:22:19.247751 [debug] [Thread-3  ]: finished collecting timing info
17:22:19.247877 [debug] [Thread-7  ]: finished collecting timing info
17:22:19.248036 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:22:19.248211 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
17:22:19.250347 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:22:19.250768 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8c6aa1c0>]}
17:22:19.251138 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
17:22:19.251445 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:22:19.251839 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:19.251936 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: BEGIN
17:22:19.251999 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:22:19.254238 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:22:19.254371 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.254461 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:22:19.256017 [debug] [Thread-7  ]: SQL status: BEGIN in 0.0 seconds
17:22:19.256130 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:19.256206 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:22:19.256293 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:19.258181 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.258298 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:22:19.258407 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:19.260350 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:19.260472 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:22:19.261983 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.265615 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: COMMIT
17:22:19.265793 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:19.266009 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: COMMIT
17:22:19.267701 [debug] [Thread-7  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.270233 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:19.270429 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:22:19.270772 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:19.271664 [debug] [Thread-7  ]: finished collecting timing info
17:22:19.272295 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: Close
17:22:19.272417 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.01 seconds
17:22:19.277982 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.278222 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:22:19.278663 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8c6be820>]}
17:22:19.278988 [info ] [Thread-7  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:22:19.279422 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
17:22:19.281682 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:19.282870 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:22:19.282982 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.283051 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:22:19.285120 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:22:19.287973 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:19.288134 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:22:19.292196 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:19.293556 [debug] [Thread-6  ]: finished collecting timing info
17:22:19.293726 [debug] [Thread-6  ]: On model.first_project.customers: Close
17:22:19.294156 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a22e45-a943-4086-be68-a98431f3bbc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8c6c3eb0>]}
17:22:19.294426 [info ] [Thread-6  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.06s]
17:22:19.294657 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:22:19.295815 [debug] [MainThread]: Acquiring new postgres connection "master"
17:22:19.295932 [debug] [MainThread]: Using postgres connection "master"
17:22:19.295998 [debug] [MainThread]: On master: BEGIN
17:22:19.296058 [debug] [MainThread]: Opening a new connection, currently in state closed
17:22:19.304866 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:22:19.305119 [debug] [MainThread]: On master: COMMIT
17:22:19.305203 [debug] [MainThread]: Using postgres connection "master"
17:22:19.305267 [debug] [MainThread]: On master: COMMIT
17:22:19.305419 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:22:19.305568 [debug] [MainThread]: On master: Close
17:22:19.305955 [info ] [MainThread]: 
17:22:19.306177 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.28s.
17:22:19.306298 [debug] [MainThread]: Connection 'master' was properly closed.
17:22:19.306357 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:22:19.306411 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:22:19.306463 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:22:19.306515 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:22:19.306567 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:22:19.306619 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:22:19.311605 [info ] [MainThread]: 
17:22:19.311898 [info ] [MainThread]: [32mCompleted successfully[0m
17:22:19.312173 [info ] [MainThread]: 
17:22:19.312300 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:22:19.313402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f821310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8f7d7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a91ec22e0>]}


============================== 2022-06-04 17:46:44.072022 | 6254cbf2-30ca-47d7-b054-5a1f816f7b1a ==============================
17:46:44.072034 [info ] [MainThread]: Running with dbt=1.1.0
17:46:44.072355 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:46:44.072440 [debug] [MainThread]: Tracking: tracking
17:46:44.075082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d0a01070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d0a01040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d0a012b0>]}
17:46:44.097039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d0a01880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d099c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3d099c3a0>]}


============================== 2022-06-04 17:47:36.777878 | 331ed1c3-aa71-43be-b62a-bcca585f76f5 ==============================
17:47:36.777892 [info ] [MainThread]: Running with dbt=1.1.0
17:47:36.778426 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:47:36.778583 [debug] [MainThread]: Tracking: tracking
17:47:36.781872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824cca9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824cca9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824cca9e20>]}
17:47:36.797010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824ccaddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824cc46220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f824cc46370>]}


============================== 2022-06-04 17:48:33.489732 | ceaa3359-33fc-4824-bed5-0dececad7288 ==============================
17:48:33.489750 [info ] [MainThread]: Running with dbt=1.1.0
17:48:33.490267 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:48:33.490416 [debug] [MainThread]: Tracking: tracking
17:48:33.493443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35febcf100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35febcfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35febcfe20>]}
17:48:33.509153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35febd3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35feb75220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35feb75370>]}


============================== 2022-06-04 17:48:48.281943 | 0f5f9ae3-ddd8-4f75-8c12-45f820ed9a57 ==============================
17:48:48.281961 [info ] [MainThread]: Running with dbt=1.1.0
17:48:48.282535 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:48:48.282741 [debug] [MainThread]: Tracking: tracking
17:48:48.293257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c85f4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c85f4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c85f42b0>]}
17:48:48.310841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c85f4250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c858e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89c858e3a0>]}


============================== 2022-06-04 17:50:01.936817 | b446dcfb-fb34-4d93-8ac5-4d331cf4187b ==============================
17:50:01.936831 [info ] [MainThread]: Running with dbt=1.1.0
17:50:01.937293 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:50:01.937410 [debug] [MainThread]: Tracking: tracking
17:50:01.940039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89219e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89219ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa89219e6d0>]}
17:50:01.965562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:50:01.966103 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/schema.yml
17:50:01.993438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b446dcfb-fb34-4d93-8ac5-4d331cf4187b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8920220d0>]}
17:50:01.997126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b446dcfb-fb34-4d93-8ac5-4d331cf4187b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa892114d30>]}
17:50:01.997384 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:50:01.997560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b446dcfb-fb34-4d93-8ac5-4d331cf4187b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa892114df0>]}
17:50:01.998707 [info ] [MainThread]: 
17:50:01.999069 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:02.000105 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:50:02.011538 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:50:02.011752 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:50:02.011891 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:50:02.017893 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:50:02.018079 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:50:02.018150 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:50:02.019458 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:50:02.020516 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:50:02.020714 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:50:02.051745 [debug] [MainThread]: Using postgres connection "master"
17:50:02.051940 [debug] [MainThread]: On master: BEGIN
17:50:02.052007 [debug] [MainThread]: Opening a new connection, currently in state init
17:50:02.055931 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:02.056108 [debug] [MainThread]: Using postgres connection "master"
17:50:02.056174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:50:02.076284 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
17:50:02.077417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b446dcfb-fb34-4d93-8ac5-4d331cf4187b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa893a34370>]}
17:50:02.077677 [debug] [MainThread]: On master: ROLLBACK
17:50:02.078023 [debug] [MainThread]: Using postgres connection "master"
17:50:02.078141 [debug] [MainThread]: On master: BEGIN
17:50:02.078607 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:02.078721 [debug] [MainThread]: On master: COMMIT
17:50:02.078795 [debug] [MainThread]: Using postgres connection "master"
17:50:02.078898 [debug] [MainThread]: On master: COMMIT
17:50:02.079163 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:02.079287 [debug] [MainThread]: On master: Close
17:50:02.079646 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:50:02.079881 [info ] [MainThread]: 
17:50:02.082987 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:50:02.083208 [info ] [Thread-1  ]: 1 of 6 START test not_null_customers_customer_id ............................... [RUN]
17:50:02.083466 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:50:02.083545 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:50:02.083631 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
17:50:02.091730 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:50:02.091958 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:50:02.105471 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:50:02.092067 [debug] [Thread-4  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:50:02.092202 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:50:02.105079 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:50:02.105907 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:50:02.110103 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:50:02.109730 [info ] [Thread-4  ]: 4 of 6 START test unique_customers_customer_id ................................. [RUN]
17:50:02.110696 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:50:02.109873 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:50:02.109493 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:50:02.092137 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:50:02.110451 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:50:02.111407 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:50:02.111032 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:50:02.111692 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:50:02.111901 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:50:02.110779 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:50:02.118095 [debug] [Thread-4  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
17:50:02.110210 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:50:02.111522 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:50:02.111251 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:50:02.117917 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:50:02.120426 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:50:02.127008 [debug] [Thread-4  ]: finished collecting timing info
17:50:02.123348 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:50:02.126231 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:50:02.126686 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:50:02.127145 [debug] [Thread-4  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:50:02.111808 [debug] [Thread-1  ]: finished collecting timing info
17:50:02.127446 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:50:02.137625 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:50:02.137802 [debug] [Thread-3  ]: finished collecting timing info
17:50:02.138595 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:50:02.138107 [debug] [Thread-2  ]: finished collecting timing info
17:50:02.138224 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:50:02.138369 [debug] [Thread-6  ]: finished collecting timing info
17:50:02.137983 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:50:02.139687 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:50:02.139824 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:50:02.147397 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:50:02.140023 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:50:02.148142 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
17:50:02.146230 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:50:02.147767 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:50:02.148461 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:50:02.147965 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:50:02.148675 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:50:02.148807 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:50:02.148544 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:50:02.143001 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:50:02.142720 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:50:02.150387 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:50:02.148267 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:50:02.150749 [debug] [Thread-5  ]: finished collecting timing info
17:50:02.151249 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:50:02.152414 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:50:02.152626 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:50:02.152719 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:50:02.152809 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:50:02.153083 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:50:02.153185 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:50:02.153247 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:50:02.150878 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:50:02.154732 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
17:50:02.154812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:50:02.156399 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:50:02.156512 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:50:02.156580 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:50:02.163522 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.01 seconds
17:50:02.165851 [debug] [Thread-4  ]: finished collecting timing info
17:50:02.166053 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
17:50:02.166397 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
17:50:02.166907 [error] [Thread-4  ]: 4 of 6 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.06s]
17:50:02.167354 [debug] [Thread-4  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:50:02.171717 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:50:02.171935 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:50:02.172217 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:50:02.172469 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
17:50:02.172641 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:50:02.172741 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:50:02.173270 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:50:02.174495 [debug] [Thread-3  ]: finished collecting timing info
17:50:02.174710 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:50:02.174847 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
17:50:02.175818 [debug] [Thread-6  ]: finished collecting timing info
17:50:02.175934 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:50:02.176319 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:50:02.176445 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:50:02.176741 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
17:50:02.177358 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:50:02.178003 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
17:50:02.176887 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:50:02.178232 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:50:02.178337 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:50:02.178126 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:50:02.178465 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:50:02.177624 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
17:50:02.178754 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:50:02.179394 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:50:02.180211 [debug] [Thread-2  ]: finished collecting timing info
17:50:02.180309 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:50:02.180694 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:50:02.180831 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
17:50:02.181021 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:50:02.182060 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:50:02.184445 [debug] [Thread-5  ]: finished collecting timing info
17:50:02.184573 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:50:02.182738 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
17:50:02.182459 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.07s]
17:50:02.185849 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:50:02.186220 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:50:02.186598 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
17:50:02.186878 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:50:02.187047 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:50:02.188239 [debug] [Thread-1  ]: finished collecting timing info
17:50:02.188396 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
17:50:02.188597 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
17:50:02.188981 [info ] [Thread-1  ]: 1 of 6 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.11s]
17:50:02.189276 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:50:02.192333 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:02.192527 [debug] [MainThread]: Using postgres connection "master"
17:50:02.192592 [debug] [MainThread]: On master: BEGIN
17:50:02.192656 [debug] [MainThread]: Opening a new connection, currently in state closed
17:50:02.202314 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:50:02.202605 [debug] [MainThread]: On master: COMMIT
17:50:02.202685 [debug] [MainThread]: Using postgres connection "master"
17:50:02.202756 [debug] [MainThread]: On master: COMMIT
17:50:02.203200 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:02.203415 [debug] [MainThread]: On master: Close
17:50:02.203902 [info ] [MainThread]: 
17:50:02.204219 [info ] [MainThread]: Finished running 6 tests in 0.20s.
17:50:02.204405 [debug] [MainThread]: Connection 'master' was properly closed.
17:50:02.204490 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
17:50:02.204571 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:50:02.204658 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:50:02.204712 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
17:50:02.204848 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:50:02.204952 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:50:02.209086 [info ] [MainThread]: 
17:50:02.209392 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:50:02.209580 [info ] [MainThread]: 
17:50:02.209735 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
17:50:02.209899 [error] [MainThread]:   Got 50 results, configured to fail if != 0
17:50:02.210028 [info ] [MainThread]: 
17:50:02.210160 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
17:50:02.210290 [info ] [MainThread]: 
17:50:02.210416 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:50:02.210545 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:50:02.210666 [info ] [MainThread]: 
17:50:02.210814 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:50:02.210951 [info ] [MainThread]: 
17:50:02.211077 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
17:50:02.211286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8921afa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8939be310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa891f97850>]}


============================== 2022-06-04 17:50:21.481193 | db27c35a-3a1e-474c-b2a6-f534629d9eaa ==============================
17:50:21.481209 [info ] [MainThread]: Running with dbt=1.1.0
17:50:21.481628 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:50:21.481751 [debug] [MainThread]: Tracking: tracking
17:50:21.484560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bf53040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bf53f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bf53070>]}
17:50:21.517756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:50:21.517995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:50:21.524789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be810d0>]}
17:50:21.528865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be50310>]}
17:50:21.529129 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:50:21.529306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be503a0>]}
17:50:21.530398 [info ] [MainThread]: 
17:50:21.530761 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:21.531638 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:50:21.545081 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:50:21.545346 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:50:21.545455 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:50:21.551052 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:50:21.552064 [debug] [ThreadPool]: On list_erp_oltp: Close
17:50:21.553298 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:50:21.557507 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:50:21.557994 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:50:21.558109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:50:21.562180 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:50:21.562342 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:50:21.562414 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:50:21.563962 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:50:21.565004 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:50:21.565276 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:50:21.568440 [debug] [MainThread]: Using postgres connection "master"
17:50:21.568569 [debug] [MainThread]: On master: BEGIN
17:50:21.568643 [debug] [MainThread]: Opening a new connection, currently in state init
17:50:21.572648 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:21.572791 [debug] [MainThread]: Using postgres connection "master"
17:50:21.572897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:50:21.582883 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:50:21.584019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bf16640>]}
17:50:21.584371 [debug] [MainThread]: On master: ROLLBACK
17:50:21.584594 [debug] [MainThread]: Using postgres connection "master"
17:50:21.584679 [debug] [MainThread]: On master: BEGIN
17:50:21.584919 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:21.585014 [debug] [MainThread]: On master: COMMIT
17:50:21.585093 [debug] [MainThread]: Using postgres connection "master"
17:50:21.585155 [debug] [MainThread]: On master: COMMIT
17:50:21.585272 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:21.585356 [debug] [MainThread]: On master: Close
17:50:21.585637 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:50:21.585795 [info ] [MainThread]: 
17:50:21.590086 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:50:21.590303 [info ] [Thread-1  ]: 1 of 6 START table model public.customer2 ...................................... [RUN]
17:50:21.590575 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:50:21.590663 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:50:21.590742 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:50:21.592344 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:50:21.592655 [debug] [Thread-1  ]: finished collecting timing info
17:50:21.592892 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:50:21.593016 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:50:21.598597 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:50:21.598735 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:50:21.599134 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:50:21.611771 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:50:21.611889 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:50:21.613677 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:50:21.599226 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:50:21.614343 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:50:21.611490 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:50:21.615129 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.615225 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:50:21.615342 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:50:21.614723 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:50:21.655457 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:50:21.655605 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:50:21.614052 [debug] [Thread-2  ]: finished collecting timing info
17:50:21.656414 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:50:21.663522 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:50:21.663216 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:50:21.665574 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:50:21.665951 [debug] [Thread-4  ]: finished collecting timing info
17:50:21.669530 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:50:21.670093 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.670377 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:50:21.670621 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.676513 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:50:21.682178 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:50:21.670932 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:50:21.688507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:50:21.688258 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:50:21.682028 [debug] [Thread-3  ]: finished collecting timing info
17:50:21.689546 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:50:21.689066 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.691747 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:50:21.691979 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:50:21.692481 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:50:21.693711 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.693884 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:50:21.693963 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:50:21.697296 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:50:21.697447 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.697526 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:50:21.698213 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:50:21.698331 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.698397 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:50:21.699417 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
17:50:21.703682 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.703827 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:50:21.704055 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
17:50:21.706346 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.706745 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:50:21.707224 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.708599 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.708705 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:50:21.708861 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:50:21.709011 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.709114 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.709229 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)

select * from customers
  );
17:50:21.710435 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.710718 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:50:21.710850 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.717863 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
17:50:21.719703 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.719814 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:50:21.719953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:50:21.723428 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:50:21.723562 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.723634 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:50:21.723827 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:50:21.724788 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.724943 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.728702 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:50:21.728871 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:50:21.725084 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:50:21.728998 [debug] [Thread-3  ]: SQL status: BEGIN in 0.04 seconds
17:50:21.729793 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.729894 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:50:21.729091 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
17:50:21.730048 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.734478 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.736568 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:50:21.737004 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.736411 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:21.738124 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:50:21.738314 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:50:21.738480 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
17:50:21.738612 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.738683 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:50:21.743947 [debug] [Thread-1  ]: finished collecting timing info
17:50:21.744081 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:50:21.742950 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:50:21.743051 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:50:21.740406 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.745420 [debug] [Thread-2  ]: finished collecting timing info
17:50:21.745702 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:50:21.746494 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.748357 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:50:21.746990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b28585fa0>]}
17:50:21.746694 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:50:21.750798 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2857d880>]}
17:50:21.748933 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.752551 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.748772 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:50:21.751090 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
17:50:21.753096 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:50:21.749210 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.16s]
17:50:21.753491 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
17:50:21.753790 [info ] [Thread-6  ]: 5 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:50:21.752649 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:50:21.755134 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:50:21.755250 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.756078 [debug] [Thread-4  ]: finished collecting timing info
17:50:21.757808 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:50:21.756689 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:50:21.757582 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:50:21.756253 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:50:21.757944 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
17:50:21.759516 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
17:50:21.759336 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.761701 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:50:21.762812 [debug] [Thread-6  ]: finished collecting timing info
17:50:21.762443 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:50:21.762968 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
17:50:21.766565 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:50:21.767055 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:21.767165 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
17:50:21.767235 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:50:21.758285 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be367f0>]}
17:50:21.768325 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.769325 [info ] [Thread-4  ]: 4 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.14s]
17:50:21.775266 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:21.775866 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:50:21.776015 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:50:21.776499 [debug] [Thread-8  ]: Began running node model.first_project.customers
17:50:21.776783 [info ] [Thread-8  ]: 6 of 6 START view model public.customers ....................................... [RUN]
17:50:21.777129 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
17:50:21.777220 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
17:50:21.777299 [debug] [Thread-8  ]: Compiling model.first_project.customers
17:50:21.782417 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
17:50:21.783071 [debug] [Thread-8  ]: finished collecting timing info
17:50:21.783457 [debug] [Thread-8  ]: Began executing node model.first_project.customers
17:50:21.787205 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
17:50:21.787719 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:50:21.788042 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:50:21.788151 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
17:50:21.789322 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:21.789210 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
17:50:21.789402 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:50:21.790912 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:50:21.789494 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:50:21.789085 [debug] [Thread-3  ]: finished collecting timing info
17:50:21.792753 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:21.794714 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:50:21.798417 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b28573370>]}
17:50:21.798799 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.18s]
17:50:21.799396 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:50:21.794912 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:50:21.800175 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.801279 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:50:21.801382 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:21.801471 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:50:21.802477 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.803656 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:21.803839 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:50:21.805082 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
17:50:21.805221 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:50:21.805290 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:50:21.806232 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:50:21.807926 [debug] [Thread-6  ]: finished collecting timing info
17:50:21.808373 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:50:21.808585 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
17:50:21.814831 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b28559970>]}
17:50:21.815303 [info ] [Thread-6  ]: 5 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
17:50:21.815681 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
17:50:21.810884 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:50:21.816090 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:50:21.816941 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:21.817977 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
17:50:21.818087 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:50:21.818159 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
17:50:21.818996 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:50:21.820279 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:50:21.820434 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:50:21.820827 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:50:21.822887 [debug] [Thread-8  ]: finished collecting timing info
17:50:21.823013 [debug] [Thread-8  ]: On model.first_project.customers: Close
17:50:21.823520 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db27c35a-3a1e-474c-b2a6-f534629d9eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b284ceeb0>]}
17:50:21.824144 [info ] [Thread-8  ]: 6 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.05s]
17:50:21.824653 [debug] [Thread-8  ]: Finished running node model.first_project.customers
17:50:21.826095 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:21.826240 [debug] [MainThread]: Using postgres connection "master"
17:50:21.826323 [debug] [MainThread]: On master: BEGIN
17:50:21.826387 [debug] [MainThread]: Opening a new connection, currently in state closed
17:50:21.835121 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:50:21.835343 [debug] [MainThread]: On master: COMMIT
17:50:21.835424 [debug] [MainThread]: Using postgres connection "master"
17:50:21.835496 [debug] [MainThread]: On master: COMMIT
17:50:21.835648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:21.835771 [debug] [MainThread]: On master: Close
17:50:21.836173 [info ] [MainThread]: 
17:50:21.836368 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0.31s.
17:50:21.836490 [debug] [MainThread]: Connection 'master' was properly closed.
17:50:21.836553 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:50:21.836610 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:50:21.836665 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:50:21.836719 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:50:21.836821 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:50:21.836887 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:50:21.840582 [info ] [MainThread]: 
17:50:21.840924 [info ] [MainThread]: [32mCompleted successfully[0m
17:50:21.841142 [info ] [MainThread]: 
17:50:21.841258 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:50:21.841457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be45e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2be4ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b2bde2f70>]}


============================== 2022-06-04 17:53:04.334996 | ecf19713-bc72-4e09-aabe-ed71d31cff6f ==============================
17:53:04.335013 [info ] [MainThread]: Running with dbt=1.1.0
17:53:04.335514 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:53:04.335671 [debug] [MainThread]: Tracking: tracking
17:53:04.338660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff6a4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff6a4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff6a4d60>]}
17:53:04.374980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:53:04.375361 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
17:53:04.391248 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:53:04.408414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff1660d0>]}
17:53:04.412290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff584c40>]}
17:53:04.412592 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:53:04.412774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff58dfa0>]}
17:53:04.414081 [info ] [MainThread]: 
17:53:04.414441 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:04.415291 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:53:04.421980 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:53:04.422128 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:53:04.422208 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:53:04.428878 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:53:04.430545 [debug] [ThreadPool]: On list_erp_oltp: Close
17:53:04.431975 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:53:04.438544 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:53:04.438931 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:53:04.439115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:53:04.443542 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:53:04.444752 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:53:04.445009 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:53:04.446908 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:53:04.447800 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:53:04.448071 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:53:04.477758 [debug] [MainThread]: Using postgres connection "master"
17:53:04.477968 [debug] [MainThread]: On master: BEGIN
17:53:04.478072 [debug] [MainThread]: Opening a new connection, currently in state init
17:53:04.482060 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:53:04.482194 [debug] [MainThread]: Using postgres connection "master"
17:53:04.482256 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:53:04.492610 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:53:04.493913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff15dcd0>]}
17:53:04.494196 [debug] [MainThread]: On master: ROLLBACK
17:53:04.494851 [debug] [MainThread]: Using postgres connection "master"
17:53:04.494962 [debug] [MainThread]: On master: BEGIN
17:53:04.495298 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:53:04.495402 [debug] [MainThread]: On master: COMMIT
17:53:04.495478 [debug] [MainThread]: Using postgres connection "master"
17:53:04.495542 [debug] [MainThread]: On master: COMMIT
17:53:04.495731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:04.495848 [debug] [MainThread]: On master: Close
17:53:04.496223 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:53:04.496408 [info ] [MainThread]: 
17:53:04.500044 [debug] [Thread-1  ]: Began running node model.first_project.customer2
17:53:04.500258 [info ] [Thread-1  ]: 1 of 6 START table model public.customer2 ...................................... [RUN]
17:53:04.500568 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customer2"
17:53:04.500675 [debug] [Thread-1  ]: Began compiling node model.first_project.customer2
17:53:04.500766 [debug] [Thread-1  ]: Compiling model.first_project.customer2
17:53:04.502494 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customer2"
17:53:04.502666 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:53:04.502826 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:53:04.503244 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:53:04.503458 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:53:04.503545 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:53:04.504985 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:53:04.505206 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:53:04.505551 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:53:04.506074 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.505659 [debug] [Thread-2  ]: finished collecting timing info
17:53:04.505373 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:53:04.506528 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:53:04.506314 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:53:04.506181 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:53:04.519532 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:53:04.526570 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:53:04.506796 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:53:04.526836 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:53:04.526930 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:53:04.527610 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:53:04.506949 [debug] [Thread-1  ]: finished collecting timing info
17:53:04.527918 [debug] [Thread-4  ]: finished collecting timing info
17:53:04.534295 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:53:04.528119 [debug] [Thread-1  ]: Began executing node model.first_project.customer2
17:53:04.547734 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customer2"
17:53:04.548028 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.546011 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:53:04.528244 [debug] [Thread-3  ]: finished collecting timing info
17:53:04.533772 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:53:04.548224 [debug] [Thread-1  ]: On model.first_project.customer2: BEGIN
17:53:04.548457 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:53:04.548717 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.550859 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:53:04.551501 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.551629 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:53:04.551248 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:53:04.551836 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:53:04.549001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:53:04.551698 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:53:04.551100 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.553947 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:53:04.554083 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:53:04.558003 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:53:04.558321 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.558472 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:53:04.561006 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
17:53:04.566797 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.566953 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:53:04.567278 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:53:04.570418 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:53:04.570868 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.570662 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.571001 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:53:04.571743 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:53:04.571216 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:53:04.571851 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.572020 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
17:53:04.571124 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.574035 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.574154 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:53:04.574717 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:04.576168 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.576261 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:53:04.576718 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.576863 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.577065 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
17:53:04.582496 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
17:53:04.584252 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:53:04.586412 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.588261 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.589856 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.590081 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.590205 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:53:04.590387 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:53:04.590528 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:53:04.591091 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.592196 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.592284 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:53:04.592416 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.590649 [debug] [Thread-1  ]: On model.first_project.customer2: COMMIT
17:53:04.593547 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.594926 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:53:04.593701 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.593627 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.595816 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:53:04.596649 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:53:04.597121 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.596954 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.597293 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:53:04.597191 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:53:04.596777 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.597029 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.597949 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:53:04.598088 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.602089 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:04.601101 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.602340 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:53:04.602209 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:53:04.601203 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.600955 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customer2"
17:53:04.603270 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:04.603467 [debug] [Thread-1  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:53:04.603608 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:53:04.604232 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:53:04.605607 [debug] [Thread-2  ]: finished collecting timing info
17:53:04.605737 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.605875 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:53:04.608469 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff59e910>]}
17:53:04.606043 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:04.609642 [debug] [Thread-3  ]: finished collecting timing info
17:53:04.608743 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
17:53:04.610056 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:53:04.609746 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:53:04.606979 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:53:04.605961 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:53:04.610404 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
17:53:04.611624 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:53:04.611844 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff0b4c10>]}
17:53:04.612664 [info ] [Thread-6  ]: 5 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:53:04.613197 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:53:04.613338 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
17:53:04.613453 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
17:53:04.615367 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:53:04.612500 [debug] [Thread-1  ]: finished collecting timing info
17:53:04.619022 [debug] [Thread-1  ]: On model.first_project.customer2: Close
17:53:04.619688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2fc052d90>]}
17:53:04.619897 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.12s]
17:53:04.619246 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
17:53:04.621643 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:53:04.621391 [debug] [Thread-1  ]: Finished running node model.first_project.customer2
17:53:04.619360 [debug] [Thread-6  ]: finished collecting timing info
17:53:04.621861 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
17:53:04.623177 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:53:04.623384 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
17:53:04.624343 [debug] [Thread-4  ]: finished collecting timing info
17:53:04.630504 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:53:04.630904 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:04.631047 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
17:53:04.631126 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:53:04.631726 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2dc7f8220>]}
17:53:04.632031 [info ] [Thread-4  ]: 4 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
17:53:04.633081 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:53:04.633511 [debug] [Thread-8  ]: Began running node model.first_project.customers
17:53:04.633680 [info ] [Thread-8  ]: 6 of 6 START view model public.customers ....................................... [RUN]
17:53:04.633966 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
17:53:04.634080 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
17:53:04.634188 [debug] [Thread-8  ]: Compiling model.first_project.customers
17:53:04.636001 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
17:53:04.636387 [debug] [Thread-8  ]: finished collecting timing info
17:53:04.636610 [debug] [Thread-8  ]: Began executing node model.first_project.customers
17:53:04.638273 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
17:53:04.638580 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:53:04.638682 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
17:53:04.638748 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:53:04.644606 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:53:04.644761 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:53:04.644872 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:53:04.648385 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:04.650728 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:53:04.650880 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:53:04.651410 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.651599 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
17:53:04.653453 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
17:53:04.653856 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:04.654002 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:53:04.654117 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:53:04.654235 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
17:53:04.655667 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:04.657228 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:04.657322 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:53:04.657688 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:04.658511 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:53:04.658598 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:04.658659 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:53:04.658856 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.659921 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
17:53:04.660022 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:53:04.660124 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:53:04.661186 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:04.661289 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:53:04.661369 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:04.662120 [debug] [Thread-8  ]: finished collecting timing info
17:53:04.662251 [debug] [Thread-8  ]: On model.first_project.customers: Close
17:53:04.662348 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:04.663189 [debug] [Thread-6  ]: finished collecting timing info
17:53:04.663304 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
17:53:04.663624 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2dc7f3910>]}
17:53:04.664721 [info ] [Thread-6  ]: 5 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
17:53:04.665034 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecf19713-bc72-4e09-aabe-ed71d31cff6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2dc7e1520>]}
17:53:04.666356 [info ] [Thread-8  ]: 6 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.03s]
17:53:04.666582 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
17:53:04.666826 [debug] [Thread-8  ]: Finished running node model.first_project.customers
17:53:04.667985 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:04.668098 [debug] [MainThread]: Using postgres connection "master"
17:53:04.668164 [debug] [MainThread]: On master: BEGIN
17:53:04.668223 [debug] [MainThread]: Opening a new connection, currently in state closed
17:53:04.673547 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:53:04.673726 [debug] [MainThread]: On master: COMMIT
17:53:04.673832 [debug] [MainThread]: Using postgres connection "master"
17:53:04.673897 [debug] [MainThread]: On master: COMMIT
17:53:04.674757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:04.674905 [debug] [MainThread]: On master: Close
17:53:04.675262 [info ] [MainThread]: 
17:53:04.675528 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0.26s.
17:53:04.675657 [debug] [MainThread]: Connection 'master' was properly closed.
17:53:04.675715 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:53:04.675768 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:53:04.675820 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:53:04.675872 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:53:04.675922 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:53:04.675996 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:53:04.680706 [info ] [MainThread]: 
17:53:04.681143 [info ] [MainThread]: [32mCompleted successfully[0m
17:53:04.681490 [info ] [MainThread]: 
17:53:04.681750 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:53:04.682008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ff615ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff301885070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff300eb3730>]}


============================== 2022-06-04 17:55:34.357270 | 2eee8b5b-ffd1-4fe3-b22e-f8ea68116662 ==============================
17:55:34.357284 [info ] [MainThread]: Running with dbt=1.1.0
17:55:34.357647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:55:34.357751 [debug] [MainThread]: Tracking: tracking
17:55:34.360232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08802be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08802b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08802b220>]}
17:55:34.380074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
17:55:34.380454 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:55:34.380630 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customer2.sql
17:55:34.392689 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:55:34.404586 [debug] [MainThread]: 1699: static parser successfully parsed erp/customer2.sql
17:55:34.433631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa087f4b1f0>]}
17:55:34.464148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa087f20970>]}
17:55:34.464416 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:55:34.464596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08a20f2e0>]}
17:55:34.465613 [info ] [MainThread]: 
17:55:34.465911 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:34.466643 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:55:34.479765 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:55:34.479952 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:55:34.480034 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:55:34.491703 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:55:34.492861 [debug] [ThreadPool]: On list_erp_oltp: Close
17:55:34.505168 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:55:34.509503 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:55:34.509702 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:55:34.509783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:55:34.514214 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:55:34.514469 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:55:34.514630 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:55:34.517009 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:55:34.518108 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:55:34.519101 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:55:34.522029 [debug] [MainThread]: Using postgres connection "master"
17:55:34.522173 [debug] [MainThread]: On master: BEGIN
17:55:34.522247 [debug] [MainThread]: Opening a new connection, currently in state init
17:55:34.527974 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:34.528160 [debug] [MainThread]: Using postgres connection "master"
17:55:34.528239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:55:34.539789 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:55:34.540927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08a20f580>]}
17:55:34.541197 [debug] [MainThread]: On master: ROLLBACK
17:55:34.541437 [debug] [MainThread]: Using postgres connection "master"
17:55:34.541535 [debug] [MainThread]: On master: BEGIN
17:55:34.541753 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:55:34.541849 [debug] [MainThread]: On master: COMMIT
17:55:34.541920 [debug] [MainThread]: Using postgres connection "master"
17:55:34.541984 [debug] [MainThread]: On master: COMMIT
17:55:34.542149 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:34.542259 [debug] [MainThread]: On master: Close
17:55:34.542656 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:55:34.542885 [info ] [MainThread]: 
17:55:34.546005 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:55:34.546225 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:55:34.546525 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:55:34.546620 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:55:34.546701 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:55:34.548546 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:55:34.548977 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:55:34.551469 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:55:34.551938 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.552039 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:55:34.552122 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:55:34.554223 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:55:34.554362 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:55:34.554629 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:55:34.554902 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:55:34.554987 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:55:34.555083 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:55:34.555935 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:55:34.556182 [debug] [Thread-3  ]: finished collecting timing info
17:55:34.556300 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:55:34.554449 [debug] [Thread-1  ]: finished collecting timing info
17:55:34.565428 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:55:34.565197 [debug] [Thread-2  ]: finished collecting timing info
17:55:34.595844 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:55:34.595568 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:55:34.589755 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:55:34.597553 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:55:34.598274 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.598630 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.598775 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:55:34.599025 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:55:34.599499 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:55:34.599364 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.599682 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:55:34.600688 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:55:34.600960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:55:34.607564 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:55:34.607783 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.607869 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
17:55:34.608467 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:55:34.608594 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.608703 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:55:34.608921 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:55:34.614114 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.614308 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:55:34.615650 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.619349 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.619520 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
17:55:34.619639 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:55:34.621322 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.621657 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:55:34.621482 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.619797 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:55:34.621805 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:55:34.622305 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.627556 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:55:34.627752 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:55:34.627925 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:55:34.631257 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.629826 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.631478 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:55:34.628027 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.631694 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:55:34.632010 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:55:34.632871 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.635093 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.635206 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:55:34.635514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.639123 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:55:34.639461 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.639280 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.639580 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:55:34.635310 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:55:34.640372 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:55:34.645038 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.645187 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:55:34.644012 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:55:34.646221 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:34.646316 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:55:34.643856 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:34.646424 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:55:34.649928 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:34.650982 [debug] [Thread-3  ]: finished collecting timing info
17:55:34.651200 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:55:34.652685 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:34.652838 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:55:34.651376 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:55:34.652976 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:55:34.654029 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa087a7ef10>]}
17:55:34.654180 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:34.655616 [debug] [Thread-1  ]: finished collecting timing info
17:55:34.656426 [debug] [Thread-2  ]: finished collecting timing info
17:55:34.656976 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:55:34.656828 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:55:34.657343 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa084209a30>]}
17:55:34.657578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa087a80730>]}
17:55:34.658686 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
17:55:34.661075 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:55:34.656648 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.10s]
17:55:34.660646 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
17:55:34.661495 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:55:34.663318 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:55:34.665022 [debug] [Thread-5  ]: Began running node model.first_project.customer2
17:55:34.665252 [info ] [Thread-5  ]: 4 of 6 START table model public.customer2 ...................................... [RUN]
17:55:34.665578 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customer2"
17:55:34.665665 [debug] [Thread-5  ]: Began compiling node model.first_project.customer2
17:55:34.665744 [debug] [Thread-5  ]: Compiling model.first_project.customer2
17:55:34.667534 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customer2"
17:55:34.667804 [debug] [Thread-5  ]: finished collecting timing info
17:55:34.667955 [debug] [Thread-5  ]: Began executing node model.first_project.customer2
17:55:34.670452 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customer2"
17:55:34.670573 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:55:34.670972 [info ] [Thread-6  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:55:34.671231 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
17:55:34.671313 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
17:55:34.671455 [debug] [Thread-6  ]: Compiling model.first_project.customers
17:55:34.670769 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:55:34.673726 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:55:34.674007 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:55:34.674092 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:55:34.674187 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:55:34.675464 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:55:34.673499 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
17:55:34.676154 [debug] [Thread-6  ]: finished collecting timing info
17:55:34.675952 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.676275 [debug] [Thread-6  ]: Began executing node model.first_project.customers
17:55:34.675772 [debug] [Thread-8  ]: finished collecting timing info
17:55:34.679950 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:55:34.679726 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
17:55:34.682942 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:55:34.682086 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:55:34.683093 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
17:55:34.683371 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:55:34.676391 [debug] [Thread-5  ]: On model.first_project.customer2: BEGIN
17:55:34.683779 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:34.684717 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:55:34.684865 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:55:34.685615 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:55:34.690523 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:55:34.690713 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:55:34.690820 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:55:34.692703 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:55:34.694331 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:34.694441 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:55:34.696200 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:55:34.696382 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.696457 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:55:34.697541 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.01 seconds
17:55:34.701003 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:55:34.701164 [debug] [Thread-5  ]: SQL status: SELECT 100 in 0.0 seconds
17:55:34.701274 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
17:55:34.702936 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.704842 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:55:34.704328 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:34.701443 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:55:34.705091 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:55:34.705617 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.706521 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:55:34.706703 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.706869 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:34.707715 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:55:34.707857 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:55:34.707956 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.709664 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.709776 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:55:34.709897 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:55:34.708070 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:55:34.711356 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:34.711494 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:55:34.711643 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:55:34.711938 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:34.712747 [debug] [Thread-8  ]: finished collecting timing info
17:55:34.712919 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:55:34.713200 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:34.713035 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:55:34.713512 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0841eb460>]}
17:55:34.715855 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
17:55:34.717840 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.717612 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
17:55:34.717934 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
17:55:34.717096 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:55:34.718232 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:55:34.718421 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:55:34.719027 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:34.719813 [debug] [Thread-6  ]: finished collecting timing info
17:55:34.719923 [debug] [Thread-6  ]: On model.first_project.customers: Close
17:55:34.720211 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0841fbd60>]}
17:55:34.720462 [info ] [Thread-6  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.05s]
17:55:34.720716 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:55:34.721726 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:55:34.722088 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:55:34.724987 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:55:34.725351 [debug] [Thread-5  ]: SQL status: DROP TABLE in 0.0 seconds
17:55:34.726095 [debug] [Thread-5  ]: finished collecting timing info
17:55:34.726243 [debug] [Thread-5  ]: On model.first_project.customer2: Close
17:55:34.726545 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2eee8b5b-ffd1-4fe3-b22e-f8ea68116662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa088041580>]}
17:55:34.726763 [info ] [Thread-5  ]: 4 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.06s]
17:55:34.727465 [debug] [Thread-5  ]: Finished running node model.first_project.customer2
17:55:34.728552 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:34.728671 [debug] [MainThread]: Using postgres connection "master"
17:55:34.728740 [debug] [MainThread]: On master: BEGIN
17:55:34.728803 [debug] [MainThread]: Opening a new connection, currently in state closed
17:55:34.736422 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:34.736645 [debug] [MainThread]: On master: COMMIT
17:55:34.736725 [debug] [MainThread]: Using postgres connection "master"
17:55:34.736824 [debug] [MainThread]: On master: COMMIT
17:55:34.736988 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:34.737094 [debug] [MainThread]: On master: Close
17:55:34.737476 [info ] [MainThread]: 
17:55:34.737717 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.27s.
17:55:34.737862 [debug] [MainThread]: Connection 'master' was properly closed.
17:55:34.737925 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:55:34.737981 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:55:34.738035 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:55:34.738087 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:55:34.738141 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:55:34.738195 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:55:34.741339 [info ] [MainThread]: 
17:55:34.741546 [info ] [MainThread]: [32mCompleted successfully[0m
17:55:34.741740 [info ] [MainThread]: 
17:55:34.741877 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:55:34.742071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa087a74850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08984f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa08a20f5b0>]}


============================== 2022-06-04 17:59:42.087681 | ad7e604d-3079-4b41-8d29-b74801c57fed ==============================
17:59:42.087694 [info ] [MainThread]: Running with dbt=1.1.0
17:59:42.090616 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:59:42.090711 [debug] [MainThread]: Tracking: tracking
17:59:42.103407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabd41fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabd41fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabd41d60>]}
17:59:42.134551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:59:42.135057 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:59:42.143881 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:59:42.206842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ead54c6d0>]}
17:59:42.210302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabd364c0>]}
17:59:42.210605 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:59:42.210759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabd36250>]}
17:59:42.211754 [info ] [MainThread]: 
17:59:42.212099 [debug] [MainThread]: Acquiring new postgres connection "master"
17:59:42.213099 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:59:42.220346 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:59:42.220480 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:59:42.220546 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:59:42.228458 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:59:42.229654 [debug] [ThreadPool]: On list_erp_oltp: Close
17:59:42.230637 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:59:42.235220 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:59:42.235461 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:59:42.235591 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:59:42.247244 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:59:42.247500 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:59:42.247572 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:59:42.249403 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:59:42.250433 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:59:42.250650 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:59:42.253881 [debug] [MainThread]: Using postgres connection "master"
17:59:42.254081 [debug] [MainThread]: On master: BEGIN
17:59:42.254158 [debug] [MainThread]: Opening a new connection, currently in state init
17:59:42.259040 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:59:42.259347 [debug] [MainThread]: Using postgres connection "master"
17:59:42.259430 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:59:42.268970 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:59:42.270228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabc2beb0>]}
17:59:42.270487 [debug] [MainThread]: On master: ROLLBACK
17:59:42.270956 [debug] [MainThread]: Using postgres connection "master"
17:59:42.271084 [debug] [MainThread]: On master: BEGIN
17:59:42.271387 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:59:42.271500 [debug] [MainThread]: On master: COMMIT
17:59:42.271570 [debug] [MainThread]: Using postgres connection "master"
17:59:42.271631 [debug] [MainThread]: On master: COMMIT
17:59:42.271752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:59:42.271843 [debug] [MainThread]: On master: Close
17:59:42.272173 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:59:42.272375 [info ] [MainThread]: 
17:59:42.277738 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:59:42.278025 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:59:42.278349 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:59:42.278463 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:59:42.278546 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:59:42.280049 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:59:42.280346 [debug] [Thread-1  ]: finished collecting timing info
17:59:42.280499 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:59:42.286812 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:59:42.286965 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:59:42.292615 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:59:42.305242 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.304820 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:59:42.305331 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:59:42.305766 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:59:42.305590 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:59:42.307271 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:59:42.303823 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:59:42.307483 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:59:42.307798 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:59:42.309929 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:59:42.310430 [debug] [Thread-3  ]: finished collecting timing info
17:59:42.310616 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.310770 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:59:42.310924 [debug] [Thread-2  ]: finished collecting timing info
17:59:42.321920 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:59:42.311032 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:59:42.326051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:59:42.324937 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:59:42.326551 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.326653 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:59:42.326717 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:59:42.325871 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:59:42.327512 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.327606 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:59:42.327670 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:59:42.336013 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:59:42.336224 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.336301 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:59:42.336447 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:59:42.336568 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.336636 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
17:59:42.341679 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
17:59:42.342109 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:59:42.351384 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.351578 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:59:42.351923 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:59:42.355141 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.355243 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
17:59:42.355392 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.352176 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.357371 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:59:42.356882 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.357249 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:42.357552 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:59:42.359404 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.359919 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:59:42.359650 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.360212 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.362640 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.369367 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:59:42.367623 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:59:42.363368 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.370562 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.372044 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.372459 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:59:42.372244 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:59:42.372910 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.373862 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:59:42.374115 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.373966 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:59:42.372136 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.374238 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:59:42.377851 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:42.382515 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:59:42.381988 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:59:42.383100 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.383265 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:59:42.384850 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:59:42.389885 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:42.390102 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
17:59:42.394924 [debug] [Thread-2  ]: finished collecting timing info
17:59:42.393877 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:59:42.395063 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:59:42.395538 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea8713f70>]}
17:59:42.395795 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
17:59:42.396055 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:59:42.396893 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:42.392933 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:59:42.397625 [debug] [Thread-3  ]: finished collecting timing info
17:59:42.398603 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:42.398790 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:59:42.398982 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:59:42.400418 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eab775d00>]}
17:59:42.400539 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:59:42.400861 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.09s]
17:59:42.401615 [debug] [Thread-1  ]: finished collecting timing info
17:59:42.401884 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:59:42.402116 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:59:42.403117 [debug] [Thread-5  ]: Began running node model.first_project.customer2
17:59:42.403282 [info ] [Thread-5  ]: 4 of 6 START table model public.customer2 ...................................... [RUN]
17:59:42.403557 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customer2"
17:59:42.403790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eab780d90>]}
17:59:42.403908 [debug] [Thread-5  ]: Began compiling node model.first_project.customer2
17:59:42.404338 [debug] [Thread-5  ]: Compiling model.first_project.customer2
17:59:42.404234 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
17:59:42.404003 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:59:42.409646 [info ] [Thread-6  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:59:42.409955 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
17:59:42.410032 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
17:59:42.410101 [debug] [Thread-6  ]: Compiling model.first_project.customers
17:59:42.409232 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:59:42.411501 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
17:59:42.412317 [debug] [Thread-6  ]: finished collecting timing info
17:59:42.411945 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:59:42.412620 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:59:42.412933 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:59:42.413095 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:59:42.413239 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:59:42.414957 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:59:42.415194 [debug] [Thread-8  ]: finished collecting timing info
17:59:42.415299 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:59:42.416735 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:59:42.412430 [debug] [Thread-6  ]: Began executing node model.first_project.customers
17:59:42.418413 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
17:59:42.408806 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customer2"
17:59:42.418598 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:42.418775 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:59:42.418841 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:59:42.419111 [debug] [Thread-5  ]: finished collecting timing info
17:59:42.419257 [debug] [Thread-5  ]: Began executing node model.first_project.customer2
17:59:42.420679 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customer2"
17:59:42.420925 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:59:42.421063 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
17:59:42.421133 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:59:42.421576 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.421669 [debug] [Thread-5  ]: On model.first_project.customer2: BEGIN
17:59:42.421732 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:59:42.430274 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:59:42.430560 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:59:42.430671 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:59:42.432132 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:42.433719 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:59:42.433808 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:59:42.434950 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.435794 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:59:42.435893 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:59:42.435961 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:59:42.436223 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
17:59:42.436332 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:42.437344 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:59:42.437477 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:59:42.438889 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:59:42.439015 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:42.439225 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:59:42.440720 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:42.441012 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:59:42.441225 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:42.442905 [debug] [Thread-6  ]: finished collecting timing info
17:59:42.443322 [debug] [Thread-6  ]: On model.first_project.customers: Close
17:59:42.444878 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea86fda90>]}
17:59:42.446866 [info ] [Thread-6  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.03s]
17:59:42.447386 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:59:42.453106 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.01 seconds
17:59:42.454685 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:59:42.454846 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:42.454961 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:59:42.456237 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:59:42.457412 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:42.457527 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:59:42.457789 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:42.458914 [debug] [Thread-8  ]: finished collecting timing info
17:59:42.459115 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:59:42.460875 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabc49670>]}
17:59:42.461165 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
17:59:42.461430 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:59:42.461947 [debug] [Thread-5  ]: SQL status: BEGIN in 0.04 seconds
17:59:42.462050 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.462118 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:59:42.465101 [debug] [Thread-5  ]: SQL status: SELECT 100 in 0.0 seconds
17:59:42.466746 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.466870 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
17:59:42.468436 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.470530 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.470690 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
17:59:42.471166 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:42.472312 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
17:59:42.472409 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.472473 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
17:59:42.474834 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:59:42.476221 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
17:59:42.476367 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
17:59:42.478441 [debug] [Thread-5  ]: SQL status: DROP TABLE in 0.0 seconds
17:59:42.479443 [debug] [Thread-5  ]: finished collecting timing info
17:59:42.479570 [debug] [Thread-5  ]: On model.first_project.customer2: Close
17:59:42.479992 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad7e604d-3079-4b41-8d29-b74801c57fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabc3d040>]}
17:59:42.480224 [info ] [Thread-5  ]: 4 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.08s]
17:59:42.480519 [debug] [Thread-5  ]: Finished running node model.first_project.customer2
17:59:42.481616 [debug] [MainThread]: Acquiring new postgres connection "master"
17:59:42.481742 [debug] [MainThread]: Using postgres connection "master"
17:59:42.481814 [debug] [MainThread]: On master: BEGIN
17:59:42.481870 [debug] [MainThread]: Opening a new connection, currently in state closed
17:59:42.486757 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:59:42.486935 [debug] [MainThread]: On master: COMMIT
17:59:42.487007 [debug] [MainThread]: Using postgres connection "master"
17:59:42.487067 [debug] [MainThread]: On master: COMMIT
17:59:42.487182 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:59:42.487273 [debug] [MainThread]: On master: Close
17:59:42.487581 [info ] [MainThread]: 
17:59:42.487744 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.28s.
17:59:42.487905 [debug] [MainThread]: Connection 'master' was properly closed.
17:59:42.488031 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:59:42.488147 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:59:42.488247 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:59:42.488384 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
17:59:42.488496 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:59:42.488648 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:59:42.495824 [info ] [MainThread]: 
17:59:42.496113 [info ] [MainThread]: [32mCompleted successfully[0m
17:59:42.496330 [info ] [MainThread]: 
17:59:42.496480 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:59:42.496712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eabc22e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2eadb308b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ea869cb20>]}


============================== 2022-06-04 18:00:09.422935 | 008a8d17-1d3b-4c16-837a-faf3f06508a9 ==============================
18:00:09.422952 [info ] [MainThread]: Running with dbt=1.1.0
18:00:09.423425 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:00:09.423523 [debug] [MainThread]: Tracking: tracking
18:00:09.426512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe015637fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe015637fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe015637d60>]}
18:00:09.451648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:00:09.451823 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:00:09.457599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '008a8d17-1d3b-4c16-837a-faf3f06508a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0154d80d0>]}
18:00:09.461775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '008a8d17-1d3b-4c16-837a-faf3f06508a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0155a33d0>]}
18:00:09.462015 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:00:09.462188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '008a8d17-1d3b-4c16-837a-faf3f06508a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0155a3670>]}
18:00:09.463477 [info ] [MainThread]: 
18:00:09.463982 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:09.465141 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:00:09.471617 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:09.471737 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:00:09.471814 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:00:09.479477 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:00:09.479719 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:09.479798 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:00:09.481944 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:00:09.483352 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:00:09.483645 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:00:09.487653 [debug] [MainThread]: Using postgres connection "master"
18:00:09.487840 [debug] [MainThread]: On master: BEGIN
18:00:09.487913 [debug] [MainThread]: Opening a new connection, currently in state init
18:00:09.493219 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:00:09.493418 [debug] [MainThread]: Using postgres connection "master"
18:00:09.493502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:00:09.504929 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:00:09.506042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '008a8d17-1d3b-4c16-837a-faf3f06508a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe015521fd0>]}
18:00:09.506310 [debug] [MainThread]: On master: ROLLBACK
18:00:09.506551 [debug] [MainThread]: Using postgres connection "master"
18:00:09.506663 [debug] [MainThread]: On master: BEGIN
18:00:09.507183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:09.507398 [debug] [MainThread]: On master: COMMIT
18:00:09.507476 [debug] [MainThread]: Using postgres connection "master"
18:00:09.507548 [debug] [MainThread]: On master: COMMIT
18:00:09.507852 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:09.507982 [debug] [MainThread]: On master: Close
18:00:09.508319 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:00:09.508499 [info ] [MainThread]: 
18:00:09.514794 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:09.515003 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [RUN]
18:00:09.515368 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:09.515485 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:09.515569 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:09.525259 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:09.525468 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:09.529593 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:00:09.529889 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:09.529207 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:00:09.530276 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:09.530356 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:09.530427 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:09.529982 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:09.537007 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:09.525586 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:09.568524 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:00:09.529461 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:09.569078 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:00:09.536903 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:09.569761 [debug] [Thread-2  ]: finished collecting timing info
18:00:09.568257 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:09.568862 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:09.570427 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:09.569335 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:09.570673 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:09.570756 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:09.529063 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:09.570258 [debug] [Thread-3  ]: finished collecting timing info
18:00:09.570549 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:09.529316 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:09.569924 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:09.529394 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:09.593092 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:00:09.593442 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:09.580391 [debug] [Thread-1  ]: finished collecting timing info
18:00:09.580229 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:09.582640 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:00:09.592877 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:09.593539 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:09.595622 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:09.593677 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:09.602438 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:09.595320 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:09.602658 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:09.602766 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:09.595028 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:09.582491 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:09.604777 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:09.579905 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:09.605871 [debug] [Thread-7  ]: finished collecting timing info
18:00:09.604939 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:09.606275 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: BEGIN
18:00:09.606357 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:00:09.605689 [debug] [Thread-5  ]: finished collecting timing info
18:00:09.606569 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:09.605595 [debug] [Thread-4  ]: finished collecting timing info
18:00:09.606151 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:09.605205 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:09.611863 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:00:09.610276 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:09.612308 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:09.610552 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:09.611712 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:09.614404 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:09.614526 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:00:09.612451 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:00:09.611954 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:00:09.606027 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:09.615203 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:00:09.615294 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:00:09.613562 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:09.615846 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:09.615933 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:00:09.615997 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:00:09.614669 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:00:09.597899 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:09.618301 [debug] [Thread-6  ]: finished collecting timing info
18:00:09.617107 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:00:09.618584 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:09.618469 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:09.619833 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:09.618672 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT'
)



      
    ) dbt_internal_test
18:00:09.614598 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:00:09.620782 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:09.620912 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:00:09.620977 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:00:09.623613 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:09.625544 [debug] [Thread-1  ]: finished collecting timing info
18:00:09.625727 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: ROLLBACK
18:00:09.626687 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: Close
18:00:09.627100 [error] [Thread-1  ]: 1 of 7 FAIL 3 accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [[31mFAIL 3[0m in 0.11s]
18:00:09.627571 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:09.631570 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:00:09.631751 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:09.631831 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:00:09.632002 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:00:09.632153 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:09.632226 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:00:09.633535 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:09.634630 [debug] [Thread-2  ]: finished collecting timing info
18:00:09.634772 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:00:09.634899 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:00:09.634998 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:09.635066 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:00:09.635352 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:00:09.635441 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:09.635501 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:00:09.635654 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:09.636463 [debug] [Thread-3  ]: finished collecting timing info
18:00:09.636567 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:00:09.636707 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:00:09.636898 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:09.638144 [debug] [Thread-4  ]: finished collecting timing info
18:00:09.638526 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:00:09.637107 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:00:09.637266 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:09.639411 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.11s]
18:00:09.639882 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:09.637186 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:00:09.640275 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.11s]
18:00:09.640676 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:09.641175 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
18:00:09.642143 [debug] [Thread-5  ]: finished collecting timing info
18:00:09.642258 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:00:09.642740 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:00:09.643117 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.05s]
18:00:09.643411 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:09.639577 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:00:09.643923 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:00:09.644232 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
18:00:09.644464 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:09.646893 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:00:09.647139 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:09.647225 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:00:09.648001 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:09.649033 [debug] [Thread-6  ]: finished collecting timing info
18:00:09.649160 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:00:09.649508 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.01 seconds
18:00:09.650298 [debug] [Thread-7  ]: finished collecting timing info
18:00:09.650398 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:00:09.650490 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:00:09.651751 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
18:00:09.651960 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:00:09.652322 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
18:00:09.652724 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:09.653434 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:09.655883 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:09.656028 [debug] [MainThread]: Using postgres connection "master"
18:00:09.656121 [debug] [MainThread]: On master: BEGIN
18:00:09.656186 [debug] [MainThread]: Opening a new connection, currently in state closed
18:00:09.661087 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:09.661293 [debug] [MainThread]: On master: COMMIT
18:00:09.661364 [debug] [MainThread]: Using postgres connection "master"
18:00:09.661429 [debug] [MainThread]: On master: COMMIT
18:00:09.661565 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:09.661672 [debug] [MainThread]: On master: Close
18:00:09.661961 [info ] [MainThread]: 
18:00:09.662268 [info ] [MainThread]: Finished running 7 tests in 0.20s.
18:00:09.662415 [debug] [MainThread]: Connection 'master' was properly closed.
18:00:09.662476 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09' was properly closed.
18:00:09.662540 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:00:09.662593 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:00:09.662645 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:00:09.662696 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:00:09.662747 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:00:09.667210 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:00:09.675687 [info ] [MainThread]: 
18:00:09.676009 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:00:09.676193 [info ] [MainThread]: 
18:00:09.676340 [error] [MainThread]: [31mFailure in test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT (models/erp/schema.yml)[0m
18:00:09.676495 [error] [MainThread]:   Got 3 results, configured to fail if != 0
18:00:09.676629 [info ] [MainThread]: 
18:00:09.676765 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/accepted_values_customers_78814b7ce7fca4528a65518db3449206.sql
18:00:09.676951 [info ] [MainThread]: 
18:00:09.677085 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:00:09.677202 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:00:09.677352 [info ] [MainThread]: 
18:00:09.677481 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:00:09.677613 [info ] [MainThread]: 
18:00:09.677743 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:00:09.677870 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:00:09.678019 [info ] [MainThread]: 
18:00:09.678137 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:00:09.678361 [info ] [MainThread]: 
18:00:09.678485 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
18:00:09.678727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0155a3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0154b57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0154b5a60>]}


============================== 2022-06-04 18:08:12.406389 | 15e37265-1cd0-4b8b-bd5f-acd93f59bdf4 ==============================
18:08:12.406403 [info ] [MainThread]: Running with dbt=1.1.0
18:08:12.406864 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:08:12.406973 [debug] [MainThread]: Tracking: tracking
18:08:12.410343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a76df550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a76df730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a76df430>]}
18:08:12.431520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:08:12.432370 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:08:12.442246 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:08:12.510179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15e37265-1cd0-4b8b-bd5f-acd93f59bdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a8f5edf0>]}
18:08:12.513968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15e37265-1cd0-4b8b-bd5f-acd93f59bdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a75ddf40>]}
18:08:12.514176 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:08:12.514342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15e37265-1cd0-4b8b-bd5f-acd93f59bdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a75dde80>]}
18:08:12.515225 [info ] [MainThread]: 
18:08:12.515513 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:12.516355 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:08:12.525216 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:12.525487 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:08:12.525584 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:08:12.531558 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:08:12.531772 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:12.531853 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:08:12.534944 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:08:12.536070 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:08:12.536361 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:08:12.539094 [debug] [MainThread]: Using postgres connection "master"
18:08:12.539245 [debug] [MainThread]: On master: BEGIN
18:08:12.539343 [debug] [MainThread]: Opening a new connection, currently in state init
18:08:12.545144 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:12.545406 [debug] [MainThread]: Using postgres connection "master"
18:08:12.545550 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:08:12.558456 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:08:12.559716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15e37265-1cd0-4b8b-bd5f-acd93f59bdf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a75ddd30>]}
18:08:12.559983 [debug] [MainThread]: On master: ROLLBACK
18:08:12.560354 [debug] [MainThread]: Using postgres connection "master"
18:08:12.560506 [debug] [MainThread]: On master: BEGIN
18:08:12.561143 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:08:12.561406 [debug] [MainThread]: On master: COMMIT
18:08:12.561500 [debug] [MainThread]: Using postgres connection "master"
18:08:12.561577 [debug] [MainThread]: On master: COMMIT
18:08:12.561987 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:12.562141 [debug] [MainThread]: On master: Close
18:08:12.562490 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:08:12.562678 [info ] [MainThread]: 
18:08:12.567220 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:12.567398 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:08:12.567751 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:12.567867 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:12.567949 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:12.573359 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:12.573513 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:12.573676 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:08:12.573861 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:12.573972 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:08:12.574102 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:12.574170 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:08:12.574396 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:12.575568 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:12.574839 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:12.575761 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:08:12.575982 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:12.576058 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:12.576123 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:12.575662 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:12.585982 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:12.574997 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:12.586240 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:08:12.580241 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:12.575482 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:12.586721 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:12.574678 [debug] [Thread-1  ]: finished collecting timing info
18:08:12.574927 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:12.586515 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:12.575250 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:12.587582 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:12.587000 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:12.587149 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:08:12.597847 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:12.597999 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:12.598081 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:12.600325 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:12.597394 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:12.587463 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:12.586830 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:12.603364 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:12.587692 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:12.606846 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:12.600661 [debug] [Thread-6  ]: finished collecting timing info
18:08:12.600961 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:12.587370 [debug] [Thread-5  ]: finished collecting timing info
18:08:12.609795 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:12.607096 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:12.607248 [debug] [Thread-3  ]: finished collecting timing info
18:08:12.611212 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:12.612188 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:12.609614 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:12.610805 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:12.600772 [debug] [Thread-2  ]: finished collecting timing info
18:08:12.610962 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: BEGIN
18:08:12.613629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:12.607374 [debug] [Thread-4  ]: finished collecting timing info
18:08:12.616379 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:12.612782 [debug] [Thread-7  ]: finished collecting timing info
18:08:12.613241 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:12.613477 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:12.607518 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:12.618483 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:12.613058 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:12.618684 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:12.620054 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:12.620288 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:08:12.621351 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:12.623370 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:12.623506 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:08:12.623579 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:08:12.622735 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:12.623036 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:12.624358 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:08:12.622527 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:12.624588 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:12.621653 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:08:12.624847 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:08:12.624714 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:08:12.625050 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:08:12.620423 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:08:12.625237 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:08:12.625633 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:12.625718 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:08:12.625773 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:08:12.623831 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:08:12.626436 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:08:12.628667 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.630461 [debug] [Thread-1  ]: finished collecting timing info
18:08:12.630671 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: ROLLBACK
18:08:12.630845 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: Close
18:08:12.630966 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:08:12.631111 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:12.631207 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:12.631481 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.06s]
18:08:12.631827 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:12.632937 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.634186 [debug] [Thread-6  ]: finished collecting timing info
18:08:12.634365 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:08:12.639882 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:08:12.640550 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.04s]
18:08:12.641315 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:12.648109 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:08:12.648380 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:08:12.648525 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:12.649266 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:08:12.648701 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:08:12.649123 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:12.649601 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:12.649432 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:12.648922 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:08:12.649734 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:08:12.649839 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:12.649988 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:12.650500 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.651406 [debug] [Thread-4  ]: finished collecting timing info
18:08:12.651661 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:08:12.651892 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:08:12.651975 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:12.652035 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:12.651772 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.652949 [debug] [Thread-5  ]: finished collecting timing info
18:08:12.653070 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:08:12.653248 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.653915 [debug] [Thread-2  ]: finished collecting timing info
18:08:12.654030 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:08:12.654123 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.655541 [debug] [Thread-7  ]: finished collecting timing info
18:08:12.654712 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:12.656332 [debug] [Thread-3  ]: finished collecting timing info
18:08:12.655652 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:08:12.654199 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:08:12.656432 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:08:12.656499 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:08:12.657168 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.08s]
18:08:12.656873 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
18:08:12.657421 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:12.657829 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:08:12.657660 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:12.654841 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:08:12.658391 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.08s]
18:08:12.658586 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:12.658111 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
18:08:12.658838 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:12.661245 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:08:12.661969 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
18:08:12.662309 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:12.664103 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:12.664257 [debug] [MainThread]: Using postgres connection "master"
18:08:12.664334 [debug] [MainThread]: On master: BEGIN
18:08:12.664392 [debug] [MainThread]: Opening a new connection, currently in state closed
18:08:12.669595 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:12.669854 [debug] [MainThread]: On master: COMMIT
18:08:12.669934 [debug] [MainThread]: Using postgres connection "master"
18:08:12.670005 [debug] [MainThread]: On master: COMMIT
18:08:12.670176 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:12.670305 [debug] [MainThread]: On master: Close
18:08:12.670684 [info ] [MainThread]: 
18:08:12.670848 [info ] [MainThread]: Finished running 7 tests in 0.16s.
18:08:12.670963 [debug] [MainThread]: Connection 'master' was properly closed.
18:08:12.671021 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
18:08:12.671077 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:08:12.671133 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:08:12.671187 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:08:12.671242 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:08:12.671294 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:08:12.671396 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:08:12.675066 [info ] [MainThread]: 
18:08:12.675470 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:08:12.675650 [info ] [MainThread]: 
18:08:12.675786 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:08:12.675932 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:08:12.676059 [info ] [MainThread]: 
18:08:12.676233 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:08:12.676378 [info ] [MainThread]: 
18:08:12.676505 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:08:12.676639 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:08:12.676762 [info ] [MainThread]: 
18:08:12.677000 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:08:12.677216 [info ] [MainThread]: 
18:08:12.677533 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
18:08:12.677889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a8f77250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a8f5e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11a40d0040>]}


============================== 2022-06-04 18:14:29.969158 | 282e22a7-ebbd-4002-84ec-30e599a767a3 ==============================
18:14:29.969171 [info ] [MainThread]: Running with dbt=1.1.0
18:14:29.969598 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:14:29.969712 [debug] [MainThread]: Tracking: tracking
18:14:29.972167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308a051e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308a051340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f308a051220>]}
18:14:29.996606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
18:14:29.996930 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_orders.sql
18:14:29.997135 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:14:30.006593 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:14:30.016398 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:14:30.045109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3089fd0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3089b01580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3089b01250>]}


============================== 2022-06-04 18:15:29.891829 | 22e85c0f-158d-4622-9240-cf888899fb5c ==============================
18:15:29.891842 [info ] [MainThread]: Running with dbt=1.1.0
18:15:29.892239 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:15:29.892333 [debug] [MainThread]: Tracking: tracking
18:15:29.895028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2cf8eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2cf8e280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2cf8e940>]}
18:15:29.923872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
18:15:29.924312 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_orders.sql
18:15:29.924552 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:15:29.931703 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:15:29.942063 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:15:29.968702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2ce91c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2ca3e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2ca3e250>]}


============================== 2022-06-04 18:15:55.796960 | ca111683-aa89-4120-ae31-772b3289a1b8 ==============================
18:15:55.796975 [info ] [MainThread]: Running with dbt=1.1.0
18:15:55.797363 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:15:55.797454 [debug] [MainThread]: Tracking: tracking
18:15:55.801486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e91a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e91ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e91ae20>]}
18:15:55.825610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
18:15:55.825984 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_orders.sql
18:15:55.826202 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:15:55.835717 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:15:55.845076 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:15:55.906105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2013a850>]}
18:15:55.909924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e819ee0>]}
18:15:55.910181 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:15:55.910355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e819df0>]}
18:15:55.911328 [info ] [MainThread]: 
18:15:55.911821 [debug] [MainThread]: Acquiring new postgres connection "master"
18:15:55.912693 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:15:55.920574 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:15:55.920768 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:15:55.920848 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:15:55.927680 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:15:55.928706 [debug] [ThreadPool]: On list_erp_oltp: Close
18:15:55.930011 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:15:55.934728 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:15:55.934896 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:15:55.934982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:15:55.940239 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:15:55.940694 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:15:55.940792 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:15:55.942405 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:15:55.943447 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:15:55.943702 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:15:55.946889 [debug] [MainThread]: Using postgres connection "master"
18:15:55.947016 [debug] [MainThread]: On master: BEGIN
18:15:55.947082 [debug] [MainThread]: Opening a new connection, currently in state init
18:15:55.951445 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:15:55.951736 [debug] [MainThread]: Using postgres connection "master"
18:15:55.951905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:15:55.962368 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:15:55.963534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e819b80>]}
18:15:55.963808 [debug] [MainThread]: On master: ROLLBACK
18:15:55.964037 [debug] [MainThread]: Using postgres connection "master"
18:15:55.964140 [debug] [MainThread]: On master: BEGIN
18:15:55.964318 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:15:55.964412 [debug] [MainThread]: On master: COMMIT
18:15:55.964480 [debug] [MainThread]: Using postgres connection "master"
18:15:55.964580 [debug] [MainThread]: On master: COMMIT
18:15:55.965243 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:15:55.965370 [debug] [MainThread]: On master: Close
18:15:55.965760 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:15:55.966149 [info ] [MainThread]: 
18:15:55.970339 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:15:55.970580 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
18:15:55.970891 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:15:55.970983 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:15:55.971065 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:15:55.972517 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:15:55.972966 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:15:55.973186 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:15:55.973697 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
18:15:55.973473 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
18:15:55.974583 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:15:55.974663 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:15:55.974164 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:15:55.974833 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:15:55.974735 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:15:55.974935 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:15:55.973315 [debug] [Thread-1  ]: finished collecting timing info
18:15:55.977750 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:15:55.977575 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:15:55.976512 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:15:55.993991 [debug] [Thread-2  ]: finished collecting timing info
18:15:55.994172 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:15:56.007423 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:15:56.009033 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:15:56.010231 [debug] [Thread-3  ]: finished collecting timing info
18:15:56.011028 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:15:56.015146 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:15:56.015715 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.015884 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:15:56.015958 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:15:56.016739 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.016906 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:15:56.016991 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:15:56.017337 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.017452 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:15:56.017515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:15:56.020687 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
18:15:56.020863 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.020963 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
18:15:56.022957 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:15:56.027808 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.027937 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:15:56.028289 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:15:56.028382 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.028443 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
18:15:56.029249 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.031123 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.031386 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:15:56.031535 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:15:56.034977 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.034742 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.035075 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:15:56.031670 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:15:56.035178 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:15:56.035679 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.035782 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.037037 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.041215 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:15:56.041353 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:15:56.041447 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:15:56.042875 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.043056 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:15:56.041571 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.043212 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:15:56.043449 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.045248 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:15:56.045353 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.045504 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.046900 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.045683 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:15:56.045584 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:15:56.047020 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:15:56.050793 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:56.051059 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:15:56.052343 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:56.052596 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:15:56.052496 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.051259 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:15:56.056252 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:15:56.056394 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:15:56.057133 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.058008 [debug] [Thread-3  ]: finished collecting timing info
18:15:56.058384 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:15:56.058244 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:15:56.058746 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e37adf0>]}
18:15:56.058919 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:15:56.060469 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.08s]
18:15:56.062002 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:15:56.061620 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:56.058115 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:15:56.062249 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:15:56.062444 [debug] [Thread-5  ]: Began running node model.first_project.customer2
18:15:56.065691 [info ] [Thread-5  ]: 4 of 6 START table model public.customer2 ...................................... [RUN]
18:15:56.066028 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customer2"
18:15:56.066130 [debug] [Thread-5  ]: Began compiling node model.first_project.customer2
18:15:56.066214 [debug] [Thread-5  ]: Compiling model.first_project.customer2
18:15:56.062530 [debug] [Thread-6  ]: Began running node model.first_project.customers
18:15:56.068214 [info ] [Thread-6  ]: 5 of 6 START view model public.customers ....................................... [RUN]
18:15:56.067973 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customer2"
18:15:56.065314 [debug] [Thread-2  ]: finished collecting timing info
18:15:56.068501 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
18:15:56.068940 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
18:15:56.069024 [debug] [Thread-6  ]: Compiling model.first_project.customers
18:15:56.070627 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
18:15:56.068701 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:15:56.071720 [debug] [Thread-1  ]: finished collecting timing info
18:15:56.070775 [debug] [Thread-5  ]: finished collecting timing info
18:15:56.070990 [debug] [Thread-6  ]: finished collecting timing info
18:15:56.072124 [debug] [Thread-6  ]: Began executing node model.first_project.customers
18:15:56.073853 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
18:15:56.074113 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:15:56.074229 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
18:15:56.074294 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:15:56.068851 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:15:56.071973 [debug] [Thread-5  ]: Began executing node model.first_project.customer2
18:15:56.071836 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:15:56.076729 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customer2"
18:15:56.077409 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.077538 [debug] [Thread-5  ]: On model.first_project.customer2: BEGIN
18:15:56.077604 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:15:56.077038 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1c2ccf40>]}
18:15:56.078435 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
18:15:56.078756 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:15:56.079039 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc233aeee0>]}
18:15:56.079374 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
18:15:56.079638 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:15:56.079909 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:15:56.080061 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
18:15:56.080309 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:15:56.080390 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:15:56.080463 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:15:56.082237 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:15:56.082545 [debug] [Thread-8  ]: finished collecting timing info
18:15:56.082727 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:15:56.091235 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:15:56.091632 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:56.091798 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:15:56.091883 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:15:56.092416 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:15:56.092530 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:15:56.092591 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select * from "erp_oltp"."public"."stg_orders"
),


customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:15:56.093108 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:15:56.093287 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.093409 [debug] [Thread-6  ]: Postgres adapter: Postgres error: relation "public.stg_orders" does not exist
LINE 9:   select * from "erp_oltp"."public"."stg_orders"
                        ^

18:15:56.093515 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:15:56.093632 [debug] [Thread-6  ]: On model.first_project.customers: ROLLBACK
18:15:56.094044 [debug] [Thread-6  ]: finished collecting timing info
18:15:56.094170 [debug] [Thread-6  ]: On model.first_project.customers: Close
18:15:56.094422 [debug] [Thread-6  ]: Database Error in model customers (models/erp/customers.sql)
  relation "public.stg_orders" does not exist
  LINE 9:   select * from "erp_oltp"."public"."stg_orders"
                          ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
18:15:56.094596 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e3782b0>]}
18:15:56.094846 [error] [Thread-6  ]: 5 of 6 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.03s]
18:15:56.095108 [debug] [Thread-6  ]: Finished running node model.first_project.customers
18:15:56.097107 [debug] [Thread-5  ]: SQL status: SELECT 100 in 0.0 seconds
18:15:56.099427 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.099701 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
18:15:56.102359 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:15:56.102580 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.102750 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:56.105576 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.105766 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:15:56.105953 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
18:15:56.106421 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.107515 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
18:15:56.107614 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.107680 [debug] [Thread-5  ]: On model.first_project.customer2: COMMIT
18:15:56.107763 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:15:56.109540 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:56.109643 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:15:56.109735 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
18:15:56.110672 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customer2"
18:15:56.110813 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:56.113832 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:15:56.113942 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:56.114053 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:15:56.112807 [debug] [Thread-5  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
18:15:56.121724 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
18:15:56.123390 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:56.123500 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:15:56.123841 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:15:56.124891 [debug] [Thread-8  ]: finished collecting timing info
18:15:56.125350 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:15:56.125927 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc2019ffd0>]}
18:15:56.127382 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:15:56.127661 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:15:56.127866 [debug] [Thread-5  ]: SQL status: DROP TABLE in 0.01 seconds
18:15:56.128813 [debug] [Thread-5  ]: finished collecting timing info
18:15:56.129016 [debug] [Thread-5  ]: On model.first_project.customer2: Close
18:15:56.129335 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca111683-aa89-4120-ae31-772b3289a1b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e3683d0>]}
18:15:56.129545 [info ] [Thread-5  ]: 4 of 6 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.06s]
18:15:56.129843 [debug] [Thread-5  ]: Finished running node model.first_project.customer2
18:15:56.133816 [debug] [MainThread]: Acquiring new postgres connection "master"
18:15:56.134091 [debug] [MainThread]: Using postgres connection "master"
18:15:56.134175 [debug] [MainThread]: On master: BEGIN
18:15:56.134244 [debug] [MainThread]: Opening a new connection, currently in state closed
18:15:56.138566 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:15:56.138759 [debug] [MainThread]: On master: COMMIT
18:15:56.138868 [debug] [MainThread]: Using postgres connection "master"
18:15:56.138936 [debug] [MainThread]: On master: COMMIT
18:15:56.139110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:15:56.139265 [debug] [MainThread]: On master: Close
18:15:56.139617 [info ] [MainThread]: 
18:15:56.139851 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.23s.
18:15:56.140000 [debug] [MainThread]: Connection 'master' was properly closed.
18:15:56.140071 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:15:56.140133 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:15:56.140191 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:15:56.140248 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
18:15:56.140307 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:15:56.140365 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:15:56.145220 [info ] [MainThread]: 
18:15:56.145579 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:15:56.145759 [info ] [MainThread]: 
18:15:56.145893 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
18:15:56.146022 [error] [MainThread]:   relation "public.stg_orders" does not exist
18:15:56.146141 [error] [MainThread]:   LINE 9:   select * from "erp_oltp"."public"."stg_orders"
18:15:56.146257 [error] [MainThread]:                           ^
18:15:56.146398 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
18:15:56.146527 [info ] [MainThread]: 
18:15:56.146653 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
18:15:56.146854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc20a937c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc20a93790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc1e3c0880>]}


============================== 2022-06-04 18:16:37.942797 | d46728d9-0e07-4e30-b12e-a12460cafa8d ==============================
18:16:37.942811 [info ] [MainThread]: Running with dbt=1.1.0
18:16:37.943309 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:16:37.943406 [debug] [MainThread]: Tracking: tracking
18:16:37.945821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2ee070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2ee040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2ee2b0>]}
18:16:37.967182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
18:16:37.967555 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:16:37.967742 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_orders.sql
18:16:37.977101 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:16:37.987682 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:16:38.042935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e19e3a0>]}
18:16:38.047376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f0460>]}
18:16:38.047689 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:16:38.047950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f0a00>]}
18:16:38.049054 [info ] [MainThread]: 
18:16:38.049390 [debug] [MainThread]: Acquiring new postgres connection "master"
18:16:38.050379 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:16:38.057202 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:16:38.057338 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:16:38.057422 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:16:38.065501 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:16:38.066551 [debug] [ThreadPool]: On list_erp_oltp: Close
18:16:38.067651 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:16:38.071346 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:16:38.071479 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:16:38.071545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:16:38.076141 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:16:38.076287 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:16:38.076355 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:16:38.078016 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
18:16:38.078908 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:16:38.079118 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:16:38.084556 [debug] [MainThread]: Using postgres connection "master"
18:16:38.084753 [debug] [MainThread]: On master: BEGIN
18:16:38.084865 [debug] [MainThread]: Opening a new connection, currently in state init
18:16:38.088743 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:16:38.088966 [debug] [MainThread]: Using postgres connection "master"
18:16:38.089037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:16:38.107256 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
18:16:38.108938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f0df0>]}
18:16:38.109308 [debug] [MainThread]: On master: ROLLBACK
18:16:38.109689 [debug] [MainThread]: Using postgres connection "master"
18:16:38.109892 [debug] [MainThread]: On master: BEGIN
18:16:38.110229 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:16:38.110395 [debug] [MainThread]: On master: COMMIT
18:16:38.110538 [debug] [MainThread]: Using postgres connection "master"
18:16:38.110672 [debug] [MainThread]: On master: COMMIT
18:16:38.110929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:16:38.111103 [debug] [MainThread]: On master: Close
18:16:38.111559 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:16:38.111904 [info ] [MainThread]: 
18:16:38.122437 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:16:38.125338 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:16:38.125489 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:16:38.125855 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:16:38.125620 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:16:38.125557 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:16:38.126163 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:16:38.127332 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:16:38.127423 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:16:38.127515 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:16:38.126942 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:16:38.128349 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:16:38.128909 [debug] [Thread-4  ]: finished collecting timing info
18:16:38.129006 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:16:38.128645 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:16:38.126679 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.139756 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:16:38.139504 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:16:38.126480 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:16:38.148535 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:16:38.139873 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:16:38.148159 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:16:38.147047 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:16:38.148666 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:16:38.150573 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:16:38.151467 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:16:38.153060 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:16:38.153565 [debug] [Thread-3  ]: finished collecting timing info
18:16:38.153707 [debug] [Thread-2  ]: finished collecting timing info
18:16:38.155195 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:16:38.154945 [debug] [Thread-1  ]: finished collecting timing info
18:16:38.156652 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:16:38.156518 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:16:38.154814 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:38.155074 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:16:38.170214 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:16:38.170671 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.172761 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:16:38.173010 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:16:38.172418 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:16:38.173301 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.173999 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:16:38.174091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:16:38.175003 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.175249 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:16:38.175680 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:16:38.170812 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:16:38.177242 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:16:38.182406 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:16:38.182649 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.182736 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:16:38.182991 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:16:38.183186 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.183275 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
18:16:38.184766 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:38.184972 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:16:38.193447 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.193621 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:16:38.194087 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.195436 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.195563 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:16:38.196138 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.196213 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
18:16:38.195666 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:16:38.196011 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:16:38.196333 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:38.196523 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
18:16:38.195876 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.196640 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:16:38.196761 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.198061 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:38.206065 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:38.206199 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:16:38.206301 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
18:16:38.210236 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.208600 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:16:38.210338 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:16:38.208407 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:16:38.210427 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.212633 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:16:38.211902 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.212767 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:38.213718 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:16:38.213249 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.216439 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.216576 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:16:38.217163 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.216695 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.221897 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:38.217914 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:16:38.222120 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.222209 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:16:38.222010 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:16:38.211734 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.213435 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:16:38.222387 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:16:38.222659 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:16:38.224801 [debug] [Thread-4  ]: finished collecting timing info
18:16:38.224948 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.225037 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.226982 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:38.225933 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:16:38.227184 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.227084 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:16:38.225119 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.227264 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:16:38.225215 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:16:38.229888 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f1730>]}
18:16:38.230296 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.10s]
18:16:38.229991 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.229289 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:16:38.229145 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:38.233062 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:16:38.232112 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:16:38.232903 [debug] [Thread-1  ]: finished collecting timing info
18:16:38.233924 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:16:38.231795 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:38.234776 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:16:38.235877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2dd4a220>]}
18:16:38.236201 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:16:38.236475 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
18:16:38.236646 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:16:38.238359 [debug] [Thread-2  ]: finished collecting timing info
18:16:38.237737 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:16:38.238472 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:16:38.237419 [debug] [Thread-3  ]: finished collecting timing info
18:16:38.239236 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:16:38.239473 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f1a60>]}
18:16:38.239687 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
18:16:38.238811 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
18:16:38.243964 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:16:38.239116 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f1850>]}
18:16:38.244243 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
18:16:38.244497 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:16:38.244733 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:16:38.245055 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
18:16:38.245136 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
18:16:38.246509 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:16:38.246790 [debug] [Thread-6  ]: finished collecting timing info
18:16:38.246921 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
18:16:38.248361 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:16:38.248596 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:38.248715 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
18:16:38.244915 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:16:38.249124 [debug] [Thread-8  ]: Began running node model.first_project.customer2
18:16:38.249286 [info ] [Thread-8  ]: 6 of 7 START table model public.customer2 ...................................... [RUN]
18:16:38.249531 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customer2"
18:16:38.249653 [debug] [Thread-8  ]: Began compiling node model.first_project.customer2
18:16:38.249736 [debug] [Thread-8  ]: Compiling model.first_project.customer2
18:16:38.251240 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customer2"
18:16:38.251446 [debug] [Thread-8  ]: finished collecting timing info
18:16:38.251575 [debug] [Thread-8  ]: Began executing node model.first_project.customer2
18:16:38.253924 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customer2"
18:16:38.254065 [debug] [Thread-9  ]: Began running node model.first_project.customers
18:16:38.254357 [info ] [Thread-9  ]: 7 of 7 START view model public.customers ....................................... [RUN]
18:16:38.254614 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
18:16:38.254731 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
18:16:38.254872 [debug] [Thread-9  ]: Compiling model.first_project.customers
18:16:38.248783 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:16:38.257270 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
18:16:38.257842 [debug] [Thread-9  ]: finished collecting timing info
18:16:38.257972 [debug] [Thread-9  ]: Began executing node model.first_project.customers
18:16:38.259562 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers"
18:16:38.259818 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:16:38.259913 [debug] [Thread-9  ]: On model.first_project.customers: BEGIN
18:16:38.259974 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:16:38.261098 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.261223 [debug] [Thread-8  ]: On model.first_project.customer2: BEGIN
18:16:38.261296 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:16:38.266689 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:16:38.267022 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
18:16:38.267204 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:38.267439 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:16:38.267760 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:16:38.267583 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:16:38.269648 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:38.271977 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:38.272133 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:38.272425 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:16:38.274366 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:16:38.274960 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:16:38.275173 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:16:38.275353 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.275655 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:16:38.275466 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.276423 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:16:38.276524 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:38.276591 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:16:38.276695 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.277692 [debug] [Thread-9  ]: On model.first_project.customers: COMMIT
18:16:38.277785 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:16:38.277849 [debug] [Thread-9  ]: On model.first_project.customers: COMMIT
18:16:38.278278 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
18:16:38.281997 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.282321 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.282503 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:16:38.285830 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:38.285984 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:16:38.282594 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
18:16:38.283702 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers"
18:16:38.286370 [debug] [Thread-9  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:16:38.286753 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.288041 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.288142 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
18:16:38.286504 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:16:38.288225 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
18:16:38.289173 [debug] [Thread-6  ]: finished collecting timing info
18:16:38.290308 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
18:16:38.290062 [debug] [Thread-9  ]: finished collecting timing info
18:16:38.289337 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:38.292662 [debug] [Thread-8  ]: On model.first_project.customer2: COMMIT
18:16:38.291732 [debug] [Thread-9  ]: On model.first_project.customers: Close
18:16:38.290764 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2c4ecee0>]}
18:16:38.293361 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:16:38.292764 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.293705 [debug] [Thread-8  ]: On model.first_project.customer2: COMMIT
18:16:38.294994 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2e41f0>]}
18:16:38.295215 [info ] [Thread-9  ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
18:16:38.295598 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
18:16:38.295938 [debug] [Thread-9  ]: Finished running node model.first_project.customers
18:16:38.296225 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:16:38.297494 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customer2"
18:16:38.297636 [debug] [Thread-8  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
18:16:38.299333 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
18:16:38.300070 [debug] [Thread-8  ]: finished collecting timing info
18:16:38.300228 [debug] [Thread-8  ]: On model.first_project.customer2: Close
18:16:38.300601 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd46728d9-0e07-4e30-b12e-a12460cafa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2dd909a0>]}
18:16:38.300851 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.05s]
18:16:38.301139 [debug] [Thread-8  ]: Finished running node model.first_project.customer2
18:16:38.302450 [debug] [MainThread]: Acquiring new postgres connection "master"
18:16:38.302562 [debug] [MainThread]: Using postgres connection "master"
18:16:38.302625 [debug] [MainThread]: On master: BEGIN
18:16:38.302680 [debug] [MainThread]: Opening a new connection, currently in state closed
18:16:38.308691 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:16:38.309080 [debug] [MainThread]: On master: COMMIT
18:16:38.309260 [debug] [MainThread]: Using postgres connection "master"
18:16:38.309389 [debug] [MainThread]: On master: COMMIT
18:16:38.309563 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:16:38.309660 [debug] [MainThread]: On master: Close
18:16:38.310009 [info ] [MainThread]: 
18:16:38.310164 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.26s.
18:16:38.310277 [debug] [MainThread]: Connection 'master' was properly closed.
18:16:38.310336 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:16:38.310392 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:16:38.310504 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:16:38.310560 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:16:38.310610 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:16:38.310661 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
18:16:38.310712 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:16:38.314982 [info ] [MainThread]: 
18:16:38.315261 [info ] [MainThread]: [32mCompleted successfully[0m
18:16:38.316774 [info ] [MainThread]: 
18:16:38.316963 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:16:38.317154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2e23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2e2f0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d2fb0a5b0>]}


============================== 2022-06-04 18:20:00.444659 | 213ce5bd-25dd-462f-80e1-8ca18948a3a7 ==============================
18:20:00.444680 [info ] [MainThread]: Running with dbt=1.1.0
18:20:00.445183 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:20:00.445285 [debug] [MainThread]: Tracking: tracking
18:20:00.447520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1c4d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1c4dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1c4d6d0>]}
18:20:00.468521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:20:00.469034 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:20:00.479571 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:20:00.537377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '213ce5bd-25dd-462f-80e1-8ca18948a3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac346a790>]}
18:20:00.540573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '213ce5bd-25dd-462f-80e1-8ca18948a3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1b92160>]}
18:20:00.540851 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:20:00.541044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213ce5bd-25dd-462f-80e1-8ca18948a3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1b92040>]}
18:20:00.542100 [info ] [MainThread]: 
18:20:00.542426 [debug] [MainThread]: Acquiring new postgres connection "master"
18:20:00.543241 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:20:00.550049 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:20:00.550156 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:20:00.550224 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:20:00.556694 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:20:00.556958 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:20:00.557057 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:20:00.559485 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:20:00.561067 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:20:00.561504 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:20:00.565219 [debug] [MainThread]: Using postgres connection "master"
18:20:00.565378 [debug] [MainThread]: On master: BEGIN
18:20:00.565450 [debug] [MainThread]: Opening a new connection, currently in state init
18:20:00.570195 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:20:00.570348 [debug] [MainThread]: Using postgres connection "master"
18:20:00.570416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:20:00.582410 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:20:00.583924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213ce5bd-25dd-462f-80e1-8ca18948a3a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1b489d0>]}
18:20:00.584217 [debug] [MainThread]: On master: ROLLBACK
18:20:00.584634 [debug] [MainThread]: Using postgres connection "master"
18:20:00.584801 [debug] [MainThread]: On master: BEGIN
18:20:00.585036 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:20:00.585133 [debug] [MainThread]: On master: COMMIT
18:20:00.585225 [debug] [MainThread]: Using postgres connection "master"
18:20:00.585313 [debug] [MainThread]: On master: COMMIT
18:20:00.585449 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:20:00.585541 [debug] [MainThread]: On master: Close
18:20:00.585820 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:20:00.585987 [info ] [MainThread]: 
18:20:00.591079 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:00.591505 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:20:00.592273 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:00.592419 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:00.592524 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:00.598362 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:00.598544 [debug] [Thread-3  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:20:00.601719 [info ] [Thread-3  ]: 3 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_customers_  [RUN]
18:20:00.602013 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:20:00.602105 [debug] [Thread-3  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:20:00.601571 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:20:00.602181 [debug] [Thread-3  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:20:00.598654 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:00.598722 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:00.605668 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
18:20:00.602455 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:00.605379 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:20:00.605546 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
18:20:00.605920 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:00.606499 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:00.606036 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:00.606711 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:00.606584 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:00.601407 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:00.606396 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:00.606810 [debug] [Thread-3  ]: finished collecting timing info
18:20:00.609190 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:00.616261 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:00.616620 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:00.616879 [debug] [Thread-3  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:20:00.617134 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:00.628578 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:20:00.634024 [debug] [Thread-3  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:20:00.631125 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:00.634295 [debug] [Thread-4  ]: finished collecting timing info
18:20:00.634453 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:00.628805 [debug] [Thread-5  ]: finished collecting timing info
18:20:00.635689 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:00.635521 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:00.637048 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:00.637150 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:20:00.636682 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:00.637489 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:00.637224 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:20:00.633740 [debug] [Thread-1  ]: finished collecting timing info
18:20:00.638162 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:00.637607 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:20:00.639298 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:20:00.634118 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: BEGIN
18:20:00.639503 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:20:00.633488 [debug] [Thread-2  ]: finished collecting timing info
18:20:00.639688 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:00.639152 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:00.640936 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:00.641070 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:20:00.641134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:20:00.640618 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:00.641498 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:00.641608 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:20:00.641670 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:20:00.645345 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:20:00.645556 [debug] [Thread-3  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:20:00.645633 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "erp_oltp"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "erp_oltp"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
18:20:00.647732 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:00.649298 [debug] [Thread-3  ]: finished collecting timing info
18:20:00.649447 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: ROLLBACK
18:20:00.650306 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:20:00.650449 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:00.650520 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:20:00.651302 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:00.652493 [debug] [Thread-4  ]: finished collecting timing info
18:20:00.652717 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:20:00.653133 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:20:00.653619 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.05s]
18:20:00.654244 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: Close
18:20:00.654609 [info ] [Thread-3  ]: 3 of 5 PASS relationships_stg_orders_customer_id__customer_id__ref_customers_ .. [[32mPASS[0m in 0.05s]
18:20:00.655129 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:00.655430 [debug] [Thread-3  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:20:00.657178 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:20:00.657344 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:00.657457 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:20:00.659138 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:00.660709 [debug] [Thread-5  ]: finished collecting timing info
18:20:00.660905 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:20:00.661714 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:20:00.661882 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:00.661987 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:20:00.662070 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:20:00.663276 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
18:20:00.663584 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:00.671443 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:20:00.675474 [debug] [Thread-1  ]: finished collecting timing info
18:20:00.675786 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:20:00.676205 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
18:20:00.676306 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:00.676374 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:20:00.676912 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:20:00.677267 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.09s]
18:20:00.677524 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:00.679160 [debug] [Thread-2  ]: finished collecting timing info
18:20:00.679489 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:00.679690 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:20:00.680567 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:20:00.680967 [info ] [Thread-2  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
18:20:00.681227 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:00.685221 [debug] [MainThread]: Acquiring new postgres connection "master"
18:20:00.685380 [debug] [MainThread]: Using postgres connection "master"
18:20:00.685483 [debug] [MainThread]: On master: BEGIN
18:20:00.685552 [debug] [MainThread]: Opening a new connection, currently in state closed
18:20:00.694475 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:20:00.694689 [debug] [MainThread]: On master: COMMIT
18:20:00.694767 [debug] [MainThread]: Using postgres connection "master"
18:20:00.694840 [debug] [MainThread]: On master: COMMIT
18:20:00.695744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:20:00.695915 [debug] [MainThread]: On master: Close
18:20:00.696247 [info ] [MainThread]: 
18:20:00.696434 [info ] [MainThread]: Finished running 5 tests in 0.15s.
18:20:00.696556 [debug] [MainThread]: Connection 'master' was properly closed.
18:20:00.696616 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:20:00.696674 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
18:20:00.696729 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:20:00.696785 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:20:00.696878 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:20:00.700183 [info ] [MainThread]: 
18:20:00.700466 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:20:00.700702 [info ] [MainThread]: 
18:20:00.700957 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:20:00.701158 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:20:00.701296 [info ] [MainThread]: 
18:20:00.701405 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:20:00.701521 [info ] [MainThread]: 
18:20:00.701624 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
18:20:00.701798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac1b6f580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac3af75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac0644d00>]}


============================== 2022-06-04 18:23:26.509193 | 3ae8ecfe-a6de-446f-886f-65009533dbd7 ==============================
18:23:26.509217 [info ] [MainThread]: Running with dbt=1.1.0
18:23:26.509903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:23:26.510040 [debug] [MainThread]: Tracking: tracking
18:23:26.513699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffde4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffde48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffde4be0>]}
18:23:26.536542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:23:26.537008 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:23:26.544369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffd110d0>]}
18:23:26.550079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffd664c0>]}
18:23:26.550468 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:23:26.550705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffd66520>]}
18:23:26.552552 [info ] [MainThread]: 
18:23:26.554096 [debug] [MainThread]: Acquiring new postgres connection "master"
18:23:26.555667 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:23:26.562301 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:23:26.562467 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:23:26.562546 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:23:26.568930 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:23:26.571627 [debug] [ThreadPool]: On list_erp_oltp: Close
18:23:26.573045 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:23:26.576534 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:23:26.576658 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:23:26.576723 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:23:26.580709 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:23:26.580896 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:23:26.580979 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:23:26.585049 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:23:26.586293 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:23:26.586769 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:23:26.589772 [debug] [MainThread]: Using postgres connection "master"
18:23:26.589885 [debug] [MainThread]: On master: BEGIN
18:23:26.589953 [debug] [MainThread]: Opening a new connection, currently in state init
18:23:26.594112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:23:26.594245 [debug] [MainThread]: Using postgres connection "master"
18:23:26.594310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:23:26.604701 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:23:26.605857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffcddcd0>]}
18:23:26.606155 [debug] [MainThread]: On master: ROLLBACK
18:23:26.606378 [debug] [MainThread]: Using postgres connection "master"
18:23:26.606459 [debug] [MainThread]: On master: BEGIN
18:23:26.606641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:23:26.606722 [debug] [MainThread]: On master: COMMIT
18:23:26.606801 [debug] [MainThread]: Using postgres connection "master"
18:23:26.606859 [debug] [MainThread]: On master: COMMIT
18:23:26.606977 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:23:26.607060 [debug] [MainThread]: On master: Close
18:23:26.607322 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:23:26.607528 [info ] [MainThread]: 
18:23:26.612779 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:23:26.613117 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:23:26.613581 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:23:26.613976 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:23:26.613376 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:23:26.614383 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:23:26.614486 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:23:26.614586 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:23:26.613181 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:23:26.616246 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:23:26.616488 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:23:26.616045 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:23:26.616563 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:23:26.616729 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:23:26.617541 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:23:26.617729 [debug] [Thread-1  ]: finished collecting timing info
18:23:26.617866 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:23:26.614066 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:23:26.651431 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:23:26.652482 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:23:26.613022 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:23:26.658483 [debug] [Thread-4  ]: finished collecting timing info
18:23:26.658852 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:23:26.665093 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.664520 [debug] [Thread-3  ]: finished collecting timing info
18:23:26.664693 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:23:26.665217 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:23:26.663902 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:23:26.681648 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.671123 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:23:26.684232 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:23:26.684507 [debug] [Thread-2  ]: finished collecting timing info
18:23:26.684641 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:23:26.681811 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:23:26.686562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:23:26.665436 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:23:26.686332 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:23:26.682561 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:23:26.689233 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:23:26.689918 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.689589 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.690049 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:23:26.690158 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:23:26.690336 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:23:26.690476 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:23:26.692090 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.692201 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:23:26.692272 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:23:26.692517 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:23:26.692703 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.692825 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:23:26.694045 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:23:26.698527 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.698972 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:23:26.699175 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:23:26.699333 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.699450 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
18:23:26.699785 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.701254 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.701347 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:23:26.701467 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:23:26.705542 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.705692 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:23:26.705889 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.711323 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:23:26.711480 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:23:26.711632 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.715783 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
18:23:26.715510 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.715983 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:23:26.716316 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.717076 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:23:26.717169 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:23:26.719217 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.719319 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:23:26.717533 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.717361 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:23:26.719466 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:23:26.719584 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.719797 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
18:23:26.720097 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.721660 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.721815 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:23:26.723570 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.721981 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.723662 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:23:26.722146 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:23:26.727524 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.727063 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:23:26.728763 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.729285 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:23:26.728974 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.729109 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:23:26.730086 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:23:26.730316 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.730381 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:23:26.730173 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.731095 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:23:26.731186 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.731252 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:23:26.713530 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:23:26.731443 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.731535 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:23:26.731804 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:23:26.732742 [debug] [Thread-3  ]: finished collecting timing info
18:23:26.732907 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:23:26.733024 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.733101 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.736272 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:23:26.736379 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:23:26.735265 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffc91d90>]}
18:23:26.736702 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
18:23:26.737009 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:23:26.733155 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.738308 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:23:26.737357 [debug] [Thread-6  ]: Began running node model.first_project.customer2
18:23:26.738417 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:23:26.734950 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:23:26.738598 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
18:23:26.738712 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:23:26.740755 [debug] [Thread-2  ]: finished collecting timing info
18:23:26.739948 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
18:23:26.741016 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
18:23:26.740905 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:23:26.739451 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:23:26.741112 [debug] [Thread-6  ]: Compiling model.first_project.customer2
18:23:26.743068 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
18:23:26.741474 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffc91bb0>]}
18:23:26.743406 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.08s]
18:23:26.741185 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:23:26.743677 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:23:26.743857 [debug] [Thread-6  ]: finished collecting timing info
18:23:26.745048 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
18:23:26.746540 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
18:23:26.746763 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.746895 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
18:23:26.746963 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:23:26.744112 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:23:26.749606 [debug] [Thread-4  ]: finished collecting timing info
18:23:26.749742 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:23:26.750187 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffc91f70>]}
18:23:26.750454 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.13s]
18:23:26.744791 [debug] [Thread-1  ]: finished collecting timing info
18:23:26.752195 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:23:26.752583 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffc919a0>]}
18:23:26.752851 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.14s]
18:23:26.753120 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:23:26.753762 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:23:26.753920 [info ] [Thread-8  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:23:26.754172 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:23:26.754259 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:23:26.754342 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:23:26.751871 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:23:26.756094 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:23:26.756542 [debug] [Thread-10 ]: Began running node model.first_project.customers
18:23:26.756739 [info ] [Thread-10 ]: 7 of 7 START view model public.customers ....................................... [RUN]
18:23:26.756988 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
18:23:26.757131 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
18:23:26.757199 [debug] [Thread-10 ]: Compiling model.first_project.customers
18:23:26.758684 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
18:23:26.758952 [debug] [Thread-10 ]: finished collecting timing info
18:23:26.759099 [debug] [Thread-10 ]: Began executing node model.first_project.customers
18:23:26.760450 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
18:23:26.760669 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:23:26.760748 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
18:23:26.760886 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:23:26.761256 [debug] [Thread-8  ]: finished collecting timing info
18:23:26.761397 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:23:26.765239 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:23:26.765623 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:23:26.765764 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:23:26.765836 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:23:26.766397 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:23:26.766501 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.766567 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:23:26.768529 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:23:26.771210 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.771724 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
18:23:26.771854 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
18:23:26.772064 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:23:26.772139 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:23:26.772354 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.775701 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.777549 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
18:23:26.779482 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.01 seconds
18:23:26.781001 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:23:26.781120 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.781247 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:23:26.782231 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
18:23:26.782466 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.782565 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
18:23:26.782732 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.783790 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:23:26.783906 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.784056 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:23:26.784168 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
18:23:26.787361 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:23:26.787155 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:23:26.787462 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:23:26.786824 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
18:23:26.787732 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
18:23:26.788502 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
18:23:26.789920 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:23:26.790014 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:23:26.790119 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
18:23:26.790925 [debug] [Thread-6  ]: finished collecting timing info
18:23:26.791051 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
18:23:26.791235 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:23:26.793674 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:23:26.792054 [debug] [Thread-10 ]: finished collecting timing info
18:23:26.793917 [debug] [Thread-10 ]: On model.first_project.customers: Close
18:23:26.794303 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22fc3a0df0>]}
18:23:26.794515 [info ] [Thread-10 ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
18:23:26.793786 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:23:26.791392 [debug] [Thread-6  ]: On model.first_project.customer2: Close
18:23:26.794793 [debug] [Thread-10 ]: Finished running node model.first_project.customers
18:23:26.796512 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22fc387f70>]}
18:23:26.796642 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:23:26.797790 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:23:26.798249 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:23:26.798370 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:23:26.801021 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:23:26.802110 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:23:26.802293 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:23:26.802706 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:23:26.804286 [debug] [Thread-8  ]: finished collecting timing info
18:23:26.804485 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:23:26.809634 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.06s]
18:23:26.810312 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ae8ecfe-a6de-446f-886f-65009533dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22fc3ade80>]}
18:23:26.810615 [info ] [Thread-8  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
18:23:26.810887 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
18:23:26.811149 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:23:26.812560 [debug] [MainThread]: Acquiring new postgres connection "master"
18:23:26.812696 [debug] [MainThread]: Using postgres connection "master"
18:23:26.812809 [debug] [MainThread]: On master: BEGIN
18:23:26.813064 [debug] [MainThread]: Opening a new connection, currently in state closed
18:23:26.816997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:23:26.817150 [debug] [MainThread]: On master: COMMIT
18:23:26.817224 [debug] [MainThread]: Using postgres connection "master"
18:23:26.817291 [debug] [MainThread]: On master: COMMIT
18:23:26.817471 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:23:26.817606 [debug] [MainThread]: On master: Close
18:23:26.817955 [info ] [MainThread]: 
18:23:26.818173 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.26s.
18:23:26.818339 [debug] [MainThread]: Connection 'master' was properly closed.
18:23:26.818430 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:23:26.818528 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:23:26.818618 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:23:26.818673 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:23:26.818724 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
18:23:26.818776 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:23:26.818845 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:23:26.823556 [info ] [MainThread]: 
18:23:26.824841 [info ] [MainThread]: [32mCompleted successfully[0m
18:23:26.825122 [info ] [MainThread]: 
18:23:26.825278 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:23:26.825521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffd11130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffcddf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22ffc6a4f0>]}


============================== 2022-06-04 20:29:28.815849 | 676e424b-6bcb-47d8-93d6-f1cbea783341 ==============================
20:29:28.815864 [info ] [MainThread]: Running with dbt=1.1.0
20:29:28.816326 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:29:28.816462 [debug] [MainThread]: Tracking: tracking
20:29:28.819821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563922280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65639227c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563922700>]}
20:29:28.840396 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:29:28.840729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563929880>]}
20:29:28.851877 [debug] [MainThread]: Parsing macros/catalog.sql
20:29:28.855102 [debug] [MainThread]: Parsing macros/relations.sql
20:29:28.856906 [debug] [MainThread]: Parsing macros/adapters.sql
20:29:28.874674 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:29:28.875795 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:29:28.877353 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:29:28.880838 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:29:28.887418 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:29:28.896958 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:29:28.909992 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:29:28.913380 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:29:28.914460 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:29:28.915308 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:29:28.916820 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:29:28.918589 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:29:28.923170 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:29:28.927859 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:29:28.929882 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:29:28.940215 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:29:28.944121 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:29:28.945611 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:29:28.948529 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:29:28.949777 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:29:28.958162 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:29:28.969292 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:29:28.975736 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:29:28.976835 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:29:28.978263 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:29:28.979218 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:29:28.980120 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:29:28.985945 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:29:28.999620 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:29:29.001423 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:29:29.002906 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:29:29.004692 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:29:29.009016 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:29:29.011734 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:29:29.012304 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:29:29.012876 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:29:29.013322 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:29:29.014182 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:29:29.019546 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:29:29.022637 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:29:29.174577 [debug] [MainThread]: 1699: static parser successfully parsed erp/customer2.sql
20:29:29.182693 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
20:29:29.184416 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
20:29:29.186138 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
20:29:29.187628 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
20:29:29.189233 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
20:29:29.190630 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
20:29:29.258339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65633ec070>]}
20:29:29.263067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563922700>]}
20:29:29.263407 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:29:29.263735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65638b5fa0>]}
20:29:29.265358 [info ] [MainThread]: 
20:29:29.265821 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:29.272896 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:29:29.279356 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:29:29.279538 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:29:29.279609 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:29:29.292571 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:29:29.293677 [debug] [ThreadPool]: On list_erp_oltp: Close
20:29:29.294862 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:29:29.299593 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:29:29.299778 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:29:29.299854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:29:29.305593 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:29:29.305766 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:29:29.305873 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:29:29.308014 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:29:29.309930 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:29:29.310281 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:29:29.314037 [debug] [MainThread]: Using postgres connection "master"
20:29:29.314228 [debug] [MainThread]: On master: BEGIN
20:29:29.314297 [debug] [MainThread]: Opening a new connection, currently in state init
20:29:29.318781 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:29.318944 [debug] [MainThread]: Using postgres connection "master"
20:29:29.319030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:29:29.329889 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
20:29:29.331004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65633ec100>]}
20:29:29.331292 [debug] [MainThread]: On master: ROLLBACK
20:29:29.331516 [debug] [MainThread]: Using postgres connection "master"
20:29:29.331611 [debug] [MainThread]: On master: BEGIN
20:29:29.331805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:29.331899 [debug] [MainThread]: On master: COMMIT
20:29:29.331968 [debug] [MainThread]: Using postgres connection "master"
20:29:29.332031 [debug] [MainThread]: On master: COMMIT
20:29:29.332306 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:29.332475 [debug] [MainThread]: On master: Close
20:29:29.332813 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:29:29.333034 [info ] [MainThread]: 
20:29:29.337307 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:29:29.337569 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:29:29.337895 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:29:29.337990 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:29:29.338073 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:29:29.339731 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:29:29.340001 [debug] [Thread-1  ]: finished collecting timing info
20:29:29.340173 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:29:29.345999 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:29:29.346240 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:29:29.346679 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.346779 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:29:29.346855 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:29:29.348439 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:29:29.348642 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:29:29.348837 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:29:29.354973 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
20:29:29.367375 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
20:29:29.368373 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:29:29.368074 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:29:29.367687 [debug] [Thread-2  ]: finished collecting timing info
20:29:29.368947 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:29:29.368462 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:29:29.368830 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:29:29.368682 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:29:29.378042 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:29:29.378193 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:29:29.388016 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:29:29.387282 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:29:29.386057 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:29:29.388423 [debug] [Thread-3  ]: finished collecting timing info
20:29:29.388731 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:29:29.390314 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:29:29.390501 [debug] [Thread-4  ]: finished collecting timing info
20:29:29.390629 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:29:29.391960 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:29:29.392245 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.392335 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:29:29.392398 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:29:29.392819 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.392917 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:29:29.392981 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:29:29.393440 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.393525 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:29:29.393582 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:29:29.394056 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.394158 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:29:29.394215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:29.398936 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
20:29:29.399177 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.399252 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
)

select * from orders
  );
20:29:29.400313 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:29:29.400448 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.400510 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:29:29.400612 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
20:29:29.400724 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.400840 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:29.400964 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente        as customer_id,
    nome                  as first_name,
    sobrenome             as last_name,
    codigo_regiao         as region_code,
    estado                as state
  from erp_oltp.public.clientes
)

select * from customers
  );
20:29:29.406380 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.407357 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
20:29:29.407859 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.410296 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.410469 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:29:29.410620 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:29.412566 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.414929 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:29:29.414520 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.415081 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
20:29:29.414794 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
20:29:29.415219 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.415293 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),

final as (
  select * from source_customers
)

select * from final
  );
20:29:29.415412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.416704 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.416995 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:29:29.417338 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.416841 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.425013 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.425171 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
20:29:29.417085 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:29.425437 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:29.427137 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.427265 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:29.427435 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.410852 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
20:29:29.429037 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:29:29.429602 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.429730 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:29:29.426970 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.429259 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:29:29.429925 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
20:29:29.430126 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.436052 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:29:29.435131 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
20:29:29.436211 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.437651 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:29:29.436359 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.434749 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:29.439298 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.439678 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
20:29:29.437403 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:29.439465 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
20:29:29.440859 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:29.439845 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
20:29:29.439563 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
20:29:29.440964 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.441065 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
20:29:29.442656 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:29:29.442892 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.442983 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:29:29.443079 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:29:29.446039 [debug] [Thread-1  ]: finished collecting timing info
20:29:29.446197 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:29.446319 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
20:29:29.448563 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:29.447281 [debug] [Thread-4  ]: finished collecting timing info
20:29:29.448784 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:29:29.448664 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
20:29:29.446411 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
20:29:29.449689 [debug] [Thread-3  ]: finished collecting timing info
20:29:29.449829 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:29:29.450640 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65633cfdf0>]}
20:29:29.450931 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.08s]
20:29:29.451365 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:29:29.446532 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:29:29.452085 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65633e1df0>]}
20:29:29.452381 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.08s]
20:29:29.452638 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:29:29.453260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65602fbbb0>]}
20:29:29.453398 [debug] [Thread-6  ]: Began running node model.first_project.customer2
20:29:29.455090 [info ] [Thread-6  ]: 5 of 7 START table model public.customer2 ...................................... [RUN]
20:29:29.455382 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customer2"
20:29:29.454794 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
20:29:29.455476 [debug] [Thread-6  ]: Began compiling node model.first_project.customer2
20:29:29.456557 [debug] [Thread-6  ]: Compiling model.first_project.customer2
20:29:29.453503 [debug] [Thread-7  ]: Began running node model.first_project.customers
20:29:29.458478 [info ] [Thread-7  ]: 6 of 7 START view model public.customers ....................................... [RUN]
20:29:29.458756 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
20:29:29.458285 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customer2"
20:29:29.458846 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
20:29:29.459037 [debug] [Thread-7  ]: Compiling model.first_project.customers
20:29:29.460744 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
20:29:29.456385 [debug] [Thread-2  ]: finished collecting timing info
20:29:29.461396 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:29:29.461152 [debug] [Thread-6  ]: finished collecting timing info
20:29:29.461271 [debug] [Thread-7  ]: finished collecting timing info
20:29:29.463280 [debug] [Thread-7  ]: Began executing node model.first_project.customers
20:29:29.461580 [debug] [Thread-6  ]: Began executing node model.first_project.customer2
20:29:29.468642 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customer2"
20:29:29.465658 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
20:29:29.453793 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
20:29:29.469100 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
20:29:29.469345 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.469645 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
20:29:29.469816 [debug] [Thread-6  ]: On model.first_project.customer2: BEGIN
20:29:29.470435 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:29:29.470003 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:29:29.470330 [debug] [Thread-7  ]: Opening a new connection, currently in state init
20:29:29.470227 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6565850940>]}
20:29:29.471542 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
20:29:29.472360 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:29:29.472655 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:29:29.472745 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
20:29:29.472872 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
20:29:29.474506 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:29:29.474742 [debug] [Thread-9  ]: finished collecting timing info
20:29:29.474914 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
20:29:29.477055 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:29:29.477452 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:29.477553 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
20:29:29.477620 [debug] [Thread-9  ]: Opening a new connection, currently in state init
20:29:29.479039 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
20:29:29.479491 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:29:29.482384 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
20:29:29.482551 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.482628 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */


  create  table "erp_oltp"."public"."customer2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),

orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
  from erp_oltp.public.pedidos
),

customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
20:29:29.483951 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
20:29:29.484145 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:29.484236 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
20:29:29.485162 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:29.487242 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:29.487338 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
20:29:29.488756 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.487417 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:29:29.488930 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2" rename to "customer2__dbt_backup"
20:29:29.489368 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
20:29:29.489483 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
20:29:29.489551 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),

final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
20:29:29.489631 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.489817 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.491103 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.495368 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:29.496425 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:29.496234 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
alter table "erp_oltp"."public"."customer2__dbt_tmp" rename to "customer2"
20:29:29.496515 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:29.496051 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.01 seconds
20:29:29.497141 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.498959 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
20:29:29.500324 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
20:29:29.499062 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
20:29:29.500173 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
20:29:29.502447 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:29.503034 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
20:29:29.502803 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.502613 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:29.503190 [debug] [Thread-6  ]: On model.first_project.customer2: COMMIT
20:29:29.504917 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
20:29:29.505293 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:29.505458 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
20:29:29.506393 [debug] [Thread-9  ]: finished collecting timing info
20:29:29.506741 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
20:29:29.506606 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
20:29:29.507090 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560263fa0>]}
20:29:29.507325 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
20:29:29.506493 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
20:29:29.508507 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customer2"
20:29:29.508642 [debug] [Thread-6  ]: On model.first_project.customer2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customer2"} */
drop table if exists "erp_oltp"."public"."customer2__dbt_backup" cascade
20:29:29.508977 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
20:29:29.513820 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
20:29:29.515776 [debug] [Thread-6  ]: finished collecting timing info
20:29:29.516041 [debug] [Thread-6  ]: On model.first_project.customer2: Close
20:29:29.516757 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6560278790>]}
20:29:29.517668 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customer2 ................................. [[32mSELECT 100[0m in 0.06s]
20:29:29.518094 [debug] [Thread-6  ]: Finished running node model.first_project.customer2
20:29:29.520909 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
20:29:29.522471 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
20:29:29.522602 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
20:29:29.522998 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:29.524435 [debug] [Thread-7  ]: finished collecting timing info
20:29:29.524615 [debug] [Thread-7  ]: On model.first_project.customers: Close
20:29:29.526730 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676e424b-6bcb-47d8-93d6-f1cbea783341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563383880>]}
20:29:29.527031 [info ] [Thread-7  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
20:29:29.527356 [debug] [Thread-7  ]: Finished running node model.first_project.customers
20:29:29.528741 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:29.528895 [debug] [MainThread]: Using postgres connection "master"
20:29:29.529064 [debug] [MainThread]: On master: BEGIN
20:29:29.529185 [debug] [MainThread]: Opening a new connection, currently in state closed
20:29:29.533614 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:29.533857 [debug] [MainThread]: On master: COMMIT
20:29:29.533943 [debug] [MainThread]: Using postgres connection "master"
20:29:29.534008 [debug] [MainThread]: On master: COMMIT
20:29:29.534767 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:29.534906 [debug] [MainThread]: On master: Close
20:29:29.535252 [info ] [MainThread]: 
20:29:29.536332 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.27s.
20:29:29.536494 [debug] [MainThread]: Connection 'master' was properly closed.
20:29:29.536562 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:29:29.536627 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:29:29.536681 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:29:29.536733 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:29:29.536786 [debug] [MainThread]: Connection 'model.first_project.customer2' was properly closed.
20:29:29.536863 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
20:29:29.536916 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:29:29.542024 [info ] [MainThread]: 
20:29:29.542250 [info ] [MainThread]: [32mCompleted successfully[0m
20:29:29.542522 [info ] [MainThread]: 
20:29:29.542669 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:29:29.542876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6565aa6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6565a9a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6563362b80>]}


============================== 2022-06-04 20:31:12.276304 | 964d5732-31fd-4765-b09c-39bedd30ca36 ==============================
20:31:12.276331 [info ] [MainThread]: Running with dbt=1.1.0
20:31:12.277115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
20:31:12.277269 [debug] [MainThread]: Tracking: tracking
20:31:12.280856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3964c6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3964c6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3964c64f0>]}
20:31:12.307836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:31:12.308043 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:31:12.316769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '964d5732-31fd-4765-b09c-39bedd30ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa39637b0d0>]}
20:31:12.322409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '964d5732-31fd-4765-b09c-39bedd30ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c78b0>]}
20:31:12.322679 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:31:12.322916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '964d5732-31fd-4765-b09c-39bedd30ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c7940>]}
20:31:12.323974 [info ] [MainThread]: 
20:31:12.324368 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:12.325085 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:31:12.331851 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:31:12.332057 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:31:12.332136 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:12.341802 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:31:12.343886 [debug] [ThreadPool]: On list_erp_oltp: Close
20:31:12.346788 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:31:12.350544 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:31:12.350658 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:31:12.350727 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:12.355458 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:31:12.355600 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:31:12.355678 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:31:12.357250 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:31:12.358226 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:31:12.358410 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:31:12.362592 [debug] [MainThread]: Using postgres connection "master"
20:31:12.362874 [debug] [MainThread]: On master: BEGIN
20:31:12.363023 [debug] [MainThread]: Opening a new connection, currently in state init
20:31:12.367262 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:12.367404 [debug] [MainThread]: Using postgres connection "master"
20:31:12.367471 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:31:12.380873 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
20:31:12.382039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '964d5732-31fd-4765-b09c-39bedd30ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c74f0>]}
20:31:12.382323 [debug] [MainThread]: On master: ROLLBACK
20:31:12.382656 [debug] [MainThread]: Using postgres connection "master"
20:31:12.382755 [debug] [MainThread]: On master: BEGIN
20:31:12.382970 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:12.383067 [debug] [MainThread]: On master: COMMIT
20:31:12.383128 [debug] [MainThread]: Using postgres connection "master"
20:31:12.383185 [debug] [MainThread]: On master: COMMIT
20:31:12.383298 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:12.383385 [debug] [MainThread]: On master: Close
20:31:12.383685 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:31:12.383846 [info ] [MainThread]: 
20:31:12.388917 [debug] [Thread-1  ]: Began running node seed.first_project.code-country
20:31:12.389171 [info ] [Thread-1  ]: 1 of 1 START seed file public.code-country ..................................... [RUN]
20:31:12.389463 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.first_project.code-country"
20:31:12.389575 [debug] [Thread-1  ]: Began compiling node seed.first_project.code-country
20:31:12.389668 [debug] [Thread-1  ]: finished collecting timing info
20:31:12.389904 [debug] [Thread-1  ]: Began executing node seed.first_project.code-country
20:31:12.425835 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:12.425981 [debug] [Thread-1  ]: On seed.first_project.code-country: BEGIN
20:31:12.426054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:31:12.431051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:31:12.431280 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:12.431356 [debug] [Thread-1  ]: On seed.first_project.code-country: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "seed.first_project.code-country"} */

    create table "erp_oltp"."public"."code-country" ("Name" text,"Code" text)
  
20:31:12.435102 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.0 seconds
20:31:12.554732 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:12.554948 [debug] [Thread-1  ]: On seed.first_project.code-country: 
          insert into "erp_oltp"."public"."code-country" ("Name", "Code") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,...
20:31:12.556339 [debug] [Thread-1  ]: SQL status: INSERT 0 249 in 0.0 seconds
20:31:12.558987 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.first_project.code-country"
20:31:12.566717 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:31:12.566914 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:12.567007 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:31:12.569249 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:31:12.569658 [debug] [Thread-1  ]: finished collecting timing info
20:31:12.569793 [debug] [Thread-1  ]: On seed.first_project.code-country: Close
20:31:12.570170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '964d5732-31fd-4765-b09c-39bedd30ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c7400>]}
20:31:12.570366 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.code-country ................................. [[32mINSERT 249[0m in 0.18s]
20:31:12.570712 [debug] [Thread-1  ]: Finished running node seed.first_project.code-country
20:31:12.572037 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:12.572155 [debug] [MainThread]: Using postgres connection "master"
20:31:12.572251 [debug] [MainThread]: On master: BEGIN
20:31:12.572346 [debug] [MainThread]: Opening a new connection, currently in state closed
20:31:12.577774 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:31:12.577971 [debug] [MainThread]: On master: COMMIT
20:31:12.578050 [debug] [MainThread]: Using postgres connection "master"
20:31:12.578113 [debug] [MainThread]: On master: COMMIT
20:31:12.578271 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:12.578373 [debug] [MainThread]: On master: Close
20:31:12.578701 [info ] [MainThread]: 
20:31:12.578941 [info ] [MainThread]: Finished running 1 seed in 0.25s.
20:31:12.579089 [debug] [MainThread]: Connection 'master' was properly closed.
20:31:12.579152 [debug] [MainThread]: Connection 'list_erp_oltp' was properly closed.
20:31:12.579209 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
20:31:12.585621 [info ] [MainThread]: 
20:31:12.585931 [info ] [MainThread]: [32mCompleted successfully[0m
20:31:12.586254 [info ] [MainThread]: 
20:31:12.586688 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:31:12.587104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3963c7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa396362f10>]}
